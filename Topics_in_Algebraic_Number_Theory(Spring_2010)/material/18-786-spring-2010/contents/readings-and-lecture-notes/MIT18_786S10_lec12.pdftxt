ALGEBRAIC  NUMBER  THEORY 

LECTURE  12  NOTES 

1.  Section  5.5 

Note that  τ (1)2  = ( −
1 ) holds  in  characteristic  0  as  well  as  characteristic  q  (set 
p 
w  =  e2π i/p ),  since  it  doesn’t  use  any  property of  ﬁnite  ﬁelds.  It  allows  us  to  see 
what  the  unique  quadratic  subﬁeld  of  Q(ζp )  is:  start  with  a  generator  ζp  =  w 
of  Q(ζp ) and  symmetrize  with  respect  to  the  unique  subgroup  of  index  2  of  the 
Galois group (which is isomorphic  to (Z/pZ)∗  under  a  ∈ (Z/pZ)∗ 
7→  ζ a)p
7→  (ζp 
).  The  subgroup  consists  of the  squares in (Z/pZ)∗ ,  so  the  quadratic  extension 
is generated by  � a∈(F∗ 
2 
a if  the  sum  is  nonzero.  This  sum  equals 
p )2  ζp
1  � � a
p  �  ζ a  = 
p  ��  ζ a  =  − 2
1  � 1 +  � a
�  2
1
τ (1)
p
p

2
2 
a∈F∗

a∈F∗ 
p 
p
This  sum  is  nonzero  since  |τ (1)| =  √p.  So  the  quadratic  subﬁeld  in  question  is 
indeed  Q(�( −1 )p) which  is  Q(√p) if  p ≡ 1  mod  4  and  Q(√−p) if  p ≡ 3  mod  4. 
p 
We  know  the  Gauss  sum  up  to  sign  since  we  know  its  square.  For  the  compu­
tation  of  the  sign  see  for  example  Flath’s  book  on  number  theory,  which  has  a 
nice  proof  using  the  ﬁnite  Fourier  transform.  For  a  good  introduction  to  Gauss 
and  Jacobi  sums  see  Ireland  and  Rosen’s  book. 

− 1 

+

.

2.  Section  5.6 

To  see  that  if  n  is  a  sum  of  two  squares  then  every  prime  which  is  3  mod 
4 divides  n  to  an  even  power  we  argue  by  contradiction.  Let  n  be  a  smallest 
counterexample  and let  p ≡ 3 mod 4 divide  n  to an odd power.  Write  n  =  a2 + b2 
and  notice  that  p  cannot divide  a  or  b  since  then  it  would  have  to  divide  both 
(sum  of  their  squares  is  divisible  by p),  and  then  n/p2  = (a/p)2  + (b/p)2  would 
6 | b  in particular,  and  so (ab−1)2  ≡ −1 
furnish  a  smaller  counterexample.  So  p 
mod  p,  which  contradicts  p ≡ 3  mod  4. 
3.  Section  5.7 

Proof  of  four  squares  theorem.  By multiplicativity  of quaternion norms, it’s enough 
to see that  every prime is a sum of four squares.  Since this is trivial for 2, assume 
1 

2 

LECTURE  12  NOTES 

p  is  an  odd prime.  Now, the Chevalley-Warning  theorem  shows that for  every  p, 
there  are  integers  a, b  such that  a2  +  b2  + 1  ≡ 0  mod  p.  So  let’s  assume  we  have 
2
2
2 
2 
x  +  y  +  z  +  w  =  mp 

for  some  positive  integer  m.  We  can  reduce  x, y , z , w  mod  p  to  assume  their 
absolute  values  are  less  than  p/2 (since  p  is  odd).  Then  the  LHS  is  less  than 
4(p/2)2  =  p2 ,  so  m < p. 
If  m  =  1  we  are  done.  So  assume  m >  1.  We 
will  then  produce  another  solution  with  smaller  m.  Since  there  are  only  ﬁnitely 
many  positive  integers  less  than  m,  eventually  we  will  reach  m  =  1.  Now  if 
x, y , z , w  are  all  divisible  by  m  then  we  get  after  dividing  my  m2  that  p/m  = 
(x/m)2  + (y/m)2  + (z/m)2  + (w/m)2  .  But  the  RHS  is  an  integer  and  the  LHS  is 
not,  since  1  < m < p,  so  that’s  impossible. 
′ 
′ 
′
′
So  reduce  x, y , z , w  mod  m  to get  x , y  , z  , w  with  absolute  values  less  than 
or  equal  to  m/2.  We  then  have  x ′2  +  y  ′2  +  z  ′2  +  w  ′2 
x2  +  y 2  +  z 2  +  w2 
2  ≡
≡
0 
mod  m.  Also  x ′2  +  y
′2  + 
′2  + 
′2
w  ≤ 4(m/2)2  =  m .  In  fact  we  can  assume  that 
z
′
′ 
′ 
′
strict  inequality  holds,  since  if  m  is  even  and  x , y  , z  , w  all  have  absolute  value 
m/2,  then  they  are  all  ±m/2  and  so  are  congruent  mod  m  to  m/2.  Hence  so  are 
x, y , z , w ,  so  in  particular  x, y , z , w  are  all  even  or  all  odd.  Then  we  can  replace 
x, y , z , w  by (x  + y )/2, (x  − y )/2, (z  + w)/2, (z  − w)/2  and  whose  sum  of  squares 
is just (x2  + y 2  + z 2  + w2)/2  = (m/2)p  to  reduce  m.  So  now  we  can  assume  that 
x ′2  +  y  ′2  +  z  ′2  +  w  ′2  =  km  with 0  < k  < m  and  with  x  ≡ x ′  mod  m  etc. 
Then  letting  u  =  x  +  y i  +  zj  +  wk  and  v  =  x  +  y  ′ i  +  z  ′  j +  w  ′ k  we  have 
′ 
N (u) =  pm, N (v ) =  N (v ) =  km,  so  N (uv ) =  pkm2  .  But  also  uv  ≡ vv  mod 
m  ≡ km  ≡ 0.  Hence  the  components  of  uv  are  all  divisible  by  m.  So  we  can 
divide  out  the  representation  as  a  sum  of  four  squares  pkm2  =  N (uv ) by  m2  to 
get  pk  = sum of four squares.  This completes the descent  step  and  shows  we  can 
� 
achieve  m  = 1  ultimately,  which  implies  p  is  a  sum  of  four  squares. 

Problem.  What’s  the  fastest  algorithm  you  can  think  of  for  expressing  a  given 
integer  as  a  sum  of  four  squares? 

Remark.  If  we  start  counting  the  number  of  representations  of  n  as a sum of four 
squares,  this  leads  us  naturally  to  modular  forms. 
For  example,  deﬁne  r4 (n) by 
(1 + 2q + 2q  4  + 2q  +  . . .  )4  =  � r4 (n)q . 
n
9 
Then  it’s  easy  to  see  that  r4(n) is  the  number  of  representations  of  n  as  a  sum 
of four integer  squares (positive  or  negative). 
Now  θ  = (1 + 2q + 2q 4  + 2q 9  +  . . .  ) is  the  theta  function  of  the  integer  lattice 
Z.  If  we  plug  in  q  =  e2π iz  it  becomes  a  function  of  a  complex  variable  z .  Usually 
we let  z  ∈ H,  the  upper  half  complex  plane  {x  +  iy | y >  0}. 

3 

ϑ4 

7→  z  + 1. 

ALGEBRAIC  NUMBER  THEORY 
So let  ϑ4 (z) =  � r4(n)e
2π inz 
.  Then  ϑ4  is  clearly  unchanged  under  z 
But  ϑ4  satisﬁes  another  transformation  property: 
�  1 � − z 
=  −z  2ϑ4 (z).
We  won’t  prove  it  here,  but  it  follows  by  using  the  Poisson  summation  formula:

1  � f�(y )
� f (x) = 
vol(Λ) 
y∈Λ∗ 
x∈Λ 
for  any  Schwarz  function  f  on  Rn  where  f� is the Fourier transform, deﬁned by 
f�(t) =  � Rn  f (x)e
2π itx dx.
These  two  transformation  properties  are  enough  to  make  ϑ4  into  a  modular 
form for the group  SL2(Z) of  weight  2.  It  lies  in  the  ﬁnite  dimensional  space  of 
modular  forms  of  weight  2  for  SL2 (Z).  We  can  arguments  from  the  theory  of 
modular  forms  to  show,  for  instance,  that 
r4(n) = 8  �  d 
d|n,46 |d 
For  an  introduction  to  modular  forms,  see  Serre’s  “A  course  in  arithmetic”. 

Remark.  A  famous  theorem  of  Hurwitz  states  that  the  only  normed  algebras 
over  R  are  R,  the  complex  numbers  C, the Hamiltonian quaternions  H,  and  the 
octonions or Cayley  numbers  O. For the proof see Conway  and Smith’s book  “On 
quaternions  and  octonions”  or  the  book  “Numbers”  by  Eddbinghaus.  Hurwitz 
also  showed  that  if  K  is  a  ﬁeld  of  characteristic  not  equal  to  2,  then  the  only 
values  of  n  for  which  there  is  an  identity  of  the  type 
+  z  2 
+  y  2 ) =  z1
+  x 2 )(y1
2  +
2  +
2  +
· · · 
· · · 
· · · 
(x1
n
n
n 
where the  zk  are  bilinear  functions  of  the  xi  and  the  yj  with  coeﬃcients  in  K  are 
n  = 1, 2, 4, 8. 
But  surprisingly, in 1967, Pﬁster showed  that there is such  an expression if  n  is 
any power of 2  and  we allow  Zk  to be linear functions of  the  Yj  with  coeﬃcients in 
the rational function  ﬁeld  K (X1 , . . . , Xn ).  In particular, the product  of  a sume of 
n  squares turns out to be a sum of  n  squares.  Conversely, if  n  is not  a power of 2, 
then  there  can  be  no  such  general  identity  with  Zk  ∈ K (X1 , . . . , Xn , Y1 , . . . , Yn). 
This  is  a  consequence  of  Pﬁster’s  beautiful  theory  of  multiplicative  forms. 

MIT OpenCourseWare
http://ocw.mit.edu 

18.786 Topics in Algebraic Number Theory 
Spring 2010 

For information about citing these materials or our Terms of Use, visit: http://ocw.mit.edu/terms . 

