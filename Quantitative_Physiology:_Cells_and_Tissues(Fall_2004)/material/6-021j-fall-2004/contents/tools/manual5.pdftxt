CELLULAR BIOPHYSICS:
TEACHING AND LEARNING
WITH COMPUTER SIMULATIONS

By
Thomas Fischer Weiss

with the assistance of
Scott I. Berkenblit, Tanmaya S. Bhatnagar, Elana B. Doering,
David Huang, David Koehler, Tommy Ng, Leela Obilichetti,
Stephanie Peek, Devang M. Shah, Giancarlo Trevisan

Department of Electrical Engineering and Computer Science
Massachusetts Institute of Technology

FALL 2000

Date of last modiﬁcation: August 28, 2000

ii

iii

Preface

Historical perspective

During the 1980’s the use of computers and information technologies began to
have an impact on higher education (Kulik and Kulik, 1986; Balestri, 1988; Wil-
son and Redish, 1989; Athena, 1990a; Athena, 1990b). As an integral part of
this trend, in 1983 MIT in partnership with the Digital Equipment Corporation
and the IBM Corporation launched Project Athena which was designed to make
computation available to undergraduate students through a network of com-
puters located in public clusters on the MIT campus (Athena, 1990a; Athena,
1990b). A major objective of Project Athena was to improve undergraduate ed-
ucation through the use of computation and information technologies. Faculty
were encouraged to participate, and support for faculty software developers was
provided on a competitive basis.
I had been involved in teaching cellular biophysics at MIT since the 1960’s.
The possibility of using software as a pedagogical aid was intriguing. With sup-
port from Project Athena, a software package on the Hodgkin-Huxley model for
nerve excitation was developed as part of an undergraduate thesis (by David
Huang), and was ﬁrst used to teach cellular biophysics in the Fall 1984 semester.
The software was designed to be easy to use so that a student’s attention would
be focussed on the Hodgkin-Huxley model and not on the computer. Informal
discussions with students and a survey of student views showed that the soft-
ware was an enormous success. During the ﬁrst semester, the software was
used primarily in lecture demonstrations and as the basis for student projects.
Both pedagogic methods were found to be eﬀective. The use of the software
in lecture was very eﬀective in motivating and engaging students. The student
projects were eﬀective in allowing students to pursue a research project of their
choice with staﬀ assistance. For many students this was their ﬁrst experience
with a research project. The use of these projects, developed in the ﬁrst year,
was so successful that it has been used ever since.
The initial results with the Hodgkin-Huxley software were so successful ed-
ucationally, that several other software development projects involving student
programmers were launched. During this phase of software development, 5
software packages were developed and, in one form or another, have been used
every year to teach the subject. All of these packages were revised extensively in
response to suggestions from students and staﬀ. The original software runs on
UNIX workstations under MIT’s Project Athena and is available to the MIT com-
munity on a network of about 1000 UNIX workstations located in public clusters
on the MIT campus as well as in some living groups. All this software was written
in C and XWindows and was based on a library of graphic user interface subrou-
tines written by one of the students (Giancarlo Trevisan). The software has been
used in lectures, in recitations held in an electronic classroom in which each

iv

student uses a workstation, in homework assignments, and in student projects.
Various modes of use of the software in teaching were developed and are de-
scribed brieﬂy elsewhere (Weiss et al., 1992) and more extensively in the last
chapter of this text. The software has become an integral part of the subject,
and it is diﬃcult to imagine teaching the subject without the software.
Several problems became apparent in the development and utilization of the
software. First, it was very expensive, in time and in money, to develop the
software with the software tools available in the late 1980’s. Much of the time
was expended in the development of graphic user interfaces that make the soft-
ware easy for the user but which are tedious for the programmers to specify.
These graphic user interfaces had to be written in a low-level language (XWin-
dows). After 1991, funds from corporate sponsors were no longer available to
support the development of new software which slowed considerably. Second,
maintenance of the software became a major headache. It became diﬃcult for
a single faculty member with research, teaching, and other academic commit-
ments to maintain a library of software in the face of changes in the operating
systems. Third, as word spread about the existence of the software, educators
and students outside of MIT requested the software. These requests accelerated
dramatically after one of the software packages entitled Hodgkin-Huxley Model
won the 1990 EDUCOM/NCRIPTAL Higher Education Software award for Best En-
gineering Software. However, almost all of the requests came from students and
faculty with access to Macintosh or PC computers and not to UNIX workstations.
Thus, when these people were informed that the software ran only on UNIX
workstations, they invariably lost interest. At the time the software was written,
the computational power of workstations so exceeded that of personal comput-
ers (PCs) that it was simply not possible to provide the type of performance on
PCs that was achieved on the workstations. Furthermore, MIT’s Project Athena
was committed to a network of UNIX workstations. Thus, for both software and
hardware considerations, it did not make sense to port the existing software to
PCs. The high cost of software development and maintenance did not justify
further development of educational software on UNIX workstations alone, and
the development of new software was terminated in 1991.
By 1995, a number of developments made it feasible to address the prob-
lems described above and to develop software for teaching cellular biophysics
in a manner that would make it easier to maintain, easier to modify, and widely
available. Thus, all the software was rewritten to operate under MATLAB, which
is a software package produced by The MathWorks, Inc., for the following rea-
sons:
• MATLAB is a powerful interpretive computational and visualization soft-
ware package with a large number of higher-level built-in functions. Thus,
it is suitable for the development of educational software packages.
• MATLAB is available for most computer platforms. The vendor supports

v

changes in MATLAB that are required as changes in computer platforms
occur. With the use of software built on MATLAB, this major maintenance
job is transferred from individual faculty members to the vendor who has
both the ﬁnancial incentive and expertise to maintain the vendor software.
• Large improvements in performance of PCs have made the development
of computationally intensive educational software feasible on these plat-
forms.
• MATLAB has provided increasingly sophisticated tools for building graphic
user interfaces (GUIs). These GUIs are essential for building user-friendly
educational software packages.
• MATLAB has rapidly become the de facto leader in supporting educational
computational subjects at MIT and elsewhere. Thus, students are exposed
to MATLAB in other subjects and the diﬀerent exposures are mutually re-
inforcing.

Here, we describe this MATLAB-based version of the software which now con-
stitutes 6 packages. The most recent addition to the library of packages is one
devoted to the propagated action potential along an unmyelinated nerve ﬁber.
Although the software is not linked directly to any textbook, it was developed
in parallel with textbooks in cellular biophysics (Weiss, 1996a; Weiss, 1996b).

Acknowledgement

A number of people contributed to the success of the development of this soft-
ware. We thank Project Athena, especially its two directors Steven Lerman and
Earll Murman, for their support. In addition Gerald Wilson, Joel Moses, Richard
Adler, Paul Penﬁeld, and Jeﬀrey Shapiro were unfailingly supportive of this ef-
fort. A number of students were involved in this eﬀort. For many students
the software project constituted a portion of their undergraduate thesis require-
ment; others (as norws) used the software projects to satisfy SM thesis require-
ments. David Huang wrote the ﬁrst version of the Hodgkin-Huxley model pack-
age. David Koehler also contributed to this package. Devang M. Shah wrote
the ﬁrst version of the random-walk model package which was also revised by
Elana B. Doering. Chapter 2 is based heavily on Devang’s thesis (Shah, 1990).
Scott I. Berkenblit wrote the ﬁrst version of the macroscopic diﬀusion package.
Chapter 3 is based heavily on Scott’s Master of Science thesis (Berkenblit, 1990).
Stephanie Peek and Leela Obilichetti helped to develop the carrier-mediated
transport package. Giancarlo Trevisan was a major contributor to all the pack-
ages. He wrote the ﬁrst version of the voltage-gated ion channel package. He
later rewrote the Hodgkin-Huxley package and the carrier-mediated transport
package. He wrote all the graphic user interface routines that were ultimately
used by all the packages. Generations of students beneﬁted from his eﬀorts. The

vi

recipients of the 1990 EDUCOM/NCRIPTAL Higher Education Software Award for
Best Engineering Software for the Hodgkin-Huxley package were Thomas Weiss,
Giancarlo Trevisan, and David Huang. More than 15 generations of the students
who took the subject helped to ﬁnd ﬂaws in the software and made valuable
suggestions for its improvements. Tanmaya S. Bhatnagar ported all the original
ﬁve software packages to MATLAB, adding new features and improving many of
them substantially. His sense of esthetics marks all the packages. Tommy Ng
wrote the elegant propagated action potential package described in Chapter 6
which constituted his Master of Engineering thesis project. The chapter is based
heavily on Tommy’s thesis.
Besides the support from Project Athena, the development of the software
was supported by the Howard Hughes Medical Institute for which we are grate-
ful. I was supported in part by the Thomas and Gerd Perkins professorship. The
porting of the software to MATLAB was supported for 3 years by the National
Science Foundation (NSF), Division of Undergraduate Education. We would par-
ticularly like to thank Dr. Herbert Levitan, Section Head of Course and Curricu-
lum Development of NSF. Dr. Karen C. Cohen has been helpful in the evaluation
of the software. Subsequent work has been supported by the MIT Class of ’51
Fund for Excellence in Education, the MIT Class of ’55 Fund for Excellence in
Teaching, and the MIT Class of ’72 Fund for Educational Innovation, and by a
John F. and Virginia B. Taplin Faculty Fellowship.

Contact information

Information on cellular biophysics texts, errata, changes, etc. can be found in
the study materials section.

Contents

1 INTRODUCTION
1.1 Motivation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.2 Overview Of Software Packages . . . . . . . . . . . . . . . . . . . . . . .
1.3 Brief Introduction To MATLAB . . . . . . . . . . . . . . . . . . . . . . .
1.3.1 Jargon . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.3.2 Help . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.4 General Operation Of The Software . . . . . . . . . . . . . . . . . . . .
1.4.1 Directory structure . . . . . . . . . . . . . . . . . . . . . . . . . .
1.4.2 Starting the software . . . . . . . . . . . . . . . . . . . . . . . . .
1.4.3 Quitting the software . . . . . . . . . . . . . . . . . . . . . . . . .
1.4.4 Printing a ﬁgure . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.4.5 Reading from and saving to a ﬁle . . . . . . . . . . . . . . . . .

1
2
2
3
4
5
5
5
6
7
7
7

9
2 RANDOM WALK MODEL OF DIFFUSION
2.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11
2.1.1 Historical background . . . . . . . . . . . . . . . . . . . . . . . . 11
2.1.2 Macroscopic and microscopic models . . . . . . . . . . . . . . . 11
2.1.3 Overview of software . . . . . . . . . . . . . . . . . . . . . . . . . 12
2.2 Description Of The Random-Walk Model . . . . . . . . . . . . . . . . . 13
2.2.1 Particle parameters within a region . . . . . . . . . . . . . . . . 14
2.2.2 Boundary conditions . . . . . . . . . . . . . . . . . . . . . . . . . 16
2.3 User’s Guide To The Software . . . . . . . . . . . . . . . . . . . . . . . . 18
2.3.1 RW Control
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18
2.3.2 RW Particle . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18
2.4 Problems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26

3 MACROSCOPIC DIFFUSION PROCESSES
33
3.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34
3.1.1 Background . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34
3.1.2 Macroscopic model of diﬀusion . . . . . . . . . . . . . . . . . . 34
3.1.3 Overview of software . . . . . . . . . . . . . . . . . . . . . . . . . 35
3.2 Methods of Solution . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37
3.2.1 Analytic solutions . . . . . . . . . . . . . . . . . . . . . . . . . . . 37
3.2.2 Numerical Solutions . . . . . . . . . . . . . . . . . . . . . . . . . . 40

vii

viii

CONTENTS

3.2.3 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40
3.3 User’s Guide To The Software . . . . . . . . . . . . . . . . . . . . . . . . 41
3.3.1 MD Control
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41
3.3.2 MD Initial concentration proﬁle . . . . . . . . . . . . . . . . . . 42
3.3.3 Numerics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48
3.3.4 Simulation results ﬁgures . . . . . . . . . . . . . . . . . . . . . . 48
3.3.5 Arbitrary concentration proﬁles . . . . . . . . . . . . . . . . . . 51
3.4 Problems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53

59
4 CARRIER-MEDIATED TRANSPORT
4.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60
4.2 Models . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60
4.2.1 Steady-state behavior of a simple, four-state carrier that binds
one solute . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 61
4.2.2 Steady-state behavior of a simple, six-state carrier that binds
two solutes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 63
4.2.3 Transient and steady-state behavior of a general, four-state
carrier that binds one solute . . . . . . . . . . . . . . . . . . . . 66
4.3 Numerical Methods . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69
4.3.1 Numerical methods . . . . . . . . . . . . . . . . . . . . . . . . . . 69
4.3.2 Choice of numerical parameters . . . . . . . . . . . . . . . . . . 69
4.4 User’s Guide . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69
4.4.1 CMT Control
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70
4.4.2 Model
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 71
4.4.3 Steady-state interactive analysis . . . . . . . . . . . . . . . . . . 71
4.4.4 Steady-state graphic analysis . . . . . . . . . . . . . . . . . . . . 75
4.4.5 Transient analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . 78
4.5 Problems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81

5 HODGKIN-HUXLEY MODEL
87
5.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 88
5.1.1 Background . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 88
5.1.2 Overview of the software . . . . . . . . . . . . . . . . . . . . . . 88
5.2 Description Of The Model
. . . . . . . . . . . . . . . . . . . . . . . . . . 89
5.2.1 Voltage-clamp and current-clamp conﬁgurations . . . . . . . . 89
5.2.2 The membrane current density components . . . . . . . . . . 89
5.2.3 The membrane conductances . . . . . . . . . . . . . . . . . . . . 90
5.2.4 The activation and inactivation factors . . . . . . . . . . . . . . 91
5.2.5 The rate constants . . . . . . . . . . . . . . . . . . . . . . . . . . . 91
5.2.6 Time constants and equilibrium values of activation and in-
activation factors . . . . . . . . . . . . . . . . . . . . . . . . . . . 92
5.2.7 Default values of parameters . . . . . . . . . . . . . . . . . . . . 92
5.3 Numerical Methods . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 93
5.3.1 Background . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 93

ix
CONTENTS
5.3.2 Choice of integration step ∆t . . . . . . . . . . . . . . . . . . . . 93
5.3.3 Method for computing solutions . . . . . . . . . . . . . . . . . . 94
5.4 User’s Guide To The Software . . . . . . . . . . . . . . . . . . . . . . . . 94
5.4.1 HH Control
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 95
5.4.2 HH Parameters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 95
5.4.3 HH Stimulus . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 101
5.4.4 Numerics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 104
5.4.5 Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 104
5.4.6 Scripts . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 107
5.5 Problems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 111
5.6 PROJECTS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 118
5.6.1 Practical considerations in the choice of a topic . . . . . . . . 118
5.6.2 Choice of topics . . . . . . . . . . . . . . . . . . . . . . . . . . . . 118

6 PROPAGATED ACTION POTENTIAL
125
6.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 126
6.1.1 Background . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 126
6.1.2 Overview of the software . . . . . . . . . . . . . . . . . . . . . . 126
6.2 Theory . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 127
6.2.1 Core conductor equations . . . . . . . . . . . . . . . . . . . . . . 127
6.2.2 Representation of stimulating electrodes . . . . . . . . . . . . 128
6.2.3 Longitudinal currents . . . . . . . . . . . . . . . . . . . . . . . . . 129
6.2.4 Intracellular and extracellular potential diﬀerences . . . . . . 130
6.2.5 The membrane current density . . . . . . . . . . . . . . . . . . . 130
6.2.6 The membrane conductances . . . . . . . . . . . . . . . . . . . . 131
6.2.7 Default values of parameters . . . . . . . . . . . . . . . . . . . . 131
6.3 Numerical Method of Solution . . . . . . . . . . . . . . . . . . . . . . . 131
6.3.1 Forward Euler method . . . . . . . . . . . . . . . . . . . . . . . . 132
6.3.2 Backward Euler method . . . . . . . . . . . . . . . . . . . . . . . 134
6.3.3 Crank-Nicolson method . . . . . . . . . . . . . . . . . . . . . . . 136
6.3.4 Staggered increment Crank-Nicolson method . . . . . . . . . . 138
6.4 User’s Guide to the Software . . . . . . . . . . . . . . . . . . . . . . . . 140
6.4.1 PAP Control . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 141
6.4.2 PAP Workspace . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 142
6.4.3 PAP Parameters . . . . . . . . . . . . . . . . . . . . . . . . . . . . 144
6.4.4 PAP Stimulus . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 149
6.4.5 PAP Numerics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 150
6.4.6 PAP Voltage-Recorder . . . . . . . . . . . . . . . . . . . . . . . . . 152
6.4.7 PAP Variable Summary . . . . . . . . . . . . . . . . . . . . . . . . 153
6.4.8 PAP Space-Time Evolution . . . . . . . . . . . . . . . . . . . . . . 153
6.4.9 PAP 3D Plots . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 155
6.4.10 PAP Comparison Plots . . . . . . . . . . . . . . . . . . . . . . . . 156
6.4.11 Step-by-step Guide To Setting Up A Customized Simulation . 162
6.5 Problems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 163

x

CONTENTS

6.6 PROJECTS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 170

7 VOLTAGE-GATED ION CHANNELS
173
7.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 174
7.1.1 Historical background . . . . . . . . . . . . . . . . . . . . . . . . 174
7.1.2 Overview of software . . . . . . . . . . . . . . . . . . . . . . . . . 174
7.2 Description Of The Model
. . . . . . . . . . . . . . . . . . . . . . . . . . 175
7.3 Numerical Methods . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 178
7.3.1 Integration step . . . . . . . . . . . . . . . . . . . . . . . . . . . . 178
7.3.2 Initial conditions . . . . . . . . . . . . . . . . . . . . . . . . . . . . 179
7.4 User’s Guide . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 180
7.4.1 IC Control . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 180
7.4.2 IC Parameters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 181
7.4.3 Membrane potential . . . . . . . . . . . . . . . . . . . . . . . . . . 186
7.4.4 Numerics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 187
7.4.5 Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 188
7.5 Problems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 196

8 PEDAGOGICAL METHODS
205
8.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 206
8.2 Uses Of The Software . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 206
8.2.1 Lectures . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 206
8.2.2 Electronic classroom and homework problems . . . . . . . . . 212
8.2.3 Projects . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 214
8.3 Assessment . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 220
8.3.1 Cost of development . . . . . . . . . . . . . . . . . . . . . . . . . 220
8.3.2 Extent of software usage . . . . . . . . . . . . . . . . . . . . . . . 221
8.3.3 Informal assessment of impact on learning . . . . . . . . . . . 221
8.3.4 Surveys and focus groups . . . . . . . . . . . . . . . . . . . . . . 222
8.3.5 Impact on teaching . . . . . . . . . . . . . . . . . . . . . . . . . . 222
8.4 Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 223
8.4.1 Pedagogical matters . . . . . . . . . . . . . . . . . . . . . . . . . . 223
8.4.2 Practical matters . . . . . . . . . . . . . . . . . . . . . . . . . . . . 224
8.4.3 Bottom line . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 226

List of Figures

1.1 Cellular biophysics software ﬁgure showing the available software
packages . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.2 Save ﬁgure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

6
8

2.1 Deﬁnition of grid of particle locations . . . . . . . . . . . . . . . . . . 13
2.2 Deﬁnition of simulation ﬁeld, regions, and boundaries . . . . . . . . 14
2.3 Motion of a particle in a homogeneous region . . . . . . . . . . . . . . 15
2.4 Motion of a particle at a vertical perimeter boundary . . . . . . . . . 17
2.5 Motion of a particle at an internal vertical boundary . . . . . . . . . . 17
2.6 The RW Control ﬁgure . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18
2.7 RW Particles ﬁgure showing the initial locations of particles . . . . . 19
2.8 RW Particles ﬁgure showing the locations of particles after a 100
step random walk . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19
2.9 RW Parameters ﬁgure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20
2.10 RW Summary ﬁgure showing a numerical summary of statistics af-
ter a 100 step random walk . . . . . . . . . . . . . . . . . . . . . . . . . 22
2.11 RW Histogram ﬁgure showing a histogram of particle locations af-
ter a 100 step random walk . . . . . . . . . . . . . . . . . . . . . . . . . 24
2.12 RW Axis ﬁgure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24
2.13 RW Graph ﬁgures showing the mean and standard deviation of par-
ticle location versus step number
. . . . . . . . . . . . . . . . . . . . . 25
2.14 Parameters for a random walk in 3 regions . . . . . . . . . . . . . . . 29
2.15 Initial locations of particles for a random walk in 3 regions . . . . . 30

3.1 Classes of initial concentration proﬁles simulated by the software . 36
3.2 The MD Control ﬁgure . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41
3.3 Initial concentration proﬁle for impulses . . . . . . . . . . . . . . . . . 43
3.4 MD Axis scale ﬁgure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43
3.5 Initial concentration proﬁle for sinusoids . . . . . . . . . . . . . . . . 45
3.6 Initial concentration proﬁle for discontinuities . . . . . . . . . . . . . 46
3.7 Initial concentration using the arbitrary option . . . . . . . . . . . . . 47
3.8 Initial concentration for the two compartments option . . . . . . . . 49
3.9 The MD Analytic parameters and MD Numeric parameters ﬁgures . 50
3.10 MD Plots vs. position ﬁgure . . . . . . . . . . . . . . . . . . . . . . . . . 50
3.11 MD Plots vs. time ﬁgure . . . . . . . . . . . . . . . . . . . . . . . . . . . 51

xi

xii

LIST OF FIGURES

4.1 Kinetic diagram of the simple, four-state carrier . . . . . . . . . . . . 61
4.2 Kinetic diagram of a simple, six-state carrier that binds two solutes 63
4.3 Kinetic diagram of a general, four-state carrier model . . . . . . . . . 66
4.4 CMT Control ﬁgure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70
4.5 CMT Units ﬁgure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70
4.6 The CMT Parameters and CMT State ﬁgures for the simple, four-
state carrier model
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 71
4.7 The CMT Parameters and CMT State ﬁgures for the simple, six-state
carrier model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 72
4.8 The CMT Parameters and CMT State ﬁgures for the general, four-
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 73
state carrier model
4.9 The CMT Steady state plot ﬁgure . . . . . . . . . . . . . . . . . . . . . . 76
4.10 CMT Setup steady state plot ﬁgure . . . . . . . . . . . . . . . . . . . . . 76
4.11 The Axis scale ﬁgure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 77
4.12 Modify line properties ﬁgure . . . . . . . . . . . . . . . . . . . . . . . . 78
4.13 The CMT Transient plot ﬁgure . . . . . . . . . . . . . . . . . . . . . . . 79
4.14 The CMT Setup transient plot ﬁgure . . . . . . . . . . . . . . . . . . . . 80
4.15 The CMT Transients numerics ﬁgure . . . . . . . . . . . . . . . . . . . 80

5.1 Voltage-clamp conﬁguration . . . . . . . . . . . . . . . . . . . . . . . . . 89
5.2 Current-clamp conﬁguration . . . . . . . . . . . . . . . . . . . . . . . . 90
5.3 The HH Control ﬁgure after the software is initiated . . . . . . . . . . 94
5.4 The HH Parameters ﬁgure after the software is initiated . . . . . . . 96
5.5 HH parameters vs. potential ﬁgure . . . . . . . . . . . . . . . . . . . . . 98
5.6 HH Setup parameters vs. potential plot ﬁgure . . . . . . . . . . . . . . 98
5.7 HH parameters vs. potential ﬁgure showing the eﬀect of calcium
concentration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 99
5.8 Axis scale ﬁgure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 100
5.9 Modify line properties ﬁgure . . . . . . . . . . . . . . . . . . . . . . . . 101
5.10 HH Stimulus ﬁgure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 101
5.11 HH Stimulus ﬁgure showing an example of a stimulus waveform . . 103
5.12 HH Stimulus ﬁgure showing an example of the use of an m-ﬁle to
generate a sinusoidal stimulus . . . . . . . . . . . . . . . . . . . . . . . 103
5.13 HH Numerics ﬁgure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 104
5.14 HH Plots vs. time ﬁgure . . . . . . . . . . . . . . . . . . . . . . . . . . . 105
5.15 HH Variable summary ﬁgure.
. . . . . . . . . . . . . . . . . . . . . . . . 105
5.16 HH Graphics ﬁgure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 106
5.17 HH Setup plot ﬁgure.
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 107
5.18 HH Graphics ﬁgure showing a parametric plot of membrane con-
ductance versus membrane potential
. . . . . . . . . . . . . . . . . . . 108
5.19 HH Graphics ﬁgure showing the membrane potential obtained at
diﬀerent temperatures . . . . . . . . . . . . . . . . . . . . . . . . . . . . 109
5.20 Simulation results for diﬀerent parameters that block the action
potential (Problem 5.11)
. . . . . . . . . . . . . . . . . . . . . . . . . . . 116

LIST OF FIGURES

xiii

5.21 Examples of action potentials . . . . . . . . . . . . . . . . . . . . . . . . 119
5.22 Dependence of the action potential on temperature . . . . . . . . . . 120
5.23 Eﬀect of extracellular sodium concentration on the action potential 120

6.1 Equivalent network model of incremental sections of an unmyeli-
nated nerve ﬁber . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 128
6.2 Relation of stimulus electrodes to a ﬁber . . . . . . . . . . . . . . . . . 129
6.3 The PAP Control ﬁgure when the software is initiated.
. . . . . . . . 141
6.4 The PAP Workspace ﬁgure.
. . . . . . . . . . . . . . . . . . . . . . . . . 143
6.5 Snapshots of a propagating action potential shown using Color
Space-Time Evolution in the PAP Workspace ﬁgure.
. . . . . . . . . . 145
. . . . . . . . . . . . . . . . . . . . . . . . . 146
6.6 The PAP Parameters ﬁgure.
6.7 The PAP Parameters vs. Potential ﬁgure.
. . . . . . . . . . . . . . . . . 148
6.8 The PAP Stimulus ﬁgure.
. . . . . . . . . . . . . . . . . . . . . . . . . . 149
6.9 The PAP Stimulus ﬁgure showing a stimulus that consists of two
pulses: the ﬁrst pulse is an exponential pulse and the second is a
ramp plus a rectangular pulse.
. . . . . . . . . . . . . . . . . . . . . . . 151
. . . . . . . . . . . . . . . . . . . . . . . . . . 151
6.10 The PAP Numerics ﬁgure.
. . . . . . . . . . . . . . . . . . . . . 153
6.11 The PAP Voltage-Recorder ﬁgure.
6.12 The PAP Variable Summary ﬁgure.
. . . . . . . . . . . . . . . . . . . . 154
6.13 The PAP Space-Time Evolution ﬁgure showing a snapshot of a prop-
. . . . . . . . . . . . . . . . . . . . . . . . . . . 155
agating action potential.
6.14 The PAP 3D Plots ﬁgure showing a propagating action potential.
Top: a surface plot. Bottom: a mesh plot.
. . . . . . . . . . . . . . . . 157
6.15 The Setup PAP Comparison Plot ﬁgure showing the variables used
to setup Figure 6.16.).
. . . . . . . . . . . . . . . . . . . . . . . . . . . . 158
6.16 The PAP Comparison Plots ﬁgure showing a ﬁxed-space plot of the
membrane potential, Vm , and the ionic conductances, GN a and GK ,
with model parameters and the stimulus deﬁned in Figures 6.6 and
6.8.
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 159
6.17 The PAP Comparison Plots ﬁgure showing a ﬁxed-time plot of the
membrane potential, Vm , and the activation factors, m and h, ob-
tained from a simulation with model parameters and the stimulus
deﬁned in Figures 6.6 and 6.8.
. . . . . . . . . . . . . . . . . . . . . . . 160
6.18 The PAP Axis Scale ﬁgure.
. . . . . . . . . . . . . . . . . . . . . . . . . . 161
. . . . . . . . . . . . . . . . . . . . . 162
6.19 The Modify Line Properties ﬁgure.
7.2 The probability of occurrence of more than 1 event in an interval ∆t 179
7.1 Kinetic diagram of a channel that has 5 states . . . . . . . . . . . . . 175
7.3 The IC Control ﬁgure after the software is initiated . . . . . . . . . . 180
7.4 IC Parameters ﬁgure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 181
7.5 IC Specify rate constants ﬁgure . . . . . . . . . . . . . . . . . . . . . . . 183
7.6 IC View rate constant ﬁgure . . . . . . . . . . . . . . . . . . . . . . . . . 184
7.7 IC Setup view rate constant ﬁgure . . . . . . . . . . . . . . . . . . . . . 185

xiv

LIST OF FIGURES

7.8 IC Membrane potential ﬁgure . . . . . . . . . . . . . . . . . . . . . . . . 187
7.9 IC Numerics ﬁgure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 187
7.10 IC State occupancy ﬁgure . . . . . . . . . . . . . . . . . . . . . . . . . . 189
7.11 IC Ionic current ﬁgure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 190
7.12 IC Summary ﬁgure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 191
7.13 IC Graphics ﬁgure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 192
7.14 IC Setup graphics ﬁgure . . . . . . . . . . . . . . . . . . . . . . . . . . . 193
7.15 IC Graphics ﬁgure showing the state occupancy probabilities for a
four-state channel . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 194
7.16 IC Graphics ﬁgure showing the ionic conductances of a two-state,
three-state, and a four-state channel . . . . . . . . . . . . . . . . . . . . 195

8.1 Random walk in two regions . . . . . . . . . . . . . . . . . . . . . . . . 207
8.2 Steady-state distribution . . . . . . . . . . . . . . . . . . . . . . . . . . . 209
8.3 Time constants in two-compartment diﬀusion . . . . . . . . . . . . . 211
8.4 The threshold for eliciting an action potential in the Hodgkin-Huxley
model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 212
8.5 Sample project proposal
. . . . . . . . . . . . . . . . . . . . . . . . . . . 216

List of Tables

2.1 The macroscopic laws of diﬀusion . . . . . . . . . . . . . . . . . . . . . 11

3.1 Summary of computational methods.
. . . . . . . . . . . . . . . . . . 41
3.2 Concentration well — Problem 3.7 . . . . . . . . . . . . . . . . . . . . . 57

4.1 Modiﬁable parameters of the carrier models . . . . . . . . . . . . . . . 74

xv

xvi

LIST OF TABLES

Chapter 1

INTRODUCTION

1

2

1.1 Motivation

CHAPTER 1.

INTRODUCTION

I have been engaged in teaching cellular biophysics since 1965. Computer sim-
ulations were ﬁrst used to teach this material in 1984 and have been used ever
since. There is no question in my mind that the use of the software has deepened
students understanding of the subject material. All faculty who have taught the
subject, even those who started as skeptics, have been convinced of the ed-
ucational eﬃcacy of the software described here. Students have no basis of
comparison of the subject before and after use of the software, but generally
enjoy using the software and feel that it is helpful, and sometimes crucial, for
understanding the concepts. This book provides a complete description of the
software including some background material for each topic.
The ﬁrst chapter introduces the software packages and MATLAB, on which
the packages are based. The subsequent 6 chapters each describe one of the
software packages in some detail complete with problems and projects. The last
chapter is devoted to describing the pedagogical methods we have used to teach
cellular biophysics using computer simulation. It is aimed at faculty interested
in using the software for teaching but may be useful for students as well.

1.2 Overview Of Software Packages

The software for cellular biophysics consists of 6 software packages. The titles
of the software packages, with acronyms in parentheses, are described brieﬂy
below.

Random Walk Model of Diﬀusion (RW) allows users to select parameters of the
random walks of particles in a ﬁeld and to observe the resulting space-
time evolution of particle location. This package is intended to link the
macroscopic laws of diﬀusion to its probabilistic, microscopic basis.

Macroscopic Diﬀusion Processes (MD) allows users to select the initial spatial
distribution of solute concentration, the diﬀusion parameters, and to ob-
serve the resulting space-time evolution of solute concentration and ﬂux.
This package is intended to give users intuition about macroscopic diﬀu-
sion processes.

Carrier-Mediated Transport (CMT) allows users to examine simple models of
carrier-mediated transport through cellular membranes. For each of three
models, the user can change any parameter and can instantly see the eﬀect
on the state of the carrier-model. This interactive mode is intended to
build intuition about these models.
In addition, there is a graphic mode
that allows display of steady-state and transient responses to changes in
any parameter.

1.3. BRIEF INTRODUCTION TO MATLAB

3

Hodgkin-Huxley Model — Space Clamped (HH) allows users to investigate the
space-independent Hodgkin-Huxley model. Users can change parameters
of the Hodgkin-Huxley model of the space-clamped giant axon of the squid,
and perform simulation experiments in either the voltage-clamp or the
current-clamp conﬁguration.

Hodgkin-Huxley Model — Propagated Action Potential (PAP) allows users to in-
vestigate the space-dependent Hodgkin-Huxley model. Users can change
parameters of the Hodgkin-Huxley model of the giant axon of the squid,
and examine propagation of the action potential and of sub-threshold po-
tentials as a function of space and time.

Voltage-Gated Ion Channels (IC) allows users to design a voltage-gated ion chan-
nel. The user selects the number of states, the conductance and gating
charge associated with each state, the voltage-dependence of state transi-
tion rates, and the membrane potential. The user can then perform simu-
lation experiments on the channel model.

These packages are all designed to enhance comprehension of topics in cellular
biophysics by providing pedagogic tools that can be used as a basis for lecture
demonstration, open-ended problems that lend themselves to classes held in an
electronic classroom in which students have access to computers, homework
problems, and research projects. Although independent of any textbook, this
suite of software packages was developed in parallel with textbooks in cellular
biophysics (Weiss, 1996a; Weiss, 1996b).

1.3 Brief Introduction To MATLAB

All the software packages are written in MATLAB which is an interactive pro-
gramming environment for numerical and symbolic computations and for visu-
alization of computational results. Because MATLAB runs on most of the major
computer platforms, the cellular biophysics software operates on all platforms
supported by MATLAB. The present version of the software is written on MAT-
LAB version 5.3 which is available under Windows and UNIX but not under Ma-
cOS. MATLAB version 5.3 is required to operate this software.1
The MATLAB environment is interpretive. That is, commands can be entered
at a prompt and interpreted within the scope of a MATLAB session. Thus, com-
putational results generated by a simulation are available to the user for further
analysis. The software is designed to perform all the simulations with minimal
typed commands. The graphical user interface allows navigation through the

1Although not tested extensively, the software should run on the Student Version of MAT-
LAB. However, it may be that parameters can be chosen for these packages which will not
satisfy the limitations of the Student Version.

4

CHAPTER 1.

INTRODUCTION

software using a sequence of mouse events (e.g., clicking the mouse, pulling
down a menu, dragging the mouse).
Users of the software do not need to learn MATLAB to use the software. How-
ever, knowledge of MATLAB can enhance user’s usage of the software. A number
of texts on MATLAB are available (Hanselman and Littleﬁeld, 1997). In addition,
MATLAB manuals can be ordered directly from MathWorks. Section 1.3.1 is a
glossary of some useful terms in the MATLAB vocabulary. Section 1.3.2 men-
tions resources that can provide on-line help with MATLAB.

1.3.1 Jargon

The following terms are useful in navigating in the MATLAB environment.

axes The area in a ﬁgure containing plots and annotation. See the MATLAB
command axes.

buttons Rectangular regions allowing a sequence of commands to be executed
when they are clicked, selected, or edited. See the MATLAB command
uicontrol.

command window The window that appears when MATLAB is started. Com-
mands entered at the MATLAB prompt (>>) in this window are evaluated in
the workspace.

ﬁgure A rectangular window containing graphical objects, such as axes, buttons,
and menu items. See the MATLAB command figure.

MAT-ﬁle A binary data ﬁle containing MATLAB variables. Each software package
uses and stores a diﬀerent set of variables.

menubar A bar at the top of a ﬁgure (Windows and UNIX implementations) or at
the top of the monitor screen (in some implementations) associated with
the currently selected ﬁgure. When selected, the menu item expands to
show its related submenu items. Submenu items marked with a check-
mark are currently active selections.

M-ﬁle A text ﬁle containing a sequence of commands to be evaluated in the
MATLAB workspace. The software contains a collection of m-ﬁles which
can be recognized by the extension .m.

parameters Numeric values that deﬁne each model.

popup-menu A rectangular region showing the current popup-menu selection.
When clicked, the menu is expanded to show all the options. See the MAT-
LAB command uicontrol.

1.4. GENERAL OPERATION OF THE SOFTWARE

5

variables Numeric values of independent variables set by the user or of depen-
dent variables calculated from the model.

workspace A collection of variables in the current session of MATLAB. When
MATLAB is started, the workspace is empty. Variables appear in the workspace
as they are deﬁned.

1.3.2 Help

Help on MATLAB is available through the command window using the following
commands at the MATLAB prompt (>>)

who lists the variables in the current workspace.

help function provides some help on the command function.

help help provides help on getting started using help.

lookfor word ﬁnds functions that involve word.

Additional help is available in the descriptions of individual software packages.

1.4 General Operation Of The Software

1.4.1 Directory structure

The software is designed to be run from a directory that includes the following
ﬁles/directories:

cmt is a directory that contains the carrier-mediated transport software.

hh is a directory that contains the Hodgkin-Huxley model of a space-clamped
axon software.

ic is a directory that contains the voltage-gated ion channel software.

md is a directory that contains the macroscopic diﬀusion processes software.

pap is a directory that contains the Hodgkin-Huxley model of a propagating
action potential software.

rw is a directory that contains the random walk model software.

softcell.m is a MATLAB m-ﬁle that initializes the software and allows the user
to choose software packages from a menu.

startup.m is a MATLAB m-ﬁle that may be used to startup the software auto-
matically.

6

CHAPTER 1.

INTRODUCTION

Figure 1.1: This Cellular biophysics
software ﬁgure is displayed when
the software is started and shows
the available software packages.
The appearance of the menu bar
near the top of the ﬁgure varies
somewhat for the diﬀerent plat-
forms. This ﬁgure was obtained us-
ing Windows 2000 and MATLAB ver-
sion 5.3.

tlib is a directory that contains a library of software routines used by all the
packages.

1.4.2 Starting the software

The software is accessible through MATLAB via a menu that allows selection
of the software packages and initializes all packages. The startup procedure is
given for the diﬀerent platforms.

Windows, UNIX, and other operating systems that support MATLAB. Initialize
MATLAB, and type the following instruction (in the MATLAB window) at the
MATLAB prompt (>>)
>> cd directory
where directory is the name of the directory (folder) that houses the cel-
lular biophysics software.2 Then type
>> softcell
This command displays the Cellular biophysics software ﬁgure shown in
Figure 1.1. Clicking on any package, initializes that package and hides the
Cellular biophysics software ﬁgure.

UNIX workstation on Project Athena at MIT. From the dashboard at the top of
the monitor select
Courseware (cid:2)⇒
Electrical Engineering and Computer Science (cid:2)⇒
6.021J/6.521J Quantitative Physiology (cid:2)⇒
New MATLAB v5 Software
This procedure displays the Cellular biophysics software ﬁgure shown in
Figure 1.1. Clicking on any package, initializes that package and hides the
Cellular biophysics software ﬁgure.

2To verify that the directory is the right one, either type pwd to indicate the name of the
present directory or type ls to list the contents of the directory.
It should contain the ﬁle
softcell.m. If it does not contain this ﬁle then either the selected directory is wrong or the
cellular biophysics software is not installed on your computer.

1.4. GENERAL OPERATION OF THE SOFTWARE

7

If a software package is selected, a number of ﬁgures are displayed includ-
ing the XX Control ﬁgure, where XX is the acronym of the software package
(RW, MD, CMT, HH, IC). Clicking on the × in the upper right-hand corner of the
menubar, deletes any ﬁgure. Clicking on the × in the upper right-hand corner of
the menubar of the XX Control ﬁgure exits from the software package and results
in the display of the Cellular biophysics software ﬁgure shown in Figure 1.1.

1.4.3 Quitting the software
Clicking on the × in the upper right-hand corner of the menubar of the Cellular
biophysics software ﬁgure exits the cellular biophysics software. Clicking on the
× in the upper right-hand corner of the menubar of the MATLAB Command
window exits MATLAB.

1.4.4 Printing a ﬁgure

Each ﬁgure associated with each package contains a Print button which if pressed
brings up a print ﬁgure that allows the user to print on any printer on the net-
work to which the computer is connected or to store a postscript ﬁle of the
ﬁgure.

1.4.5 Reading from and saving to a ﬁle

A variety of information about the software can be saved in MAT-ﬁles using the
standard MATLAB binary ﬁle format (see MATLAB’s save and load commands).
For example, all the packages allow storage of simulation parameters to allow a
simulation to be repeated at a later time. In addition, results of simulations can
also be saved in ﬁles for later retrieval. However, the information stored varies
for diﬀerent software packages, and the individual descriptions of the packages
should be consulted for more detailed information.
A ﬁle can be read by pushing the Open button in a ﬁgure. A ﬁle can be stored
by pushing the Save button. Pushing either button displays a ﬁgure (Figure 1.2)
that allows the user to navigate to the desired directory to either read or save a
ﬁle.

8

CHAPTER 1.

INTRODUCTION

Figure 1.2:
Save ﬁgure opened
from the HH package using Win-
dows 2000 and MATLAB 5.3.

Chapter 2

RANDOM WALK MODEL OF
DIFFUSION

9

10

CHAPTER 2. RANDOM WALK MODEL OF DIFFUSION

2.1.

INTRODUCTION

2.1 Introduction

2.1.1 Historical background

11

A bolus of soluble material will gradually spread out in its solvent until a uniform
solution results. This diﬀusion process must have been familiar to humans in
antiquity. However, a mathematical description of these macroscopic changes in
concentration was not available until the 1850s (Fick, 1855), and a microscopic
or particle-level model, not until the turn of this century (Einstein, 1906).
Diﬀusion plays an important role in such a wide range of disciplines, that it is
important for students of science and engineering to develop an understanding
of the macroscopic laws of diﬀusion and their microscopic basis. We will review
some important characteristics of the macroscopic laws of diﬀusion and their
relation to random-walk models. A fuller treatment is available elsewhere (Weiss,
1996a).

2.1.2 Macroscopic and microscopic models

Macroscopic laws of diﬀusion

The macroscopic laws of diﬀusion for the simple case when the particles are not
subject to a body force, the medium does not convect the particles, the diﬀusion
coeﬃcient is a constant, and the particles are conserved are summarized in one
and three dimensions in Table 2.1. These equations relate the ﬂux of particles

Equation

Fick’s ﬁrst law

Continuity equation

Diﬀusion equation

One Dimension Three Dimensions
¯φ = −D∇c
φ = −D
∂ c
∂x
= − ∂ c
∇ · ¯φ = − ∂ c
∂φ
∂ t
∂x
∂ t
= D∇2c
= D
∂ 2c
∂ c
∂ c
∂ t
∂x 2
∂ t

Table 2.1: The macroscopic laws of diﬀusion for a concentration of particles diﬀusing
in a homogeneous region with a constant diﬀusion coeﬃcient D , in the absence of a
body force on the particles or convection of the medium, and where the particles are
conserved.

(φ), which is the number of moles of particles transported through a unit area in
a unit time, to the concentration of particles (c ), which is the number of moles of
particles per unit volume. Fick’s ﬁrst law relates ﬂux to particle concentration;
it is analogous to other laws that relate a ﬂow to a force such as Ohm’s law of
electric conduction, Darcy’s law of convection, and Fourier’s law of heat ﬂow.

12

CHAPTER 2. RANDOM WALK MODEL OF DIFFUSION

Fick’s ﬁrst law implies that a solute concentration gradient causes a solute ﬂux
in a direction to reduce the concentration gradient. The continuity equation
follows from conservation of particles, and the diﬀusion equation is obtained by
combining Fick’s ﬁrst law with the continuity equation.

Microscopic basis of diﬀusion

An important notion in understanding diﬀusion processes is to relate the macro-
scopic laws of diﬀusion to microscopic models of diﬀusing particles. The sim-
plest microscopic model that captures the essence of diﬀusion is the discrete-
time, discrete-space random walk. In a one-dimensional random walk in a ho-
mogeneous region of space, we assume a particle moves along the x -axis in a
series of statistically independent steps of length +l or −l, where the time be-
tween steps is τ . In an unbiased walk, positive and negative steps are equally
likely, i.e., each has probability 1/2. It can be shown that statistical averages of
properties of a population of particles obey the macroscopic laws of diﬀusion.
In particular, this simple model can be shown (Weiss, 1996a) to yield Fick’s ﬁrst
law with a diﬀusion coeﬃcient,

D = l2
2τ
Therefore, the connection between the random walk of a particle and the laws of
macroscopic diﬀusion can be made clear if the motion of a number of particles
(on the order of 50) can be visualized for a number of steps.

.

2.1.3 Overview of software

The software described here is intended to allow users to investigate the prop-
erties of the simplest microscopic model that captures the essence of diﬀusion:
the discrete-time, discrete-space random-walk model.
In the discrete-time, discrete space random walk model described here, there
is a population of particles which execute statistically-independent, but other-
wise identical two-dimensional random walks in a rectangular ﬁeld. The ﬁeld
can be divided into one, two, or three homogeneous regions whose widths are
speciﬁable, and whose properties may diﬀer. Each particle undergoes a ran-
dom walk with parameters that include: the probability that the particle takes
a step to the left or right, and the step size. These parameters can be set in-
dependently in the three regions. The particles can be set to have a speciﬁable
lifetime. One source and one sink of particles can be placed in the ﬁeld and the
initial concentration of particles can be speciﬁed in each of the three regions.
Characteristics of the boundary conditions between regions can also be speci-
ﬁed. With this software package it is possible: to visualize the spatial evolution
of particle concentration from a variety of initial distributions selectable by the
user; to examine the evolution of particle concentration from a source and in the

2.2. DESCRIPTION OF THE RANDOM-WALK MODEL

13

1 unit

j +2

j +1

j
j −1
j −2

i −2

i −1

i

i +1 i +2

Figure 2.1: Deﬁnition of grid of particle locations. A particle
is shown at the grid location (i, j ). The distance between
adjacent grid locations, in both the horizontal and vertical
directions, is the unit distance.

presence of a sink; to examine diﬀusion in regions of diﬀering diﬀusion coeﬃ-
cients; to simulate diﬀusion of particles subjected to a body force; to simulate
diﬀusion between two compartments separated by a membrane; to investigate
the eﬀects of chemical reactions or recombination which consume particles at
a ﬁxed rate; and to investigate the eﬀects of diﬀerent boundary conditions be-
tween regions. Two diﬀusion regimes can be run and displayed simultaneously
to allow direct comparison between the space-time evolution of two diﬀerent
diﬀusion processes. In addition, a variety of statistics of the spatial distribution
of particles can also be displayed.
By watching the particles move and by comparing simulation results to ex-
pectations, the user can develop an intuition for the way in which the random
motions of particles lead to their diﬀusive spread.

2.2 Description Of The Random-Walk Model

In this simulation, the discrete-time, discrete-space random walk takes place on
a ﬁnite two-dimensional grid of locations accessible to the particles and called
the ﬁeld. The location of each particle is speciﬁed by giving its coordinates on
this grid (i, j ) where i is the horizontal coordinate and ranges from 0 to 399 and
j is the vertical coordinate and ranges from 0 to 99 (Figure 2.1). The horizontal
distance between adjacent grid locations is 1 unit of distance and all spatial
dimensions of the random walk are expressed as multiples of this unit distance.
The location of the particle in the grid can change probabilistically at each step
of the random walk. Thus, successive steps represent successive times that are
separated by a unit time interval. All times are expressed in terms of the number
of steps of the random walk.
The ﬁeld can be divided into one, two or three homogeneous regions (Fig-
ure 2.2). Certain parameters of the simulation are deﬁned for the entire ﬁeld,
others at boundaries between regions, and still others are deﬁned independently
for each region. The latter parameters will be described ﬁrst and include: region
size, particle step size, directional probabilities, and initial particle distribution.

14

CHAPTER 2. RANDOM WALK MODEL OF DIFFUSION

Region 1

Region 2

Region 2

Region 1 size

perimeter boundary:
vertical
horizontal

vertical internal
boundaries

Figure 2.2: Deﬁnition of simulation ﬁeld, regions, and boundaries. Solid lines delimit
the perimeter boundaries of the ﬁeld; dashed lines indicate the internal vertical bound-
aries that separate the regions.

2.2.1 Particle parameters within a region

The parameters that deﬁne the random walk are identical at each location within
a region — each region is homogeneous. These parameters are described below.

Region size

The width of each region can be speciﬁed, but the sum of the widths cannot
exceed 400. This allows a variety of diﬀusion regimes to be deﬁned. For exam-
ple, if Region 1 has width of 400 then the other two regions must have width 0
and the random walk is deﬁned for one homogeneous region. By specifying two
regions with non-zero widths, it is possible to deﬁne a diﬀusion process with
diﬀerent initial conditions in the two regions. This allows a rich variety of initial
distributions to be deﬁned. Three non-zero width regions allows simulation of
diﬀusion between two regions separated by a third region with diﬀerent proper-
ties. This might be used to investigate diﬀusion between two baths separated by
a membrane.

Step size

The step size deﬁnes the distance, in multiples of unit distances, that particles
may move in each step of time. Varying the step size simulates varying the
diﬀusion coeﬃcient. The size of a region is always set to a multiple of the step
size in that region; all particles in a region are located at integer multiples of
the step size starting from the left boundary of the region. This ensures that
particles at a boundary fall on the boundary and simpliﬁes the speciﬁcation of
particle motion at a boundary.

2.2. DESCRIPTION OF THE RANDOM-WALK MODEL

15

upper left

upper right

step size

expired

lower left

lower right

step size

Figure 2.3: Schematic diagram of motion of a particle in a homogeneous region. The
grid of possible particle locations, separated by unit distances, are indicated by + sym-
bols. A particle is shown in the center of the ﬁgure at one instant in time. One time
step later the particle either stays in the same location or moves to one of 4 possible
locations (indicated by the shaded particle) or it expires (is removed from the ﬁeld). If
the particle moves, it translates one step size (here shown as 2 units of distance) in
both the vertical and the horizontal direction.

Particle motion — directional probabilities

At each instant in time, a particle is at some location in the region. The dis-
position of the particle at the next instant in time is determined by one of six
mutually exclusive and collectively exhaustive possibilities as illustrated in Fig-
ure 2.3. The particle can move one step size to the upper left, upper right, lower
left, or lower right; stay in the same location (center); or be eliminated (expire).
The probabilities for each of the six outcomes is as follows:
P[expired] = 1/L ,
P[center] = (1 − 1/L) (1 − p − q) ,
P[upper left] = 0.5 (1 − 1/L) q ,
P[upper right] = 0.5 (1 − 1/L) p ,
P[lower left] = 0.5 (1 − 1/L) q ,
P[lower right] = 0.5 (1 − 1/L) p ,
where L is the average lifetime of the particle, i.e. the average number of time
steps to expiration; p is the conditional probability that the particle moves to
the right given that it has not expired; q is the conditional probability that the
particle moves to the left given that it has not expired. Note that while the
probability of moving to the left and to the right can diﬀer, the probability of
moving up or down is always the same. Because the six probabilities deﬁne all
the possible outcomes at each instant in time, they sum to unity.
Diﬀerent types of random walks are described by changing the directional
probabilities. The random walk deﬁned by assuming p = q = 1/2 is the simple,

(2.1)

16
CHAPTER 2. RANDOM WALK MODEL OF DIFFUSION
unbiased random walk described in Section 2.1. In general, if p = q the random
walk is unbiased; there is no statistical tendency for particles to move preferen-
tially in either horizontal direction. However, if p ≠ q, the random walk is biased
so that there is a tendency for particles to move in one horizontal direction. For
a step size of S , the mean distance E [m] that the particle moves to the right in
n units of time is
E [m] = Sn(1 − 1/L)(p − q) .

2.2.2 Boundary conditions

The ﬁeld contains three diﬀerent types of boundaries (Figure 2.2) which are, in
order of increasing complexity, horizontal perimeter boundaries at the top and
bottom of the ﬁeld, vertical perimeter boundaries at the left and right ends of
the ﬁeld, and vertical internal boundaries that separate regions.

Horizontal perimeter boundaries

Horizontal perimeter boundaries act as perfectly reﬂecting walls.
If a particle
is located within one step size of such a boundary and takes a step toward
the boundary then the new vertical location of the particle is determined in the
following manner: the vertical distance the particle travels to reach the wall plus
the vertical distance the particle travels after reﬂecting from the wall must sum
to the step size. This relation determines the new location given the old location
and the value of the step size.

Vertical perimeter boundaries

The vertical perimeter boundaries are also reﬂecting walls. Because the prob-
abilities of stepping to the left and right need not be the same, we found that
purely reﬂecting wall of the type described for the horizontal perimeter bound-
aries created undesirable artefacts especially when the conditional probabilities
of moving to the left and right were not equal (p ≠ q). Therefore, we modi-
ﬁed the boundary condition so that a particle that would have crossed a vertical
perimeter boundary at a given step was placed on the boundary and then subject
to the following boundary condition which is illustrated for the left boundary in
Figure 2.4 and whose directional probabilities are:
P[expired] = 1/L ,
P[center] = (1 − 1/L) (1 − p) ,
P[upper right] = 0.5 (1 − 1/L) p ,
P[lower right] = 0.5 (1 − 1/L) p ,

(2.2)

i.e. the particle cannot move to the left.

2.2. DESCRIPTION OF THE RANDOM-WALK MODEL

17

upper right

left vertical
perimeter
boundary

step size

expired

Figure 2.4: Schematic diagram of mo-
tion of a particle at a vertical perimeter
boundary. For purposes of illustration
the particle motion at the left boundary
is shown. Conditions at the right bound-
ary are the mirror-image of those shown
here.

lower right

step size

left region

right region

upper right

upper left

lower left

lower right

step size in
right region

step size in
left region
internal vertical
boundary

step size in
right region

expired

Figure 2.5: Schematic diagram of mo-
tion of a particle at an internal vertical
boundary between two regions. The
step size is 1 to the left of the bound-
ary and 2 to the right of the boundary.

Vertical internal boundaries

The motion of particles at a vertical internal boundary is similar to that within
a homogenous region. The diﬀerences are that: the step sizes in the two ad-
jacent regions may diﬀer; and special directional probabilities, speciﬁed by the
user, apply at the boundary. These have been provided to allow users to explore
the consequences of a rich variety of boundary conditions. To simplify boundary
conditions, the software ensures that particles do not cross this boundary in one
time step but rather they land on the boundary. This is guaranteed by forcing
the width of boundaries, initial particle locations, locations of sources and sinks
to be commensurate with the step size. Given this restriction, the possible out-
comes for a particle on a boundary are shown schematically in Figure 2.5. The
directional probabilities are identical to those in a homogeneous (region given
above) except that the conditional probability of moving to the left and to the
right given that the particle did not expire (p and q in the homogeneous region)
are independently speciﬁed at each internal boundary. The step size to the left
is equal to the step size in the region to the left of the boundary; the step size
to the right is equal to the step size in the region to the right of the boundary.

18

CHAPTER 2. RANDOM WALK MODEL OF DIFFUSION

Figure 2.6: The RW Control ﬁgure.

2.3 User’s Guide To The Software

When this software package is selected, 2 ﬁgures are displayed (in addition to
MATLAB’s command window) — RW Control and RW Particle set #1.

2.3.1 RW Control

The RW Control ﬁgure controls the random walk software and is shown in Fig-
ure 2.6. The part of the RW Control ﬁgure below the menubar is divided into two
panels. The left panel indicates which of the two independent simulations are to
be displayed — the choices are Particle Set #1 and/or Particle Set #2. When RW
is selected, Particle Set #1 is selected by default.
The right panel allows the simulation to be started, paused, continued, or
reset. If Reset is chosen, the step counter is set to 0 and the particle locations
are reset to their initial locations. The # steps in the random walk before the
simulation pauses can be entered in the text edit box. Clicking 1-step executes
one step of the random walk. A counter for the current number of steps in the
random walk is displayed.

2.3.2 RW Particle

The RW Particle ﬁgure shows the locations of particles in the ﬁeld as shown for
an initial distribution of particles in Figure 2.7. When the simulation is started
by clicking the Start button in the RW Control ﬁgure, the random walks of the
particles are exhibited in the RW Particle ﬁgure. A step counter indicates the
number of steps taken in the random walks. After 100 steps of the random
walks of particles, the RW Particle ﬁgure is as shown in Figure 2.8.
Several options are provided in the RW Particle ﬁgure. The user can select
Param to change the parameters of the random walk, Summ to obtain a numer-
ical summary of statistics of the random walk, Hist to obtain a histogram of
particle positions, and Graphs to obtain plots of statistics versus step number.
These options are described in detail below. The RW Particle ﬁgure also has op-
tions to Open a ﬁle that contains a particle distribution, Save the current particle
distribution in a ﬁle, and Print the current ﬁgure. Clicking on Save saves the fol-
lowing: the current state of all the particles including the expected locations of
particles, the histogram binwidth, the step #, and all the parameters.

2.3. USER’S GUIDE TO THE SOFTWARE

19

Figure 2.7: RW Particles ﬁgure showing the initial locations of particles. Initially there
are 50 particles located at position 200 and spread randomly with a uniform distribu-
tion in the vertical direction.

Figure 2.8: RW Particles ﬁgure showing the locations of particles after a 100 step ran-
dom walk for the initial locations of particles shown in Figure 2.7.

20

CHAPTER 2. RANDOM WALK MODEL OF DIFFUSION

Figure 2.9: RW Parameters ﬁgure showing the parameters used to deﬁne the simula-
tions whose particle distributions are shown in Figures 2.7 and 2.8.

RW Parameters

Choosing Param in the RW Particles ﬁgure displays the RW Parameters ﬁgure,
shown in Figure 2.9, which allows selection of the parameters of the simulation.
Region #1 is indicated in blue in both the RW Parameters ﬁgure and in the RW
Particle ﬁgure; magenta is used for region #2 and green for region #3. After new
parameters are chosen, clicking on Update resets the initial distribution to the
newly selected one and activates all the new parameters. The parameters are
described below. In addition, the parameters (alone) can be saved in a ﬁle (by
clicking on Save) or read from a ﬁle (by clicking on Open).
• Region Size. The user may deﬁne up to three regions, whose combined
width may not exceed 400. To eliminate a region, enter 0 for the region
size. Regions can also be of size k(s teps ize) where k = 3, 4, 5, .... That is,
regions of size s teps ize and 2(s teps ize) are not allowed.
• Step Size. The step size can be speciﬁed independently in each region.
• Initial Distribution Of Particles. The initial distribution of particles can
be speciﬁed independently in the three regions. Particles start at locations
that are integral multiples of the step size in each region. Particles are
distributed randomly (with a uniform distribution) in the vertical direction
and have the selected distribution in the horizontal direction. The initial
distribution of particles can be selected to be one of the following.

2.3. USER’S GUIDE TO THE SOFTWARE

21

– Empty implies that initially there are no particles in the region.

– Pulsatile implies that a speciﬁed number of particles are placed at
a speciﬁed horizontal location in the region and spaced randomly in
the vertical direction. Figure 2.7 shows an initial distribution that is
pulsatile.

– Linear implies that a linear concentration proﬁle is generated whose
slope and number of particles are speciﬁed. A uniform distribution of
particles is obtained if the slope is set to zero. Negative concentrations
are not allowed: if the parameters are chosen such that the concentra-
tion would become negative at some point in the region, these putative
negative concentrations are set to zero.

– Sinusoidal implies that the spatial distribution is sinusoidal with a
speciﬁed period and number of particles.
• Right Step Prob. The conditional probability of a step to the right given
that the particle has not expired can be speciﬁed independently in each
region.
• Left Step Prob. The conditional probability of a step to the left given that
the particle has not expired cannot be speciﬁed. It is set automatically so
that in each region, the sum of the probabilities of all possible outcomes is
one.
• Stay Prob. The conditional probability that the particle stays in the same
location given that the particle has not expired can be speciﬁed indepen-
dently in each region.
• Probabilities at Boundaries.
The perimeter boundaries of the ﬁeld act
as reﬂecting boundaries; the boundaries between regions are characterized
by user-deﬁned boundary conditions. Boundary conditions are deﬁned as
shown in Figure 2.9: left-step-probability L, stay probability S , and right-
step-probability R at the boundary between regions. For example, if the
Region #1-#2 has the set of probabilities (L, S , R) = (0, 0, 1) then particles
at the boundary may only step to the right. Therefore, to a particle from Re-
gion #2, this looks like a reﬂecting boundary, whereas all particles reaching
the boundary from Region #1 will cross into Region #2. As with the direc-
tional probabilities within a region, the user selects the conditional (on not
expiring) probability of a step to the right and the conditional probability
of no step; the conditional probability of a step to the left is then computed
so that probabilities of all possible outcomes sum to one.
• Source. One source can be placed at a horizontal location in the ﬁeld and
covers the entire vertical height of the ﬁeld. The source must be located at
an integer multiple of the step size from the left boundary of each region

22

CHAPTER 2. RANDOM WALK MODEL OF DIFFUSION

Figure 2.10: RW Summary ﬁgure
showing a numerical summary of
statistics after a 100 step random
walk for the same parameters as
shown in Figure 2.9 and for the ini-
tial locations of particles shown in
Figure 2.7.

in which it is located. The rate of generation of particles is speciﬁed by
giving the number of particles (speciﬁed as a two-digit number) produced
in some number of time steps (speciﬁed as a two-digit number). Thus the
rate of generation of particles can be a rational number. The particles
are generated at the horizontal location of the source and are distributed
randomly along the vertical direction using a uniform distribution. When
the source is turned on, a small + is placed at the horizontal location of
the source just above the ﬁeld.
• Sink. A sink can be placed at a horizontal location in the ﬁeld and covers
the entire vertical height of the ﬁeld. The sink is located at an integer
multiple of the step size from the left boundary of each region in which it
is located. Particles that land on the sink are absorbed; hence the number
of particles at the sink is always zero. When the sink is turned on, a small
− is placed at the horizontal location of the sink just above the ﬁeld.
• Average Lifetime. The user may deﬁne the average particle lifetime de-
ﬁned as the number of steps it takes, on average, for the particle to expire.

RW Summary

Choosing Summ in the RW Particles ﬁgure pauses the simulation and displays
numerical values of statistics in the RW Summary ﬁgure as shown in Figure 2.10.
Two sets of computations are performed simultaneously during a simulation:
statistics based on the actual locations of particle and statistics based on the
expected locations of particles. Given a particle location at one step and a set
of directional probabilities, a random number generator is used to determine
which of the possible new locations occurs at the next step. These sequence
of locations determines the locations of the particles on the screen and all the
statistics labelled actual. However, given a particle location at one time and the

2.3. USER’S GUIDE TO THE SOFTWARE

23

same directional probabilities, an expected location of the particle in the next
step is also computed. Thus, during a simulation both the set of actual and
expected locations for the particles are computed and can be displayed.
The available statistics (both actual and expected) are as follows.
• Mean is the mean location of the particles in the entire ﬁeld.
• Standard Deviation is the standard deviation of particle location in the
entire ﬁeld.
• #Generated is the cumulative number of particles generated by the source
since the beginning of the simulation.
• #Absorbed is the cumulative number of particles absorbed by the sink
since the beginning of the simulation.
• #Expired is the cumulative number of particles lost (due to their ﬁnite
lifetimes) since the beginning of the simulation.
• Total #Particles is the total number of particles in the entire ﬁeld at each
step number.
• Region 1 #Particles is the total number of particles in Region 1 at each
step number.
• Region 2 #Particles is the total number of particles in Region 2 at each step
number. For this total only, the particles located at the boundary between
Region 1 and Region 2 are counted as belonging to Region 2.
• Region 3 #Particles is the total number of particles in Region 3 at each step
number. For this total only, the particles located at the boundary between
Region 2 and Region 3 are counted as belonging to Region 3.

RW Histogram

Choosing Hist in the RW Particles ﬁgure pauses the simulation and displays the
RW Histogram ﬁgure (Figure 2.11). Histograms summarize the spatial distri-
bution of particle locations; both the actual and the expected distribution of
particle locations are shown. Each histogram consists of a set of bins that spans
the ﬁeld in the horizontal direction; the number of bins depends upon the spec-
iﬁcation of the bin size. With a bin size of 16, there are 25 bins that span the
entire ﬁeld of 400 locations. The histogram shows the number of particles in
each bin as a function of bin location. Choice of bin size is important. A small
bin size depicts the particle distribution with high spatial resolution. However,
a small bin size implies that each bin will contain relatively few particles and the
number of particles will ﬂuctuate randomly from bin to bin. Conversely, a large

24

CHAPTER 2. RANDOM WALK MODEL OF DIFFUSION

Figure 2.11: RW Histogram ﬁgure showing a histogram of particle locations after a 100
step random walk for the same parameters as shown in Figure 2.9 and for the initial
locations of particles shown in Figure 2.7. The histogram is for the particle locations
shown in Figure 2.8.

Figure 2.12: RW Axis ﬁgure showing options
for changing axis properties.

bin size gives a histogram with poor spatial resolution but a larger amount of
statistical averaging of the spatial distribution of particles.
The shape of the histogram is sensitive to the choice of bin size and can lead
to confusing patterns. For example, suppose the bin size is ﬁve and the step
size is two. Suppose further that particles are located uniformly in the ﬁeld; one
particle per accessible location. However, the step size constrains the possible
locations that a particle may occupy to be separated by 2. Therefore, with a bin
size of ﬁve, successive bins in the histogram alternate between 2 and 3 particles.
Thus the histogram will not appear uniform, but oscillatory. This problem is
cured if the bin size is an integral multiple of the step size.
If the step sizes
diﬀer in the three regions, then the bin size should be set equal to the least
common multiple of the three step sizes.
Clicking on either the ordinate or the abscissa axis label displays the RW Axis
ﬁgure (Figure 2.12) that allows the user to change the axis scale. The scale is
indicated by a vector [min max] in which min represents the minimum value and
max represents the maximum value of the range. Clicking on Log makes the axis
scale logarithmic.

2.3. USER’S GUIDE TO THE SOFTWARE

25

Figure 2.13: RW Graph ﬁgures showing the mean (above) and the standard deviation
(below) of particle location versus step number for the same parameters as shown in
Figure 2.9 and for the initial locations of particles shown in Figure 2.7.

RW Graph

Choosing Graphs in the RW Particles ﬁgure pauses the simulation and displays
the RW Graph ﬁgure. The temporal evolution of any of the summary statistics
shown in Figure 2.10 can be plotted versus the step number. Figure 2.13 shows
an example of both the mean and the standard deviation of particle locations
plotted versus step number. Clicking on either the ordinate or the abscissa axis
label displays the RW Axis ﬁgure that allows the user to change the axis scale (as
in Figure 2.12).
These statistics allow a quantitative evaluation of simulation results. We give
a number of examples of the use of these statistics. A systematic change in
the mean location of the particles as a function of step number demonstrates a
drift or migration of the particles as can be achieved by a bias in the directional
probabilities. A diﬀerence in the standard deviation of two distributions can

26

CHAPTER 2. RANDOM WALK MODEL OF DIFFUSION

be achieved by changing the step size. The dependence on step number of the
number of particles in the ﬁeld, in a region, generated, absorbed, or expired can
be used to assess whether a particle distribution has reached steady state. The
change in the total number of particles in each region can be used to estimate
the rate of transport of particles between regions.

2.4 Problems

Problem 2.1 The purpose of this problem is to explore random walks from an
initial distribution where all particles begin from the same horizontal location.

a. Use the default simulation parameters with a pulsatile initial distribution
of particles but set the step size to 2 and 4 for Particle Sets #1 and #2,
respectively. The parameters of Particle Sets #1 and #2 should diﬀer only
in step size. Run the simulation for 100 steps. Examine graphs of the
mean and the standard deviation of the horizontal locations of the particles
versus step number.

i. Explain quantitatively the diﬀerences in the graphs in terms of the
diﬀerence in step size of the two simulations.
ii. Why does the slope of the standard deviation decrease with step num-
ber? What type of dependence on step number do you expect? Explain.
[Hint — You may wish to replot the graph in diﬀerent coordinates to
check out your expectations.]

b. Now set the step size to 2 for both simulations and decrease the number
of particles in the pulsatile initial distribution for one of the simulations
to 25. Rerun the simulation. Describe how the number of particles aﬀects
the dependence of mean location and standard deviation on step number?
Explain your results.

c. Set all the parameters at their default values and then set the step size
for both Particle Sets #1 and #2 to 2. For Particle Set #1 set the right step
probability to 0.75, the left step probability to 0.25, place an impulse of 50
particles at location 100. For Particle Set #2 set the right step probability
to 0.25, the left step probability to 0.75, place an impulse of 50 particles
at location 300. Run the simulation for at least 100 steps. Examine graphs
of the mean and the standard deviation of the horizontal locations of the
particles versus step number. Explain your results quantitatively.

Problem 2.2 The purpose of this problem is to explore the steady-state distribu-
tion of particles in the presence of a source and sink for both unbiased and biased
random walks. For all parts of this problem set the parameters for both Particle

2.4. PROBLEMS

27

Sets #1 and #2 as follows: make the size of Region #1 400; the step size 20; and
make the initial distribution of particles empty. Also place a source at location
0 and a sink at location 400 and make the histogram bin size 20.

a. Make the random walks for both Particle Sets #1 and #2 unbiased with a
right step probability of 0.5. For Particle Set #1 make a source that gen-
erates 1 particle every 2 steps and for Particle Set #2 make a source that
generates 1 particle every 1 step. Make the particle lifetime inﬁnite for both
simulations. Now run the simulation. In the steady-state, by deﬁnition the
particle distribution will not depend upon step number.

i. Before you run the simulation, estimate the form of the steady-state
particle distribution. Will it be uniform, exponential, pulsatile, linear,
Gaussian, or none of these?
ii. Using the available statistics, determine a criterion for estimating when
the particle distribution is in steady state.
iii. Now run the simulation until your criterion for steady state is met.
Look at the histograms of particle location. What is the steady-state
particle distribution? Does it ﬁt with your initial expectation? There
are diﬀerences between the actual and expected histograms. Explain
these diﬀerences.
iv. How can you explain the diﬀerence in steady-state distribution for
Particle Sets #1 and #2?
v. Show that the steady-state particle distribution you have found for the
random walks is consistent with Fick’s laws.

b. Use the same parameters for Particle Set #2 as in part a, but change those
of Particle Set #1 so that the source rate is also 1 particle every 1 step; and
so that the probability of a right step is 0.55. Run the simulation until it
has reached a steady state.

i. Compare the steady-state distributions for the biased and unbiased
random walks. How do they diﬀer?
ii. Describe the shape of the steady-state distribution for the biased ran-
dom walk?
iii. Modify Fick’s ﬁrst law to account for not only diﬀusion of particles but
a steady drift of particles of velocity v . Determine the steady-state
distribution of particles predicted from Fick’s laws and the continu-
ity equation in the presence of this steady drift of particles.
Is this
distribution consistent with the simulation results you obtained?

c. Keep the parameters of Particle Sets #1 and #2 the same as in part b, but
change the right step probability of Particle Set #2 to 0.48. Explain the

28

CHAPTER 2. RANDOM WALK MODEL OF DIFFUSION

diﬀerences in the shapes of the steady-state distributions for the two sim-
ulations.

Problem 2.3 The purpose of this problem is to explore the eﬀect of a ﬁnite particle
lifetime on the statistics of a random walk.

a. Deﬁne a simulation with an initial particle distribution that is uniformly
distributed in space. Set the average particle lifetime to be ﬁnite. Run
the simulation until all the particles have expired. Examine a graph of #
particles versus step number. Explain the shape of this function.

b. Deﬁne another simulation that is identical with the one in part a, but this
time with a source of particles. Do you expect a steady state to be reached
between the the source and expirations? Determine a criterion for steady
state and check out your intuition.

c. Design a combination of source rate and lifetime such that the distribution
reaches a steady state. This might correspond, for example, to a drug
concentration reaching steady state in the body, as it is both infused and
eliminated.

d. Design a combination of source rate and lifetime such that most particles
in the region have expired by the time the source injects the next batch.
This might correspond to the drug concentration when the dosing interval
is longer than the elimination half-life of the drug.

Problem 2.4 The purpose of this problem is to explore random walks in three
regions which simulates diﬀusion through a membrane that separates two baths.
Set up the parameters as shown in Figure 2.14. For both simulations, the two end
regions contain uniform concentrations of particles; but the number of particles
diﬀers. There is a concentration diﬀerence between the end regions as shown
in Figure 2.15 for one of the simulations; the other is similar. The center region
can be regarded as a membrane that separates the two end regions and initially
contains no particles. The random walk in the membrane region is unbiased in
one simulation and biased in the other. Run the simulation for several hundred
steps.

a. Explain the diﬀerences between the distributions of particles for the two
simulations.

b. Quantitatively describe the ﬂux of particles between the two end compart-
ments — both the magnitude and sign of the ﬂux.

c. What physical process might be represented in the simulation with Particle
Set #2?

2.4. PROBLEMS

29

Figure 2.14: Parameters for a random walk in 3 regions (Problem 2.4).

30

CHAPTER 2. RANDOM WALK MODEL OF DIFFUSION

Figure 2.15: Initial locations of particles for a random walk in 3 regions (Problem 2.4).

Problem 2.5 The purpose of this problem is to explore random walks in three
regions which simulates diﬀusion through a membrane that separates two baths.
Design a three region diﬀusion regime where the center region is considered
to be a membrane. Design membrane characteristics such that the membrane
is transparent for particles moving from left to right but purely reﬂecting for
particles moving from right to left. Test your design by running the simulation.

Problem 2.6 The purpose of this problem is to examine the steady-state particle
distribution that results in the presence of sources and sinks. Start with two iden-
tical simulations with Regions #1 and #2 that have: a region size of 400; a step
size of 2; unbiased random walks; no sources or sinks; inﬁnite particle lifetimes;
and sinusoidal initial particle distributions. Choose one simulation with a period
of 200 and the other with a period of 50. Choose an appropriate bin size for the
histograms. Run the simulation.

a. What is the shape of the equilibrium distribution of particles?

b. Which particle distribution approaches this equilibrium faster?

c. Experiment with diﬀerent frequencies and generalize your conclusion from
part b.

Problem 2.7 The purpose of this problem is to examine the factors that inﬂuence
the equilibrium distribution of particles and the time to reach equilibrium. This
problem deals with a random walk in two regions. Make the size of Regions #1
and #2 each 50 steps wide and set the step size to 5 in each region. Let the initial
distribution of particles in Region #1 be 50 particles distributed uniformly and

2.4. PROBLEMS

31

let the initial distribution of particles in Region #2 be empty. Run the simulation
until equilibrium is reached. Plot the number of particles in Regions #1 and #2
as a function of step number.

a. Estimate the initial Ni and ﬁnal Nf values of the number of particles in
each region and explain these values.

b. Deﬁne the “equilibrium time” τ as the time taken for the number of parti-
cles to change from 0.1|Nf − Ni | to 0.9|Nf − Ni | and estimate the value of
τ for both Regions #1 and #2.

c. The region size aﬀects the time course of particle number in each region.
Run simulations with the size of Regions #1 and #2 set to 25 steps and to
100 steps and measure Ni , Nf , and τ for each value of region size. How
do Ni , Nf , and τ depend upon regions size for the three sizes used in your
simulations? Explain.

d. Assume that the probabilities for steps are unchanged, which other RW
parameters will aﬀect the time course of particle number in each region?
Indicate how the parameter will aﬀect the time course and test your sug-
gestion by performing appropriate simulations and measuring Ni , Nf , and
τ .

32

CHAPTER 2. RANDOM WALK MODEL OF DIFFUSION

Chapter 3

MACROSCOPIC DIFFUSION PROCESSES

33

34

CHAPTER 3. MACROSCOPIC DIFFUSION PROCESSES

3.1 Introduction

3.1.1 Background

Diﬀusion is an important transport process in physical, chemical, and biolog-
ical systems. Two theoretical models of diﬀusion capture complementary as-
pects of the phenomenon. The microscopic model describes the probabilistic
behavior of a population of individual solute particles which execute statisti-
cally independent, but otherwise identical, random walks. Software dealing with
such a microscopic model of diﬀusion is described in Chapter 2. The software
described in this chapter involves macroscopic diﬀusion which describes the
aggregate behavior of large populations of solute particles.

3.1.2 Macroscopic model of diﬀusion

,

.

In 1855, Adolph Fick proposed a macroscopic model for passive diﬀusion (Fick,
1855). By analogy to Fourier’s law of heat conduction and Ohm’s law for elec-
trical conduction, Fick proposed that the ﬂux of solute at a point in space is
proportional to the concentration gradient at that point. Mathematically, this
relation is expressed by Fick’s ﬁrst law, which, in its one-dimensional form, is as
follows:
φ = −D
∂ c
∂x
where c (x , t ) is the solute concentration and φ(x , t ) is the solute ﬂux. The
constant of proportionality, D , is known as the diﬀusion coeﬃcient. Conservation
of solute (in the absence of sources or sinks or of chemical reactions that create
or destroy solute) results in a second relation between concentration and ﬂux,
the continuity equation:

= − ∂ c
∂φ
∂ t
∂x
Diﬀerentiating both sides of Equation 3.1 with respect to x and using the con-
tinuity equation yields Fick’s second law, or the one-dimensional diﬀusion equa-
tion:
= D
∂ 2c
∂ c
∂ t
∂x 2
In principle, any one-dimensional diﬀusion process can be modelled by solving
this equation subject to the appropriate initial conditions and boundary condi-
tions.
We next consider the same problem but with two changes: (1) a body force
acts uniformly on the solute so that it drifts (migrates) and (2) a chemical reac-
tion occurs that removes solute. The solute ﬂux, φ(x , t ), is now the sum of the
diﬀusive ﬂux, given by Fick’s law, and the ﬂux due to drift. Thus, in this case,
+ v c ,
φ = −D
∂ c
∂x

(3.2)

(3.1)

(3.3)

(3.4)

3.1.

INTRODUCTION

35

where v is the drift velocity of the solute; i.e., the velocity of the solute in re-
sponse to the body force in the absence of diﬀusion. If r is the reaction rate at
which solute is removed, then the continuity equation becomes
− r c .
= − ∂ c
∂ t

∂φ
∂x

(3.5)

Combining these expressions yields a modiﬁed diﬀusion equation:
− r c .
= D
− v

∂ c
∂ t

∂ 2c
∂x 2

∂ c
∂x

(3.6)

Thus, solute drift and a chemical reaction that removes solute contribute addi-
tional terms to the diﬀusion equation.
If the initial concentration, c (x , 0) is known in some region of space and if the
relation between the concentration and ﬂux is known at each boundary of this
region, then a unique solution exists for t > 0. Given an initial concentration
proﬁle, c (x , 0), Fick’s laws govern the unique evolution of the concentration
proﬁle for all later times.

3.1.3 Overview of software

While macroscopic diﬀusion has been successfully modelled by Fick’s equations,
studying the equations alone provides only limited insight into the behavior of
diﬀusion processes. The goal of this software is to help users gain intuition
about diﬀusion in one dimension. The solutions to the diﬀusion equation are
functions of two variables: one spatial variable, x , and time, t . These solutions
can be plotted either as a function of time at a particular point in space or as a
function of the spatial variable at a particular instant in time. Such isolated snap-
shots, however, do not fully convey the dynamic behavior of diﬀusion processes.
With this software, the user can view the temporal evolution of the solute con-
centration and solute ﬂux as a function of position. Thus, the software enables
the user to gain intuition about the dynamic behavior of macroscopic diﬀusion
processes.
Furthermore, the software provides an opportunity for users to experiment
with the macroscopic diﬀusion processes. For example, the user can explore
how changing the diﬀusion coeﬃcient aﬀects the time-course of the simulation.
The user can also specify transparent or reﬂecting boundaries and can explore
how a body force acting on the solute or a chemical reaction that removes solute
inﬂuence the diﬀusion process. Thus, the software can be used as a tool for in-
vestigating how various parameters and boundary conditions inﬂuence diﬀusion
processes.
Five options for initial concentration proﬁles, corresponding to ﬁve charac-
teristic diﬀusion problems, are implemented in the software (Figure 3.1). Four
of these problems involve diﬀusion from a speciﬁed initial concentration proﬁle

36

CHAPTER 3. MACROSCOPIC DIFFUSION PROCESSES

n
o
i
t
a
r
t
n
e
c
n
o
c
 
l
a
i
t
i
n
I

Impulse

Sinusoid

Discontinuity

Arbitrary

Bath 1 M

Bath 2

Position

Two compartment

Position

Figure 3.1: Schematic representation of the ﬁve classes of initial concentration proﬁles
simulated by the software. M designates the membrane.

in a one-dimensional region of space (which may be inﬁnite in extent), while the
ﬁfth involves diﬀusion between two ﬁnite, well-mixed compartments separated
by a membrane.

One-dimensional diﬀusion

In one-dimensional diﬀusion, the initial concentration can be chosen to be one
of four options:
impulses, sinusoids, discontinuities, and an arbitrary spatial
distributions. An impulse of solute concentration is a mathematical idealization
corresponding to a ﬁnite amount of solute initially concentrated at a single point
in space. In the impulses option, the user can specify the magnitude and posi-
tion of up to four impulses. This option illustrates diﬀusion from point sources.
The sinusoids option illustrate the spatial frequency response of a system gov-
erned by the diﬀusion equation, speciﬁcally, the low-pass spatial ﬁltering eﬀect
of diﬀusion. By superimposing up to four sinusoids, the user can observe the de-
pendence of the space-time evolution of concentration on its spatial frequency
content.
In the discontinuities option, the initial concentration proﬁle may be
piecewise-constant but contain discontinuities. The user can specify the magni-
tude and location of up to four such discontinuities. For example, this allows
simulation of the diﬀusion that results from an initial rectangular pulse of so-
lute concentration. The user can also explore the response for more complicated
initial conditions which can be speciﬁed by drawing an arbitrary initial concen-
tration on the monitor screen with a mouse.

3.2. METHODS OF SOLUTION

37

For these diﬀerent initial distributions, the user can specify the boundary
type (transparent or reﬂecting), the value of the drift velocity, and the chemical
reaction rate at which solute is removed.

Two-compartment diﬀusion through a membrane

The baths are assumed to be well-stirred, so that the concentration within each
bath varies with time but not with position in the bath. The total amount of
solute in the system is assumed to be ﬁnite. The user can specify the width of
each bath and of the membrane, the initial concentration of each bath, and an
arbitrary initial concentration proﬁle in the membrane.

3.2 Methods of Solution

For several of the diﬀusion problems implemented in the software, analytic so-
lutions of the modiﬁed diﬀusion equation (Equation 3.6) are available in a form
that makes computation eﬃcient. Such solutions have been used wherever pos-
sible. The remainder of the solutions were obtained by numerical methods. The
methods are described in some detail elsewhere (Berkenblit, 1990); only a brief
summary of the methods is given here.
The method used to obtain solutions depends upon the type of boundary
condition. Two types of boundary conditions for the diﬀusion problems can be
selected by the user: transparent or reﬂecting boundary conditions. If trans-
parent boundaries are speciﬁed, then the region over which diﬀusion occurs is
inﬁnite; the spatial limits of the region over which diﬀusion is displayed are
set by the user. At a reﬂecting boundary, on the other hand, the solute ﬂux is
constrained to be zero, since no solute particles can cross such a boundary.

3.2.1 Analytic solutions

Analytic solutions were used to compute the response for all one-dimensional
diﬀusion problems with transparent boundaries. These are described in this
section.

Impulse response — Green’s function

No drift, no chemical reaction. First, we consider the case when the drift ve-
locity is zero and the chemical reaction rate is zero. Let the initial concentration
be a unit impulse located at position x = ξ and delivered at time t = 0,
c (x , 0) = δ(x − ξ ).

(3.7)

38

CHAPTER 3. MACROSCOPIC DIFFUSION PROCESSES

The solution of the diﬀusion equation (Equation 3.3), called the Green’s function
G(x , t ; ξ , 0), is

c (x , t ) = G(x , t ; ξ , 0) =

1√
4π Dt
√
Thus, the concentration proﬁle is a Gaussian function of the spatial variable.
2Dt , increases with increasing
The standard deviation of the concentration,
time, but the total area of the concentration remains constant because solute is
conserved.

e−(x−ξ )2 /4Dt .

(3.8)

Drift but no chemical reaction. We next consider the same problem but with
a non-zero drift velocity. In this case, the concentration satisﬁes the modiﬁed
diﬀusion equation, Equation 3.6, with r = 0:
= D
− v
∂ 2c
∂ c
∂ t
∂x 2

∂ c
∂x

(3.9)

,

with the initial condition

c (x , 0) = δ(x − ξ ).
The solution can be shown to be
1√
c (x , t ) =
e−(x−ξ−v t )2 /4Dt = G(x − v t , t ; ξ , 0).
4π Dt

(3.10)

(3.11)

Thus, the response in this case is a Gaussian function, as before, but the entire
proﬁle drifts in the positive x -direction with drift velocity v .

Drift and chemical reaction. With a non-zero chemical rate, r , and drift veloc-
ity, v , we need to solve Equation 3.6 which has a solution
c (x , t ) = e−r tG(x − v t , t ; ξ , 0).
(3.12)
In general, if c (cid:11)(x , t ) is the solution to Equation 3.3, with a speciﬁed initial con-
centration proﬁle and transparent boundaries, then the solution to the modiﬁed
equation, 3.6, satisfying the same initial conditions, is given by
c (x , t ) = e−r t c (cid:11)(x − v t , t ).

(3.13)

Sinusoid

First we consider the solution to Equation 3.3 with the initial condition
c (x , 0) = A (1 + sin(ωx + θ))

(3.14)

3.2. METHODS OF SOLUTION

39

for some arbitrary constant amplitude, A, spatial radian frequency, ω, and phase
(cid:4)
(cid:3)
angle, θ . The solution for t > 0 is given by
1 + e−Dω2 t sin(ωx + θ)
c (x , t ) = A

(3.15)

,

which can be veriﬁed by substituting this expression into Equation 3.3. Thus,
an initially sinusoidal concentration proﬁle remains sinusoidal for all later time,
but the amplitude decreases exponentially with time. The rate of attenuation is
proportional to the square of the spatial frequency.
(cid:3)
(cid:3)
(cid:4)(cid:4)
With drift and a chemical reaction between solute and solvent, the solution
ω(x − v t ) + θ
1 + e−Dω2 t sin
c (x , t ) = Ae−r t
where v is the drift velocity and r is the reaction rate.

(3.16)

is

,

Discontinuous initial proﬁle

(3.17)

(3.18)

δ(x − x (cid:11)) dx (cid:11) .

We next consider the case of an initial proﬁle that is piecewise-constant but
(cid:5)
contains a jump discontinuity at x = ξ . The initial condition is that
c (x , 0) =
cL , x < ξ
cR , x > ξ ,
(cid:6) ∞
ξ

which can also be written as
c (x , 0) = cL + (cR − cL)
For t > 0, we can integrate the Green’s function deﬁned by Equation 3.8 to obtain
(cid:6) ∞
the solution:
(cid:6) ∞
G(x , t ; x (cid:11) , 0) dx (cid:11)
ξ
(cid:7)
(cid:8)(cid:8)
(cid:7)
1√
e−(x−x (cid:11) )2 /4Dt dx (cid:11)
4π Dt
ξ
x − ξ
√
1 − 1
Dt
2
2
(cid:6) ∞
where the complementary error function, erfc(x ), is deﬁned by the integral
erfc(x ) = 2√
e−t2 dt .
π
x
(cid:7)
(cid:7)
With a drift velocity, v , and reaction rate, r , the solution is
x − v t − ξ
√
c (x , t ) = cLe−r t + (cR − cL)e−r t
1 − 1
Dt
2
2

c (x , t ) = cL + (cR − cL)
= cL + (cR − cL)
= cL + (cR − cL)

(cid:8)(cid:8)

.

(3.21)

erfc

erfc

,

(3.19)

(3.20)

40

CHAPTER 3. MACROSCOPIC DIFFUSION PROCESSES

3.2.2 Numerical Solutions

(3.22)

(3.23)

where

i = 1, . . . , N
j = 1, . . . , M .

One-dimensional problems with reﬂecting boundaries and the two-compartment
problem are solved using numerical methods. To solve a diﬀusion problem nu-
merically over some speciﬁed spatial region and some speciﬁed time interval,
∆t and the position increment by ∆x , we deﬁne
the position and time variables are discretized. Denoting the time increment by
i = c (xi , tj ),
uj
xi = x0 + i∆x ,
tj = t0 + j∆t ,
A general approach to solving partial diﬀerential equations numerically is to
replace the partial derivatives by ﬁnite-diﬀerence approximations. The ﬁnite-
diﬀerence expressions involve the uj
i terms deﬁned above and result in sets
of algebraic equations that can be solved by numerical methods for solving
matrix equations.
In the software, the equation with no drift term is solved
by the implicit Crank-Nicolson algorithm, while for problems with a non-zero
drift term, this algorithm is combined with the explicit Two-Step Lax-Wendroﬀ
method (Press et al., 1988; Gerald and Wheatley, 1989). When a non-zero chem-
ical reaction rate, r , is speciﬁed, the computed concentration is multiplied by
volve the parameters α = D∆t/(∆x )2 and β = v ∆t/∆x . The numerical methods
the attenuation factor, e−r t . The Crank-Nicolson and Lax-Wendroﬀ formulas in-
give stable solutions provided α < 0.5 and |β| ≤ 1. For the two compartments
option, the boundary conditions at the membrane solution interface is that the
concentration in the membrane at the interface is equal to the bath concentra-
tion.

3.2.3 Summary

A variety of techniques are used to ﬁnd analytic solutions to one-dimensional
diﬀusion problems with transparent boundaries. The speciﬁc methods used in
the software to solve one-dimensional problems depend on the initial condi-
tions and are summarized in Table 3.1. With two reﬂecting boundaries and in
the absence of drift, the analytic solutions consist of inﬁnite series. Thus it is
cumbersome to compute these analytic solutions. With two reﬂecting bound-
aries and with drift, analytic solutions are in general not available. Therefore,
we have chosen to solve these problems numerically using the Crank-Nicolson
and Lax-Wendroﬀ methods. The latter methods are also used to compute the
solutions to the two-compartment problem.

3.3. USER’S GUIDE TO THE SOFTWARE

41

Option

Boundary Type Computational Method

Impulse

Transparent

Analytic solution

Reﬂecting

Crank-Nicolson

Sinusoid

Transparent

Analytic solution

Discontinuity Transparent

Analytic solution

Reﬂecting

Crank-Nicolson

Arbitrary

Reﬂecting

Crank-Nicolson

Two-Compartment

Crank-Nicolson

Table 3.1: Summary of computational methods.

Figure 3.2: The MD Control
ﬁgure.

3.3 User’s Guide To The Software

When this software package is selected, 4 ﬁgures are displayed (in addition to
MATLAB’s command window) — MD Control, MD Initial concentration proﬁle,
MD Plots vs. position, and MD Plots vs. time. A typical session with the software
consists of selecting one of ﬁve initial concentration proﬁle options, selecting
the values of parameters, executing a simulation, and viewing the simulation
results.

3.3.1 MD Control

The MD Control ﬁgure controls the macroscopic diﬀusion software and is shown
in Figure 3.2. The part of the MD Control ﬁgure below the menubar is divided
into three panels. The left panel controls the display of the initial concentration
and the numerical parameters of the simulation abbreviated as numerics. The
middle panel controls calculation of the simulation, and allows the simulation to
be started, paused, continued, or reset. The user can select the number of steps
in time for computing the simulation results. The interpoint time is adjustable
in the numerics ﬁgures (described later). The Time is the elapsed simulation
time since the simulation was started. Clicking on 1-step results in the com-
putation of one step of the simulation. The simulation results and parameters
can be saved to a ﬁle and read from a ﬁle. Clicking on Save saves the follow-

42

CHAPTER 3. MACROSCOPIC DIFFUSION PROCESSES

ing items in a ﬁle: all the initial proﬁle parameters, the numerical parameters,
concentration and ﬂux versus position and versus time. Clicking on Open reads
these same quantities from a ﬁle. The right panel (the Simulation results panel)
controls the display of simulation results. Clicking on a selection box displays
the appropriate ﬁgure; clicking again hides it.

3.3.2 MD Initial concentration proﬁle

The MD Initial concentration proﬁle ﬁgure allows control of the initial concentra-
tion and all the parameters of the diﬀusion process. The four one-dimensional
diﬀusion problems and the two-compartment problem are implemented in the
software as ﬁve options called: Impulses (Figures 3.3), Sinusoids (Figures 3.5),
Discontinuities (Figures 3.6), Arbitrary (Figures 3.7), and Two Compartments
(Figures 3.8). To change the proﬁle type, the user clicks on the proﬁle push-
button in the MD Initial concentration proﬁle ﬁgure. Each pushbutton has an
icon suggesting the initial proﬁle type. Parameters can be viewed by clicking on
Parameters in the same ﬁgure which results in the display of the appropriate
parameters ﬁgure. Parameters can be changed by typing in the text edit box.
To activate the new parameters, the user must click on Update either in the MD
Parameters ﬁgure or in the MD Initial concentration proﬁle ﬁgure; these actions
are equivalent. Information about the initial proﬁle and parameters (alone) can
be saved in a ﬁle by clicking on Save or read from a ﬁle by clicking on Open.
These actions can be done either in the MD Parameters ﬁgure or in the MD Ini-
tial concentration proﬁle ﬁgure; they are equivalent.

Features of initial proﬁles and parameters common to all options

Variables. The initial concentration is plotted in the MD Initial concentration
proﬁle ﬁgure (Figures 3.3, 3.5, 3.6, 3.7, and 3.8). Check boxes in the upper left-
hand and the upper right-hand corners allow display of the initial concentration
and/or the initial ﬂux.

Axes scales. An axis scale can be changed by clicking on its label to display the
Axis-scale ﬁgure Figure 3.4. The new axis limits can be typed into the edit boxes
to change the axis.

Markers. There are two markers that are indicated by two green triangles on
the abscissa of both the MD Initial concentration proﬁle ﬁgure and the MD Plots
vs. position ﬁgure. These markers indicated positions at which the concentration
and ﬂux can be displayed as a function of time in the MD Plots vs. time ﬁgure.
The positions of these markers can be controlled numerically or graphically. Nu-
merical control is achieved by typing into the appropriate text edit box in the pa-
rameters ﬁgure (Figures 3.3, 3.5, 3.6, 3.7, and 3.8). Graphical control is achieved

3.3. USER’S GUIDE TO THE SOFTWARE

43

Figure 3.3:
Initial con-
centration proﬁle for im-
pulses; MD Initial con-
centration proﬁle ﬁgure
(above), MD Impulse pro-
ﬁle parameters ﬁgure for
impulses (below). A sin-
gle impulse located at po-
sition 0.5 cm of area 10 is
speciﬁed.

Figure 3.4: MD Axis scale ﬁgure when the
abscissa is chosen in the MD Initial concen-
tration proﬁle ﬁgure.

44

CHAPTER 3. MACROSCOPIC DIFFUSION PROCESSES

by clicking just below the abscissa axis in the MD Initial concentration proﬁle
ﬁgure. The left marker is controlled by clicking the left button on a two-button
mouse or by clicking the button on a single-button mouse. The right marker is
controlled by clicking the right button on a two-button (or three-button) mouse
or by shift-clicking the button on a single-button mouse.

In the MD parameters ﬁgure for each option, the user can select a
Parameters.
parameter by clicking on it and then modify that parameter by typing the new
value in the text edit box. This modiﬁcation is terminated by a carriage return or
by selection of another parameter. One panel displays the Diﬀusion parameters
— diﬀusion coeﬃcient, drift velocity, and chemical reaction rate — which are set
independently for each option. For the two compartments option these diﬀusion
parameters apply to the membrane and not to the baths.
After all the parameters in the ﬁgure have been changed, the user must press
Update before the new parameters are reﬂected in both the MD Initial concen-
tration proﬁle ﬁgure and the MD Plots vs. position ﬁgure. All the parameters for
each option can be saved in a ﬁle and read from a ﬁle.

Descriptions of the ﬁve options

For each option, the user can modify the values of parameters, change all graph
parameters, and run a simulation.

Impulses. When the software is initiated, Impulses is the default initial con-
centration proﬁle and the MD Initial concentration proﬁle ﬁgure is shown in Fig-
ure 3.3. The areas and positions of 4 impulses can be speciﬁed by the user as
shown in the parameters ﬁgure so that the initial concentration has the form
A1δ(x − x1) + A2δ(x − x2) + A3δ(x − x3) + A4δ(x − x4),
where δ(x ) is the unit impulse located at x = 0, Aj and xj are the area and
position of the j th impulse. The positions of each impulse can be set only if
its area is non-zero. Since the initial ﬂux is the spatial derivative of the initial
concentration, if the concentration contains an impulse δ(x − xo ) at x = xo then
the ﬂux contains a doublet ˙δ(x −xo ) at x = xo which is signiﬁed by a two-headed
arrow. Either transparent boundaries or reﬂecting boundaries can be chosen and
the locations of right (R) and left (L) reﬂecting boundaries can be speciﬁed.

In the Sinusoid option, the amplitudes, spatial frequencies, and phase
Sinusoid.
angles of four sinusoids can be speciﬁed (Figure 3.5) so that the initial concen-
tration has the form
A1(1 + sin(2π f1x + θ1)) + A2(1 + sin(2π f2x + θ2)) +
A3(1 + sin(2π f3x + θ3)) + A4(1 + sin(2π f4x + θ4)),

3.3. USER’S GUIDE TO THE SOFTWARE

45

Figure 3.5:
Initial
concentration pro-
ﬁle for sinusoids;
MD Initial
con-
centration
proﬁle
ﬁgure (above), MD
Sinusoid
proﬁle
parameters ﬁgure
(below). The spatial
frequencies
and
amplitudes of four
sinusoids
were
chosen to corre-
spond to the ﬁrst
four terms in the
Fourier series of a
square wave.

where Aj , fj , and θj are the amplitude, spatial frequency, and phase of the
j th sinusoid. The spatial frequency and phase of a sinusoid can be set only
if its amplitude is non-zero. Only transparent boundaries are available for the
sinusoid option.

In the Discontinuity option, the magnitude and position of four
Discontinuity.
discontinuities can be speciﬁed (Figure 3.6) so that the initial concentration has
the form

A1u(x − x1) + A2u(x − x2) + A3u(x − x3) + A4u(x − x4),

46

CHAPTER 3. MACROSCOPIC DIFFUSION PROCESSES

Figure 3.6:
Initial con-
centration proﬁle for
discontinuities;
MD
Initial
concentration
proﬁle ﬁgure (above),
MD Discontinuity pro-
ﬁle parameters ﬁgure
Two discon-
(below).
tinuities were
used
to generate an initial
concentration
proﬁle
that
is a rectangular
pulse.

 1 if x > 0,
where u(x ) is the unit step function deﬁned as
0 if x < 0,
and Aj and xj are the amplitude and position of the j th step. The position of a
step can be set only if its magnitude is non-zero. The boundary type (transparent
or reﬂecting) is selectable, and, if the boundaries are reﬂecting, the positions of
the two boundaries can be set.

u(x ) =

In the Arbitrary option, the initial proﬁle is drawn on the monitor
Arbitrary.
screen by moving the mouse cursor. The details are described in Section 3.3.5.
Only reﬂecting boundary conditions are available for this option, and the posi-
tions of the two boundaries are speciﬁable by the user (Figure 3.7).

3.3. USER’S GUIDE TO THE SOFTWARE

47

Figure 3.7:
Initial con-
centration using the arbi-
trary option; MD Initial
concentration proﬁle ﬁg-
ure (above), MD Arbitrary
proﬁle parameters ﬁgure
(below).

48

CHAPTER 3. MACROSCOPIC DIFFUSION PROCESSES

In the Two compartment option, speciﬁcation can be made
Two-compartment.
for the width and the initial concentration in each bath, the membrane width,
and the initial membrane concentration. The initial membrane concentration
proﬁle is drawn with a mouse cursor (as described in Section 3.3.5). The user can
also choose how the two baths and the membrane are to be displayed. Selecting
the View bath option (Figure 3.8) displays the membrane and both baths to scale.
The left boundary of the membrane is located at x = 0. Hence, the left bath is
located for x < 0 and if the width of the membrane is W , the right bath is located
at x > W . Selecting the View membrane option displays the membrane and a
small portion of each bath on each side.

3.3.3 Numerics

Clicking on Analytic parameters or Numeric parameters in the MD Control ﬁg-
ure displays the appropriate numerics ﬁgure (Figure 3.9). The numerics ﬁgures
control the spatial and temporal resolution of the simulation. The MD Analytic
parameters ﬁgure deals with those computations that make use of analytic solu-
tions of the diﬀusion equation (i.e., all one-dimensional diﬀusion problems with
transparent boundaries). For this case, the user can select the number of spatial
points at which the solution is computed. The larger the number of points, the
higher the spatial resolution of the computation and the longer it will take to
complete the computation. The user can also specify the temporal resolution of
the computation by selecting the time between samples (integration time).
The MD Numeric parameters ﬁgure deals with those computations that use
numerical integration of the diﬀusion equation (i.e., all one-dimensional diﬀu-
sion problems with reﬂecting boundaries and the two-component diﬀusion prob-
lem). The user can choose to select the number of points in space at which the
solution is computed. The user has a choice in how the temporal resolution is
to be determined. The numerical method is stable provided an inequality that
relates the temporal and spatial resolutions is satisﬁed. If Link is selected, the
simulation determines the integration time to satisfy the inequality and to guar-
antee a stable integration method which results in an accurate solution. If this
choice is not selected, the user can choose the temporal resolution (integration
time) and spatial resolution independently. However, with this choice there is
no guarantee that the solution will be accurate.

3.3.4 Simulation results ﬁgures

There are two ﬁgures that display the solute concentration and ﬂux during a
simulation. The MD Plots vs. position ﬁgure displays the concentration and/or
the ﬂux as a function of position at each instant in time during the simulation
(Figure 3.10). The current simulation Time is displayed in the upper left part
of the ﬁgure. Axes limits can be changed by clicking on the axes labels to dis-

3.3. USER’S GUIDE TO THE SOFTWARE

49

Initial con-
Figure 3.8:
the
centration for
two
compartments
option;
MD Initial concentration
proﬁle ﬁgure for the two
compartments option for
the bath view (top) and the
membrane view (center),
MD
Two-compartment
proﬁle parameters ﬁgure
(bottom). The bath view
shows the left bath lo-
cated between −1 and 0
cm, the membrane located
between 0 and 1 cm, and
right bath located between
1 and 3 cm.

50

CHAPTER 3. MACROSCOPIC DIFFUSION PROCESSES

Figure 3.9: The MD Analytic parameters and MD Numeric parameters ﬁgures.

Figure 3.10: MD Plots vs. position ﬁgure.

3.3. USER’S GUIDE TO THE SOFTWARE

51

Figure 3.11: MD Plots vs. time ﬁgure.

play the Axis-scale ﬁgure. The two green triangular markers mirror the markers
shown in the MD Initial concentration proﬁle ﬁgure. With the Two compartments
option, the user can also chose how the two baths and the membrane are to be
displayed in the MD Plots vs. position ﬁgure. Selecting the View membrane op-
tion displays the membrane and a bit of each bath on each side. Selecting the
View baths option displays the membrane and both baths to scale.
The MD Plots vs. time ﬁgure (Figure 3.11) displays the concentration and/or
the ﬂux as a function of time during the simulation for two positions selected by
the markers found in both the MD Initial concentration proﬁle ﬁgure and the MD
Plots vs. position ﬁgure (Figure 3.10). The locations of the markers are indicated
at the top of the ﬁgure. Axes limits can be changed by clicking on the axes labels
to display the Axis-scale ﬁgure.

3.3.5 Arbitrary concentration proﬁles

For the MD Arbitrary and MD Two compartment options, the user can draw
an arbitrary initial concentration proﬁle by clicking on the Reset/Draw button
which will also erase an existing proﬁle. Drawing a proﬁle consists of generating
a list of concentration values at a corresponding array of positions. The user
selects these points by moving the mouse and clicking any mouse button. After
the ﬁrst point is selected by the user, the word Incomplete is displayed over the
proﬁle indicating that the proﬁle is incomplete and does not span the horizontal

52

CHAPTER 3. MACROSCOPIC DIFFUSION PROCESSES

dimension of the plotting ﬁeld. As the pointer moves within the plotting ﬁeld in
the MD Initial concentration proﬁle ﬁgure, a line joins the last point which was
selected to the current pointer position. When a button is pressed, the position
and concentration that are added to the coordinate arrays depend on the pointer
location:

1. If a mouse button is pressed within the graph axes and to the right of the
previous point, then the coordinates of the pointer location are added to
the list.

2. A mouse button pressed at a position that does not lie to the right of the
previous point is ignored, in order to ensure that the user-drawn concen-
tration proﬁle is a single-valued function of position.

3. If a mouse button is pressed outside the boundaries of the graph (but still
within MD Initial concentration proﬁle ﬁgure), then the point that is added
to the list is the point of intersection between the graph boundary and a
line from the previous point to the current position. Thus, while a proﬁle
is being drawn, it is constrained to lie entirely within the boundaries of the
graph.

4. In the arbitrary initial proﬁle, the concentration at the left-hand point of
the proﬁle is set to a default value. The user can change the value of this
point by pressing the mouse button for ﬁrst point at the desired vertical
location but to the left of the concentration axis. In the two components
option, the concentration at the left-hand point of the proﬁle is set equal
to the concentration in the left bath (bath #1), and the concentration at the
right-hand point of the proﬁle is set equal to the concentration in the right
bath (bath #2).

5. If the mouse button is pressed outside the MD Initial concentration proﬁle
ﬁgure, e.g., on another ﬁgure, then the proﬁle is incomplete.

6. An incomplete proﬁle can be completed by pressing Update.
In the arbi-
trary initial proﬁle, a horizontal line segment is drawn from the last cho-
sen point to the right boundary. In the two-compartment option, the last
chosen point is connected to the concentration in the right bath.

7. An incomplete proﬁle can be completed by clicking the mouse button with
the cursor located just to the right of the right boundary of the region. Item
3 (above) gives the rule that indicates the location of the right boundary
point.

Clicking on Update after completion of the proﬁle, activates the initial proﬁle.

3.4. PROBLEMS

3.4 Problems

53

Problem 3.1 The purpose of this problem is to explore the relation between molar
solute concentration and molar solute ﬂux. The diﬀusion coeﬃcient is D = 10
−5
cm2/s.

a. For an initial, spatial sinusoidal solute concentration with an amplitude
−1 , determine the initial spatial
of 10 µmol/cm2 and a frequency of 1 cm
distribution of the molar solute ﬂux.

b. Determine an initial spatial distribution of molar solute concentration such
that the initial spatial distribution of molar ﬂux is a constant of value 1
µmol/(cm2 ·s).

Problem 3.2 The purpose of this problem is to explore the space-time evolution of
solute diﬀusion from a point source. For all parts of this problem use a single im-
pulse and transparent boundaries. Set the impulse strength to 100 moles/cm2 ,
place the impulse at position 0.5 cm, and set the drift velocity and the reaction
rate to zero. Set the marker positions to 0.55 and 0.6 cm unless indicated other-
−5 cm2/s and run the simulation for 1000
wise. Set the diﬀusion coeﬃcient to 10
seconds. Obtain a plot of the concentration and ﬂux on appropriate ordinate
scales. You should obtain the spatial distribution of the concentration and the
ﬂux at 1000 seconds and both variables as a function of time at the two marker
positions. Repeat these two steps for a diﬀusion coeﬃcient of 4 × 10
−5 cm2/s.
a. Brieﬂy describe qualitatively the eﬀect of the change in diﬀusion coeﬃcient
on the spatial distribution of concentration.

b. For both values of the diﬀusion coeﬃcient, determine the maximum am-
plitude of the concentration versus position and the width of the spatial
distribution of concentration at an amplitude that is e−1 of its peak value.
Explain the numerical values of all four measurements. Be brief and pre-
cise; state your assumptions explicitly.
−5 cm2/s, examine the concentration ver-
c. For the diﬀusion coeﬃcient at 10
sus time at the two positions 0.55 and 0.6 cm. Brieﬂy describe, in a qual-
itatively manner, the diﬀerences in concentration versus time at the two
positions.

−5 cm2/s, measure the maximum concen-
d. For the diﬀusion coeﬃcient at 10
tration as a function of time at the two positions and the time of occurrence
of this maximum. Explain the values of all four measurements. Be brief and
precise; state your assumptions explicitly.

e. Explain the shape of the spatial distribution of ﬂux for a diﬀusion coeﬃ-
−5 cm2/s.
cient of 10

54

CHAPTER 3. MACROSCOPIC DIFFUSION PROCESSES

f. Explain the relation between the ﬂux and concentration versus time at lo-
−5 cm2/s.
cation 0.55 cm for a diﬀusion coeﬃcient of 10
−5 cm2/s at positions
g. Rerun the simulation for a diﬀusion coeﬃcient of 10
0.45 and 0.55 cm. Explain the diﬀerences in the ﬂux as a function of time
for these two locations.

Problem 3.3 The purpose of this problem is to explore the space-time evolution
of solute diﬀusion from a point source in the presence of drift. Set the impulse
strength to 100 moles/cm2 ; place the impulse at position 0.5 cm; set the dif-
−5 cm2/s, and the reaction rate to zero. Set the marker
fusion coeﬃcient to 10
positions to 0.75 and 0.9 cm unless indicated otherwise. The parts of this prob-
lem that deal with reﬂecting boundaries are solved numerically. To decrease the
time taken for these computations, consider decreasing the spatial resolution of
the computation to 10 points.

a. Set the boundary conditions to transparent and the drift velocity to zero
−4 cm/s
and run the simulation for 1000 s. Now set the drift velocity to 10
and run the simulation again for 1000 s. Describe the eﬀect of the drift
on the spatial distribution of concentration. Account quantitatively for the
position of the peak of the spatial distribution at 1000 s.

b. Set the boundary conditions to reﬂecting and the drift velocity to zero.
Run the simulation until the spatial distribution is no longer a function of
time. This is the equilibrium distribution. What is the spatial distribution
at equilibrium? Explain your answer.

−4 cm/s,
c. Set the boundary conditions to reﬂecting, the drift velocity to 10
and run the simulation. Describe the eﬀect of drift on the spatial distribu-
tion of concentration. Illustrate your description with printed copies of the
distribution at characteristic times.

d. With the boundary conditions still set to reﬂecting and the drift velocity
−4 cm/s, determine the equilibrium spatial distribution of concentration.
10
Account quantitatively for this distribution.

e. It is known that the density of air decreases exponentially with distance
above the earth’s surface. Explain this phenomenon, taking the above sim-
ulation results into account.

Problem 3.4 The purpose of this problem is to explore some of the assumptions
that underlie two-compartment diﬀusion. As shown elsewhere (Weiss, 1996a,
Chapter 3), two-compartment diﬀusion is based on 4 assumptions:

1. The two compartments are well-mixed so that the concentrations of solute
n(t ) and c 2
n(t ).
n are uniform and have values at time t of c 1

3.4. PROBLEMS

55

2. Solute particles are conserved, e.g., there is no chemical reaction present
that either creates or destroys particles.

3. The membrane is suﬃciently thin and the number of solute particles con-
tained in the membrane at any time is negligibly small.

4. The membrane is suﬃciently thin that at each instant in time the concen-
tration proﬁle in the membrane is in steady state.

This problem concerns the conditions for the validity of assumptions 3 and 4.
Speciﬁcally, you will explore the eﬀect of bath dimensions on two-compartment
diﬀusion without making these two assumptions.
In all parts of the problem, use the Two compartments option of the software.
Set the membrane width to 0.01 cm, and the concentration of bath #1 to 70 and
bath #2 to 10 mol/cm3 . Leave the drift velocity and reaction rate at 0 and the
−5 cm2/s. Set the parameters of the plot of concentra-
diﬀusion coeﬃcient at 10
tion versus position so that the membrane and a little of each bath are visible on
the screen — select membrane view. Note that the left edge of the membrane is
at a position of 0 cm. Draw some initial concentration in the membrane. Make
sure all ordinate scales on all plots are 0 to 100 mol/cm3 . Keep these parameters
ﬁxed throughout this problem. To reduce the time taken for the computation re-
duce the spatial resolution in the membrane to 10 points in space. The software
will determine the time increment (DELTA_T). Initially set the number of steps so
that the end time is 5 s.
For each of the pairs of bath widths — Bath #1 = 1 cm, Bath #2 = 1 cm; Bath #1
= 0.1 cm, Bath #2 = 0.1 cm; Bath #1 = 0.01 cm, Bath #2 = 0.01 cm; Bath #1 = 0.01
cm, Bath #2 = 0.05 cm; Bath #1 = 0.001 cm, Bath #2 = 0.001 cm; — answer the
following questions.

a. Assess the validity of assumption 4.

i. Make rough estimates of both the steady-state (τs s ) and equilibrium
(τeq ) time constants from the computations.
ii. Estimate the same two time constants based on theoretical considera-
tions (Weiss, 1996a, Chapter 3).

iii. What is your conclusion based on your computations and your esti-
mates of time constants?

b. Assess the validity of assumption 3.

i. Before you do the computation, make an estimate of the ﬁnal concen-
tration in each bath. Then do the computation, and check your initial
estimates against the computed values

ii. If they diﬀer, explain the basis of the diﬀerence.

56

CHAPTER 3. MACROSCOPIC DIFFUSION PROCESSES

iii. How good is the assumption that the quantity of solute in the mem-
brane is negligible? If you decide that the quantity of solute in the
membrane is not negligible, design a simulation experiment to test
your conclusion.

e. Are the bath concentrations exponential functions of time? Explain.

Problem 3.5 The purpose of this problem is to explore the successes and pitfalls of
the method of images for solving diﬀusion problems in the presence of a reﬂecting
boundary. Some problems in diﬀusion with a reﬂecting boundary can be solved
by using the solution for a transparent boundary and the method of images to
match the reﬂecting boundary condition.
In all parts of this problem, set the drift velocity to zero, the reaction rate
−5 cm2/s unless state otherwise. The
to zero, and the diﬀusion coeﬃcient to 10
parts of this problem that deal with reﬂecting boundaries are solved numeri-
cally. To decrease the time taken for these computations, consider decreasing
the spatial resolution of the computation to 10 points.

a. Use reﬂecting boundaries, and an initial impulse of concentration of strength
100 moles/cm2 located at 0.2 cm. Run the simulation for 1000 s and obtain
a print of the spatial distribution of concentration at time 1000 s and the
concentration versus time at locations 0 and 0.3 cm.

b. At a reﬂecting boundary, the ﬂux must be zero. Change the boundary
condition to transparent and determine the parameters of two impulses:
one to match the left boundary condition and another to independently
match the right boundary condition. Run the simulation again and compare
with the results in part a. Does this “method of images” work exactly?
Explain.

Problem 3.6 The purpose of this problem is to explore the space-time evolution of
diﬀusion from an initial sinusoidal concentration proﬁle. Diﬀusion from an initial
sinusoidal concentration distribution gives important insights into the space-
time evolution of diﬀusion processes.
In all parts of this problem, use a drift
−5 cm2/s
velocity of zero, a reaction rate of zero, and a diﬀusion coeﬃcient of 10
unless state otherwise.

a. Use an initial concentration that is sinusoidal with amplitude 50 moles/cm2
and a spatial frequency of 1 cycle/cm. Run the simulation for 1000 s and
print the spatial distribution of concentration at 1000 s and the concentra-
tion versus time at 0.25 and 0.75 cm. Repeat this procedure for sinusoids
with the same amplitudes but the following spatial frequencies: 3, 5, and 7
cycles/cm. Summarize your results both qualitatively (in words) and then
quantitatively (with suitable calculations).

3.4. PROBLEMS

Amplitude
(µmol/cm2 )

10
−10
10
−10

Position

(cm)
−100
0.4

0.6

100

57

Table 3.2: Concentration well — Problem 3.7.

b. Construct a periodic waveform from four sinusoids with the following am-
plitudes (moles/cm2 ) and spatial frequencies (cycles/cm): 105, 1; 35, 3;
21, 5; 15, 7. Run the simulation and observe the spatial distribution of
concentration. Summarize your results and relate them to results of part
a.

c. Switch to the arbitrary initial distribution option and set the boundary con-
ditions to reﬂecting. Using the mouse draw an arbitrary, preferably jagged,
initial proﬁle. This part of this problem uses a numerical solution method
that is time consuming. To decrease the time taken for these computa-
tions, consider decreasing the spatial resolution of the computation to 10
points. Run the simulation and watch the spatial distribution of concentra-
tion change. Summarize your results. What is the eﬀect of diﬀusion on the
spatial distribution?

Problem 3.7 The purpose of this problem is to explore the time it takes for diﬀu-
sion to take place in a concentration well. We examine the following two estimates
of diﬀusion time.

1. A crude estimate of the time t1 it takes for 1/2 the particles to diﬀuse over
a distance x is t1 = x 2/D (Weiss, 1996a, Sections 3.2 and 3.3).
2. The time for equilibration of a slab of dimensions 2a so that the average
concentration in the slab is half its ﬁnal value corresponds to the condition
Dt2/a2 = 0.21 (Weiss, 1996a, Figure 3.18).
Deﬁne a concentration well as shown in Table 3.2 and let the diﬀusion coeﬃcient
be D = 10
−5 cm2/s.

a. Run the software and measure the concentration in the center of the well
as a function of time. Estimate the time t3 it takes for this concentration to
reach 1/2 its ﬁnal value.

b. Quantitatively compare the estimates t1 , t2 , and t3 .

58

CHAPTER 3. MACROSCOPIC DIFFUSION PROCESSES

c. Brieﬂy discuss the bases of the diﬀerences you found between these three
estimates.

c. Suggest a new method to estimate an equilibration time that will be close to
t2 using the concentration well deﬁned in Table 3.2. Test your suggestion
by performing the computations and making the comparison.
d. Why are there discontinuities in the well at ±100? What eﬀect do they have
on the estimates of equilibration time.

Chapter 4

CARRIER-MEDIATED TRANSPORT

59

60

CHAPTER 4. CARRIER-MEDIATED TRANSPORT

4.1 Introduction

Transport of many solutes including important metabolites (e.g. monosaccha-
rides, amino acids, mononucleotides, phosphates, uric acid, etc.) through cel-
lular membranes is accomplished by membrane-bound carrier molecules that
combine with the solute molecule on one face of the membrane, then translo-
cate in the membrane and uncombine at the other face. Thus, transport involves
chemical reactions in which the solute binds and unbinds with a carrier. This
type of transport is called carrier-mediated transport. Carrier-mediated trans-
port has distinctive properties. For example, the relation of ﬂux to concentra-
tion saturates, i.e., it does not obey Fick’s law for membranes. In addition, dif-
ferent molecules compete for the carrier. For example, glucose and sorbose (two
monosaccharides) compete for the sugar carrier. Hence, transport of one sugar
can inhibit transport of another simply by occupying a site to which both can
bind.

There are canonical models of carrier-mediated transport that capture impor-
tant properties of the transport of metabolites through cellular membranes. It
is important to understand these canonical models in order to understand how
metabolites are transported across these membranes. Derivations of predictions
of these models are not particularly diﬃcult to follow; the individual steps are
simple. However, the models typically result in messy algebraic expressions that
relate ﬂux to concentration and transport parameters. Thus, it is easy to get lost
in algebraic manipulation as well as in a sea of parameters so that an intuitive
grasp of the models becomes illusive. The intent of this software is to allow the
user to develop intuition for these models.

4.2 Description Of The Models

Descriptions of carrier-mediated transport as well as models of such transport
processes can be found elsewhere (Stein, 1986; Weiss, 1996a). Here we consider
three models and list both the assumptions and the important results. First,
we consider the steady-state behavior of a simple, four-state carrier that binds
one solute Then, we consider the steady-state behavior of a simple, six-state
carrier that binds two solutes with diﬀerent aﬃnities. Finally, we consider both
the transient and the steady-state behavior of a general, four-state carrier model
that binds one solute.

4.2. MODELS

61

ni
E
S i + E i

Membrane
φE
αES
βES

no
E
E o + S o

c i
S

K i
S

K o
S

c o
S

r
a
l
u
l
l
e
c
a
r
t
n
I

ES i
ni
ES

αE
βE
φS = φES

ES o
no
ES

r
a
l
u
l
l
e
c
a
r
t
x
E

Figure 4.1: Kinetic diagram of
the simple, four-state carrier
that binds one solute.

4.2.1 Steady-state behavior of a simple, four-state carrier that
binds one solute

Assume that the membrane contains NET moles of carrier per unit area of mem-
brane.1 Each of these carriers exist in one of four states labeled ES i , ES o , E i , and
E o (Figure 4.1). In the ES states, the solute S is bound to the carrier E ; in the
E state the carrier is unbound. In the ES i and E i states, the carrier, bound and
unbound, communicates with the solution on the inner side of the membrane.
In the ES o and E o states, the carrier, bound and unbound, communicates with
the solution on the outer side of the membrane. The densities of carrier in the
four states are ni
E , and no
ES , ni
ES , no
E moles per unit area of membrane. The ﬂuxes
of bound and unbound carrier are φES and φE and the ﬂux of solute is φS . The
ﬂux is deﬁned as positive when the ﬂux is in the outward direction; the units
are in moles per unit area per second. The model is deﬁned by the following
assumptions:
• The total amount of carrier, bound and unbound, is constant, i.e. the sum
of the carrier density over all of its states equals the total density of carrier
in the membrane
E + no
NET = ni
ES + no
ES + ni
E .
(4.1)
• Since the carrier resides permanently in the membrane, the total ﬂux of
carrier must be zero, i.e.
φES + φE = 0.
(4.2)
• The only time the solute crosses the membrane is when it is bound to the
carrier; ES o is assumed to undergo a reversible change in conformation to

1Because the kinetic equations for binding of the carrier to the solute are analogous to
those of the binding of an enzyme to its substrate, the carrier is denote by E which stands for
enzyme.

62

CHAPTER 4. CARRIER-MEDIATED TRANSPORT

the form ES i . The unbound carrier is assumed to undergo a similar reac-
tion between the two conformations E i and E o . These two reactions are as-
sumed to be ﬁrst-order reactions with forward and reverse rate constants,
αE , αES , βE , and βES , so that the ﬂuxes are deﬁned as follows:
φES = φS = αES ni
ES − βES no
ES ,
(4.3)
φE = αE ni
E − βE no
E .
(4.4)
• In the simple model, the binding reactions at the membrane interfaces are
assumed to be so rapid, compared to the rate of transport of solute across
the membrane, that the membrane interface reactions are assumed to be
at equilibrium, i.e.,

S ni
c i
E
ni
ES
where K o
S and K i
S are the dissociation constants on the two membrane in-
terfaces.

= K o
S and

S no
c o
E
no
ES

= K i
S ,

(4.5)

(4.6)

0
K o
S−βES
1

These equations can be solved to determine the n’s in terms of the concentra-
tions and transport parameters. Equations 4.3 and 4.4 can be used to determine
the φ’s. Combining Equations 4.2, 4.3, and 4.4 yields
E − βE no
ES ) + (αE ni
ES − βES no
E ) = 0.
(αES ni
 ni

 0
 =
 .
 K i
Equations 4.1, 4.5, and 4.6 can be expressed as a matrix equation as follows:
−c i
0−c o
S
S
ES
no
0
0
0
S−βE
ES
ni
αE
αES
0
E
no
NET
1
1
1
E
The ﬁrst two rows correspond to the two relations in Equation 4.5. The third
row results from Equation 4.6, and the fourth row corresponds to Equation 4.1.
This set of simultaneous equations has the following solutions (Weiss, 1996a):
S + βES c o
c i
S (βE K o
ES = NET
S )
ni
D1
S + αES c i
c o
S (αE K i
ES = NET
S )
no
D1
S + βES c o
S (βE K o
K i
S )
D1
S + αES c i
S (αE K i
K o
S )
D1

E = NET
ni

E = NET
no

(4.11)

(4.10)

(4.7)

(4.9)

(4.8)

,

,

,

,

4.2. MODELS

63

ni
ES
ES i

Membrane
φS = φES
αES
βES

no
ES
ES o

c i
S

S i
R i

c i
R

r
a
l
u
l
l
e
c
a
r
t
n
I

K i
S

ni
E

+ E i

φE
αE
βE

K o
S

c o
S

no
E
E o +

r
a
l
u
l
l
e
c
a
r
t
x
E

S o
Ro

K i
R

K o
R

c o
R

ER i
ni
ER

αER
βER
φR = φER

ERo
no
ER

where

Figure 4.2: Kinetic diagram of a simple,
six-state carrier that binds two solutes (S
and R ).

S + c o
S + αES c i
S ) + (αE K i
S + c i
S + βES c o
D1 = (βE K o
S )(K o
S )(K i
S ).
φS and φE can be obtained from Equations 4.3 and 4.4.
The ﬂux of solute can also be expressed in terms of the uni-directional ﬂuxes
φS − ←
φS = →
φS ,
←
φS = βES no
ES .

→
φS = αES ni
ES and

(4.12)

as

where

4.2.2 Steady-state behavior of a simple, six-state carrier that binds
two solutes

The simple, four-state carrier shown in Figure 4.1 can be extended to account
for the binding of two solutes that compete for binding sites on the carrier (Fig-
ure 4.2). In this scheme, solutes S and R combine with carrier E but with diﬀerent
aﬃnities. The binding to solute S has dissociation constants K i
S and K o
S and the
binding to R has dissociation constants K i
R and K o
R .
The kinetic equations are analogous to those derived for the simple, four-
state carrier except that the carrier now has 6 states:

64

(4.13)

CHAPTER 4. CARRIER-MEDIATED TRANSPORT
• The total amount of carrier, bound and unbound, is constant, i.e. the sum
of the carrier density over all of its six states equals the total density of
carrier in the membrane
E + no
ER + ni
ER + no
ES + ni
ES + no
NET = ni
E ,
where NET is the total density of carrier in the membrane.
• Since the carrier remains in the membrane, the net ﬂux of carrier must be
zero
φES + φER + φE = 0.
• The ﬂuxes are related to the carrier densities so that
φES = φS = (αES ni
ES − βES no
ES ).
(4.15)
ER − βERno
φER = φR = (αERni
ER ).
(4.16)
φE = (αE ni
E − βE no
E ).
(4.17)
• In the simple model, the reactions at the membrane interfaces are assumed
to take place so rapidly, compared to the rate of transport of solute across
the membrane, that the membrane interface reactions are assumed to be
at equilibrium, i.e.,
= K o
S ,

= K i
S and

= K o
R ,

= K i
R ,

(4.18)

(4.14)

S no
c o
E
no
ES

S ni
c i
E
ni
ES

Rno
c o
E
no
ER

Rni
c i
E
ni
ER

where K o
R and K i
S , K o
S , K i
R are the dissociation constants for solutes S and
R , respectively at the two membrane interfaces.

(4.19)

Combining Equations 4.14 and 4.15, 4.16, and 4.17 yields
E − βE no
ER ) + (αE ni
ER − βERno
ES ) + (αERni
ES − βES no
E ) = 0.
(αES ni
It is of interest to obtain the ﬂux of solutes S and R as a function of both con-
centrations and the transport parameters K i
S , K o
S , K i
R , K o
R , αES , αER , αE , βES , βER ,
βE , and NET . Therefore, it is useful to regard the system of algebraic equations
given by Equations 4.14 through 4.19 as a set of 6 equations in the 6 unknowns
 .
 =




ni
ES , no
ES , ni
ER , no
ER , ni
E , and no
E . These can be written in matrix form as follows:
−c i
ni
K i
0−c o
0
0
ES
S
S
no
K o
0−c i
0
0
ES
S
S
K i
ni
0−c o
0
0
R
R
ER
no
0
0
0−βES
0
R−βE
ER
ni
αE
αER
αES
E
no
1
1
1
1
1
E

0
0
0
K o
R−βER
1

0
0
0
0
0
NET

(4.20)

4.2. MODELS

65

ES = NET
ni

ES = NET
no

The ﬁrst four rows correspond to the four relations in Equation 4.18. The ﬁfth
row results from Equation 4.19, and the sixth row corresponds to Equation 4.13.
This set of simultaneous equations has solutions (Weiss, 1996a):
R + βES c o
R + βERK o
S c o
S K o
S K o
R (βE K o
S K i
c i
R )
D2
R + αES c i
R + αERK i
S c i
S K i
S K i
R (αE K i
S K o
c o
R )
D2
R + βES c o
R + βERK o
S c o
S K o
S K o
R (βE K o
S c i
K i
R )
D2
R + αES c i
R + αERK i
S c i
S K i
S K i
S (αE K i
RK o
c o
R )
D2
R + βERK o
R + βES c o
S c o
S K o
S K o
R (βE K o
S K i
K i
R )
D2
R + αERK i
R + αES c i
S c i
S K i
S K i
R (αE K i
S K o
K o
R )
D2

ER = NET
no

ER = NET
ni

E = NET
ni

E = NET
no

,

,

,

,

,

,

(4.23)

(4.24)

(4.25)

(4.26)

(4.21)

(4.22)

where

R + K o
R + c o
RαER + K i
D2 = K i
R ) +
S c o
S K o
S K o
RαE )(K o
S (c i
R + c i
R βER + K o
R + K i
R ) +
R βE )(K i
S (c o
K o
S K i
S K i
S c i
R + c o
R + K o
R ) +
c i
S K i
RαES (K o
S K o
S K o
S c o
R + K i
R + c i
S c i
S K i
S K i
R βES (K i
S K o
c o
R ).

(4.27)

The ﬂuxes can be computed using Equations 4.15-4.17.
The solute ﬂuxes can also be expressed in terms of the uni-directional ﬂuxes

as

where

φS = →
φS − ←
φS ,
φR − ←
φR = →
φR ,

→
φS = αES ni
ES and
→
φR = αERni
ER and

←
φS = βES no
ES ,
←
φR= βERno
ER .

66

r
a
l
u
l
l
e
c
a
r
t
n
I

CHAPTER 4. CARRIER-MEDIATED TRANSPORT

ni
E
S i + E i

Membrane
φE
ai
ao

no
E
E o + S o

c i
S

gi

hi

ho

go

c o
S

ES i
ni
ES

bi
bo
φS = φES

ES o
no
ES

r
a
l
u
l
l
e
c
a
r
t
x
E

Figure 4.3: Kinetic diagram of a general,
four-state carrier model that binds one so-
lute.

4.2.3 Transient and steady-state behavior of a general, four-state
carrier that binds one solute

Transient solution

Suppose that in the simple, four-state carrier model shown in Figure 4.1, the as-
sumption that the interfacial binding reactions are fast is dropped. The model
which results is called the general, four-state carrier model and the kinetic dia-
gram for this model is shown in Figure 4.3.
This model is deﬁned by the following assumptions:
• The total amount of carrier, bound and unbound, is constant, i.e. at each
instant in time the sum of the densities of carrier over all of its states
equals the total density of carrier
E (t ) + no
ES (t ) + ni
ES (t ) + no
NET = ni
E (t ).
Since both transient and steady-state values will be considered, the nota-
tion will be to specify a variable that changes in time as, for example, ni
ES (t )
ES (∞).
and its steady-state value as ni
• Since the carrier resides permanently in the membrane, the total ﬂux of
carrier must be zero, i.e.

(4.28)

φES (t ) + φE (t ) = 0.
(4.29)
• The only time the solute crosses the membrane is when it is bound to the
carrier; ES o is assumed to undergo a reversible change in conformation to
the form ES i . The unbound carrier is assumed to undergo a similar reac-
tion between the two conformations E i and E o . The kinetic equations for
the general, four-state carrier model can be written for the rate of change

4.2. MODELS

67

d
dt

d
dt

 =
 ni
of carrier in each of the four states by a matrix diﬀerential equation which
is
E (t )
no
E (t )
ni
ES (t )
 . (4.30)
 ni

 −ai − hic i
no
ES (t )
gi
E (t )
ao
0
−ao − ho c o
S
no
ai
E (t )
go
0−bi − gi
S
hic i
ni
bo−bo − go
ES (t )
0
S
ho c o
no
bi
ES (t )
0
S
The binding reactions are not assumed to be arbitrarily fast. Since the
binding reactions are assumed to be second-order kinetic equations, the
solute concentrations enter the binding reactions.
The four kinetic equations are not independent; e.g., the fourth can be derived
from the ﬁrst three equations. Thus, the fourth equation can be eliminated and
no
ES (t ) can be eliminated using the conservation of carrier relation,
E (t ) − ni
E (t ) − no
ES (t ) = NET − ni
no
ES (t ),
 =
 ni
to yield the matrix equation
E (t )
no
E (t )
 −ai − hic i
ni
ES (t )
ai − go
S
 0
 NET .
S − bo
hic i
go
bo
This matrix equation can be solved for the three carrier densities and Equa-
tion 4.31 can be used to solve for the fourth density. The solution for each of
the carrier densities has the form
nj (t ) = Aj1eλ1 t + Aj2eλ2 t + Aj3eλ3 t ,
(4.34)
where the nj ’s are the four carrier densities, the λ’s are the three non-zero eigen-
values of the system, and the A’s are the residues. This solution is valid when
the eigenvalues are distinct. All 4 carrier densities have the same 3 eigenvalues,
but in general, the residues diﬀer. Since the rate constants and concentrations
are all positive quantities, it can be shown that all the eigenvalues have negative
real parts. Both the eigenvalues and residues are functions of the rate constants
and the solute concentrations. Hence, the solutions yield the carrier densities
(ni
ES (t ), no
ES (t ), ni
E (t ), and no
E (t )) as functions of time for any values of the con-
centrations of solute S and of the transport parameters ai , ao , bi , bo , gi , go , hi ,
ho , and NET .

  ni
E (t )
no
E (t )
ni
ES (t )

 +

ao
−ao − go − ho c o
−bo
S

gi−go
−bi − gi − bo

(4.31)

(4.32)

(4.33)

68

CHAPTER 4. CARRIER-MEDIATED TRANSPORT

Steady-state solution

In the steady state, the density of carrier in each of its four states is constant and
the derivative terms on the left-hand side of Equation 4.30 are zero. As noted
previously, the four equations are not independent. Thus, one of the equations
can be eliminated. However, conservation of carrier leads to an independent
constraint which can be added to the three independent steady-state equations
 ni

 =
 .
 −(ai + hic i
 0
to yield the following four steady-state equations
E (∞)
ao
gi
S )
−(ao + ho c o
E (∞)
no
S )
ai
0−(bi + gi)
0
ES (∞)
ni
hic i
0
0
ES (∞)
S
no
NET
1
1
1
The solutions (Weiss, 1996a) are ratios of sums of products of rate constants
ES (∞)
ES (∞)
E (∞)
E (∞)
= M o
no
= M i
ni
= M o
no
= M i
ni
ES
ES
E
E
D
D
D
D
NET
NET
NET
NET

0
go
bo
1

(4.36)

(4.35)

,

,

,

,

where

(4.37)

E = aobigo + aogigo + aobogi + bogiho c o
M i
S ,
E = aibigo + aigigo + aibogi + bigohic i
M o
S ,
S + bohiho c i
ES = aiboho c o
S + aogohic i
S + aobohic i
S c o
M i
S ,
ES = aibiho c o
S + aigiho c o
S + aobihic i
S + bihiho c i
M o
S c o
S ,
ES + M o
E + M i
E + M o
D = M i
ES .
The steady-state ﬂux is found elsewhere and equals (Weiss, 1996a)
E (∞) − bogiho c o
E (∞)
−φE (∞) = φS (∞) = φES (∞) = bigohic i
S no
S ni
bigo + bogi + gigo
.
(4.38)
These equations yield the values of the n(∞)’s and the φ(∞)’s in steady state as
a function of the concentrations of solute S and of the transport parameters ai ,
ao , bi , bo , gi , go , hi , ho , and NET .
The ﬂux of solute can also be expressed in terms of the uni-directional ﬂuxes
φS (∞)− ←
φS (∞) = →
φS (∞),

as

where

→
φS (∞) =
←
φS (∞) =

E (∞)
bigohic i
S ni
bigo + bogi + gigo
E (∞)
bogiho c o
S no
bigo + bogi + gigo

,

.

4.3. NUMERICAL METHODS

69

4.3 Numerical Methods And Parameters

4.3.1 Numerical methods

The steady-state values of the carrier densities and the carrier ﬂuxes are alge-
braic functions of the solute concentrations and of the parameters. They could
have been computed directly from the steady-state matrix equations for each
carrier model. However, it proved to be faster to compute these quantities di-
rectly from the solutions of these matrix equations which are: Equations 4.3-4.4
and Equations 4.8-4.11 for the simple, four-state carrier, Equations 4.15-4.17 and
Equations 4.21-4.26 for the simple, six-state carrier, and Equations 4.36-4.38 for
the general, four-state carrier.
The transient solution for the general, four-state carrier was obtained by solv-
ing Equation 4.33 numerically using MATLAB’s ode15s routine for solving sets
of ordinary diﬀerential equations. The solution for 3 of the 4 carrier densities
were computed; the fourth was computed from Equation 4.31. Eigenvalues of
the matrix of rate constants (Equation 4.33) were computed to aid the user in
choosing a time scale for displaying transient responses. Eigenvalues were com-
puted using MATLAB’s eig function.

4.3.2 Choice of numerical parameters

The software enables the user to compute the n’s and φ’s for any values of the
parameters, the α’s, β’s, K ’s, NET , and the concentrations of solute, the c ’s. For
the simple models, the software is initiated with default parameters chosen to
approximate hexose transport in human erythrocytes (Carruthers, 1984; Stein,
1986) assuming a symmetric transport scheme. The density of carriers was set
to NET = 10 pmoles/cm2 . The dissociation constant of solute S was set to ap-
S = K o
S = 2 µmoles/cm2 , and that of R was set
proximate that of D-glucose, K i
to that of a solute to which the carrier binds with lower aﬃnity, approximating
R = K o
R = 200 µmoles/cm2 . All the rate constants
that of D-xylose, so that K i
were set equal with a value that made the maximum ﬂux 100 pmoles/cm2 -s so
that αES = βES = αER = βER = αE = βE = 20 s
−1 . For the general model, the pa-
rameters were chosen somewhat arbitrarily except that rate constants of binding
reaction were chosen to be much greater than those of translocation reactions.
All the parameters were chosen to be approximately consistent with the simple
S = 2,
models. The concentrations of solute were chosen arbitrarily as follows: c i
S = 1, c i
R = 2, c o
R = 1 µmoles/cm3 .
c 0

4.4 User’s Guide

When the program is selected, 3 ﬁgures are displayed (in addition to MATLAB’s
command window): CMT Control, CMT Parameters, and CMT State. The CMT

70

CHAPTER 4. CARRIER-MEDIATED TRANSPORT

Figure 4.4: CMT Control ﬁgure.

Figure 4.5: CMT Units ﬁgure showing the
units of all the variables in the carrier mod-
els.

Control ﬁgure controls the software. The remaining ﬁgures are for steady-state
interactive analysis of the simple, four-state carrier. In the interactive mode, any
parameter of the carrier model can be changed and the resulting steady-state val-
ues of carrier densities and ﬂuxes are displayed immediately. The same steady-
state interactive analysis is available in all three models: the simple symmetric,
four-state carrier; the simple symmetric, six-state carrier; and the general, four-
state carrier. Additional modes of analysis allow plotting the steady-state values
of carrier densities and ﬂuxes as functions of a user-speciﬁed model parameter.
In addition, for the general, four-state carrier, the user can observe transient
changes in carrier densities in response to a change in parameters. All of these
modes of analysis are selected using the CMT Control ﬁgure.

4.4.1 CMT Control

The part of the CMT Control ﬁgure (Figure 4.4) below the menubar is divided
into three panels. The Model panel allows the user to choose a particular model
for analysis. The Analysis panel allows the user to choose among the available
modes of analysis in the software by clicking on the appropriate button. The
miscellaneous panel allows the user to display the units for all variables used by
the software (Figure 4.5).

4.4. USER’S GUIDE

71

Figure 4.6: The CMT Parameters ﬁgure (left) and CMT State ﬁgure (right) for the simple,
four-state carrier model that binds one solute.

4.4.2 Model

The CMT Control ﬁgure allows selection of three models of carrier-mediated
transport. Selecting a diﬀerent model will initiate the steady-state, interactive
analysis for that model. The models are:

Simple, four-state: refers to the simple, four-state carrier that binds one solute.
This is the default model that is displayed when the software is initialized.
The parameters and state ﬁgures associated with this model are shown in
Figure 4.6.

Simple, six state: refers to the simple, six-state carrier that binds two solutes
shown in Figure 4.7.

General, four-state: refers to the general, four-state carrier that binds one solute
shown in Figure 4.8.

4.4.3 Steady-state interactive analysis

Interactive, steady-state analysis involves two ﬁgures — the CMT Parameters and
the CMT State ﬁgures. Any parameter (independent variable) can be changed in
the CMT Parameters ﬁgure and the resulting changes in the steady-state values

72

CHAPTER 4. CARRIER-MEDIATED TRANSPORT

Figure 4.7: The CMT Parameters ﬁgure (left) and CMT State ﬁgure (right) for the simple,
six-state carrier model that binds two solutes.

4.4. USER’S GUIDE

73

Figure 4.8: The CMT Parameters ﬁgure (left) and CMT State ﬁgure (right) for the general,
four-state carrier model that binds one solute.

of the carrier state densities and carrier ﬂuxes (dependent variables) are dis-
played in the CMT State ﬁgure. The parameters for all three carrier models are
listed in Table 4.1. In both the CMT Parameters and CMT State ﬁgures, clicking
on any variable (parameter, carrier density, or carrier ﬂux) displays information
about that variable.

CMT Parameters

The numerical value of each parameter is displayed in the button located either
above or below each parameter. Parameter values can be changed en masse
by clicking the appropriate buttons in the upper part of the parameters ﬁgure.
Parameters can be Reset to their default values or read from a ﬁle. Parameters
may also be saved to a ﬁle.
Parameters may be changed individually in three ways.
• A value may be changed arbitrarily by clicking on the button for each pa-
rameter. The button is changed to a text-edit box which allows editing the
parameter value. After typing RETURN, the new values of carrier densities
and carrier ﬂuxes are computed and displayed in the CMT State ﬁgure. A
non-numeric entry or a negative entry is not accepted and the prior value
is restored.

74

CHAPTER 4. CARRIER-MEDIATED TRANSPORT

Simple

Simple

General

four state

six state

four state

Rate constants

Total carrier density

NET
αE , βE ,
αES , βES
c i
S , c o
Solute concentrations
S
S , K o
Dissociation constants K i
S

NET
NET
αE , βE , αES , βES , ai , ao , bi , bo
gi , go , hi , ho
αER , βER
R , c o
S , c o
c i
S , c o
S , c i
c i
R
S
R , K o
K i
S , K o
S , K i
R

Table 4.1: Modiﬁable parameters of the carrier models — the independent variables.
• A parameter, selected by clicking on its button, may be incremented or
decremented by clicking on or
in the upper right in the CMT Parameters
ﬁgure. The state ﬁgure is updated with each incremental change in the
parameter.
• A parameter, selected by clicking on its button, may be incremented or
, respec-
or to the left of the
decremented repeatedly by clicking on
tively. The CMT State ﬁgure is updated with each incremental change in
the parameter. Clicking on a repeat button again stops the repetitive pro-
cess.

In the general, four-state carrier, passive transport of solute (also called the
principle of detailed balance) requires that (Weiss, 1996a)
aihobogi = aohibigo .

When this condition is violated, a warning messages is displayed in the CMT
Parameters ﬁgure, and the ratio

r = aohibigo
aihobogi

is displayed. To avoid warning messages for small diﬀerences in r caused by the
limited precision with which parameters are speciﬁed, messages are displayed
only if r diﬀers from 1 by more than 5%.

CMT State

The steady-state values of carrier densities and carrier ﬂuxes are displayed in
the CMT State ﬁgure below each quantity for the particular set of parameters

4.4. USER’S GUIDE

75

shown in the CMT Parameters ﬁgure. These quantities are also displayed graph-
ically. Carrier densities are displayed with bar graphs that represent the relative
densities of carrier in each states. Both four-state carriers display ni
E , no
E , ni
ES ,
and no
ER , and no
ES , ni
ES , no
E , ni
E , no
ES . The six-state carrier displays ni
ER . The car-
rier ﬂuxes are displayed with thick arrows in the center of the ﬁgure. No arrow
is displayed when the ﬂux is zero. The direction of the arrow indicates the di-
rection of the ﬂux. The color of the arrow indicates the relative magnitude of
the carrier ﬂux; a small magnitude ﬂux has a black arrow, a large magnitude ﬂux
has a bright red arrow. The color coding is irrelevant for the four-state models
since there are only two ﬂuxes and they must have the same magnitude, but is
useful for the six-state model.

4.4.4 Steady-state graphic analysis

Selection of Graphic analysis in the CMT Control ﬁgure, displays the CMT Steady
state plot ﬁgure (Figure 4.9). This ﬁgure allows the user to plot any variable
versus any of the parameters of the carrier-mediated transport model. This
ﬁgure contains a number of panels.

Plot control. The panel in the upper left corner controls plotting in the manner
described below.

Setup. Clicking on Setup results in the display of the CMT Setup steady
state plot ﬁgure (Figure 4.10) which allows selection of one indepen-
dent variable which determines the abscissa of the plot and multiple
dependent variables which determine the ordinates.

Variables. Clicking on an independent variable selects it for the ab-
scissa (X) variable and deselects a previously selected variable.
Clicking on an unselected dependent (Y) variable adds it to the
collection of selected variables. Clicking on a selected dependent
variable deselects it. A maximum of four types of dependent vari-
ables can be selected for plotting. The range over which the in-
dependent variable is swept can be selected in the text edit box.
Values of parameters of the model (those not being changed) can
be selected from a ﬁle or taken from the interactive environment
by clicking on the appropriate button in the upper left panel of
the ﬁgure.
Graph. Clicking on Graph results in a plot of the selected data. The
new plot replaces the old plot.
Overlay. Clicking on Overlay results in the next plot being overlayed
over the current plot.

Open. Clicking this button allows plotting of results stored in a ﬁle.

76

CHAPTER 4. CARRIER-MEDIATED TRANSPORT

Figure 4.9: The CMT Steady state plot ﬁgure showing a plot of carrier densities versus
c i
S on linear ordinate and abscissa scales.

Figure 4.10: CMT Setup steady
state plot ﬁgure showing a plot
of ﬂuxes and carrier densities
versus c i
S on linear ordinate
and abscissa scales.Note that c i
S
(which is highlighted in blue)
was selected as the indepen-
dent variable that deﬁnes the
abscissa (horizontal axis) in the
plot. The variables ni
E , ni
E , no
ES ,
and no
ES were selected as the de-
pendent variables and plotted
as the ordinates (vertical axis).

4.4. USER’S GUIDE

77

Figure 4.11: The Axis scale ﬁgure after the
abscissa was selected in Figure 4.9.

Save. Clicking this button allows the information in the plot to be saved in
a ﬁle. All lines, labels, and annotations are saved.

Print. Clicking on Print prints the ﬁgure.

displays a vertical line, the cross line, in the plot
Cross-line. Clicking on
ﬁeld at the location of the pointer cursor. The line follows the cursor
as it moves across the plot ﬁeld. The values of all plotted variables at
the intersection with the cross line are displayed in the legend. Click-
ing on cross-line button again removes the cross-line values from the
legend and removes the cross line from the plotting ﬁeld.

Annotate. Clicking on A and then on a desired location in the plot area
displays a text edit box at that location. Click in the text edit box, type
the annotation followed by a <RETURN> when the annotation is com-
pleted. Clicking on the annotation and dragging the mouse moves the
annotation to a desired location in the plot ﬁeld. The text string can
be formatted into mathematical notation by using a LATEX like notation,
e.g., to get ni
ES type n_{ES}ˆi.
Zoom. Clicking on + allows the user to magnify a region of the plotting
ﬁeld by clicking on it. Additional magniﬁcation can be achieved by
zooming again.

Unzoom. Clicking on - undoes the eﬀects of all prior zooms.

Axes control. The plot axes can be changed by clicking on any of the axis labels
— either the abscissa or any of the ordinates — which results in the display
of the CMT axis scale ﬁgure (Figure 4.11). The axis scale can be chosen to
be linear, logarithmic, and/or reciprocal. If none of the options is chosen,
the scale is linear. If log scale is chosen, the scale is the logarithm of the
magnitude of the variable.
If invert is chosen then the reciprocal of the
abscissa variable is plotted either on a linear or on a logarithmic scale.
Clicking on Apply results in a change in the axis. The title of the axis label
can also be edited and the plot range can be changed.

Legend. The legend panel records a list of all data plotted. The following are
recorded.

78

CHAPTER 4. CARRIER-MEDIATED TRANSPORT

Figure 4.12: Modify line properties
ﬁgure. The user can select the line
color, style, and the marker.

Line properties. The color, line style, and symbol type are used to encode
a particular variable; this marker is shown in the legend. Clicking on
the marker displays a ﬁgure that allows the user to edit all the line
and marker properties (Figure 4.12).
Variable name. The name of the variable that was plotted is shown. Click-
ing on the variable name alternately displays and hides the curve as-
sociated with this entry. When variables are added or deleted, the axis
is auto-scaled if that option is selected — it is selected by default — in
the axis ﬁgure.
Cross-line If the cross-line is used the cross-line values are displayed.
Data-set. The time when the curves were generated are indicated. Click-
ing on the time stamp alternately displays and hides all the curves
associated with this legend item.

4.4.5 Transient analysis

Transient analysis is available only for the generalized, four-state carrier by
clicking on Transient in the CMT Control ﬁgure. This action displays the CMT
Transient plot ﬁgure (Figure 4.9). The display control features of this ﬁgure are
similar to those of the CMT Graphics Figure described above (Figure 4.9). We
describe the diﬀerences only.

Setup. Clicking on Setup displays the CMT Setup transient plot ﬁgure shown in
Figure 4.14. The ﬁrst column of this ﬁgure shows all the 11 independent
variables for the general, four-state carrier. The initial values are shown in
the second column and the ﬁnal values are shown in the fourth column.
The initial values can be changed individually by typing in the new value
in the appropriate text edit box. The third column gives several options
for changing any particular variable. Several independent variables can be
changed at once. The transient parameters can be saved in a ﬁle and read
from a ﬁle. The bottom of the ﬁgure gives several additional options for
changing variables.

Numerics. Clicking on this item displays the CMT Transients numerics ﬁgure
which gives information to the user and allows for control of the time scale

4.4. USER’S GUIDE

79

Figure 4.13: The CMT Transient plot ﬁgure showing the transient response to the
change in parameters shown in Figure 4.14 and using the numerical data shown in
Figure 4.15.

80

CHAPTER 4. CARRIER-MEDIATED TRANSPORT

Figure 4.14: The CMT Setup transient plot ﬁg-
ure.

of the transient response (Figure 4.15). The CMT Transients numerics ﬁg-
ure displays the eigenvalues (as rate constants or time constants) of the
transient response. These eigenvalues can be computed for the initial or
the ﬁnal values of all parameters by clicking on the appropriate button in
this ﬁgure. The eigenvalues have the dimensions of rate constants (RC).
But the software allows the equivalent time constants (TC = −1/RC) to be
displayed. In addition, the user can choose to show the absolute value of
either the rate constant or the time constant. The ﬁnal value of the time in
the plot is determined by the bottom panel which has several options.

Figure 4.15: The CMT Transients numerics ﬁgure.

4.5. PROBLEMS

81

Absolute scale. Selecting this item displays plots of all carrier densities on the
same absolute scale.

Relative scale. Selecting this item displays plots of all carrier densities on indi-
vidual scales so that all the carrier densities are discernible.

4.5 Problems

Problem 4.1 The purpose of this problem is to explore the steady-state behavior
of the simple, symmetric, four-state carrier model. You will observe the eﬀects of
changes in parameters on both the ﬂux and the carrier densities. Use the simple,
four-state carrier model and start with all the parameters at their default values.

a. What is the relation of φS and φE ? Explain.
S − c o
b. What is the relation of the direction of φS to the sign of c i
S ? Explain.
c. How does the state of the carrier depend on solute concentration?
i. Do changes in c i
ES and ni
S change ni
E ? If so, how? If not, why not?
ii. Do changes in c i
S change no
ES and no
E ? If so, how? If not, why not?
ES and ni
S change ni
iii. Do changes in c o
E ? If so, how? If not, why not?
iv. Do changes in c o
S change no
ES and no
E ? If so, how? If not, why not?

Problem 4.2 The purpose of this problem is to explore the eﬀect of asymmetry of
the parameters of the simple, four-state carrier model on the relation between ﬂux
and concentration diﬀerence across the membrane. Use the simple, four-state
carrier model and start with all the parameters at their default values. Note the
symmetry of the default parameters, i.e., αE = αES , βE = βES , and K i
S = K o
S .
a. Using the default parameters, plot φS versus c i
S .
i. Determine the value of c i
S at which the sign of φS changes. Explain
this sign change.
S − c o
ii. On this plot indicate the region for which c i
S > 0. Is φS > 0 for
this range?
S − c o
iii. On this plot indicate the region for which c i
S < 0. Is φS < 0 for
this range?
iv. What can you conclude from parts i-iii?

b. Use the interactive environment, and change βES from its default value
−1 . At these values what is the relation of the solute
−1 to 60 s
of 20 s
concentration gradient to the ﬂux of solute?

82

CHAPTER 4. CARRIER-MEDIATED TRANSPORT
c. Use the default parameters except that βES = 60 s
−1 . Plot φS versus c i
S .
i. Determine the value of c i
S at which the sign of φS changes. Explain
this sign change.
S − c o
ii. On this plot indicate the region for which c i
S > 0. Is φS > 0 for
this range?
S − c o
iii. On this plot indicate the region for which c i
S < 0. Is φS < 0 for
this range?

iv. What can you conclude from parts i-iii?

d. In part c is the ﬂux always down the chemical potential gradient of the
solute? If not, from where does the energy for transporting the solute
come?

Problem 4.3 The purpose of this problem is to explore the eﬀect of asymmetry
of the parameters of the simple, four-state carrier model on the relation between
unidirectional ﬂux and concentration.

a. Use the simple, four-state carrier model and start with all the parameters
at their default values. Note the symmetry of the default parameters, i.e.,
αE = αES , βE = βES , and K i
S = K o
S .
→
φS versus 1/c i
i. Plot 1/
S . [The unidirectional eﬄux
in the software.]
←
φS versus 1/c o
ii. Plot 1/
S . [The unidirectional inﬂux
in the software.]

→
φS is called eﬄuxS
←
φS is called inﬂuxS

iii. To make direct comparisons between results you may wish to overlay
the plots. What do you conclude from parts i and ii? Explain these
results.

b. Use the simple, four-state carrier model with all the parameters at their
default values except change K i
S from its default value of 2 to 4 µmol/cm3 .
Note that the parameters are no longer symmetric.
→
φS versus 1/c i
i. Plot 1/
S . [The unidirectional eﬄux
in the software.]
←
φS versus 1/c o
ii. Plot 1/
S . [The unidirectional inﬂux
in the software.]

→
φS is called eﬄuxS
←
φS is called inﬂuxS

iii. To make direct comparisons between results you may wish to overlay
the plots. What do you conclude from parts i and ii? Explain these
results.

4.5. PROBLEMS

83

c. Compare the results in part a with those obtained in part b. What can you
conclude from these results?

Problem 4.4 The purpose of this problem is to explore the functional relation
between solute ﬂux and solute concentration when expressed in diﬀerent coordi-
nates. Use the simple, four-state carrier model and start with all the parameters
S = 0. In parts a through c your job is to esti-
at their default values, except set c o
mate the values of (φS )max and K i
S from the graphs speciﬁed, where (φS )max is
S = 0.
the maximum ﬂux of S with c o
a. Obtain a graph of φS versus c i
S in linear coordinates.
b. Obtain a graph of φS versus c i
S in double logarithmic coordinates.
c. Obtain a graph of 1/φS versus 1/c i
S .
d. Determine the values of (φS )max and K i
S from the model parameters.
e. Compare the 4 sets of values you have obtained for (φS )max and K i
S .

Problem 4.5 The purpose of this problem is to explore the eﬀect of solute concen-
tration on carrier state. Use the simple, four-state carrier model and start with
S = 0. Obtain a graph of
all the parameters at their default values, except set c o
all four carrier states as a function of c i
S . Some of the these n’s increase, others
decrease, while others remain constant. Summarize and explain the results you
found.

Problem 4.6 The purpose of this problem is to explore some of the conditions
for which a plot of ﬂux versus concentration in reciprocal coordinates results in
a straight line. Use the simple, four-state carrier model and start with all the
parameters at their default values.
S = 0 and plot 1/φS versus 1/c i
a. Set c o
S .
S = 1 µmol/cm3 , and plot 1/φS versus 1/c i
b. Set c o
S to its default value, c o
S .
c. Compare the results in parts a and b and explain the diﬀerences.
→
S = 1 µmol/cm3 , plot 1/
d. With c o
φS versus 1/c i
S . [The unidirectional eﬄux
→
φS is called eﬄuxS in the software.] Compare the results of parts b and d
and explain the diﬀerence.

Problem 4.7 The purpose of this problem is to explore the process of exchange
diﬀusion. Use the simple, four-state carrier model and start with all the parame-
ters at their default values.

84

CHAPTER 4. CARRIER-MEDIATED TRANSPORT
a. In the interactive environment, set αE = βE = 0. Explain the values of the
variables in the state diagram.
b. In the graphics environment, plot φS versus c i
S . What do you conclude?
←
→
φS versus 1/c i
φS and 1/
S . What do

c. In the graphics environment, plot 1/
you conclude?

d. Reconcile the results of parts b and c.

e. The process deﬁned in this problem has been called exchange diﬀusion.
Critique this choice of name for this process. Why is this name appropri-
ate? Why is this name inappropriate?

Problem 4.8 The purpose of this problem is to compare properties of simple and
general, four-state carriers.

a. Use the simple, four-state carrier model and start with all the parameters
→
S = 1 and c o
S = 10 µmol/cm3 , plot 1/
at their default values. For both c o
φS
→
versus 1/c i
φS is called eﬄuxS in the software.]
S . [The unidirectional eﬄux
You may wish to overlay the plots to compare the results directly.

b. Use the general, four-state carrier model and start with all the parameters
→
S = 1 and c o
S = 10 µmol/cm3 , plot 1/
at their default values. For both c o
φS
→
versus 1/c i
φS is called eﬄuxS in the software.]
S . [The unidirectional eﬄux
You may wish to overlay the plots to compare the results directly.

c. What do you conclude from parts a and b.

Problem 4.9 The purpose of this problem is to explore properties of six-state car-
riers. Use the simple, six-state carrier model and start with all the parameters
at their default values. Set the solute concentrations of S and R to zero on both
sides of the membrane.

a. Explain the initial carrier states and ﬂux values.

b. Increase c i
S and observe both the carrier states and the ﬂux. What is the
relation of the ﬂux of S to c i
S ?
S = 10 µmol/cm3 and increase c i
c. Now set c i
R . How do the ﬂuxes of S and R
depend upon c i
R ?
S = 5 µmol/cm3 . Now increase c i
S = 10 and c o
d. Set c i
R from an initial value of
0. How do the ﬂuxes of S and R depend upon c i
R ? Pay particular attention
to the direction of the ﬂux of S .

4.5. PROBLEMS

85

Problem 4.10 The purpose of this problem is to explore properties of the simple,
six-state carrier model; in particular, the relation between the solute ﬂux and
the parameters of the model. Use the simple, six-state carrier model and start
with all the parameters at their default values. Choose any parameter of the
model (a rate constant or a dissociation constant). Try to think of a change in
that parameter that will lead to an increase in φS . Change the value of this
parameter accordingly and determine if this change results in an increase in φS .
If φS does not change the way you predicted, ﬁnd out why.
If it does change
as you predicted, then try another parameter and repeat the process. Do this
for at least 5 parameters to make sure that you have developed some intuition.
Describe what you did and the outcome.

Problem 4.11 The purpose of this problem is to explore elementary properties of
the transient response of the general, four-state carrier. Use the general, four-
state carrier model and start with all the parameters at their default values.

a. In the interactive environment, record the values of all states of the carrier
— ni
E , ni
ES , no
E , and no
ES . Now change c i
S from its default value of 2 to 20
µmol/cm3 and record the values of all the states of the carrier.

b. Switch to the transient environment and compute the transient response
as c i
S is stepped from its default value of 2 to 20 µmol/cm3 .

i. Determine the initial and ﬁnal values of the transient response and
compare these results with the results obtained in part a.
ii. From plots of the transient response, estimate the time it takes the
response to go from its initial value to 0.63 of its ﬁnal value.

c. Examine the CMT Transients numerics ﬁgure.

i. Explain why there are multiple time constants listed?
ii. Do the time constants listed in this ﬁgure explain the transient re-
sponse seen in part b? Explain.

Problem 4.12 The purpose of this problem is to explore eigenvalues of the gen-
eral, four-state carrier model. Use the general, four-state carrier model and start
with all the parameters at their default values. Switch to the transient response
and click on Setup in the CMT Transient plot ﬁgure. This displays the CMT
Setup transient plot ﬁgure. Select Numerics in the latter plot to display the CMT
Transient numerics ﬁgure. Make sure that the eigenvalues are calculated from
the ﬁnal parameter values and that rate constants are displayed instead of time
constants.
In this problem, you will change the ﬁnal values and calculate the
eigenvalues expressed as rate constants.

a. Record the eigenvalues (as rate constants) for the default settings.

86

CHAPTER 4. CARRIER-MEDIATED TRANSPORT

b. Change the value of c i
S from its default value of 2 to 20 µmol/cm3 . Record
S = 20 µmol/cm3 .
the eigenvalues (as rate constants) corresponding to c i
S = 2 to that for c i
S = 20
c. Compare the eigenvalues (as rate constants) for c i
µmol/cm3 .

d. Explain why the eigenvalues (as rate constants) depend upon the concen-
tration.

e. Suppose you regard the general, four-state carrier as a system that relates
the solute concentrations (as inputs) to the ﬂuxes (as outputs).
Is that
system linear?

Problem 4.13 The purpose of this problem is to explore the eigenvalues of the
general, four-state carrier model. Use the general, four-state carrier model and
start with all the parameters at their default values. Switch to the transient
response and click on Setup in the CMT Transient plot ﬁgure. This displays the
CMT Setup transient plot ﬁgure. Select Numerics in the latter plot to display the
CMT Transient numerics ﬁgure. Make sure that the eigenvalues are calculated
from the ﬁnal parameter values and are expressed as time constants.
In this
problem, you will change the ﬁnal values and calculate the eigenvalues (as time
constants).

a. Record the eigenvalues (as time constants) for the default settings.

b. For each of the values given below, plot the transient response and record
the eigenvalues (as time constants).

i. Change the binding/unbinding rate constants gi , go , hi , ho to 0.1 of
their default values.
ii. Change the binding/unbinding rate constants gi , go , hi , ho to 0.01 of
their default values.
iii. Change the binding/unbinding rate constants gi , go , hi , ho to 0.001 of
their default values.
iv. Change the binding/unbinding rate constants gi , go , hi , ho to 0.0001
of their default values.

c. Plot the locations of the eigenvalues (as time constants) versus the factor
by which the binding/unbinding rate constants were multiplied in double
logarithmic coordinates.

d. Examine the transient responses and the results of part c. Discuss the
implication of these results.

Chapter 5

HODGKIN-HUXLEY MODEL — SPACE
CLAMPED

87

88

CHAPTER 5. HODGKIN-HUXLEY MODEL

5.1 Introduction

5.1.1 Background

Electrically excitable cells produce action potentials which are important for
transmission of information in neurons, for contraction of muscle cells, and for
secretion of chemical substances by neurosecretory cells (Aidley, 1989; Hodgkin,
1964; Katz, 1966; Kandel et al., 1991; Keynes and Aidley, 1991; Nicholls et al.,
1992; Weiss, 1996b). The macroscopic mechanisms of production of action po-
tentials can be understood in terms of the nonlinear electrical characteristics of
cellular membranes ﬁrst described by Hodgkin and Huxley for the membrane
of the giant axon of the squid (Hodgkin and Huxley, 1952). Since the nonlin-
ear properties of the membranes of electrically excitable cells are controlled by
the membrane potential, it is relatively simple to understand these mechanisms
when the membrane potential is constant, but vastly more diﬃcult when the
membrane potential is not constant such as occurs during an action potential.
Of course, it is the properties of electrically-excitable cells under the latter con-
ditions that are the most important for the function of these cells.

5.1.2 Overview of the software

The purpose of this software package is to allow users to enhance their com-
prehension of the Hodgkin-Huxley model by providing a complete simulation of
the model under space clamped conditions. Thus, this software package allows
users to explore the dependence on time of the space-independent Hodgkin-
Huxley model. This software package is complementary to the the software
package described in Chapter 6 which examines the dependence of the Hodgkin-
Huxley model on space and on time.
In the software described in the current
chapter, the user can specify the mode of stimulation (either voltage or current
clamp), model parameters (such as the membrane capacitance, the maximum
membrane conductances for membrane ionic channels, kinetic parameters for
each of these membrane conductances, the concentrations of all relevant ions,
the temperature, etc.), run the simulation, and display the results (such as the
membrane potential, membrane-current components, membrane-conductance
components, and channel activation and inactivation variables). The results
can be saved in ﬁles, and the contents of multiple ﬁles can be plotted on the
same axes. Hence, any of the parameters of the Hodgkin-Huxley model can be
changed by the user and simulation experiments can be done to examine the
consequences of the parameter changes. Extensive graphics utilities allow the
user to plot any variable versus any other variable in the model, to zoom on any
part of the plot, to annotate the plot, and to determine the coordinates of any
point on a plot using a mouse-driven cursor.

5.2. DESCRIPTION OF THE MODEL

89

Jm (t)

+
−
Vm (t)

JC

JK

JN a

GK (Vm , t) GN a (Vm , t)

Cm

+−

VK

+−

VN a

JL

GL

+−

VL

Jm (t)

+
−
Vm (t)

Figure 5.1: Schematic di-
agram and circuit model
of a space-clamped axon
in the voltage-clamp con-
ﬁguration.

5.2 Description Of The Model

Descriptions of the Hodgkin-Huxley model are available elsewhere (Aidley, 1989;
Hodgkin, 1964; Katz, 1966; Plonsey and Barr, 1988; Johnston and Wu, 1995;
Weiss, 1996b). A summary of this model is given in this section. The model that
is the basis of this software is a one-compartment model that represents a space-
clamped axon stimulated by means of two electrodes so that the membrane
current density and membrane potential are uniform along the length of the
axon.

5.2.1 Voltage-clamp and current-clamp conﬁgurations

Two simple and mutually exclusive stimulus conﬁgurations can be used to in-
vestigate the model: the voltage-clamp and current-clamp conﬁgurations. In the
voltage-clamp conﬁguration (Figure 5.1), the simulated space-clamped axon is
driven by a voltage source and the membrane current density is computed. In
the current-clamp conﬁguration, the simulated space-clamped axon is driven by
a current source and the membrane potential is computed.

5.2.2 The membrane current density components
The total membrane current density, Jm , is the sum of the capacitance current
density plus the ionic current density
Jm = JC + Jion ,
where the capacitance current density is
JC = Cm
dVm (t )
dt

(5.2)

(5.1)

,

90

CHAPTER 5. HODGKIN-HUXLEY MODEL

JC

JK

JN a

GK (Vm , t) GN a (Vm , t)

Cm

+−

VK

+−

VN a

+
Vm (t)
−

JL

GL

+−

VL

Jm (t)

+

Vm (t)

Jm (t)

−

Figure 5.2: Schematic di-
agram and circuit model
of a space-clamped axon
in the current-clamp con-
ﬁguration.

where Cm is the capacitance of a unit area of membrane and Vm is the membrane
potential. The ionic current density can be expressed in terms of its components
Jion = JN a + JK + JL ,
where the ionic current densities due to sodium, potassium and leakage are
JN a = GN a(Vm , t )(Vm (t ) − VN a),
JK = GK (Vm , t )(Vm (t ) − VK ),
JL = GL(Vm (t ) − VL),
(cid:19)
(cid:20)
and where the Nernst equilibrium potential for the nth ion is deﬁned in terms of
the concentrations as follows

(5.4)
(5.5)
(5.6)

(5.3)

Vn = RT
c o
n
znF ln
c i
n
where R is the molar gas constant, T is absolute temperature, F is Faraday’s
constant, and zn , c o
n and c i
n are the valence, outside, and inside concentrations
(cid:20)
(cid:19)
of ion n, respectively. For a univalent ion, the Nernst equilibrium potential is
expressed as

(5.7)

,

Vn = 0.08616 (Tc + 273.16) ln
where Tc is the temperature in Centigrade.

c o
n
c i
n

(mV),

(5.8)

5.2.3 The membrane conductances

The sodium and potassium conductances are deﬁned as
GN a(Vm , t ) = GN am3(Vm , t )h(Vm , t ),
GK (Vm , t ) = GK n4(Vm , t ).

(5.9)
(5.10)

5.2. DESCRIPTION OF THE MODEL

91

5.2.4 The activation and inactivation factors

The ﬁrst-order kinetic equations for the activation and inactivation factors are
written in terms of the rate constants as follows:
= αm − m(αm + βm ),
= αh − h(αh + βh),
= αn − n(αn + βn),

(5.11)

(5.12)

(5.13)

dm
dt
dh
dt
dn
dt

where the α’s and β’s depend upon Vm .

5.2.5 The rate constants

(5.14)

(5.15)
(5.16)

The dependence of the rate constants on membrane potential has been gener-
alized from the original Hodgkin-Huxley model to allow control of the potential
dependence of individual rate constants and to represent approximately the ef-
fects of changes in calcium concentration and temperature.
αm = −0.1(35 + Vm + ∆VC a + Vαm )
The rate constants are
e−0.1(35+Vm+∆VC a+Vαm ) − 1
KT Km ,
βm = 4e−(Vm+∆VC a+Vβm+60)/18 KT Km ,
αh = 0.07e−0.05(Vm+∆VC a+Vαh+60) KT Kh ,
1 + e−0.1(Vm+∆VC a+Vβh+30) KT Kh ,
βh =
1
αn = −0.01(Vm + ∆VC a + Vαn + 50)
e−0.1(Vm+∆VC a+Vαn+50) − 1
KT Kn ,
βn = 0.125e−0.0125(Vm+∆VC a+Vβn+60) KT Kn ,
where KT is a temperature factor, that is deﬁned as
KT = 3(T c −6.3)/10 .
KT multiplies all the rate constants; this eﬀect approximates the eﬀect of tem-
perature on the electrical properties of the membrane of the squid giant axon
(Huxley, 1959). The factors Km , Kh and Kn have been added to the original
stants of m, h, and n. The factor ∆VC a is used to approximate the dependence
Hodgkin-Huxley model to allow changes to be made in the individual rate con-
(cid:20)
(cid:20)
(cid:19)
(cid:19)
of rate constants on calcium concentration and is
∆VC a = 0.03335 (Tc + 273.16)
− 12.995

(mV).

(5.17)

(5.21)

(5.18)

(5.19)

(5.20)

ln

c o
C a
c i
C a

CHAPTER 5. HODGKIN-HUXLEY MODEL
92
At the normal calcium concentration, the potential ∆VC a has the value 0. For cal-
cium concentration ratios that diﬀer from the normal value, ∆VC a diﬀers from 0
and the dependence of the rate constants on the membrane potential is shifted
by a term that is proportional to the calcium equilibrium potential. This approxi-
mates the eﬀect of a change in calcium concentration on the parameters of squid
giant axon membrane (Frankenhaeuser and Hodgkin, 1957). The potentials Vαm ,
Vβm , Vαh , Vβh , Vαn , and Vβn have the value 0 in the original Hodgkin-Huxley
model. These potentials can be used to shift the dependence of individual rate
constants on membrane potential.

5.2.6 Time constants and equilibrium values of activation and
inactivation factors

Equations 5.11-5.13 are expressed in terms of rate factors, but it is also useful
to express these equations in terms of time constants and equilibrium values, as
follows
= m∞ − m
τm
= h∞ − h
τh
= n∞ − n
τn

dm
dt
dh
dt
dn
dt

(5.22)

,

,

.

The time constants and equilibrium values can be deﬁned in terms of the rate
constants by comparing Equations 5.11-5.13 to Equation 5.22.

τm =
τh =
τn =

1
αm + βm
1
αh + βh
1
αn + βn

and m∞ =
h∞ =
and
and n∞ =

,

αm
αm + βm
αh
αh + βh
,
αn
αn + βn

.

(5.23)

5.2.7 Default values of parameters
The default numerical values for the Hodgkin-Huxley model are: GN a = 120,
GK = 36, and GL = 0.3 mS/cm2 ; Cm = 1 µF/cm2 ; c o
N a = 491, c i
N a = 50, c o
K =
C a = 44, c i
K = 400, c o
C a = 0.00011 mmol/L; VL = −49 mV; temperature is
20.11, c i
◦
6.3
C.

5.3. NUMERICAL METHODS

5.3 Numerical Methods

5.3.1 Background

93

In order to compute the membrane potential for a given set of parameters, the
equations describing the Hodgkin-Huxley model (listed in Section 5.2) must be
approximated in a form that is appropriate for numerical solution on a digital
computer. A variety of methods exist for the numerical integration of a set of
coupled diﬀerential equations (Press et al., 1986). The simplest methods, called
the forward and backward Euler methods,
is to approximate all derivatives by
a series of discrete times separated by a time increment ∆t . Although simple
ﬁrst diﬀerences, and to solve the resulting collection of algebraic equations at
in concept, the Euler methods are not particularly accurate or eﬃcient. Because
the Hodgkin-Huxley software is built on MATLAB which includes a variety of
methods of numerical integration, the user can choose the method of integration
from a number of choices.
5.3.2 Choice of integration step ∆t
tion step ∆t . Simulation users will need to concern themselves with the choice
The accuracy of all numerical methods is dependent on the choice of the integra-
of ∆t . If ∆t is decreased, the accuracy of a single step increases but the time it
takes to compute the solution increases. Furthermore, if computations are con-
tinued for a large number of steps, the accumulation of round-oﬀ errors, due
appreciable. Conversely, if ∆t is increased, the accuracy of the computation
to the limited precision for representing numbers in a computer, can become
decreases and the solution may even diverge. This divergence can lead to spuri-
ous phenomena that may mistakenly be attributed to the Hodgkin-Huxley model
when they are really artifacts of the numerical methods. A plausible empirical
of the solution to changes in ∆t . If increasing the value of ∆t does not appre-
test of whether or not a solution is suﬃciently accurate is to test the sensitivity
ciably change the solution, then the value of ∆t used initially is too small and
time was wasted in performing the computation. If decreasing the value of ∆t
does not appreciably change the computational result, then the larger value is
preferable. The simulation of the Hodgkin-Huxley model is set initially with de-
fault numerical parameters. For changes in parameters of the model that do not
appreciably change the various time constants of the model, the default numer-
ical parameters are adequate. However, if changing a model parameter (such as
constant of the system, then a smaller value of ∆t should be used. Therefore, it
the temperature, membrane capacitance, etc.) appreciably decreases some time
is advisable to explore brieﬂy the eﬀects of varying ∆t on simulation results.

94

CHAPTER 5. HODGKIN-HUXLEY MODEL

Figure 5.3: The HH Control ﬁgure
after the software is initiated.

5.3.3 Method for computing solutions
solution is known at time tp −∆t and the solution at time tp is desired. The value
In the voltage clamp simulation, the solution is obtained as follows: Suppose the
of the membrane potential Vm (tp ) at tp is determined from speciﬁcation of the
stimulus (see Equations 6.23 and 6.24 on Page 149). This value is substituted
rate constants, and given the values of m, h, and n at time tp − ∆t , the values of
into Equations 5.14 and 5.19 to determine the rate constants at tp . Using these
m, h, and n are determined at tp by solving Equations 5.11-5.13 numerically by
an integration method that can be chosen by the user. The values of these factors
are used to compute the values of the conductances and current densities from
Equations 5.1-5.6. The computation is begun with initial values of m, h, and n
that are determined from Equation 5.23 for a membrane potential equal to the
source voltage for t < 0.
In the current clamp simulation, the initial values of m, h, n, and Vm are com-
puted ﬁrst. This is done by using MATLAB’s fzero function to solve the set of
Equations 5.1, 5.3-5.21 and a speciﬁcation of the source current (Equation 6.23
on Page 149) with the derivatives of all the variables set to zero. Starting with
these initial values, the time-varying equations are solved numerically by an in-
tegration method that can be chosen by the user.

5.4 User’s Guide To The Software

When this software is selected, 3 ﬁgures are displayed (in addition to MATLAB’s
command window): HH Control, HH Parameters, HH Stimulus. The HH Control
ﬁgure controls the software (Figure 5.3). The HH Parameters ﬁgure allows the
user to change any of the parameters of the model. The HH Stimulus ﬁgure
allows the user to specify the stimulus. Once the parameters and the stimulus
are speciﬁed, clicking the Start pushbutton results in the computation of the
response as a function of time. A variable is plotted as a function of time during
the computation. Upon completion of the computation, the user can examine
the results graphically and numerically.

5.4. USER’S GUIDE TO THE SOFTWARE

95

5.4.1 HH Control

The part of the HH Control ﬁgure (Figure 5.3) immediately below the menubar
allows the user to choose between voltage-clamp and current-clamp conﬁgura-
tions. Below this choice of conﬁguration, there are three panels. In the left panel,
the user can choose to view the HH Parameters ﬁgure (which is used to specify
the parameters), the HH Stimulus ﬁgure (which is used to specify the stimulus as
a function of time), and/or the HH Numerics ﬁgure (which control the numerical
methods and numerical parameters). In the center panel, the user can start the
simulation by clicking on the Start button. The user can also save the simula-
tion (including a speciﬁcation of all the model and numerical parameters, the
stimulus, and simulation results) in a ﬁle and open a previously stored ﬁle (that
includes a speciﬁcation of all the model and numerical parameters, the stimu-
lus, and simulation results). The right (analysis) panel becomes active after the
simulation is completed and allows the user to select three options for analysis
of the results. The ﬁrst option allows the user to plot any model variable as a
function of time. This ﬁgure is displayed automatically as the computation pro-
ceeds. The second option displays a numerical summary of simulation variables.
The third option allows the user to access a quite general plotting facility that
not only plots any of the model variables versus any other model variable, but
allows plotting results stored in ﬁles.

5.4.2 HH Parameters

Changing parameter values

The HH Parameters ﬁgure contains three columns for each parameter: the ﬁrst
column identiﬁes the parameter, the second gives its default value, and the third
column shows the value of the parameter if it is modiﬁed from its default value.
Parameters are selected for modiﬁcation by clicking on the entry in the third
column of the parameter ﬁeld. When a parameter is selected, its third column
entry is replaced by an edit box. Clicking any mouse button inside the edit box
allows the parameter to be changed. The new value of the parameter is entered
from the keyboard; < RETURN > terminates the parameter entry.
If the new
value diﬀers from the default value, then the new value will appear in the third
column. With this method of display, the parameter list can be scanned quickly
to indicate which parameters diﬀer from their default values.
There are some restrictions on the numerical values of parameters; G’s ≥ 0,
Cm ≥ 0, c ’s > 0, K ’s > 0, and the temperature must be above absolute zero. The
derived parameters cannot be changed but are derived from the other parame-
ters and are displayed for the convenience of the user. For example, the sodium
equilibrium potential VN a cannot be changed directly by the user, but changes
automatically when the sodium concentrations or temperature are changed.

96

CHAPTER 5. HODGKIN-HUXLEY MODEL

Figure 5.4: The HH Parameters ﬁgure after
the software is initiated.

5.4. USER’S GUIDE TO THE SOFTWARE

97

Reading, saving, printing, reseting the parameters

Parameters (only) can be read from a ﬁle by clicking on Open and can be saved
by clicking on Save. Saving and reading in the HH Parameters ﬁgure deals only
with the model parameters; e.g., simulation results are not read or saved. The HH
Parameters ﬁgure can be printed by clicking the Print button. The parameters
can be reset to default values by clicking on Reset.

Viewing the voltage dependent parameters

The Hodgkin-Huxley model contains several parameters that are instantaneous
functions of the membrane potential. Plots of these parameters are available
as a function of Vm for the following: αm (Vm ), βm (Vm ), m∞(Vm ), τm (Vm ),
αh(Vm ), βh(Vm ), h∞(Vm ), τh(Vm ), αn(Vm ), βn(Vm ), n∞(Vm ), τn(Vm ) (see Sec-
tions 5.2.5 and 5.2.6). These can be accessed by clicking on the button marked
α, β, τ , h, m, n which results in the display of the HH parameters vs. poten-
tialﬁgure (Figure 5.5). This ﬁgure contains a number of panels.

Plot control. The panel in the upper left corner controls plotting in the manner
described below.

Setup. Clicking on Setup results in the display of the HH Setup parame-
ters vs. potential plot ﬁgure (Figure 5.6) which allows selection of the
voltage-dependent parameters as a function of the membrane poten-
tial.
Variables. The abscissa is the membrane potential. Clicking on any
variable adds it to the collection of selected ordinate variables.
Clicking on it again deselects it. Values of parameters of the
model can be selected from a ﬁle or taken from the parameters
by clicking on the appropriate button in the upper right panel of
the ﬁgure.
Graph. Clicking on Graph results in a plot of the selected data. The
new plot replaces the old plot.
Overlay. Clicking on Overlay results in the next plot being overlayed
over the current plot. Since the voltage-dependent parameters
depend upon additional parameters and variables, overlaying the
plots allows a display of the eﬀect of these additional parameters
and variables on the voltage dependence parameters. For exam-
ple, a plot of m∞ versus Vm for diﬀerent calcium concentrations
reveals the eﬀects of calcium concentration on the voltage depen-
dence of sodium activation (Figure 5.7).
Open. Clicking this button allows plotting of results stored in a ﬁle.
Save. Clicking this button allows the information in the plot to be saved in
a ﬁle. All lines, labels, and annotations are saved.

98

CHAPTER 5. HODGKIN-HUXLEY MODEL

Figure 5.5: The HH parameters vs. potential ﬁgure after selection of parameters as in
Figure 5.6.

Figure 5.6: The HH Setup pa-
rameters vs. potential plot
ﬁgure that was used to pro-
duce the plot shown in Fig-
ure 5.5.

5.4. USER’S GUIDE TO THE SOFTWARE

99

Figure 5.7: The HH parameters vs. potential ﬁgure showing the eﬀect of calcium con-
centration on the voltage dependence of the sodium activation parameter m∞ . The
calcium concentration was varied from 0.000011 to 0.11 mmol/L by factors of 10.

100

CHAPTER 5. HODGKIN-HUXLEY MODEL

Figure 5.8: The Axis scale ﬁgure.

Print. Clicking on Print prints the ﬁgure.

Cross-line. Clicking on
displays a vertical line, the cross line, in the plot
ﬁeld at the location of the pointer cursor. The line follows the cursor
as it moves across the plot ﬁeld. The values of all plotted variables at
the intersection with the cross line are displayed in the legend. Click-
ing on cross-line button again removes the cross-line values from the
legend and removes the cross line from the plotting ﬁeld.

Annotate. Clicking on A and then on a desired location in the plot area
displays a text edit box at that location. Click in the text edit box, type
the annotation followed by a <RETURN> when the annotation is com-
pleted. Clicking on the annotation and dragging the mouse moves the
annotation to a desired location in the plot ﬁeld. The text string can
be formatted into mathematical notation by using a LATEX like notation,
e.g., to get m∞ type m_{\infty}.
Zoom. Clicking on + allows the user to magnify a region of the plotting
ﬁeld by clicking on it. Additional magniﬁcation can be achieved by
zooming again.

Unzoom. Clicking on - undoes the eﬀects of all prior zooms.

Axes control. The plot axes can be changed by clicking on any of the axis labels
— either the abscissa or any of the ordinates — which results in the display
of a ﬁgure that allows changing the axis (Figure 5.8). The axis scale can be
chosen to be linear, logarithmic, and/or reciprocal. If neither the Log nor
the Inverse (1/) options is chosen, the scale is linear. If Log is chosen, the
scale is the logarithm of the magnitude of the variable.
If Inverse (1/) is
chosen then the reciprocal of the variable is plotted either on a linear or on
a logarithmic scale. Clicking on Apply results in a change in the axis. The
plot range can be changed, but the axis labels cannot be edited.

Legend. The legend panel records a list of all data plotted. The following are
recorded.

Line properties. The color, line style, and symbol type are used to encode a
particular variable; this marker is shown in the legend. Clicking on the

5.4. USER’S GUIDE TO THE SOFTWARE

101

Figure 5.9: The Modify line proper-
ties ﬁgure.

Figure 5.10: HH Stimu-
lus ﬁgure with the de-
fault stimulus waveform
for a current-clamp conﬁg-
uration.

marker allows the user to edit the attributes of the plot line/symbol
(Figure 5.9).

Variable name. The name of the variable that was plotted is shown. Click-
ing on the variable name alternately displays and hides the curve as-
sociated with this entry. When variables are added or deleted, the axis
is auto-scaled if that option is selected — it is selected by default — in
the axis ﬁgure.

Cross-line If the cross-line is used the cross-line values are displayed.

Data-set. The time when the curves were generated are indicated. Click-
ing on the time stamp alternately displays and hides all the curves
associated with this legend item.

5.4.3 HH Stimulus

Selecting Stimulus in the controls ﬁgure displays the HH Stimulus ﬁgure as shown
in Figure 5.10. The stimulus is the membrane potential in the voltage-clamp con-

102

CHAPTER 5. HODGKIN-HUXLEY MODEL

ﬁguration and the membrane current density in the current-clamp conﬁguration.
The duration of the stimulus can be set and, as described below, the user can
also select a ﬁle that will deﬁne the stimulus arbitrarily.

Use of the m-ﬁle hhpulse.m

By default, the stimulus is generated by the MATLAB m-ﬁle hhpulse.m which
uses the parameters listed in the lower part of the stimulus ﬁgure. The stim-
ulus is the sum of a constant plus two independently speciﬁable pulses. Each
pulse can be a rectangular pulse, a ramp pulse or an exponential pulse or a com-
bination of these.
If the slope and the time constant are set to zero, then the
remaining parameters specify the amplitude, duration and onset time of a rect-
angular pulse. If the slope has a non-zero value, a ramp of that slope is added to
the rectangular pulse for the duration of the pulse. Similarly, if the time constant
has a non-zero value, then an exponential pulse with the selected time constant
is added to the waveform. The time constant can be positive or negative.
The stimulus, s (t ), is deﬁned as follows
s (t ) = s o + s 1(t ) + s 2(t ),
where s o is a constant and s 1(t ) and s 2(t ) are independently speciﬁable pulses.
 mi(t − t i
Each pulse has the form
if to ≤ t ≤ to + tdur ,
o ) + Aie−(t−t i
o )/τ i
otherwise,
0
where pulse i (i = 1 or 2) starts at to and has a duration tdur . The amplitude
of the pulse is Ai , the slope is mi , and the time constant is τ i . With this spec-
iﬁcation, a rich variety of stimuli can be produced; an example is shown in Fig-
ure 5.11.
The stimulus parameters alone can be read from or saved to a ﬁle by selecting
either Open or Save in the HH Stimulus ﬁgure.

s i(t ) =

(5.24)

(5.25)

Use of stimulus m-ﬁles

This speciﬁcation of the stimulus by hhpulse.m is quite rich. However, a user
who wishes to deﬁne a stimulus that diﬀers from the one provided can write a
MATLAB m-ﬁle to generate that stimulus. That ﬁle can then be selected in the
HH Stimulus ﬁgure, and the stimulus it generates will be displayed in the ﬁgure.
However, the parameters will have to be set by the user in the m-ﬁle. The script
for the available m-ﬁles can be used as templates to deﬁne new user-speciﬁed m-
ﬁles. For example, the simple m-ﬁle shown in Figure 5.12 generates a sinusoidal
stimulus.

5.4. USER’S GUIDE TO THE SOFTWARE

103

Figure 5.11: HH Stimulus
ﬁgure showing an exam-
ple of a stimulus current
waveform consisting of a
constant plus two pulses:
the ﬁrst pulse is a ramp
plus rectangular pulse; the
second is an exponential
pulse.

Figure 5.12: HH Stimulus
ﬁgure showing an example
of the use of an m-ﬁle to
generate a sinusoidal stim-
ulus.

104

CHAPTER 5. HODGKIN-HUXLEY MODEL

Figure 5.13: HH Numerics ﬁgure.

5.4.4 Numerics

Selecting Numerics in the controls ﬁgure displays the HH Numerics ﬁgure (Fig-
ure 5.13). This ﬁgure allows selection of the numerical method used to solve
the ordinary diﬀerential equations (or ode solver) as well as the numerical pa-
rameters of the simulation. The dialog-box that appears at the top allows direct
selection of one of seven ode solvers called: ode45, ode23, ode113, ode23t,
ode15s, ode23s, and ode23tb. The MATLAB manuals or MATLAB’s help facility
should be consulted for further information about these methods. For exam-
ple, to learn about ode15s type Help ode15s at MATLAB’s command line in
the MATLAB Command Window. More detailed descriptions are available else-
where (Shampine and Reichelt, 1997). By default, the software uses the ode15s
ode solver. The integration methods require that the following parameters be
deﬁned: Initial step-size, Maximum step-size, Relative Tolerance.
The relative tolerance is an estimate of the accuracy of the solution, i.e., a tol-
erance of 0.001 implies that the error in the solution is less than 0.1% of the
correct value. Decreasing the tolerance will increase the accuracy of the solu-
tion, but will increase the computation time.
The numerical parameters alone can be saved in a ﬁle or read from a ﬁle by
clicking on Save or Open, respectively, in the HH Numerics ﬁgure.

5.4.5 Analysis

The software provides one numeric and two graphic displays of simulation re-
sults. These three displays are selected and deselected in the controls ﬁgure.
Analysis is available after a simulation has been run if the parameters have not
been changed after the simulation was run.

Plots versus time

Selecting Plots vs. time in the Analysis panel of the HH Control ﬁgure displays
the HH Plots vs. time ﬁgure as shown in Figure 5.14. During a computation, this
ﬁgure displays the following variables: Vm in current clamp conﬁguration and
m in voltage-clamp conﬁguration. When the computation is completed, any vari-

5.4. USER’S GUIDE TO THE SOFTWARE

105

Figure 5.14: The
HH
Plots
vs.
time ﬁgure with
Vm chosen
for
plotting.

Figure 5.15: The HH Variable
summary ﬁgure after the sim-
ulation has been completed
using the default parameters
for a current-clamp conﬁgu-
ration.

able can be selected by clicking on the dropdown menu at the top of the ﬁgure
and then dragging the mouse to the variable of interest. This ﬁgure provides a
simple and rapid means of plotting any of the simulation variables versus time.
Clicking on an axis label displays the Axis scale ﬁgure (see Figure 5.8) which
allows the axis to be changed.

Variable summary

Selecting Variable summary in the HH Control ﬁgure displays the HH Variable
summary ﬁgure as shown in Figure 5.15. This ﬁgure contains ﬁve columns of
text. The ﬁrst column identiﬁes the simulation variable. The second shows
the units for the variable. The third contains the initial value of the variable.
The fourth and ﬁfth columns contain the minimum and maximum values of the

106

CHAPTER 5. HODGKIN-HUXLEY MODEL

Figure 5.16: HH Graphics ﬁgure showing the membrane potential and ionic conduc-
tance obtained from a simulation with model parameters and the stimulus deﬁned in
Figures 5.4 and 5.10.

variables during the course of the simulation. The dropdown menus located
below the menubar allow the user to control the precision and formatting of the
numerical values.

Graphics

Selecting Graphics in the HH Control ﬁgure displays the HH Graphics ﬁgure as
shown in Figure 5.16. This ﬁgure allows plotting any result of the simulation
against any other in coordinates chosen by the user. The control of this ﬁgure is
virtually identical to that for the HH Parameters vs. potential ﬁgure (Figure 5.5).
Hence, we describe only the diﬀerences. The main diﬀerence occurs if Setup is
selected in the HH Graphics ﬁgure which results in display of the HH Setup plot
ﬁgure (Figure 5.17). Several dependent variables can be plotted simultaneously.

5.4. USER’S GUIDE TO THE SOFTWARE

107

Figure 5.17: HH Setup plot ﬁg-
ure showing the variables used
to setup Figure 5.16.

In addition, results saved in ﬁles can be plotted so that results for diﬀerent
parameters can be compared.
In addition, results of consecutive simulations
can be overlayed. We give a few examples of the types of graphics that are
readily available with the HH Graphics ﬁgure.
As shown in Figure 5.18, parametric plots of one variable versus another
with time as the parameter are easily obtained. Figure 5.19 shows the membrane
potential obtained at several diﬀerent temperatures. This ﬁgure was obtained by
overlaying successive computations. It could also have been created by saving
the results of simulations performed for diﬀerent temperatures in ﬁles and then
plotting the results from these ﬁles.

5.4.6 Scripts

Scripting commands alleviate the burden of being present while repetitive, time
consuming simulations are computed. The set of commands available to the
software user can be found by issuing the command help hhscr.
Although the set of scripting commands is not exhaustive enough to allow
operating all aspects of the software from the command-line, it is suﬃcient to
carry out some of the time-consuming elements of the simulation.
The following is an example of a script used to perform current clamp simu-
lations at diﬀerent temperatures.

%A Hodgkin-Huxley script demonstration
%(contents are in HHDEMO1.M)

%This script can be used to generate simulation data using the
%current-clamped configuration.
The temperature is varied while
%all other parameters remain unchanged.

%For each value of the temperature, the simulation is run
%and the resulting data are saved to data files which can then

108

CHAPTER 5. HODGKIN-HUXLEY MODEL

Figure 5.18: HH Graphics ﬁgure showing a parametric plot of membrane conductances
versus membrane potential during an action potential. All the parameters were the
default parameters shown in Figure 5.4 and the stimulus was the same as shown in
Figure 5.10 except that the duration was increased to 20 ms.

5.4. USER’S GUIDE TO THE SOFTWARE

109

Figure 5.19: HH Graphics ﬁgure showing the membrane potential obtained at diﬀerent
temperatures. All the parameters were the default parameters shown in Figure 5.4
except for the temperature and the stimulus was the same as shown in Figure 5.10.

110

CHAPTER 5. HODGKIN-HUXLEY MODEL

%be used to display the results in the Graphics figure.

%Before using the script, make sure that the Hodgkin-Huxley
%software has been started.
%If it hasn’t been started, start the software using SOFTCELL.M
%as follows softcell(’hh’);

%hhscr(’set’) will list the parameters that can be changed
%The parameter names are case-sensitive, so make sure that
%you type them exactly as shown.

%Insure that the current clamped configuration is being used.
hhscr(’set’,’Configuration’,’Current clamped’);

%Since a lot of files will be created, it is best to store them
%in a separate folder. Examples of foldername are
%foldername = ’C:\data\temp’; %Windows
%foldername = ’/user/tsb/data/temp’; %UNIX
foldername = pwd;

%Set up a loop that increments through a temperature range.
%In this case, we use the range T = [0 10 20 30] Celsius
for temp = 0:10:30

%set the model’s temperature parameter
newtemp = hhscr(’set’,’T_C’,temp);

%perform simulation
hhscr(’start’);

%For feedback, display the temperature in the console
disp([’Temperature is set to ’ num2str(newtemp)]);

%create a unique filename that contains the simulation data
filename = [’temp’ num2str(temp) ’.mat’];

%save the simulation data to the file
hhscr(’save’,’simulation’,foldername,filename);
end

%That’s it -- all the data have been saved.

%Now, display the data simultaneously by following these steps:

5.5. PROBLEMS

111

%1. call up the "Graphics" figure,
%2. using "Setup", select which variable(s) to plot,
%3. still inside "HH Setup plot" figure, select the source of "Get
%
values from" to be the "Files with parameters".
% 3a. using "Select files", add the files to the list "Use these
%
files".
% 3b. select "Overlay" to view the selected variable(s) in all
the datafiles.
%

Scripting can also be used to create customized plots of variables. For exam-
ple, after running a simulation, the time dependance of the sodium conductance
can be plotted on a separate ﬁgure using the following commands:

u_gna = hhscr(’get’,’G\{ Na\}’); %get the sodium conductance vector
u_time = hhscr(’get’,’t’); %get the vector of sampled time values
figure; %create a new figure
plot(u_time,u_gna); %plot sodium conductance vs. time

Once the values of these variables are so obtained, they can be manipulated,
modiﬁed, and saved to ﬁles.

5.5 Problems

Problem 5.1 The purpose of this problem is to explore the Hodgkin-Huxley model
in the voltage-clamp conﬁguration. Use the default parameters of the Hodgkin-
Huxley model under voltage-clamp conditions to complete the following prob-
lems. You may change only the stimulus parameters.

a. The potassium conductance

i. Find the amplitude and duration of a rectangular pulse of membrane
potential such that the potassium conductance reaches its ﬁnal of
GK (Vm , ∞) = 9 ± 0.2 mS/cm2 .
ii. What is the value of the time constant of n, τn , during this pulse?

b. The sodium conductance

i. Find the amplitude and duration of a rectangular pulse of membrane
potential such that the peak sodium conductance is 15 ± 0.2 mS/cm2 .
Make sure that the pulse duration is suﬃcient so that there is a peak
in the sodium conductance before the pulse terminates.
ii. What are the values of m and h at the time of the peak value of the
sodium conductance?

112

CHAPTER 5. HODGKIN-HUXLEY MODEL

iii. Increase the amplitude of the pulse 20 mV from the value you found
above and determine the peak sodium conductance and the values of
m and h at the time of the peak value of the sodium conductance.
iv. Decrease the amplitude of the pulse 20 mV from the value you found
above and determine the peak sodium conductance and the values of
m and h at the time of the peak value of the sodium conductance.

Problem 5.2 The purpose of this problem is to explore the diﬀerences in time
dependence of the [in]activation factors in voltage-clamp and current-clamp ex-
periments.

a. Run the simulation in the voltage-clamp conﬁguration using the default
parameters, except delay the onset of the pulse of voltage by 1 ms to make
the on and oﬀ transients more readily visible. Examine the results of the
simulation and answer the following questions.

i. Describe and explain the dependence on time of τm , m∞ , and m.
ii. Describe and explain the dependence on time of τh , h∞ , and h.
iii. Describe and explain the dependence on time of τn , n∞ , and n.
iv. Plot the voltage dependence of τm , τh , τn , m∞ , h∞ , and n∞ . Check the
numerical values of these variables against those obtained in parts i,
ii, and iv.

b. Run the simulation in the current-clamp conﬁguration using the default pa-
rameters. Examine the results of the simulation and answer the following
questions.

i. Describe and explain the dependence on time of τm , m∞ , and m.
ii. Describe and explain the dependence on time of τh , h∞ , and h.
iii. Describe and explain the dependence on time of τn , n∞ , and n.

c. Succinctly summarize the diﬀerences in the time dependence of all these
variables in voltage-clamp and current-clamp conﬁgurations.

Problem 5.3 The purpose of this problem is to explore a useful aspect of per-
forming simulation experiments on a model; the model can be used to test ideas
concerning proposed measurements on cells.
Assume that the membrane of neuron X has voltage-current characteristics
as described by the Hodgkin-Huxley model except that the voltage dependences
of the parameters of the factors n, m, and h are unknown.
In this problem
you are asked to develop methods to estimate the voltage dependence of some
of these parameters and to assess the accuracy of your methods. To make the

5.5. PROBLEMS

113

simulations realistic, in all parts of the problem you may only change the follow-
ing parameters: the concentrations of sodium, potassium, and calcium either
inside or outside the cell, and the temperature. You may use either voltage-
clamp experiments or current clamp experiments. You can choose any stimulus
waveform that you can construct with the simulation. However, you must base
your estimation method on the membrane current in voltage clamp experiments
and/or on the membrane potential in current-clamp experiments. For example,
you cannot base your estimation method on a direct measurement of m(t ).
a. Develop a method to estimate the voltage dependence of m∞ . Use the
simulation to assess the accuracy of your method by comparing the results
of your estimation of m∞ with a direct computation of m∞ .

b. Develop a method to estimate the voltage dependence of h∞ . Use the sim-
ulation to assess the accuracy of your method as in part a.

Problem 5.4 The purpose of this problem is to explore the threshold for elicit-
ing an action potential for a model of a space-clamped axon. By changing the
amplitude of the stimulus pulse, while keeping all other parameters at their de-
fault values, determine the thresholdof the action potential to a precision of 4
signiﬁcant digits.

a. Describe the changes in action potential waveform as a function of current
amplitude.

b. Does the change in waveform of the action potential as a function of stim-
ulus amplitude violate the all-or-none principal? Explain.

c. Investigate the basis of the change in waveform of the action potential by
examining the behavior of variables in addition to the membrane potential
as the current amplitude is varied.

Problem 5.5 The purpose of this problem is to explore the refractory properties
of the Hodgkin-Huxley model. Apply two current pulses, each of amplitude 30
µA/cm2 and duration 0.5 ms, separated by 12 ms in time. Set the simulation
duration to 20 ms. Run the simulation. You should observe two action poten-
tials. Reduce the inter-pulse interval to 10 ms. What happens? Now change the
amplitude of the second pulse to 50 µA/cm2 and observe the response. Change
the inter-pulse interval to 5 ms and observe the outcome.

a. Have you observed properties of the absolute or the relative refractory pe-
riod?

b. By examining the behavior of the factors m, n, and h during these two-
pulse simulations, determine which of these factors are most inﬂuential in
refractory properties.

114

CHAPTER 5. HODGKIN-HUXLEY MODEL

Problem 5.6 The purpose of this problem is to explore the phenomena of repet-
itive activity and depolarization block of the Hodgkin-Huxley model. Perform
a sequence of simulations with the following parameters. Use a single current
pulse of duration 40 ms, a simulation duration of 50 ms, and stimulus ampli-
tudes of 10, 25, 50, 100, and 200 µA/cm2 .

a. Note that both the number of action potentials and their amplitudes vary
with the current amplitude. Sketch the relation between the number of
action potentials and current amplitude and between action potential am-
plitude and current amplitude.

b. By examining the behavior of the factors m, n, and h determine which of
these factors are most inﬂuential in determining repetitive activity. Explain
your reasoning.

Problem 5.7 The purpose of this problem is to explore the phenomenon of anode-
break excitation. The phenomenon can be demonstrated by applying a pulse
of current of duration 20 ms and amplitude −20 µA/cm2 . Use a simulation
duration of 40 ms.

a. Why is this phenomenon called anode-break excitation?

b. By exploring the model variables explain this phenomenon.

Problem 5.8 The purpose of this problem is to explore the phenomenon of accom-
modation. Accommodation can be illustrated by applying a ramp of current of
slope 0.4 µA/(cm2 · ms) starting at an amplitude of 0 for a duration of 6 sec-
onds (also set the simulation duration to 6 seconds). The model does not show
accommodation for the default value of ¯GN a = 120 mS/cm2 but does for a value
of 80 mS/cm2 . When the simulation is completed, plot the sodium, potassium
and membrane current versus the membrane potential.

a. Perhaps no action potential has occurred in response to the ramp of cur-
rent because the reduced value of the sodium conductance prevents action
potential from being generated for any stimulus. Test this hypothesis.

b. Explain the underlying basis of accommodation.

c. What does the phenomenon of accommodation suggest about the notion
of the threshold for eliciting an action potential?

Problem 5.9 The purpose of this problem is to explore sub-threshold oscillations
in the Hodgkin-Huxley model. Sub-threshold oscillations can be observed by us-
ing the default parameters with current pulses of 50 ms duration and simulation
durations of 100 ms. Use current amplitudes of .01, .1, 1, 2, and 2.5 µA/cm2 .

5.5. PROBLEMS

115

a. Describe your observations.

b. Can the response of the model to a step of current be represented by the
response of a network consisting of a constant resistance in parallel with a
constant capacitance. Explain.

c. If your answer to part b was no, then devise a current stimulus such that
the model’s response will approximate that of a network consisting of a
constant resistance in parallel with a constant capacitance. Explain your
method.

Problem 5.10 The purpose of this problem is to explore the strength-duration re-
lation of the Hodgkin-Huxley model. Determine the threshold current amplitudes
(to three signiﬁcant ﬁgures) for eliciting action potentials for current pulses of
duration 0.01, 0.05, 0.1, 0.5, 1, 2, 5, 10, and 20 ms.

a. How does the threshold depend on current duration for low durations?
Explain this behavior.

b. How does the threshold depend on current duration for long durations?
Explain this behavior.

Problem 5.11 The purpose of this problem is to explore the interplay of factors
that determine the excitation of an action potential in the Hodgkin-Huxley model.
The Hodgkin-Huxley model with the default parameters stimulated by a pulse of
membrane current of amplitude 20 µA/cm2 and of duration 0.5 ms produces an
action potential as shown in Figure 5.20. In each of the following computations,
one membrane parameter only diﬀers from the default parameters, and for each
of these computations no action potential occurs. The parameter changes are:
◦
◦
C to 35

C blocks the action potential

i. A change in the temperature from 6.3
as shown in Figure 5.20.

ii. A change in the maximum potassium conductance from 36 to 72 mS/cm2
blocks the action potential. [Results not shown.]

iii. A change in the internal calcium concentration from 0.0001 to 0.0002
mmol/l blocks the action potential. [Results not shown.]

iv. A change in the membrane capacitance from 1 µF/cm2 to 20 µF/cm2 blocks
the action potential as shown in Figure 5.20.

v. A change in the external calcium concentration from 44 mmol/l to 22
mmol/l blocks the action potential. [Results not shown.]

116

CHAPTER 5. HODGKIN-HUXLEY MODEL

Figure 5.20: Results of simulation with all model parameters at their default values
except where indicated (Problem 5.11). The curve labelled Default was obtained with
the default parameters. The curve labeled Tc = 35 was obtained with the default pa-
C. The curve labeled Cm = 20 was
◦
rameters except that the temperature was set to 35
obtained with the default parameters except that the membrane capacitance was set to
20 µF/cm2 .

5.5. PROBLEMS

117

Examination of the results for the above computations (e.g., Figure 5.20) re-
veals that there is no large change in membrane potential, i.e., no action potential
has occurred. For each of the computations:

a. Explain why no action potential occurred. You may wish to base your ex-
planation on the results obtained with each of the above computations. For
example, you may wish to examine the membrane currents, conductances,
and activation variables that occurred for each computation. You may also
wish to perform additional computations using diﬀerent model parame-
ters. For example, to see why no action potential occurs for a large temper-
ature change, it might be instructive to examine the eﬀects produced by
smaller changes in temperature. Since for many of the parts of this prob-
lem, there are large changes in parameters you may wish to explore the
role of the numerical methods in arriving at the solutions.

b. Determine a set of parameters so as to produce an action potential with a
waveform that is identical, except for a change in time scale and a change
in resting potential, to the action potential obtained with the default pa-
rameters. However, for each of the above parts, you may not change the
parameter that diﬀers from its default value. For example, for computation
in part i, you may not change the temperature. Your task is to change some
other parameter or group of parameters such that the action potential is
restored. For computation in part ii, you may not change the maximum
potassium conductance. For computations in parts iii and v, you may not
change either the internal or the external calcium concentration, etc. RE-
MEMBER — the objective is not just to produce an action potential, that
is too easy, but to obtain an action potential whose waveform is identi-
cal to that obtained with the default parameters. To determine whether
or not the action potential is identical to that obtained with the default
parameters, you can superimpose plots and/or look at the variables sum-
mary ﬁgures from the responses. You should use the computer as a tool
to check your ideas and not as a substitute for thinking. You should avoid
a strictly trial-and-error approach. There are simply too many parameters
in the Hodgkin-Huxley model for you to explore them all randomly. When
you have arrived at a satisfactory solution, print a hard copy of the model
parameters ﬁgure showing the parameters you used to solve the problem
and include this with your solution. Explain why your parameter change
produces the desired result. [HINT: simulations are not required to solve
these problems, but they are helpful for checking ideas quickly.]

118

CHAPTER 5. HODGKIN-HUXLEY MODEL

5.6 PROJECTS

The simulation software lends itself to more extensive study than that included
in the Problems. These more extensive studies are called Projects and these are
described here.

5.6.1 Practical considerations in the choice of a topic

Projects can involve almost any of the properties of the Hodgkin-Huxley model.
However, to avoid projects whose aims are vague (e.g., “I would like to under-
stand how the Hodgkin-Huxley model works”) the proposed project should be in
the form of a speciﬁc and testable hypothesis. Projects that involve months of
computation should obviously be avoided. Experience should indicate the dura-
tion required to run simulations of the Hodgkin-Huxley model. These durations
should be taken into account explicitly in planning a project. For example, any
project that involves measuring the threshold of occurrence of an action poten-
tial for many diﬀerent parameter values is bound to be very time consuming,
because determining the threshold for a single set of parameters itself involves
many computations. The task is to choose a physiological property of the ex-
citation of the action potential that is of interest, and then to deﬁne a speciﬁc,
feasible project.

5.6.2 Choice of topics

Topics can involve comparing predictions of the Hodgkin-Huxley model with
measurements on cells. For example, the eﬀects of changes in sodium ion
concentration on the action potential have been measured (Hodgkin and Katz,
1949a; Baker et al., 1961). A project might involve reading the original papers
that describe such measurements (some were made before the Hodgkin-Huxley
model was formulated), and testing the hypothesis that these measurements
are (or are not) consistent with the Hodgkin-Huxley model. Similarly, a project
might involve examining the eﬀect of some pharmacological substance on mea-
surements of the action potential and testing the hypothesis that the substance
produces its eﬀect by changing one or another parameter of the model. These
projects will require some reading of original literature which is often diﬃcult
and usually time consuming. However, such a project can lead to a very reward-
ing educational experience. Alternatively, the project might involve a purely
theoretical topic in which some property of the model is explained in terms of
the underlying structure of the model. This type of project does not necessarily
involve reading the original literature. To make the process of project deﬁni-
tion more tangible, we shall discuss one property of the Hodgkin-Huxley model
of a space-clamped axon, the shape of the action potential, and suggest some
appropriate projects based on this property.

5.6. PROJECTS

119

+50

0
−50
−100

)
V
m
(
 
l
a
i
t
n
e
t
o
p
 
e
n
a
r
b
m
e
M

+50

0
−50
−100

+50

0
−50
−100

0

0

0

Squid giant
axon

4
Time (ms)

8

Cat
motoneuron

+50

0
−50
−100

+50

0
−50
−100

Electric eel
electroplaque

0

3
6
Time (ms)

9

Frog sartorius
muscle fiber

10
20
Time (ms)

30

Sheep purkinje
fiber

4
Time (ms)

Cat myelinated
fiber

8

0

+50

0

-50
−100

1
Time (ms)

2

0

0.5
1
Time (s)

1.5

Figure 5.21: Examples of action potentials measured in a variety of cell types (Keynes
and Aidley, 1991, adapted from Figure 2.4).

Background

The waveform of the action potential is diﬀerent in diﬀerent types of electrically-
excitable cells. As demonstrated in Figure 5.21, while the action potential wave-
form has a peak-to-peak amplitude of about 100 mV, the duration and time
course vary greatly.
It is also known that the action potential waveform of a
cell can be changed by changing a number of experimental variables. For ex-
ample, increasing the temperature tends to decrease the duration of the action
potential (Figure 5.22), and reducing the external sodium concentration reduces
the amplitude and increases the duration of the action potential (Figure 5.23).
Since action-potential waveforms vary from cell to cell and vary for one cell if
environmental variables are changed, this raises a question — To what extent
are changes in action-potential waveforms seen in diﬀerent cells due to inherent
diﬀerences in the membrane mechanisms rather than to diﬀerences in membrane
parameters with identical membrane mechanisms? For example, the action po-

120

CHAPTER 5. HODGKIN-HUXLEY MODEL

)
V
m
(
 
o
m
V
 
−
 
)
t
(
m
V

100

20.2

32.5

50

0

3.6

6.3

9.8

13.3

0

1
2
Time (ms)

3

Figure 5.22: Dependence of the action potential on temperature for measurements
obtained from a giant axon of the squid (Hodgkin and Katz, 1949b).

40

0

-40

-80

)
V
m
(
 
l
a
i
t
n
e
t
o
p
 
e
n
a
r
b
m
e
M

1

3

2

0

1

2
Time (ms)

3

4

Figure 5.23: Eﬀect of extracellular sodium concentration on the membrane potential of
a giant axon of a squid (Hodgkin and Katz, 1949a, adapted from Figure 4). Traces 1 and
3 are the action potentials obtained in normal sea water before and after trace 2 which
was obtained in sea water with 50% sodium content. Isotonic solutions were obtained
by using mixtures of sea water and a glucose solution.

5.6. PROJECTS

121

tentials of the squid axon and the frog and rat nodes of Ranvier shown in Fig-
ure 5.21 were measured at diﬀerent temperatures. In fact, the briefest action po-
tentials were obtained at the highest temperatures. Since Figure 5.22 indicates
that the duration of the action potential does become shorter at higher temper-
atures in squid axon, it may be that the temperature diﬀerences in the measure-
ments could explain the diﬀerences in the waveforms of the action potentials
of these three preparations. It is clear that temperature changes alone cannot
explain all the variations seen in Figure 5.21 since the long-duration action po-
tential of frog cardiac muscle was obtained at a higher temperature than was the
action potential of the squid giant axon. However, perhaps some combination
of changes of parameters in addition to temperature (e.g., ion concentrations,
ion conductances, membrane capacitance, etc.) might explain the long-duration
action potential of cardiac muscle.

Examples of hypotheses

The list of projects given below includes a number that deal with the waveform
of the action potential generated by the Hodgkin-Huxley model as well as a few
that deal with other topics.

1. Hypothesis — The diﬀerence in waveform of the action potential of a frog
node of Ranvier and of a squid giant axon (Figure 5.21) can be reproduced
by the Hodgkin-Huxley model of a squid giant axon by a change in temper-
ature.

2. Hypothesis — The membrane capacitance determines the time course of
the rising phase of the action potential. Increasing the membrane capaci-
tance decreases the rate of increase of the rising phase of the action poten-
tial.

3. Hypothesis — The falling phase of the action potential (repolarization) can
occur in the absence of a change in potassium conductance.

4. Hypothesis — Increasing the temperature suﬃciently blocks the occur-
rence of the action potential because the membrane time constant limits
the rate at which the membrane variables can change and prevents the dif-
ference in time course of the sodium and potassium activation which is
responsible for initiation of the action potential.

5. Hypothesis — The initiation of the action potential is independent of the
potassium conductance.

6. Hypothesis — The prolonged plateau of the cardiac muscle action poten-
tial can be accounted for by the Hodgkin-Huxley model with a potassium
conductance that has a slow activation.

122

CHAPTER 5. HODGKIN-HUXLEY MODEL

7. Hypothesis — The eﬀect of tetraethylammonium chloride (TEA) on the ac-
tion potential of the squid giant axon can be modelled with the Hodgkin-
Huxley model by decreasing Kn and increasing Kh . Articles in the literature
should be consulted for this project (Armstrong, 1966; Armstrong and Bin-
stock, 1965; Tasaki and Hagiwara, 1957).

8. Hypothesis — The shape of the action potential in the presence of tetraethy-
lammonium chloride (TEA) can be accounted for by the Hodgkin-Huxley
model with a reduced maximum value of the potassium conductance. Arti-
cles in the literature should be consulted for this project (Armstrong, 1966;
Armstrong and Binstock, 1965; Tasaki and Hagiwara, 1957).

9. Hypothesis — Increasing the external calcium concentration will block the
occurrence of the action potential because this will reduce the diﬀerence in
the time constant of sodium and potassium activation which is responsible
for the initiation of the action potential.

10. Hypothesis — Increasing the external concentration of potassium will de-
crease the refractory period; decreasing this concentration will lengthen
the refractory period.

11. Hypothesis — Increasing the external concentration of sodium will de-
crease the refractory period; decreasing this concentration will lengthen
the refractory period.

12. Hypothesis — Absolute and relative refractory periods are decreased by
increasing the rate constants for sodium inactivation and for potassium
activation.

13. Hypothesis — Repolarization cannot occur if the potassium activation rate
constant is zero.

14. Hypothesis — The threshold of the action potential to a brief pulse of cur-
rent decreases as the external potassium current is increased.

15. The Hodgkin-Huxley model with default parameters does not exhibit ac-
commodation (Weiss, 1996b). Hypothesis — Accommodation occurs if the
leakage conductance is increased.

16. The Hodgkin-Huxley model with default parameters does not exhibit ac-
commodation (Weiss, 1996b). Hypothesis — Accommodation occurs if the
potassium conductance is increased.

17. Hypothesis — Increasing the leakage equilibrium potential will block the
action potential.

5.6. PROJECTS

123

18. Hypothesis — The eﬀect of the changes in concentration of sodium ions on
the action potential of the giant axon of the squid can be accounted for by
the Hodgkin-Huxley model. Articles in the literature should be consulted
for this project (Hodgkin and Katz, 1949a; Baker et al., 1961).

19. Hypothesis — In response to rectangular pulses of current, the rheobase of
the strength-duration relation increases as temperature increases.

20. Hypothesis — An increase in temperature results in a decrease in the du-
ration of the refractory period.

21. Hypothesis — The threshold membrane potential at which the Hodgkin-
Huxley model produces an action potential in response to a brief pulse
of current is equal to the membrane potential for which the linearized
Hodgkin-Huxley equations have unstable eigenvalues.

22. Application of a long-duration constant current to the Hodgkin-Huxley
model produces a train of action potentials. Hypothesis — The frequency
of the action potentials increases with increasing current amplitude.

23. Application of a long-duration constant current to the Hodgkin-Huxley
model produces a train of action potentials. Hypothesis — The frequency
of action potential increases as the parameter Kn is increased.

24. Application of a long-duration constant current to the Hodgkin-Huxley
model produces a train of action potentials. Hypothesis — The frequency
of action potential increases as the temperature is increased.

25. Hypothesis — An increase in the external concentration of potassium in-
creases the threshold potential at which an action potential is elicited.

26. Hypothesis — Increasing Kh will result in an increase in the steepness of
the repolarization phase of the action potential.

Caveats

Any of these (or other) hypotheses can be the starting point for a project. Most
of the hypotheses given above are simplistic, and a careful investigation will
reveal their shortcomings. The Hodgkin-Huxley model is suﬃciently complex
that investigation of any of the hypotheses will most likely lead to unexpected
results. It is informative to pursue these unexpected results and to try to under-
stand their bases. For example, you may ﬁnd that in pursuing some hypothesis
you choose to change some parameter of the model that you expect to result
in some change in action potential waveform. The resulting computation might
reveal, much to your surprise and chagrin, that no action potential has occurred

124

CHAPTER 5. HODGKIN-HUXLEY MODEL

or that multiple action potentials occur. Investigation of these unexpected ﬁnd-
ings will usually be instructive. The aim should be not simply to reject or accept
the hypothesis but to delve into the topic in suﬃcient depth so as to a deepen
understanding of the model. One outcome of the project might be to restate the
original hypothesis in a new and more sophisticated form.
In pursuing these projects, it is important to keep in mind that it is not nerve
membrane that is being investigated but rather a model of nerve membrane; in
fact, a very speciﬁc model — the Hodgkin-Huxley model for the membrane of
the squid giant axon. Explanations of all phenomena seen with the model must
involve the primitive concepts of this model — e.g., the ionic conductances, ionic
concentrations, ionic currents, the capacitance, and the variables m, n, and h.
Explanations in terms of molecular channel mechanisms or electrodiﬀusion of
ions in the membrane or ion pumps are irrelevant in so far as they are not con-
tained in the Hodgkin-Huxley model! Finally, it is important to remember that
the software performs a numerical integration of the Hodgkin-Huxley equations.
Thus, the user will have to contend with the inherent approximations involved
in numerical solutions of equations.

Chapter 6

HODGKIN HUXLEY MODEL —
PROPAGATED ACTION POTENTIAL

125

126

CHAPTER 6. PROPAGATED ACTION POTENTIAL

6.1 Introduction

6.1.1 Background

An electrically excitable cell produces a diﬀerence of potential across its cell
membrane, called an action potential. The diﬀerence in membrane potential is
accompanied by a ﬂow of current longitudinally through the intracellular and
extracellular media, as well as current ﬂow across the cell membrane along its
entire length. The spatial coupling of current ﬂow through neighboring seg-
ments of the membrane results in the propagation of the action potential along
the cell surface.
In the 1950s, Hodgkin and Huxley derived a partial diﬀerential equation that
eﬀectively describes the electrical properties of the giant axon of the squid
(Hodgkin and Huxley, 1952). This partial diﬀerential equation consists of the
core conductor equations, that describe the relation of current and voltage for
an electrical cable, plus a characterization of the electrical properties of the cell
membrane. The cell is assumed to be cylindrical and the inner and outer conduc-
tors are assumed to be equipotentials at each longitudinal position. Numerical
solutions to the partial diﬀerential equation were originally computed tediously
by hand (Hodgkin, 1977; Huxley, 1964). With the introduction of the digital com-
puter in the 1950s, solutions to these equations were computed more rapidly
(Fitzhugh and Antosiewicz, 1959). By the 1960’s computer speeds had increased
to allow the ﬁrst comprehensive study of the solutions to the partial diﬀerential
equations (Cooley and Dodge, 1966). Further increases in computer speeds and
the development of improved numerical methods (Moore et al., 1975; Joyner
et al., 1978; Hines, 1984), have allowed solutions to be obtained on personal
computers. The software package described here yields numerical solutions of
the partial diﬀerential equation that describe the propagation of the action po-
tential along a model of the squid giant axon.

6.1.2 Overview of the software

This software deals with the time and space dependent Hodgkin-Huxley model
and is complementary to the software described in Chapter 5. The software
described in the current chapter is comprised of a number of setup and anal-
ysis ﬁgures that are launched from a main control ﬁgure. Using the setup ﬁg-
ures, the user can specify the physical characteristics of the axon (length, radius,
etc.) and parameters of the membrane (capacitance, conductances of membrane
ionic channels, kinetic parameters, etc.) and bath (concentration of all relevant
ions, temperature, etc.). A stimulus source can be customized to the user’s
speciﬁcations, and graphic icons of a pair of stimulus electrodes can be visu-
ally placed along a schematic representation of an axon.
In addition, graphic
icons representing a pair of recording electrodes can be placed along the axon

6.2. THEORY

127

schematic to compute and display the diﬀerence in potential. When a simula-
tion is started, solutions are calculated using one of four user selectable numer-
ical methods, and the time-evolution of the membrane potential is shown color
coded to convey the space-time evolution of potentials on the axon schematic.
After a simulation is completed, the user can display any of the computed so-
lution variables (such as membrane potential, membrane-current components,
membrane-conductance components, channel activation and inactivation vari-
ables, etc.) using diﬀerent interactive analysis ﬁgures which include: a ﬁgure
that displays the space-time evolution of any solution variable, a ﬁgure that gen-
erates three-dimensional plots to show the dependence on time and on space of
any solution variable, and a ﬁgure that generates comparison plots between the
solution variables at ﬁxed times or at ﬁxed positions.

6.2 Theory

The theory of the propagation of an action potential along an unmyelinated axon
was ﬁrst described for the squid giant axon (Hodgkin and Huxley, 1952). We
brieﬂy review this theory here; a more detailed description is available elsewhere
(Weiss, 1996b).

6.2.1 Core conductor equations

An incremental portion of the core conductor model of a cylindrical unmyeli-
nated nerve ﬁber is shown in Figure 6.1. Kirchhoﬀ’s laws relate the variables of
this incremental model. The core conductor equations result (Weiss, 1996b) if
to zero, ∆z → 0,
the limit of these equations is taken as the incremental length of the ﬁber goes

= Kei(z, t ) − Km (z, t ),
∂ Ii(z, t )
∂z
= Km (z, t ) − Keo (z, t ),
∂ Io (z, t )
∂z
= −ri Ii(z, t ),
∂Vi(z, t )
∂z
= −ro Io (z, t ),
∂Vo (z, t )
∂z
Vm (z, t ) = Vi(z, t ) − Vo (z, t ),
= −ri Ii(z, t ) + ro Io (z, t ).
∂Vm (z, t )
∂z

(6.1)

(6.2)

(6.3)

(6.4)

(6.5)

(6.6)

These equations can be combined to obtain a relation between the membrane
potential Vm and the membrane current density Jm at time t and location z along

128

CHAPTER 6. PROPAGATED ACTION POTENTIAL

ri∆z

Ii (z , t)

Kei (z , t)∆z

ri∆z

Ii (z+∆z , t)

Kei (z+∆z , t)∆z

ri∆z

Inner conductor
Km (z , t)∆z

Vi (z , t)

Membrane

+

Vm (z , t)

−

Outer conductor
ro∆z

Io (z , t)

Vo (z , t)

Km (z+∆z , t)∆z

Vi (z+∆z , t)

+

Vm (z+∆z , t)

−

Vo (z+∆z , t)

ro∆z

Io (z+∆z , t)

ro∆z

Keo (z , t)∆z

z

Keo (z+∆z , t)∆z

z + ∆z

Figure 6.1: Equivalent network model of incremental sections of an unmyelinated nerve
ﬁber showing the reference directions for all the voltage and current variables. The K s
are currents per unit length of the ﬁber: Km is the membrane current; Keo and Kei are
extrinsic currents applied (by electrodes) externally and internally, respectively. Ii and
Io are the internal and external longitudinal currents. Vm is the potential across the
membrane and Vi and Vo are the internal and external potentials, respectively. The
internal and external resistance per unit length of the ﬁber are ri and ro .

a cylindrical, unmyelinated nerve ﬁber, often called the core-conductor equation
(roKeo (z, t ) + riKei(z, t )),
= Jm (z, t ) −
∂ 2Vm (z, t )
1
1
2π a(ro + ri)
2π a(ro + ri)
∂z2
where a is the radius of the cylindrical cell and Km = 2π aJm , where Jm is the
membrane current per unit area. In addition, the resistance per unit length of
cytoplasm can be expressed in terms of the resistivity as follows
ri = ρi
4π a2

where ρi is the resistivity of cytoplasm.

6.2.2 Representation of stimulating electrodes

An arrangement of stimulating electrodes is shown in Figure 6.2. From Kirch-
hoﬀ’s current law we have that at any position along the ﬁber
Ii(z, t ) + Io (z, t ) + Is (z, t ) = 0,

(6.7)

6.2. THEORY

129

I1 (t )

I2 (t )

Extracelllular

Intracellular

Extracellular

z11

z12

z21

z22

Figure 6.2: The relation of two
pairs of stimulus electrodes to a
ﬁber is shown. The stimulus elec-
trodes are shown as extracellular
but any of the electrodes can be
intracellular or extracellular.

u(z) =

(cid:4)
(cid:3)
(cid:4)
(cid:3)
where Is (z, t ) is the stimulus current in the positive z-direction which can be
written as
u(z − z21) − u(z − z22)
+ I2(t )
u(z − z11) − u(z − z12)
Is (z, t ) = I1(t )
,
 1 if z > 0,
(6.8)
where u(z) is the unit step function deﬁned as
0 if z < 0.
The electrode conﬁguration shown in Figure 6.2 also imparts current compo-
(cid:4)
(cid:3)
(cid:4)
(cid:3)
nents to Equations 6.1 and 6.2. With all the electrodes external, the currents per
unit length are as follows
Keo (z, t ) = I1(t )
δ(z − z11) − δ(z − z12)
Kei(z, t ) = 0,
where δ(z) is the unit impulse function.
If all four of the electrodes were intracellular then the currents per unit length
would be
(cid:4)
(cid:3)
(cid:4)
(cid:3)
Keo (z, t ) = 0,
Kei(z, t ) = −I1(t )
δ(z − z11) − δ(z − z12)
− I2(t )
δ(z − z21) − δ(z − z22)
With careful attention to signs, any combination of intracellular and extracellular
stimulating electrodes can be accommodated. The algorithm is that extracellular
electrodes supply positive impulses at the cathode and negative impulses at
the anode; intracellular electrodes supply negative impulses at the cathode and
positive impulses at the anode.

δ(z − z21) − δ(z − z22)

+ I2(t )

,

,

6.2.3 Longitudinal currents

By using the core conductor equations (Equation 6.6) and the KCL equation for
the current (Equation 6.7), we can solve for the longitudinal currents as follows
− ro
Ii(z, t ) = − 1
∂Vm (z, t )
ri + ro
ri + ro
∂z

Is (z, t ),

130

CHAPTER 6. PROPAGATED ACTION POTENTIAL

Io (z, t ) =

1
ri + ro

∂Vm (z, t )
∂z

− ri
ri + ro

Is (z, t ).

6.2.4 Intracellular and extracellular potential diﬀerences

The expressions for the longitudinal currents can be combined with Equations 6.3
and 6.4 and the result integrated on z to yield the potential diﬀerences of a
recording electrode at zr 2 minus that at zr 1 as follows
(cid:6) zr 2
Vi(zr 2 , t ) − Vi(zr 1 , t ) =
(Vm (zr 2 , t ) − Vm (zr 1 , t ))
ri
ri + ro
+ riro
ri + ro
Is (z, t ) dz,
zr 1
(cid:6) zr 2
Vo (zr 2 , t ) − Vo (zr 1 , t ) = − ro
(Vm (zr 2 , t ) − Vm (zr 1 , t ))
ri + ro
+ riro
ri + ro
zr 1

Is (z, t ) dz,

(cid:6) zr 2
(cid:3)
where use of Equation 6.8 results in
(cid:3)
Is (z, t ) dz = I1(t )
(z − z11)u(z − z11) − (z − z12)u(z − z12)
zr 1
+I2(t )
(z − z21)u(z − z21) − (z − z22)u(z − z22)

(cid:4)

(cid:4)

.

6.2.5 The membrane current density

The membrane current density consists of a capacitance current density and an
ionic current density Jion as follows,
Jm (z, t ) = Cm
∂Vm (z, t )
∂ t
where Cm is the speciﬁc membrane capacitance, i.e., the capacitance of a unit
area of membrane. For purposes of numerical solution of the core conductor
equation, it is helpful to combine the ionic current density with the external
currents so that
J (z, t ) = Jion(z, t ) −

(roKeo (z, t ) + riKei(z, t )),

+ Jion(z, t ),

1
2π a(ro + ri)
and, therefore, the core conductor equation can be expressed as
+ J (z, t ).
= Cm

1
2π a(ro + ri)
The ionic current density can be expressed in terms of its ionic components
Jion(z, t ) = GK (Vm , t )(Vm − VK ) + GN a(Vm , t )(Vm − VN a) + GL(Vm − VL), (6.11)

∂ 2Vm (z, t )
∂z2

∂Vm (z, t )
∂ t

(6.10)

(6.9)

6.3. NUMERICAL METHOD OF SOLUTION

131

(cid:19)
(cid:20)
where Vn is the Nernst equilibrium potential of ion n
Vn = RT
znF ln
where R is the molar gas constant, T is absolute temperature, F is Faraday’s
constant, and zn , c o
n and c i
n are the valence, outside, and inside concentrations
(cid:19)
(cid:20)
of ion n, respectively. For a univalent ion, the Nernst equilibrium potential is
expressed as

c o
n
c i
n

,

Vn = 0.08616 (Tc + 273.16) ln

c o
n
c i
n

(mV),

where Tc is the temperature in Centigrade.

6.2.6 The membrane conductances

A full description of the Hodgkin-Huxley model of the ionic conductances is
given beginning with Section 5.2.3.

6.2.7 Default values of parameters
The default numerical values for the Hodgkin-Huxley model are: GN a = 120,
GK = 36, and GL = 0.3 mS/cm2 ; Cm = 1 µF/cm2 ; c o
N a = 491, c i
N a = 50, c o
K =
K = 400, c o
C a = 44, c i
C a = 0.00011 mmol/L; VL = −49 mV; external
20.11, c i
resistance per unit length, ro = 0 Ohm/cm; resistivity of axoplasm, ρi = 35.4
Ohm·cm; axon radius, a = 238 µm; temperature is 6.3
◦
C.

6.3 Numerical Method of Solution

There are several ways to obtain a numerical solution to the equations describ-
ing the membrane potential in a cylindrical cell. In the ﬁnite-element method, the
cylindrical axon is segmented into small cylinders over each of which the mem-
brane potential is assumed to be constant. Ordinary diﬀerential equations (with
time as the independent variable) can be written to describe the membrane po-
tential and membrane current for each segment and the set of ordinary diﬀeren-
tial equations can be solved numerically with appropriate boundary conditions
linking the electrical variables in adjoining segments.
In the ﬁnite-diﬀerence
method, the partial diﬀerential equations are discretized directly by discretizing
the membrane potential and membrane current and approximating the spatial
and temporal derivatives with ﬁnite diﬀerences. We use the second method
which is described in a number of texts on numerical methods of solution of
partial diﬀerential equations (Smith, 1985; Press et al., 1986; Gerald and Wheat-
ley, 1989) and in research papers on the solution of the Hodgkin-Huxley model

132

CHAPTER 6. PROPAGATED ACTION POTENTIAL

∂ 2Vm (z, t )
∂z2

(Hines, 1984; Hines and Carnevale, 1998; Mascagni and Sherman, 1998; Pearl-
mutter and Zador, 1999).
The ﬁrst step is to discretize the membrane potential and current density
i = Vm (i∆z, n∆t ) = Vm (z, t )|z=i∆z,t=n∆t ,
variables as follows,
i = J (i∆z, n∆t ) = J (z, t )|z=i∆z,t=n∆t ,
V n
J n
where ∆z and ∆t are the increments in z and t . The second spatial derivative
is approximated by the centered diﬀerence (also known as the method of lines),
(∆z)2
− 2V n
i + V n
≈ V n
i+1
i−1
All of the numerical methods implemented use the above centered diﬀerence
approximation to the second spatial derivative. The methods diﬀer only in the
approximation of the temporal derivative. There are two simple ways to approx-
imate the temporal derivative at time t .
In the forward Euler approximation,
∆t
− V n
≈ V n+1
∂Vm (z, t )
i
i
∂ t
whereas in the backward Euler approximation
i∆t
i − V n−1
≈ V n
∂Vm (z, t )
∂ t
The temporal approximation used in the Crank-Nicolson method essentially av-
erages the forward Euler and the backward Euler approximations. The staggered
increment Crank-Nicolson method is a variant of the Crank-Nicolson method
with desirable numerical characteristics.

.

.

,

6.3.1 Forward Euler method
With the forward Euler approximation, the discretized core conductor equation
(cid:19)
(cid:20)
(cid:20)
(cid:19)
(Equation 6.10) is
∆t
(∆z)2
− V n
− 2V n
i + V n
V n+1
i−1
1
i
i
2π a(ro + ri)
By collecting terms, the forward Euler approximation leads to the following dif-
ference equations

+ J n
i .

= Cm

V n
i+1

(6.12)

where

V n+1
i

η =

− ξJ n
i + ηV n
+ (1 − 2η)V n
= ηV n
i ,
i+1
i−1
and ξ = ∆t
∆t
2π a(ro + ri)(∆z)2Cm
Cm

.

6.3. NUMERICAL METHOD OF SOLUTION

133

= Cm

+ J n
1 ,

1
2π a(ro + ri)

Note that the forward Euler approximation results in an explicit method of solu-
tion since it gives an explicit formula for computing the V n+1
given both V n
i and
i , i.e., the values of variables at time n + 1 are computed directly from their
i
J n
values at at time n.
In order to solve the equations numerically, we require initial conditions
along the length of the ﬁber plus boundary conditions at the two ends of the
ﬁber. Initial conditions are simply that the membrane potential is at its resting
value and that the membrane current is zero. The method for computing the
resting potential is described in Section 5.3.3. A variety of boundary conditions
are plausible. We shall use the boundary condition that the ﬁber is closed at
both ends so that the longitudinal current is zero at the two ends of the ﬁber.
Equation 6.12 essentially expresses Kirchhoﬀ’s current law which can be modi-
ﬁed at the closed end to set the appropriate longitudinal current to zero. Using
this method for i = 1 and setting the longitudinal current from node 0 to node
(cid:20)
(cid:19)
(cid:8)
(cid:7)
1 to zero yields
∆t
(∆z)2
− V n
1 − V n
V n+1
V n
1
1
2
which, after collecting terms, results in the diﬀerence equation
1 − ξJ n
+ (1 − η)V n
1 = ηV n
V n+1
1 .
2
A similar equation results at the other end of the ﬁber model so that the matrix
equation can be written as








The matrix equation can be written compactly as
Vn+1 = AF E Vn − ξ Jn .
To obtain a solution, we need to compute J n
i . This current is linked to the
ionic currents (Equation 6.9) which themselves depend upon factors that are
solutions to diﬀerential equations (Equations 5.11-5.13). Let x stand for m, n,
and h then we have
= αm − x (αm + βm ),

· · ·
0
· · ·
η
1 − 2η · · ·
· · ·
η
...
...
· · ·
0
· · ·
· · ·

V n+1
1
V n+1
2
V n+1
3
...
V n+1
I−1
V n+1
I

η
1 − 2η
η
0
...
0

V n
1
V n
2
V n
3
...
V n
I−1
V n
I

0
...
1 − 2η
η
0

0
...
η
1 − 2η
η

J n
1
J n
2
J n
3
...
J n
I−1
J n
I

0
...
0
η
1 − η

1 − η
η
0

− ξ

.

0

0

0

0

0
...
0

0

0

dx
dt

0

0

0

0

0

0

0

0

0

=

134

CHAPTER 6. PROPAGATED ACTION POTENTIAL

αx

,

.

αx

(6.13)

V n−1
i

V n−1
i

V n−1
i

V n−1
i
(cid:3)

where α and β are instantaneous functions of membrane potential. We dis-
(cid:3)
(cid:4)
(cid:3)
(cid:3)
(cid:4)
(cid:3)
(cid:4)(cid:4)
cretize this equation with the forward Euler algorithm as follows
i∆t
i − xn−1
xn
= αx
− xn−1
+ βx
V n−1
V n−1
i
i
i
(cid:4)
(cid:3)
(cid:3)
(cid:4)
(cid:3)
(cid:3)
(cid:4)(cid:4)(cid:4)
+ ∆tαx
1 − ∆t
and collect terms to obtain
i = xn−1
+ βx
xn
i
With the factors m, n, and h substituted for x , the ionic current can be com-
puted as follows
i − VN a) + GL(V n
i − VK ) + ¯GN a(mn
i = ¯GK (nn
i − VL),
i (V n
i )3hn
i )4(V n
(Jion)n
where each of the factors mn
i , and hn
i , nn
i are computed according to Equa-
tion 6.13. The total current is
i + ri(Kei)n
i − ro (Keo )n
i = (Jion)n
i
J n
2π a(ro + ri)
Although the Forward Euler method is relatively easy to understand, it’s nu-
merical properties are undesirable. The forward Euler method is stable provided
η ≤ 0.5 which implies that to achieve stable solutions, the discretization in space
quires ∆t ≤ π a(ro + ri)(∆z)2Cm (Mascagni and Sherman, 1998). Thus, a choice
and in time cannot be chosen independently. Speciﬁcally, a stable solution re-
of ∆x limits the choice of ∆t required to achieve stable solutions. If ∆t is too
cannot be used to eﬃciently compute the response for large values of ∆t such as
large, the solution will diverge. Thus, for example, the forward Euler algorithm
resulting from temporal and spatial discretization behaves as O (∆t )+O ((∆x )2).
would be desirable to determine steady-state responses. Furthermore, the error
Thus, although the method of solution using the forward Euler algorithm is sim-
ple to understand, the numerical properties of the method are not desirable.

.

6.3.2 Backward Euler method
With the backward Euler approximation (advanced one point in time), the dis-
(cid:19)
(cid:20)
(cid:20)
(cid:19)
cretized core conductor equation is
∆t
(∆z)2
− V n
− 2V n+1
+ V n+1
V n+1
V n+1
i+1
i−1
1
i
i
i
2π a(ro + ri)
which, after collecting terms and changing signs, yields the diﬀerence equation
−ηV n+1
i − ξJ n+1
= V n
− ηV n+1
+ (1 + 2η)V n+1
i+1
i−1
i
i

+ J n+1
i

= Cm

(6.14)

,

.

6.3. NUMERICAL METHOD OF SOLUTION

135

=

.

0

0

0

0

0

0

0

0

0

0

0

0

0

− ξ

Note that the backward Euler method is an implicit method of solution since it
gives an implicit formula for computing the V n+1
given both V n
i and J n
i . Thus,
i
the solution can only be obtained by solving a set of coupled algebraic equations.
We use the same initial and boundary conditions as for the forward Euler
algorithm. By modifying Equation 6.14 with a closed end condition at i = 1 and
collecting terms, the diﬀerence equation is
1 − ξJ n
1 = V n
+ (1 + η)V n+1
−ηV n+1
1 .
2
A similar equation results at the other end of the ﬁber model so that the incor-
poration of the closed-end boundary conditions results in the following matrix
equation







1 + η
−η
0
0
...
0
0
0
The matrix equation can be written compactly as
ABE · Vn+1 = Vn − ξ Jn+1 ,
(cid:3)

· · ·
0
· · ·
−η
1 + 2η · · ·
· · ·
−η
...
...
· · ·
0
· · ·
· · ·

V n+1
1
V n+1
2
V n+1
3
...
V n+1
I−1
V n+1
I

−η
1 + 2η
−η
0
...
0

J n+1
1
J n+1
2
J n+1
3
...
J n+1
I−1
J n+1
I

V n
1
V n
2
V n
3
...
V n
I−1
V n
I

0
...
−η
1 + 2η
−η

0
...
1 + 2η
−η
0

which has the solution

0
...
0
−η
1 + η

(cid:4)

(6.15)

Vn − ξ Jn+1
−1 ·
Vn+1 = ABE
.
Similar to the procedure with the forward Euler algorithm, J n+1
can be com-
i
puted from the factors that determine the ionic conductances. Once again, we
let x stand for m, n, and h, and we discretize this equation, this time with the
(cid:4)(cid:4)
(cid:3)
(cid:4)
(cid:3)
(cid:3)
(cid:3)
(cid:4)
backward Euler algorithm as follows
∆t
i − xn
xn+1
− xn+1
= αx
V n+1
i
αx
i
i
(cid:4)
(cid:3)
i + ∆tαx
and collect terms to obtain
(cid:3)
(cid:3)
(cid:4)
(cid:3)
V n+1
1 + ∆t
xn
i =
xn+1
i
+ βx
V n+1
V n+1
αx
i
i
With the factors m, n, and h substituted for x , the ionic current can be com-
puted as follows
i = ¯GK (nn+1
(Jion)n+1
i

i − VN a) + GL(V n
i − VL),
(V n

i − VK ) + ¯GN a(mn+1
)4(V n
i

+ βx
(cid:4)(cid:4) .

)3hn+1
i

V n+1
i

V n+1
i

(6.16)

,

.

are computed according to Equa-

136
CHAPTER 6. PROPAGATED ACTION POTENTIAL
where each of the factors mn+1
, and hn+1
, nn+1
i
i
i
tion 6.16. The total current is
i + ri(Kei)n+1
i − ro (Keo )n+1
= (Jion)n+1
J n+1
i
2π a(ro + ri)
i
depends upon the potential V n+1
One diﬀerence is that the factor xn+1
so
i
i
that the four equations — Equation 6.15 and three equations (one for each of
the factors m, n, and h) of the form of Equation 6.16 — need to be solved simul-
taneously. To obtain accurate solutions, the set of 4 equations are iterated until
the 4 variables V n+1 , mn+1
, nn+1
, and hn+1
converge to within some speciﬁed
i
i
i
limit. For example, Equation 6.15 can be solved for the value of V n+1 using the
values of the factors at time increment n to compute new values of the factors.
These are then used to compute the new value of V n+1 which is used to compute
The backward Euler algorithm is stable for all values of ∆t and ∆x . Thus ∆t
new values of the factors, etc.
and ∆z can be chosen independently. Large values of ∆t can be used to deter-
mine approximate steady-state values of the solution. Just as for the forward
ing the backward Euler algorithm behaves as O (∆t ) + O ((∆x )2).
Euler algorithm, the error resulting from temporal and spatial discretization us-

Cm

=

(6.17)

1
4π a(ro + ri)

6.3.3 Crank-Nicolson method
In the Crank-Nicolson method, the forward Euler and backward Euler approxi-
(cid:19)
(cid:20)
mations are averaged to yield the following diﬀerence equation
(∆z)2
(∆z)2
i + V n
+ V n+1
− 2V n+1
− 2V n
V n+1
(cid:20)
(cid:19)
+ V n
i+1
i−1
i+1
i−1
i
∆t
− V n
V n+1
i + J n+1
i
i
(J n
).
i
Alternatively, this equation can be regarded as satisfying the partial diﬀerential
equation at the discrete time n + 1
2 with central diﬀerences used for all deriva-
tives. This interpretation is exploited in the next section on the Staggered incre-
ment Crank-Nicolson method.
Equation 6.17 can be rearranged and simpliﬁed so that all the voltage vari-
ables evaluated at time step n + 1 are on the left and all those at time step n are
on the right as follows

+ 1
2

− η
2

V n+1
i+1

+ (1 + η)V n+1
i

− η
2

V n+1
i−1

= η
2

V n
i+1

i + η
+ (1 − η)V n
2

− ξ

V n
i−1

i + J n
J n+1
i
2

.

As can be seen from the above equations, the Crank-Nicolson method is also an
implicit method.

6.3. NUMERICAL METHOD OF SOLUTION

137

=

0

0

0

0

V n
2

).

0

0

0

0

0

0

0

0

0

0

0

0

0

0

0

0

0

0

0

0

0

0

0
...
0

0

0
...
0

0

0

0
1 − η
2
η
2
0

0
...
1 + η
− η
2
0

0
...
− η
2
1 + η
− η
2

0
...
0
− η
2
1 + η
2

η
2
1 − η
η
2
0
...
0

V n+1
1
V n+1
2
V n+1
3
...
V n+1
I−1
V n+1
I

We use the same initial and boundary conditions as for the forward and back-
ward Euler algorithms. By modifying Equation 6.17 at the closed end at i = 1
and collecting terms, the diﬀerence equation is
1 + J n+1
1 − 1
+ (1 − η
1 = η
+ (1 + η
− η
)V n+1
V n+1
ξ (J n
)V n
1
2
2
2
2
2
2
A similar equation results at the other end of the ﬁber model so that with the
incorporation of the closed-end boundary conditions, the matrix equation for




the Crank-Nicolson method is
· · ·
− η
1 + η
0
2
2
− η
− η
1 + η
· · ·
2
2
− η
1 + η · · ·
0
2
− η
· · ·
0
2
...
...
...
· · ·
0
0
· · ·






· · ·
· · ·
0
· · ·
η
2
1 − η · · ·
· · ·
η
2
...
...
· · ·
0
· · ·
· · ·
(cid:4)
(cid:3)
The matrix equation can be written as
Jn + Jn+1
ACN1 · Vn+1 = ACN2 · Vn − ξ
,
2
(cid:3)
which has the solution
−1 · ACN2 · Vn − ξ
Vn+1 = ACN1
2
Similar to the procedure with the forward and backward Euler algorithms,
we need to compute J n
i from the factors that determine the ionic conductances.
time with the trapezoidal rule, so as to preserve the O ((∆t )2) error in time, as
Once again, we let x stand for m, n, and h, and we discretize this equation, this
(cid:7)
(cid:7)
(cid:7)
(cid:8)(cid:8)
(cid:8)
(cid:8)
(cid:7)
follows
V n+ 1
V n+ 1
V n+ 1
− xn+1
+ βx
∆t
i − xn
xn+1
αx
(cid:7)
(cid:7)
(cid:8)
(cid:7)
(cid:8)
(cid:7)
(cid:8)(cid:8)
2
2
2
i
i
i
i
i
2
αx

J n+1
1
J n+1
2
J n+1
3
...
J n+1
I−1
J n+1
I

V n
1
V n
2
V n
3
...
V n
I−1
V n
I

J n
1
J n
2
J n
3
...
J n
I−1
J n
I




0
...
0
η
2
1 − η
2

0
...
η
2
1 − η
η
2

0
...
1 − η
η
2
0

Jn + Jn+1

= αx





+ βx

−1 ·

ACN1

− ξ
2

(cid:4)

.

V n+ 1
2
i

− xn
i

V n+ 1
2
i

V n+ 1
2
i

+

.

+ αx

2

,

+xn
i

αx

αx

(6.18)

(cid:7)

(cid:8)(cid:8)

xn+1
i

=

(cid:8)(cid:8)
(cid:8)(cid:8)

(cid:7)
V n+ 1
2
i
(cid:7)
V n+ 1
+ βx
2
i
V n+ 1
+ βx
2
i

138

and collect terms to obtain

CHAPTER 6. PROPAGATED ACTION POTENTIAL
(cid:8)
(cid:7)
∆t
(cid:7)
(cid:8)
V n+ 1
2 αx
2
i
(cid:7)
(cid:7)
(cid:8)
V n+ 1
+ βx
2
i
(cid:8)
(cid:7)
(cid:7)
V n+ 1
2
i
V n+ 1
2
i

(cid:7)
1 + ∆t
αx
1 − ∆t
2
1 + ∆t
2
2
With the factors m, n, and h substituted for x , the ionic current can be com-
puted as follows
i = ¯GK (nn+1
i − VK ) + ¯GN a(mn+1
)3hn+1
(Jion)n+1
)4(V n
i
i
i
where each of the factors mn+1
, and hn+1
, nn+1
i
i
i
tion 6.16. The total current is
i + ri(Kei)n+1
i − ro (Keo )n+1
= (Jion)n+1
J n+1
i
2π a(ro + ri)
i
As with the backward Euler algorithm, the factor xn+1
depends upon the po-
i
tential V n+ 1
through the parameters α and β so that iteration must be used to
2
i
arrive at a solution of the 4 simultaneous equations.
For linear, parabolic partial diﬀerential equations, the Crank-Nicolson method
yields stable solutions although not as stable as the backward Euler method,
i.e., spurious bounded amplitude oscillations may appear for large values of in-
crements. In contrast to both the forward and backward Euler algorithms, the
method behaves as O ((∆t )2) + O ((∆x )2) provided appropriate boundary con-
error resulting from temporal and spatial discretization for the Crank-Nicolson
ditions (such as those shown above) are used. Thus, with the Crank-Nicolson
method it is possible to achieve more accurate solutions for large time intervals
than for the backward Euler method.

i − VN a) + GL(V n
i − VL),
(V n
are computed according to Equa-

.

6.3.4 Staggered increment Crank-Nicolson method

A computationally eﬃcient method (Hines, 1984) that avoids iteration of the so-
lution is based on the observation that the Crank-Nicolson diﬀerencing scheme
satisﬁes the partial diﬀerential equation at the discrete time n + 1
2 . This property
 + J n+ 1
 V n+ 1
 V n+ 1
 = 2Cm
can be seen by writing out the expression as follows
∆t
(∆z)2
− 2V n+ 1
+ V n+ 1
− V n
i−1
i+1
2
2
2
2
i
i
i
2
i

1
2π a(ro + ri)

(6.19)

,

6.3. NUMERICAL METHOD OF SOLUTION

139

which results in the following diﬀerence equation
V n+ 1
+ (1 + η)V n+ 1
V n+ 1
− η
− η
= V n
i − ξ
i+1
i−1
2
2
2
i
2
2
2
Note that starting with the membrane potential at discrete time n, the diﬀerence
equation computes (by an implicit method) the potential at n + 1
2 . Then the
potential at discrete time n + 1 is computed by the explicit method
= 2V n+ 1
− V n
V n+1
i .
2
i
i

J n+ 1
2
i

(6.20)

.

.

0

0

0

=

− ξ
2

.

0

0

0

0

0

0

0

0

0

0

0
...
0

0

0

V n+ 1
2
2

)V n+ 1
2
1

0
...
1 + η
− η
2
0

+ (1 + η
2

0
...
− η
2
1 + η
− η
2

0
...
0
− η
2
1 + η
2

− η
2
1 + η
− η
2
0
...
0

V n
1
V n
2
V n
3
...
V n
I−1
V n
I

J n+ 1
2
1
J n+ 1
2
2
J n+ 1
2
3
...
J n+ 1
I−1
2
J n+ 1
2
I

We use the same initial and boundary conditions as for the other algorithms.
By modifying Equation 6.19 at the closed end at i = 1 and collecting terms, the
diﬀerence equation is
(J n+ 1
= V n
1 − ξ
− η
2
1
2
2
A similar equation results at the other end of the ﬁber model so that the matrix


equation is






1 + η
2
− η
2
0
The matrix equation can be written as
2 = Vn − ξ
ACN · Vn+ 1
2
(cid:7)

· · ·
0
· · ·
− η
2
1 + η · · ·
− η
· · ·
2
...
...
· · ·
0
· · ·
· · ·

V n+ 1
2
1
V n+ 1
2
2
V n+ 1
2
3
...
V n+ 1
I−1
2
V n+ 1
2
I

2 = ACN
Vn − ξ
−1 ·
Jn+ 1
Vn+ 1
.
2
2
This scheme requires that the current be evaluated at the time n + 1
2 which
can be done by iteration as described previously or by having two computing
quantization at O ((∆t )2), we need to compute the factors with second-order
time grids staggered by 1
2 units of time. To maintain the error due to time
accuracy by a centered diﬀerence as follows
(cid:28)(cid:28) xn+ 1
(cid:27)
(cid:28) + βx
(cid:27)
(cid:28) − (cid:27)
(cid:27)
i∆t
+ xn− 1
− xn− 1
xn+ 1
2
2
2
2
i
i
i
2

= αx

which has the solution

Jn+ 1
2 ,

(6.21)

V n
i

αx

V n
i

(cid:8)

V n
i

(cid:27)

V n
i

(6.22)

140

CHAPTER 6. PROPAGATED ACTION POTENTIAL
(cid:28)(cid:28)
(cid:27)
(cid:27)
(cid:28) + βx
(cid:27)
(cid:28)
(cid:27)
∆tαx
and collect terms to obtain
1 − ∆t
(cid:28) + βx
(cid:27)
(cid:27)
(cid:27)
(cid:28)(cid:28)
(cid:28)(cid:28) + xn− 1
(cid:28) + βx
(cid:27)
(cid:27)
1 + ∆t
1 + ∆t
xn+ 1
V n
αx
=
i
2
2
2
i
i
V n
αx
αx
i
2
2
With the factors m, n, and h substituted for x , the ionic current can be com-
puted as follows
)3hn+ 1
i − VK ) + ¯GN a(mn+ 1
= ¯GK (nn+ 1
(Jion)n+ 1
)4(V n
2
2
2
2
i
i
i
i
where each of the factors mn+ 1
, and hn+ 1
, nn+ 1
2
2
2
i
i
i
Equation 6.22. The total current is

i − VN a) + GL(V n
i − VL),
(V n

are computed according to

V n
i
V n
i

V n
i
V n
i

J n+ 1
2
i

= (Jion)n+ 1
2
i

− ro (Keo )n+ 1
+ ri(Kei)n+ 1
2
2
i
i
2π a(ro + ri)

.

which allows a computa-

using Equation 6.22 which then allows a computation of

The method is outlined as follows:
i and the value of xn− 1
• Start with the value of V n
2
i
tion of J n− 1
;
2
i
• Compute xn+ 1
2
i
J n+ 1
;
2
i
• Compute V n+ 1
2
i
• Compute V n+1
using Equation 6.20;
i
and the value of xn+ 1
• The solution has now been advanced to V n+1
2
i
i
The process can be initiated by calculating either Vi or xi for a 1
2 time step
increment to stagger the variables.

using Equation 6.21;

.

6.4 User’s Guide to the Software

When the software is selected from the Softcell menu, two ﬁgures are displayed
(in addition to MATLAB’s command window): PAP Control , and PAP Workspace;
the PAP Workspace is distinct from MATLAB’s workspace. The PAP Control ﬁg-
ure allows the user to display other ﬁgures for setup and analysis, and to start
a simulation. The PAP Workspace ﬁgure is (as the name suggests) a workspace
where a schematic representation of an axon, a stimulus source, and a voltage
recorder are displayed. In the PAP Workspace ﬁgure, the user can choose to dis-
play the stimulus setup ﬁgure (PAP Stimulus ), the parameter setup ﬁgure (PAP

6.4. USER’S GUIDE TO THE SOFTWARE

141

Figure 6.3: The PAP Control ﬁgure when the software is
initiated.

Parameters ), the voltage recorder ﬁgure (PAP Voltage-Recorder ), and place the
electrodes of the stimulus source and recorder using the mouse cursor on the
axon schematic. Clicking on the Start pushbutton in the PAP Control ﬁgure re-
sults in the computation of the response as a function of time and space. Upon
completion of the computation, the user can choose to view the space-time evo-
lution of the membrane potential (which is one of the computed solution vari-
ables) by means of a color code along the axon schematic in the PAP Workspace
ﬁgure. The user can also examine the space-time evolution of other response
solution-variables to gain insight to the model’s dynamic behavior or use 3D and
comparison plots for static analyses of the model’s behavior.

6.4.1 PAP Control

There are three panels in the PAP Control ﬁgure (Figure 6.3). With the left panel,
the user can display the PAP Workspace ﬁgure (See Section 6.4.2) and the PAP
Numerics (See Section 6.4.5). In the center (Simulation) panel, the user can spec-
ify the simulation duration and start the simulation by clicking on the Start
pushbutton. The right (Analysis) panel allows the user to do post simulation
analysis of the results. The ﬁrst (Variable summary) option allows the user to
display a numerical summary of all the solution variables. The second (Space-
time evolution) option allows the user to view the dynamics of a solution vari-
able (such as membrane potential, membrane current-components, etc.) as a
function of space with running time. The third (3D plots) option allows the user
to view three-dimensional graphs of any solution variable as a function of time
and space. The fourth (Comparison plots) option allows the user to compare
multiple solution variables as a function of a solution variable of choice (or as a
function of time or space) in two diﬀerent modes: ﬁxed-time or ﬁxed-space.

142

CHAPTER 6. PROPAGATED ACTION POTENTIAL

Starting, pausing, and stopping a simulation

Clicking on the Start pushbutton starts the computation of the solution vari-
ables. While a computation is in progress, the status-bar located along the bot-
tom of the ﬁgure shows the name of the numerical method being used and the
percentage of completion. The Start pushbutton changes to a Pause pushbut-
ton. Clicking on the Pause pushbutton pauses the computation and causes the
status-bar to display Paused. When the simulation is paused, the Pause push-
button changes to a Continue pushbutton. Clicking on the Continue pushbutton
resumes the computation and the two states (pause/continue) toggle with each
click of the pushbutton until the computation is completed. Upon completion,
the pushbutton changes back to Start and the status-bar acknowledges success-
ful completion along with a time stamp. Next to Start is the Stop pushbutton
which allows the user to abort a computation that is currently in progress or
paused. Clicking on the Stop pushbutton causes the status-bar to display Simu-
lation Aborted.

Loading, saving, and re-initializing

The user can save all simulation parameters and results in a ﬁle as well as load
a previously saved ﬁle by clicking on the Save and Open button, respectively.
The data stored includes the parameter values of the axon, the membrane, the
bath, the stimulus, the conﬁguration of the electrodes, and solution variables.
When a ﬁle is loaded, the ﬁlename (along with it’s directory path) is shown in
this ﬁgure’s status-bar as well as in the status-bar of other setup ﬁgures such
as PAP Parameters , PAP stimulus , and PAP numerics. This is useful for keeping
track of the source of the parameter values used during a session.
When the software is launched, the ﬁgure’s status-bar displays Ready . This
indicates that no simulation has been run and that there are no results. This is
the initial state of the software and all parameters are set to their default values.
After parameters have been changed they can be reset to their default values by
clicking on the Default pushbutton.

6.4.2 PAP Workspace

Selecting Workspace in the PAP Control ﬁgure displays the PAP Workspace ﬁgure
(Figure 6.4). The PAP Workspace ﬁgure consists of a window and a control re-
gion. The window contains from top to bottom: a ruler, an interactive display
area (showing a schematic of an axon, a stimulus-source icon, and a voltage-
recorder icon), another ruler, a status-bar, and a horizontal scrollbar. The de-
fault length of the axon is three centimeters and ﬁts in the window’s display
area. The schematic representation of a longer axon model stretches beyond
the display area’s right edge. The user can use the horizontal scrollbar to scroll

6.4. USER’S GUIDE TO THE SOFTWARE

143

Figure 6.4: The PAP Workspace ﬁgure.

to the hidden portion. By default the top ruler is set to show number of dis-
cretized segments, and the bottom ruler is set to show distance in centimeters.
Clicking on either ruler will toggle its unit of measurement between number of
discretized segments and distance. The status-bar shows the simulation time.
Clicking on the Help button located in the lower right corner of the PAP
Workspace ﬁgure displays the PAP Workspace Help ﬁgure. This ﬁgure shows
a step-by-step guide to setting up a customized simulation as described in Sec-
tion 6.4.11.

Positioning electrodes

Stimulus electrodes (yellow) are located above the axon schematic and voltage-
recorder electrodes (grey) are located below the axon schematic. The user can
control the position of an electrode either by pointing and clicking near the
electrode or by clicking and typing in the Electrode Positions panel.
To change electrode locations by the point-and-click method, ﬁrst select the
electrode by clicking on the appropriate radiobutton in the Electrode Positions
panel. Note that the positive and negative electrodes of the stimulus (S+ and
S−) are selected independently from the positive and negative electrodes of the
recorder (R+ and R−). After the appropriate radiobutton is selected, clicking
anywhere outside of the axon schematic within the interactive display area (e.g.,
the black region) sets the electrode’s longitudinal position to the mouse-click lo-
cation. Clicking in the black region above the axon schematic moves the stimulus
electrodes, and clicking in the black region below the axon schematic moves the

144

CHAPTER 6. PROPAGATED ACTION POTENTIAL

recorder electrodes. Both stimulus and recording electrode positions can also be
changed by typing in the relevant text edit boxesin the Electrode Positions panel.
Clicking on an electrode will toggle the electrode position between intracellular
and extracellular. Clicking on the check boxes in the Electrode Positions panel
also allows control of the intracellular/extracellular locations of electrodes. The
check box on the right part of the Electrode Positions panel controls the display of
the voltage recorder and its electrodes. Distances between stimulus electrodes
and between voltage recording electrodes are indicated below the lower ruler.

Displaying other setup ﬁgures

Clicking on the stimulus-source icon (yellow) will bring up the PAP Stimulus ﬁg-
ure where the user can specify the characteristics of the desired stimulus (See
Section 6.4.4). Clicking on the voltage-recorder icon (green and grey) will dis-
play the PAP Voltage-Recorder ﬁgure where a real-time potential curve is plotted
during a simulation run (See Section 6.4.6). Clicking on the axon schematic will
display the PAP Parameters ﬁgure where the user can change the parameters of
the axon, the membrane, and the bath (See Section 6.4.3).

Showing discretization and color-coded space-time evolution

The option (Show discretization) to the right of the Color Space-Time Evolution
panel allows the user to toggle on/oﬀ the spatial discretization display on the
axon schematic.
In the Color Space-Time Evolution panel, the pushbutton Start
allows the user to playback the space-time evolution of the membrane potential
on the axon schematic by using a color code to convey the range of potential
levels. The playback can be stopped using the Stop button. During playback,
the Start becomes a Pause button which allows the user to pause the playback.
The speed of the playback can be adjusted in the Speed ﬁeld located under the
pushbutton. For example, if the simulation data contains membrane potential
values for every 0.01 ms, changing the ﬁeld value to ten will playback simulation
data of every 0.1 ms.
Note that a voltage curve is plotted in the Voltage-Recorder ﬁgure during
playback (See Section 6.4.6). Figure 6.5 shows a series of snapshots taken from
a time-evolution color code visualization of the membrane potential of a three-
centimeters long axon model.

6.4.3 PAP Parameters

Clicking on the axon schematic in the PAP Workspace ﬁgure displays the PAP
Parameters ﬁgure (Figure 6.6). The PAP Parameters ﬁgure is divided into three
sections: Membrane Characteristics , Bath Characteristics , and Axon Characteris-
tics . In each section, there are three columns for each parameter: the ﬁrst col-

6.4. USER’S GUIDE TO THE SOFTWARE

145

Figure 6.5: Snapshots of a propagating action potential shown
using Color Space-Time Evolution in the PAP Workspace ﬁgure.

146

CHAPTER 6. PROPAGATED ACTION POTENTIAL

Figure 6.6: The PAP Parameters ﬁgure.

6.4. USER’S GUIDE TO THE SOFTWARE

147

umn identiﬁes the parameter, the second gives its default value, and the third
column shows the value of the parameter if it is modiﬁed from its default value
(Note that the PAP Parameters ﬁgure data entry method is based on that of the
HH Parameters ﬁgure).

Changing parameter values

Parameters can be modiﬁed by clicking on the entry in the third column of the
parameter ﬁeld. When the parameter is selected, its third column entry is re-
placed by an edit box. Clicking any mouse button inside the edit box allows the
parameter to be changed. The new value of the parameter is entered from the
keyboard; < RETURN > terminates the parameter entry. If the new value diﬀers
from the default value, then the new value will appear in the third column. With
this method of display, the parameter list can be scanned quickly to indicate
which parameters diﬀer from their default values.
There are some restrictions on the numerical values of parameters; G’s ≥ 0,
Cm ≥ 0, c ’s > 0, K ’s > 0, ρi ≥ 0, ro ≥ 0 (ro cannot be zero when ρi = 0),
the axon’s radius and length must be greater than zero, and the temperature
must be above absolute zero. The derived parameters cannot be changed but
are derived from the other parameters and are displayed for the convenience of
the user. For example, the sodium equilibrium potential VN a cannot be changed
directly by the user, but changes automatically when the sodium concentrations
or temperature are changed.

Loading, saving, resetting, and printing

The parameters can be loaded from a ﬁle by clicking on Open and can be saved
by clicking on Save. Saving and loading in the PAP Parameters ﬁgure deals only
with the model’s axon, membrane and bath parameters; e.g., simulation results
are not loaded or saved. When a parameters ﬁle is loaded, the status-bar of the
PAP Parameters ﬁgure displays the ﬁlename (with the directory path) and the
parameter values loaded from the ﬁle become the default values. For example,
if the user changes the temperature value and clicks the Reset pushbutton, the
temperature value resets to the value stored in the loaded ﬁle. To reset the
parameter values to their software-default values, use the Default pushbutton in
the PAP Control ﬁgure. If no ﬁle is loaded, clicking the Reset pushbutton resets
the parameter values to the software-default values. The PAP Parameters ﬁgure
can be printed using the Print button.

Viewing the voltage dependent parameters

The Hodgkin-Huxley model of a propagated action potential as well as the Hodgkin-
Huxley model of a membrane action potential of a space-clamped axon contains
several parameters that are instantaneous functions of the membrane potential.

148

CHAPTER 6. PROPAGATED ACTION POTENTIAL

Plots of these parameters are available as a function of Vm for the following:
αm (Vm ), βm (Vm ), m∞(Vm ), τm (Vm ), αh(Vm ), βh(Vm ), h∞(Vm ), τh(Vm ), αn(Vm ),
βn(Vm ), n∞(Vm ), τn(Vm ) (see Section 5.2.3). These can be accessed by clicking
on the button marked α, β, τ , h, m, n which results in the display of the PAP
Parameters vs. Potential ﬁgure (Figure 6.7).

Figure 6.7: The PAP Parameters vs. Potential ﬁgure.

Note that the PAP Parameters vs. Potential ﬁgure is similar to the PAP Com-
parison Plots ﬁgure described in Section 6.4.10. Please refer to that section for
more information about the available plot manipulation functions. The PAP Pa-
rameters vs. Potential ﬁgure has its own setup ﬁgure which diﬀers from the one
of the PAP Comparison Plots . Clicking on the Setup button displays this setup
ﬁgure. The user can select one or more variables and click on either Graph
or Overlay to make the plot. The Graph and Overlay buttons are described in
Section 6.4.10.

6.4. USER’S GUIDE TO THE SOFTWARE

149

Figure 6.8: The PAP Stimulus ﬁgure.

6.4.4 PAP Stimulus

Clicking on the stimulus-source icon (yellow) in the PAP Workspace ﬁgure dis-
plays the PAP Stimulus ﬁgure (Figure 6.8). Note that the layout of the PAP Stim-
ulus ﬁgure is similar to that of the HH Stimulus ﬁgure. The upper-half of the
ﬁgure shows a graph of the stimulus pulse(s) speciﬁed in the parameter-entry
columns: Pulse 1 and Pulse 2 . The duration of the stimulus depends on the du-
ration of the simulation speciﬁed in the PAP Control ﬁgure. For example, if the
simulation duration is four milliseconds, then the abscissa of the stimulus graph
is also of length four milliseconds.

Specifying a pulse

A maximum of two pulses can be deﬁned using a set of parameters for each
pulse. In addition, a holding DC current can be speciﬁed in the Holding current
ﬁeld. Thus, the overall stimulus is the sum of a constant plus two indepen-
dently speciﬁable pulses. In mathematical terms, the stimulus, s (t ), is deﬁned
as follows

s (t ) = s o + s 1(t ) + s 2(t ),

(6.23)

150

CHAPTER 6. PROPAGATED ACTION POTENTIAL

(6.24)

s i(t ) =

where s o is a constant and s 1(t ) and s 2(t ) are independently speciﬁable pulses.
 mi(t − t i
Each pulse has the form
o ) + Aie−(t−t i
if to ≤ t ≤ to + tdur ,
o )/τ i
otherwise,
0
where pulse i (i = 1 or 2) starts at to and has a duration tdur . The amplitude
of the pulse is Ai , the slope is mi , and the time constant is τ i . If the slope and
the time constant are set to zero, then the remaining parameters specify the
amplitude, duration and onset time of a rectangular pulse.
If the slope has a
non-zero value, a ramp of that slope is added to the rectangular pulse for the
duration of the pulse. Similarly, if the time constant has a non-zero value, then
an exponential pulse with the selected time constant is added to the waveform.
The time constant can be positive or negative.
o , t i
The variables t i
dur , Ai , mi , and τ i that deﬁnes a pulse in the form of Equa-
tion 6.24 are speciﬁed in the PAP Stimulus ﬁgure by the parameter ﬁelds Start ,
Duration, Amplitude, Slope, and Time constant in the Pulse i column, respec-
tively. By adjusting these parameters, the user can generate rectangular pulses,
ramp pulses, exponential pulses or a combination of these. An example is shown
in Figure 6.9.

Loading, saving, and resetting

The parameters can be loaded from a ﬁle by clicking on Open and can be saved
by clicking on Save. Saving and loading in the PAP Stimulus ﬁgure deals only with
the stimulus parameters; e.g., simulation results are not loaded or saved. When
a ﬁle with stimulus parameters is loaded, the status-bar of the PAP Stimulus
ﬁgure displays the ﬁlename (with the directory path) and the parameter values
loaded from the ﬁle become the default values. For example, if the user changes
the holding current value and clicks the Reset pushbutton, the holding current
value resets to the value stored in the loaded ﬁle. To reset the parameter values
to their software-default values, use the Default pushbutton in the PAP Control
ﬁgure. If no ﬁle is loaded, clicking the Reset pushbutton resets the parameter
values to the software-default values.

6.4.5 PAP Numerics

Selecting Numerics in the PAP Control ﬁgure displays the PAP Numerics ﬁgure
(Figure 6.10). The PAP Numerics ﬁgure allows the user to select the numerical
method used to solve the partial diﬀerential equations described in Section 6.2.

6.4. USER’S GUIDE TO THE SOFTWARE

151

Figure 6.9: The PAP Stimulus ﬁgure showing a stimulus
that consists of two pulses: the ﬁrst pulse is an expo-
nential pulse and the second is a ramp plus a rectangular
pulse.

Choosing a numerical method and specifying discretization parameters

The list-box located at the top of the ﬁgure allows the user to select one of four
available numerical methods: forward Euler, backward Euler, Crank-Nicolson,
and staggered Crank-Nicholson (staggered C-N). These numerical methods are
described in detail in Section 6.3. By default, the software uses the staggered C-N
which requires two discretization parameters: a time step, ∆t , and a spatial
numerical method. All numerical methods employ the ﬁnite diﬀerence method
step, ∆z . Decreasing the time step produces a smoother time evolution of the
solution variables (for example, a smoother action potential propagation), but
computation time and memory usage increases. Decreasing the space step pro-
duces an axon schematic with more discrete elements – hence a smoother spatial

Figure 6.10: The PAP Numerics ﬁgure.

152

CHAPTER 6. PROPAGATED ACTION POTENTIAL

evolution of the solution variables (for example, a smoother membrane-potential
curve as a function of space when viewed in a snapshot), but computation time
and memory usage increases. In order to obtain a reasonably accurate solution
using a particular numerical method, the discretization parameters have to be
chosen appropriately.

Loading, saving, resetting, and printing

The parameters can be loaded from a ﬁle by clicking on Open and can be saved by
clicking on Save. Saving and loading in the PAP Numerics ﬁgure deals only with
the numerics parameters; e.g., simulation results are not loaded or saved. When
a numerics parameters ﬁle is loaded, the status-bar of the PAP Numerics ﬁgure
displays the ﬁlename (with the directory path) and the parameter values loaded
from the ﬁle become the default values. For example, if the user changes the time
step and clicks the Reset pushbutton, the time step resets to the value stored in
the loaded ﬁle. To reset the parameter values to their software-default values,
use the Default pushbutton in the PAP Control ﬁgure. If no ﬁle is loaded, clicking
the Reset pushbutton resets the parameter values to the software-default values.
The PAP Numerics ﬁgure can be printed using the Print button.

6.4.6 PAP Voltage-Recorder

Clicking on the voltage-recorder icon (grey and green) in the PAP Workspace
ﬁgure displays the PAP Voltage-Recorder ﬁgure (Figure 6.11). The PAP Voltage-
Recorder ﬁgure shows a graphing region where a voltage curve is plotted when
the user clicks on the Start button located in the PAP Workspace ﬁgure. When
plotting a curve, the graphing area can display only a portion 3 ms long.
If
the plot extends beyond 3 ms, the scrollbar under the graphing area becomes
active, so the user can scroll to see any section of the curve. Also, a Show entire
plot option is enabled, so the user can choose to display the whole curve on
the graphing area. For example, shrink the abscissa to ﬁt the entire plot in the
graphing region.
The voltage plot corresponds to the voltage recorded at the location of the
recording electrodes located beneath the axon schematic. The user can re-
position the recording electrodes as described in Section 6.4.2 and click on Start
to obtain the corresponding voltage plot. Clicking on the Grid option displays a
grid on the graphing region.
Markers can be set to measure the times of occurrence of features in the
waveform. Clicking on the t1 marker and clicking on the plot, results in a red,
vertical line; clicking again ﬁxes the time of occurrence of that line. The same
can be done with the t2 marker. The time of occurrence of each of the markers
and the diﬀerence in time between the two markers are displayed at the top of
the ﬁgure.

6.4. USER’S GUIDE TO THE SOFTWARE

153

Figure 6.11:
The PAP Volt-
age-Recorder ﬁgure.

6.4.7 PAP Variable Summary

Selecting Variable summary in the Analysis panel of the PAP Control ﬁgure dis-
plays the PAP Variable Summary ﬁgure as shown in Figure 6.12. This ﬁgure
allows the user to display the initial, minimum, and maximum value of any solu-
tion variable. The user can either select to view these summary values obtained
from the spatial dimension at a speciﬁed time, or from the temporal dimension
at a speciﬁed location. The time and location are speciﬁed in units of millisec-
onds and centimeters, respectively. The largest valid time value is equal to the
simulation duration, and the largest valid location value is equal to the length of
the axon model.

6.4.8 PAP Space-Time Evolution

Selecting Space-time evolution in the Analysis panel of the PAP Control ﬁgure
displays the PAP Space-Time Evolution ﬁgure as shown in Figure 6.13. This ﬁgure
only appears if there are simulation results (i.e. after a simulation has been run).
The PAP Space-Time Evolution ﬁgure provides a means of viewing the dynamics
of any solution variable along the axon as time changes.

Viewing the space-time evolution of a solution variable

When the ﬁgure is ﬁrst displayed, Vm (membrane potential) is selected in the
list-box located at the top of the ﬁgure. Use the list-box to view any desired
solution variable. After a selection is made, the graph under the list-box shows

154

CHAPTER 6. PROPAGATED ACTION POTENTIAL

Figure 6.12: The PAP Variable Summary ﬁgure.

6.4. USER’S GUIDE TO THE SOFTWARE

155

Figure 6.13: The PAP Space-Time Evolution ﬁgure showing
a snapshot of a propagating action potential.

the selected solution variable as a function of space at time = 0 ms. To view
the selected solution variable as a function of space at progressing time starting
from 0 ms, click on the Start pushbutton. The process can be stopped and
paused using the appropriate buttons. The Start button changes to a Pause
button when a process is running. Clicking on an axis label displays the Axis
conﬁguration ﬁgure (Figure 6.18) which allows the user to change the properties
of the axis.

6.4.9 PAP 3D Plots

Selecting 3D plots in the Analysis panel of the PAP Control ﬁgure displays the
PAP 3D Plots ﬁgure (Figure 6.14). This ﬁgure only appears if there are simulation
results (i.e. after a simulation has been run). The PAP 3D Plots ﬁgure provides a
means of visualizing the space-time dependence of any solution variable.

Viewing a 3D plot of a solution variable

When the ﬁgure is ﬁrst displayed, Vm (membrane potential) is selected in the
list-box located at the top of the ﬁgure. Use the list-box to view any desired
solution variable. After a selection is made, the surface plot beneath the list-
box shows the selected solution variable as a function of space and time. The
colorbar on the right indicates the magnitude of the colored surface plot. To
change the view angle use the horizontal scrollbar located at the bottom and the
vertical scrollbar located on the left of the plot. The vertical scrollbar controls

156

CHAPTER 6. PROPAGATED ACTION POTENTIAL

the viewing elevation (i.e. rotates the plot up and down), and the horizontal
scrollbar controls the viewing azimuth (i.e. rotates the plot left and right).
In
addition, the user can switch between mesh and surface plot by toggling the
mesh option on/oﬀ . Since the mesh plot samples the surface of the variable as
a function of space and time, care must be taken with evaluating 3D mesh plots
of discontinuous functions.
Clicking on the box option toggles on/oﬀ an axes-bounding box. Clicking on
a solution variable’s axis label displays the Axis conﬁguration ﬁgure (Figure 6.18)
which allows the user to change the properties of that axis.

6.4.10 PAP Comparison Plots

Selecting Comparison plots in the Analysis panel of the PAP Control ﬁgure dis-
plays the PAP Comparison Plots ﬁgure as shown in Figure 6.16. The PAP Compar-
ison Plots ﬁgure allows the user to plot any solution variable against any other.
The ﬁgure displays a group of pushbuttons on the upper-left corner, a legend
panel on the upper-right corner, and a graphing region.

Using the Comparison Plots Setup ﬁgure to generate plots

Clicking on the Setup button in the PAP Comparison Plots ﬁgure displays the
Comparison Plots Setup ﬁgure (See Figure 6.15) where the user can choose: ﬁxed-
space plots (Figure 6.16) or ﬁxed-time plots (Figure 6.17). Fixed-space plots
require the user to specify a longitudinal location of the axon, zo , in units of
centimeters. The user can use this mode to generate solution-variable-A vs. solu-
tion variable-B at location, zo , plots . Fixed-time plots require the user to specify a
time, to , in units of milliseconds. This mode is used to generate solution-variable-
A vs. solution-variable-B at time, to , plots .
Follow these steps to make a plot:
• Choose a plotting mode: ﬁxed-space plots or ﬁxed-time plots.
• For ﬁxed-space plots specify the Distance parameter: enter a value in units
of centimeters. Note that the maximum allowable value is the length of the
axon model. Multiple distance values can also be entered in MATLAB array
format (i.e. [1.0 1.5 3.5], [1.0 : 0.05 : 2.0]). Please refer to the MATLAB
user’s manual for more information.
• For ﬁxed-time plots specify the Time parameter: enter a value in units
of milliseconds. Note that the maximum allowable value is equal to the
simulation duration. Multiple time values can also be entered in MATLAB
array format.
• Choose a solution variable in the X-Variable panel: this is the independent
variable and it corresponds to the the values along the abscissa.

6.4. USER’S GUIDE TO THE SOFTWARE

157

Figure 6.14: The PAP 3D Plots ﬁgure showing a propagat-
ing action potential. Top: a surface plot. Bottom: a mesh
plot.

158

CHAPTER 6. PROPAGATED ACTION POTENTIAL

Figure 6.15: The Setup PAP Comparison Plot ﬁgure show-
ing the variables used to setup Figure 6.16.).

• Choose one or more solution variables in the Y-Variable panel: multiple
dependent variables can be plotted for comparison. They are all plotted as
a function of the solution variable selected in the X-Variable panel. Depen-
dent variables that have same unit of measurements share one ordinate
axis. Both sides of the plotting area may show distinct ordinate axes to ac-
comodate distinct units of the variables selected. For example, the user can
choose to plot the membrane potential, Vm , and the sodium conductance,
GN a , both as a function of time, t . In this case, the user would select t in
the X-Variable panel, and both Vm and GN a in the Y-Variable panel. Since
Vm is in units of millivolts and GN a is in units of mS/cm2 , the plot should
show two ordinate axes. The abscissa, in this case, should be in units of
milliseconds.
• Click on Graph to graph the selections on a cleared plotting region. The
Graph pushbutton clears all previous plots. Click on Overlay to graph the
selection on the plotting region without clearing any previous plots. This
feature allows the user to overlay the solutions obtained from diﬀerent
simulations. For example, suppose the user wants to plot the membrane
potential, Vm , as a function of time, t , at the axon longitudinal location,
zo = 2 cm, for temperature values of 6.5
◦
◦
◦
, 18
, and 20
Celsius. The user
would need to run a simulation with the temperature parameter set to 6.5,
plot Vm vs. t at zo = 2 using the Graph button. Then do the subsequent
simulation runs with the the other two temperature values and plot using
the Overlay button so that all three plots are retained in the plotting region.

In addition, the user can make plots using data stored in ﬁles. To do this,

6.4. USER’S GUIDE TO THE SOFTWARE

159

Figure 6.16: The PAP Comparison Plots ﬁgure showing a
ﬁxed-space plot of the membrane potential, Vm , and the
ionic conductances, GN a and GK , with model parameters
and the stimulus deﬁned in Figures 6.6 and 6.8.

160

CHAPTER 6. PROPAGATED ACTION POTENTIAL

Figure 6.17: The PAP Comparison Plots ﬁgure showing a
ﬁxed-time plot of the membrane potential, Vm , and the ac-
tivation factors, m and h, obtained from a simulation with
model parameters and the stimulus deﬁned in Figures 6.6
and 6.8.

6.4. USER’S GUIDE TO THE SOFTWARE

161

Figure 6.18: The PAP Axis Scale ﬁgure.

select the Files with Parameters option and click on the Select ﬁles pushbutton.
A ﬁle-loading dialog box appears which allows the user to select the data ﬁle(s).
The user can then plot the loaded solution variables.

Annotating, zooming, and other functions

The PAP Comparison Plots ﬁgure has a few functions that facilitates the analysis
of the plots.
• Clicking on the Cross-line pushbutton
displays a vertical line in the plot
region at the location of the pointer cursor. The line follows the cursor as
it moves across the plot region. The values of all plotted variables at the
intersection with the cross-line are displayed in the Legend panel, under
the column labeled Cross-line . Clicking on the Cross-line button again
removes the cross-line values from the legend and removes the cross line
from the plotting region.
• Clicking on the A button allows the user to make annotations on the plot.
With this button set to on, click on a desired location in the plot to dis-
play a text edit box at that location. Click in the text edit box, type the
annotation followed by a <RETURN> when the annotation is completed.
Clicking on the annotation and dragging the mouse moves the annotation
to a desired location in the plot ﬁeld. The text string can be formatted into
mathematical notation by using a LATEX like notation, e.g., to get m∞ type
m_{\infty}.
• Clicking on the + button next to the annotation button allows the user
to magnify a region of the plotting region by clicking on it. Clicking again
causes further magniﬁcation. Clicking on the - button causes the plot to
change to its original magniﬁcation.
• In the plotting region, clicking on any of the axis labels (i.e. either the
abscissa or any of the ordinates) displays an axis scale ﬁgure (Figure 6.18)
which allows the user to change parameters of the chosen axis. The range
of the axis can be speciﬁed in MATLAB array format (i.e. [-200 200]) in the

162

CHAPTER 6. PROPAGATED ACTION POTENTIAL

Figure 6.19: The Modify Line
Properties ﬁgure.

Range ﬁeld. The range is set to rescale automatically by default. To inhibit
auto-scaling, unselect the Auto option. Selecting the Log option changes
the axis scale to a logarithmic scale (i.e. the logarithm of the magnitude
of the variable is plotted). Selecting the Inverse [1/] option produces a
reciprocal scale axis. (i.e. the reciprocal of the magnitude of the variable is
plotted). A combination of the two is allowed.
• In the Legend panel, clicking on any entry under the column labeled Marker
displays a modify line properties ﬁgure (Figure 6.19) which allows the user
to customize the color, line style, line width, marker type, and marker size
of the selected plot curve. The color ﬁeld is speciﬁed in RGB values in a
MATLAB array (i.e. to specify the primary color, red, use [1 0 0]).
• In the Legend panel, clicking on any entry under the column labeled Name
causes the curve associated with that entry’s variable to alternately display
and hide. Hiding and displaying curves causes the axes to rescale automat-
ically unless the auto-scaling function of the particular axis is disabled by
means of the axis scale ﬁgure described above.

Loading, saving, and printing

The user can save the plots by clicking on the Save pushbutton. All lines, axis
scale and annotations are saved. The Open pushbuttons loads a previously saved
ﬁle. The plots can be printed using the Print button.

6.4.11 Step-by-step Guide To Setting Up A Customized Simula-
tion

Launch the software from the Softcell menu. Once the application has started,
two ﬁgures will be displayed: the PAP Control ﬁgure, and the PAP Workspace
ﬁgure. All model parameters are started in their default values. To start setting
up a simulation with customized parameter values, complete all or any of the
following steps:

6.5. PROBLEMS

163

1. Change the membrane, axon, and bath parameter values: in the PAP Workspace
ﬁgure, click on the axon schematic. The PAP Parameters ﬁgure is displayed.
Adjust any parameter as described in Section 6.4.2. Clicking on the axon
schematic again closes the PAP Parameters ﬁgure.

2. Change the stimulus-pulse parameter values: in the PAP Workspace ﬁgure,
click on the stimulus-source icon (yellow ﬁlled-circle with an arrow inside).
The PAP Stimulus ﬁgure is displayed. Adjust any parameter as described
in Section 6.4.4. Clicking on the stimulus-source icon again closes the PAP
Stimulus ﬁgure.

3. Position the stimulus electrodes: in the PAP Workspace ﬁgure, select the ap-
propriate radiobutton in the Electrode Positions panel (i.e. cathode/anode-
electrode). To position the selected electrode longitudinally along the axon
schematic, click on the black region between the top ruler and the schematic.
The desired electrode moves to the position of the mouse cursor. Click on
the electrode to toggle its position between intracellular and extracellular.
Note that the icon of an intracellular electrode touches the axon schematic,
whereas an extracellular electrode does not.

4. Position the voltage-recording electrodes: in the PAP Workspace ﬁgure, se-
lect the appropriate radiobutton in the Position Electrode panel. Click on
the black region between the bottom ruler and the axon schematic to move
the desired electrode to the position of the mouse cursor. Click on the
electrode to toggle its position between intracellular and extracellular.

5. Change the numerics values: in the PAP Control ﬁgure, click on the Numer-
ics option. The PAP Numerics ﬁgure is displayed. Adjust any parameter as
described in Section 6.4.5.

6. Change the simulation duration: in the PAP Control ﬁgure, enter the simu-
lation duration in milliseconds.

7. Start simulation: in the PAP Control ﬁgure, click on the pushbutton Start .
Note that when a simulation has started, the Start pushbutton changes to
a Pause pushbutton. Clicking on Pause pauses the simulation. Click on
Continue to resume. Click on the Stop pushbutton anytime to abort.

6.5 Problems

Problem 6.1 The purpose of this problem is to estimate the conduction velocity of
the action potential. Using the default parameters of the Hodgkin-Huxley model,
devise a method to estimate the conduction velocity of the action potential. De-
scribe your method carefully and give a numerical estimate of the conduction
velocity for the default parameters.

164

CHAPTER 6. PROPAGATED ACTION POTENTIAL

Problem 6.2 The purpose of this problem is to investigate the dependence of the
propagated action potential on resistance per unit length of the inner and outer
conductors and the relation of these results to the notion of a space clamp.

a. Run the simulation using the default parameters. Examine the membrane
potential as a function of space and time. You may wish to use the three-
dimensional plots or to use the comparison plots to plot the membrane
potential as a function of time for locations from 0.5 cm to 2.5 cm every
0.2 cm.
b. Reduce the resistivity of the intracellular conductor ρi to 10 Ohm·cm. Run
the simulation again and examine the membrane potential as a function of
space and time.
c. Reduce the resistivity of the intracellular conductor ρi to 1 Ohm·cm. Run
the simulation again and examine the membrane potential as a function of
space and time.
d. Reduce the resistivity of the intracellular conductor ρi to 0.1 Ohm·cm. Run
the simulation again and examine the membrane potential as a function of
space and time.
e. Keep the resistivity of the intracellular conductor ρi to 0.1 Ohm·cm but
increase the resistance per unit length of the outer conductor ro to 10,000
Ohm/cm. Run the simulation again and examine the membrane potential
as a function of space and time.

f. What do you conclude about the dependence of the membrane potential on
space and on time as the internal and external resistance per unit length
are decreased?

g. How are these results related to the notion of a space clamp? How are these
results related to the notion of an electrically large cell and an electrically
small cell.

h. Explain how you could reduce the eﬀective resistivity of the inner conduc-
tor ρi in an experiment on an axon.

Problem 6.3 The purpose of this problem is to investigate the step response of
the Hodgkin-Huxley model with the nonlinear elements removed. Determine the
stimulus and numerical parameters required to examine the step response of
the Hodgkin-Huxley model when stimulated at z = 1.5 cm with the nonlinear
elements removed, i.e., set GN a = GK = 0. Perform simulations with ρi = 35.4
Ohm·cm and for ρi = 0.001 Ohm·cm. Save the results in ﬁles. In the various
parts of this problem, you will examine the solutions that you have already com-
puted and saved.

6.5. PROBLEMS
165
a. For ρi = 35.4 Ohm·cm, examine the dependence of the membrane poten-
tial on space at various times by plotting Vm versus z at diﬀerent times.
Describe the results as precisely as possible.
b. For ρi = 0.001 Ohm·cm, examine the dependence of the membrane poten-
tial on space at various times by plotting Vm versus z at diﬀerent times.
Describe the results as precisely as possible. Compare these results with
those of part a.
c. For ρi = 35.4 Ohm·cm, examine the dependence of the membrane potential
on time at various positions by plotting Vm versus t at diﬀerent positions.
Describe the results as precisely as possible.
d. For ρi = 0.001 Ohm·cm, examine the dependence of the membrane po-
tential on time at various positions by plotting Vm versus t at diﬀerent
positions. Describe the results as precisely as possible. Compare these
results with those of part c.

Problem 6.4 The purpose of this problem is to investigate the relations among the
membrane potential, the intracellular potential, and the extracellular potential.

a. Run the simulation with the default parameters.

i. Examine the space-time evolution of Vm , Vi , and Vo . Describe the rela-
tion among these three variables. Explain these results.
ii. Using the comparison plots, plot Vm , Vi , and Vo versus position at the
time t = 0.4 ms and at the time t = 1 ms. Describe the relation among
these three variables at the two times and explain these results.

b. Set ro to equal the default value of ri and repeat part a.

c. Compare the results in parts a and b and explain the diﬀerences.

Problem 6.5 The purpose of this problem in to relate the membrane potential
as a function of space to the membrane potential as a function of time during a
propagated action potential.

a. Run the simulation using the default parameters. Compare the membrane
potential as a function of time at 2 cm with the membrane potential as a
function of position at 1 ms. Determine the relation between these two
waveforms.

b. Move the electrode S+ (keeping it intracellular) to position 2.9 cm and run
the simulation again. Once again compare the membrane potential as a
function of time at 2 cm with the membrane potential as a function of
position at 1 ms. Determine the relation between these two waveforms.

166

CHAPTER 6. PROPAGATED ACTION POTENTIAL

c. The relation between the membrane potential as a function of time and of
position for part a diﬀers from that in part b. Explain the diﬀerence.

Problem 6.6 The purpose of this problem in to examine the relation between the
membrane potential as a function of time and the longitudinal current as a func-
tion of time during a propagated action potential.

a. Run the simulation using the default parameters.

i. Compare the membrane potential as a function of time with the exter-
nal longitudinal current Io as a function of time at the position 2 cm.
Determine the relation between these two waveforms.
ii. Compare the external longitudinal current Io as a function of time with
the internal longitudinal current Ii as a function of time. Pay particular
attention to t < 0.5 ms and to t > 0.5 ms. What is the relation of these
two variables in these two time ranges. Explain these results.

b. Move the intracellular electrode (S+ ) to position 2.9 cm and run the simu-
lation again.

i. Once again compare the membrane potential as a function of time
with the external longitudinal current as a function of time at the po-
sition 2 cm. Determine the relation between these two waveforms.

ii. Compare the results of parts a-i and b-i. Explain the diﬀerences.

Problem 6.7 The purpose of this problem in to examine the relation among the
membrane potential, the longitudinal currents, the membrane current density
and the capacitance current all as functions of time during a propagated action
potential.
Run the simulation using the default parameters.

a. Using the comparison plots, compare Vm and Ii as a function of time at a
location of 1.5 cm. What is the relation and why?

b. Using the comparison plots, compare Vm and JC as a function of time at a
location of 1.5 cm. What is the relation and why?

c. Using the comparison plots, compare Ii and JC as a function of time at a
location of 1.5 cm. What is the relation and why?

d. Using the comparison plots, compare Ii and Jm as a function of time at a
location of 1.5 cm. What is the relation and why?

e. Using the comparison plots, compare Vm and Jm as a function of time at a
location of 1.5 cm. What is the relation and why?

6.5. PROBLEMS

167

f. Using the comparison plots, compare Ii and Io as a function of time at a
location of 1.5 cm. What is the relation and why?

Problem 6.8 The purpose of this problem is to examine the waveform of the prop-
agated action potential at various locations along the axon. Use the default pa-
rameters of the model except arrange the stimulating electrodes as follows: S−
is extracellular and located at position 1 (discrete segment 1 located at 0 cm)
and S+ is intracellular and located at position 20 (1 cm). The stimulus current
provided by the current source (which can be seen by clicking on the current
source) ﬂows from S− to S+ and is 0.05 mA with a duration of 0.5 ms. Run the
simulation and compare Vm at the locations 1, 1.5, 2, 2.5 cm by plotting all 4
traces on one axis using the Comparison Plots.

a. Does the all-or-none principal apply at all the positions along the axon?

b. Explain the diﬀerences in waveshape at the diﬀerent locations along the
axon. You may wish to plot additional variables on your plot of Vm .

Problem 6.9 This problem concerns the direction of a current stimulus that elicits
a propagating action potential. The parameters of the model are the default val-
ues as indicated. Throughout this problem, the stimulus electrodes are located
as follows: S− is located at position 1 (discrete segment 1) and S+ is located at
position 30.

a. Simulations with one intracellular and one extracellular electrode.

i. Set S− to be extracellular and S+ to be intracellular. The stimulus
current provided by the current source (which can be seen by clicking
on the current source) ﬂows from S− to S+ and is 0.05 mA with a
duration of 0.5 ms. Run the simulation and determine whether an
action potential occurs and, if so, at which electrode(s) it arises.
ii. With all other parameters the same as in part a-i, make S− intracellular
and S+ extracellular. Run the simulation and determine whether an
action potential occurs and, if so, at which electrode(s) it arises.
iii. Draw a diagram of current ﬂow about the axon and through the cur-
rent source for the two cases considered in parts a-i and a-ii. Describe
the conditions for the occurrence of an action potential and explain
the polarity of Vm when an action potential does not occur.

b. Simulations with two extracellular electrodes.

i. Set the stimulating electrodes and the stimulating current identical
to that in part a-i except make both current electrodes extracellular.
Run the simulation and determine whether an action potential occurs

168

CHAPTER 6. PROPAGATED ACTION POTENTIAL

and, if so, at which electrode(s) it arises. Examine the two longitudinal
currents Ii and Io and and the membrane current Jm and explain these
results.
ii. With the default settings in part b-i, ro = 0 which crudely simulates
an axon in a large volume of sea water. This assumption is reasonable
for computing whether or not an action potential occurs since only
the sum ro + ri occurs in these equations and for an axon in a large
volume of sea water ro (cid:20) ri . But assuming that ro = 0 does not
give a good approximation for determining longitudinal currents, for
example. Therefore, in this part of the problem, increase ro to 20,000
Ohm/cm so that it is roughly comparable to ri . This value of ro can be
achieved experimentally by putting an axon in an insulating medium
(oil, air, deionized sucrose) so that only a thin layer of sea water clings
to the axon. Run the simulation and determine whether an action
potential occurs and, if so, at which electrode(s) it arises. Examine Ii ,
Io , and Jm . What do you conclude?
iii. Keep all the stimulus parameters the same as in b-ii except make both
stimulating electrodes intracellular. Run the simulation and determine
whether an action potential occurs and, if so, at which electrode(s) it
arises.
iv. Return to the conditions of part b-ii except reverse the polarity of the
stimulus current, i.e., make its amplitude −0.05 mA. Run the simula-
tion and determine whether an action potential occurs and, if so, at
which electrode(s) it arises.

c. Integrate the results you have obtained in parts a and b to come to a general
conclusion about the key properties of an electric current stimulus that
elicits an action potential.

Problem 6.10 The purpose of this problem is to investigate what happens when
two action potentials travelling in opposite directions collide.

a. Start with the default parameters, and adjust the stimulus electrodes so
that an action potential is produced both at 0 cm and at 3 cm. You will need
to understand the direction of a current stimulus that elicits and action
potential. You may wish to explore Problem 6.9 to aid you to understand
this matter. [HINT: Note also that the default value for ro = 0 so that little
of the stimulus current from an extracellular electrode enters the axon.
Therefore, you may wish to adjust the value of ro .]

b. By plotting the results using the various plotting tools, determine what has
happened. Did the action potentials pass through each other or did they
annihilate each other? Suggest an explanation for your results.

6.5. PROBLEMS

169

Problem 6.11 The purpose of this problem is to explore the bases of the sub-
threshold oscillatory response of the model to a step of current.
Start with the
default parameters except as follows: set the duration of the current pulse to
10 ms and its amplitude to 0.0001 mA. Set the duration of the simulation to
10 ms in the PAP Control ﬁgure. Run the simulation and examine the results.
You should ﬁnd that the membrane potential contains a highly damped slow
oscillation at the onset which constitutes the step response. The purpose of this
problem is to determine the basis of the oscillation.

a. Devise an experiment to determine whether the relation of the stimulus
current to the membrane potential is a linear relation for current stimulus
parameters near those given above. What do you ﬁnd?

b. Investigate whether the variation in membrane potential with position is
somehow responsible for the shape of the step response, in particular, the
presence of the oscillations.

i. Devise a simulation experiment that will eliminate the spatial variation
of the membrane potential and run a simulation.

ii. Demonstrate that the spatial variation you set out to eliminate is in
fact eliminated.

iii. Are the oscillations eliminated?

iv. Which aspects of the step response are changed and why?

c. If oscillations are still present in the step response, devise simulation ex-
periments to determine their origin.

d. Discuss how the results you have obtained in the previous parts are related
to the cable model of an axon?

Problem 6.12 The purpose of this problem is to explore the variables associated
with a propagated action potential near the end of the model axon.
Use the
default parameters to compute the propagated action potential.

a. Using the comparison plots, plot Ii and Io versus time at positions of 2.9
and 3 cm. Explain the diﬀerences in longitudinal currents with position.

b. Using the comparison plots, plot Jm versus time at positions of 2.9 and 3
cm. Explain the diﬀerences in membrane current densities with position.

Problem 6.13 The purpose of this problem is to investigate the space constant of
the Hodgkin-Huxley model of the giant axon of the squid.

170

CHAPTER 6. PROPAGATED ACTION POTENTIAL

a. Design a simulation experiment in order to estimate the space constant of
the Hodgkin-Huxley model of the giant axon of the squid for the default
parameters. Determine the value of the space constant.

b. Keeping all other parameters the same, set the radius of the axon to 0.0952
cm and repeat part a.

c. Compare the estimated space constants in parts a and b and explain the
diﬀerence.

6.6 PROJECTS

This simulation software lends itself to more extensive study than that included
in the Problems. These more extensive studies are called Projects. A description
of the practical considerations in the choice of a project are contained in Sec-
tion 5.6. Speciﬁc topics for projects with the software described in this Chapter
are listed here.

1. Hypothesis — The eﬀect of temperature on the conduction velocity of the
squid giant axon can be ﬁt by the Hodgkin-Huxley model. Articles in the
literature should be consulted for this project (Chapman, 1967; Easton and
Swenberg, 1975).

2. Hypothesis — When two action potentials are elicited, the velocity of the
second is slower than the velocity of the ﬁrst action potential. This phe-
nomenon is predicted by the Hodgkin-Huxley model. Articles in the litera-
ture should be consulted for this project (George et al., 1984).

3. Hypothesis — The threshold current for eliciting an action potential with an
intracellular electrode is higher for a space-clamped than for an unclamped
model of an axon.

4. Hypothesis — Increasing the membrane capacitance will decrease the con-
duction velocity.

5. Hypothesis — Increasing the membrane conductance (by scaling all the
ionic conductances) will increase the conduction velocity.

6. Hypothesis — Increasing the external concentration of sodium will increase
the conduction velocity.

7. Hypothesis — Increasing the external concentration of potassium will in-
crease the conduction velocity.

6.6. PROJECTS

171

8. Hypothesis — Increasing the external concentration of calcium will increase
the conduction velocity.

9. Hypothesis — Increasing the temperature will increase the conduction ve-
locity.
vided ∆t ≤ π a(ro + ri)(∆z)2Cm .
10. Hypothesis — The solution using the forward Euler method is stable pro-
11. Hypothesis — The backward Euler algorithm is stable for all values of ∆t
and ∆x .
Crank-Nicolson method are stable for all values of ∆t and ∆x .
12. Hypothesis — The Crank-Nicolson method and the staggered increment
from temporal and spatial discretization behaves as O (∆t ) + O ((∆x )2).
13. Hypothesis — Using the forward Euler approximation, the error resulting
from temporal and spatial discretization behaves as O (∆t ) + O ((∆x )2).
14. Hypothesis — Using the backward Euler approximation, the error resulting
15. Hypothesis — Using the Crank-Nicolson method and the staggered incre-
tial discretization behaves as O ((∆t )2) + O ((∆x )2).
ment Crank-Nicolson method, the error resulting from temporal and spa-

172

CHAPTER 6. PROPAGATED ACTION POTENTIAL

Chapter 7

VOLTAGE-GATED ION CHANNELS

173

174

CHAPTER 7. VOLTAGE-GATED ION CHANNELS

7.1 Introduction

7.1.1 Historical background

Passive transport of ions through cellular membranes is mediated by membrane-
bound channel proteins that form selectively permeable ion channels. Although
their existence was long suspected, the ﬁrst direct physiological evidence for
these channels became available in 1976 (Neher and Sakmann, 1976). Subse-
quently, many diﬀerent types of channels have been identiﬁed (Hille, 1992).
Channels can be categorized on the basis of the physical/chemical variable that
opens or gates the channel. For example, the channels that underlie the prop-
erties of electrically excitable cells are gated by the membrane potential and are
called voltage-gated channels. These channels are opened by a change in mem-
brane potential. Other channels are gated by the binding of speciﬁc chemical
substances, mechanical deformation of the membrane, etc. In all of these cases,
the channels behave as if they have a discrete number of states, of which a few
(usually only one) are conducting or open states and the others (usually more
than one) are non-conducting or closed states. The channel switches rapidly and
randomly among its allowable states, and the probability that a transition occurs
at a particular time depends on the value of the gating variable.
Models of the gating of single ion channels were developed almost immedi-
ately after single-channel data were obtained (Colquhoun and Hawkes, 1977).
Descriptions of these models can be found elsewhere (Colquhoun and Hawkes,
1995a; Weiss, 1996b).

7.1.2 Overview of software

This software package enables users to enhance their understanding of models
of the gating of single voltage-gated ion channels. The software allows the user
to design a channel by choosing the number of states, the voltage dependence
of transitions between states, the conductance and gating charge of each state,
and the equilibrium potential for the channel. After the channel is designed, the
user can analyze the behavior of the channel to a change in membrane poten-
tial. Any of the variables associated with the channel can be displayed including
the state occupancy probability, ionic conductance, ionic current, gating charge,
and gating current. Both random variables and their expected values can be dis-
played as a function of time. The software is suﬃciently powerful and ﬂexible
to allow users to synthesize realistic, state-of-the-art models for the gating of
voltage-gated ion channels.

7.2. DESCRIPTION OF THE MODEL

175

7.2 Description Of The Model

A brief description of the channel model is given here; a more complete descrip-
tion is given elsewhere (Weiss, 1996b). We assume that a channel has N states
and that at each instant in time t , the channel is found in one of its states (Fig-
ure 7.1). The states are enumerated as {S1 , S2 , S3 , . . . SN }. Each state has state at-

S1
γ1 , Q1

α12
α21

S2
γ2 , Q2

α23
α32

S3
γ3 , Q3

α34
α43

S4
γ4 , Q4

α15

α51

α45

α54

S5
γ5 , Q5

Figure 7.1: Kinetic diagram of a channel that has 5 states. The states are shown linked
by rate constants for transitions between states, where αij is the rate of transition from
state i to state j . When the channel is in state j the conductance of the channel is γj
and the gating charge of the channel is Qj .

tributes: the state conductance and the state gating charge. The state attributes
for these states are denoted as {γ1 , γ2 , γ3 , . . . γN } for the state conductances and
{Q1 , Q2 , Q3 , . . . QN } for the state gating charges. Given the membrane potential Vm
and the equilibrium potential Veq , the state ionic currents are {I1 , I2 , I3 , . . . IN }.
Thus, when the channel is in state Sj , the state conductance is γj , the state ionic
current is Ij = γj (Vm − Veq ), and the state gating charge is Qj . Gating currents
occur at the transitions of the gating charge.
The temporal evolution of the electrical properties of a channel depend upon
the state occupancy probabilities which we discuss brieﬂy. Deﬁne the probability
the channel is in state j at time t + ∆t given that it was in state i at time t as
that the channel is in state j at time t as xj (t ), and the transition probability that
yij (t + ∆t ). The fundamental assumption of the model for state transitions is
that the transition probabilities depend on the present state of the channel and
not on previous states. Such a probabilistic process is called a Markov process.
yij (t + ∆t ) = αij ∆t + o(∆t ) ,
Formally, we assume that
where o(∆t ) has the property that lim∆t→0 o(∆t )/∆t = 0 and αij is a rate con-
stant for transitions from state i to state j . The ﬁrst term is the probability of

CHAPTER 7. VOLTAGE-GATED ION CHANNELS
176
occurrence of a single transition in the interval of duration ∆t when this interval
is short and the rate of transitions is αij . The second term takes into account
tervals ∆t that are suﬃciently small so that no more than one transition is likely
the probability of the occurrence of multiple transitions in the interval. For in-
to occur in the interval, the o(∆t ) term is negligible; we will ignore this term in
time t + ∆t and in state i at time t is yij (t + ∆t )xi(t ) ≈ αij xi∆t .
the development that follows. The probability that the channel is in state j at
(t , t + ∆t ) is xj (t + ∆t ) − xj (t ). In this time interval, this probability increases
The increase in probability that the channel is in state j in the time interval
as a result of transitions from states i into state j and decreases as a result of
xj (t + ∆t ) − xj (t ) ≈ N(cid:29)
αij xi(t )∆t − N(cid:29)
transitions from state j into state i. By collecting all such terms we obtain,
αj ixk(t )∆t ,
i=1,i(cid:24)=j
i=1,i(cid:24)=j
where the ﬁrst summation is due to transitions into state j and the second sum-
the limit as ∆t → 0, we obtain the diﬀerential equation
mation is due to transitions out of state j . If we rearrange the terms and take
αij xi(t ) − N(cid:29)
= N(cid:29)
dxj (t )
αj ixj (t ).
dt
i=1,i(cid:24)=j
i=1,i(cid:24)=j
 .

This equation can be written in matrix form by deﬁning the matrix of transition
probabilities to be
· · · α1N
α11 α12
· · · α2N
α21 α22
· · ·
· · ·
· · ·
· · ·
· · · αNN
αN 1 αN 2
(cid:30)N
where αij is the transition rate from state i to state j when i (cid:24)= j , and αii is
i=1 αij = 0. The state occupancy probability satisﬁes the matrix
chosen so that
diﬀerential equation
= x (t )α,
dx (t )
dt
where x (t ) is a row matrix of state occupancy probabilities. In addition, since
N(cid:29)
the channel is in one of its N states at each instant in time,
xj (t ) = 1 .
j=1

α =

(7.1)

(7.2)

The equilibrium state occupancy probability can be obtained directly from Equa-
tion 7.2 by setting dx (t )/dt = 0 to yield
0 = x (∞)α,

(7.3)

177

S j eλj t ,

(7.4)

x (t ) = x (0)

7.2. DESCRIPTION OF THE MODEL
to obtain the equilibrium state occupancy probability x (∞).
If the matrix α is constant, then the solution to the matrix equation for the
state occupancy probability is (Colquhoun and Hawkes, 1995a)
x (t ) = x (0)eαt ,
where x (0) is the matrix of the initial value of x (t ). Evaluation of the exponential
N(cid:29)
matrix yields the result
j=1
where λj is the j th eigenvalue of and S j is the j th spectral matrix of α. There-
fore, we see that the state occupancy probabilities are weighted sums of ex-
ponentials whose exponents are the eigenvalues of the transition rate matrix.
Because the α matrix is singular, one eigenvalue has value zero. All other eigen-
values have negative real parts (Cox and Miller, 1965). Thus, the non-zero eigen-
values lead to solution exponentials that decay with time.
For a voltage-gated channel, the transition rates depend explicitly on the
membrane potential which in turn may vary with time. If the rate constants are
assumed to satisfy the theory of absolute reaction rates (Weiss, 1996a; Weiss,
 Aij eaij Vm if i ≠ j ,
1996b), then they depend exponentially on the membrane potential,
if i = j ,
0
where Aij is a rate factor and aij is an exponential factor. αij (Vm ) depends
on the membrane potential which in turn depends upon time. Therefore, the
rate constants will in general depend upon time. A more physical representation
follows by linking the rate constants to the state gating charges. In this formu-
lation, the rate constants that link states i and j (where i ≠ j ) can be written
(cid:4)
(cid:3)
as
αij (Vm ) = Ae(0.5+ξ )
(Vm−Vij )/kT ,
(cid:4)
(cid:3)
αj i(Vm ) = Ae(0.5−ξ )
(Vm−Vj i )/kT ,
where k is Boltzmann’s constant, T is the absolute temperature, ξ is an asym-
metry factor, Qi and Qj are the state gating charges in states i and j , Vij and Vj i
are the membrane potentials at which the rate constants equal A.
During intervals of time when the membrane potential is a constant, Equa-
tion 7.2 is a linear, ﬁrst-order matrix diﬀerential equation with constant coeﬃ-
cients. The solution determines the state occupancy probabilities, the {xj (t )}s.
The expected values of the channel conductance, channel current, and gating
charge are computed directly from the state occupancy probabilities. If the con-
ductance of the channel is γj when the channel is in state j , then the expected

αij (Vm ) =

Qj −Qi
Qi−Qj

178

γj xj (t ).

.

CHAPTER 7. VOLTAGE-GATED ION CHANNELS
g(t ) = N(cid:29)
value of the conductance of the channel, g(t ), is
j=1
If we assume that the current through the channel when the channel is in state
j is γj (Vm − Veq ), the expected value of the single-channel current, i(t ), is
i(t ) = N(cid:29)
j=1
Similarly, if the gating charge of the channel when the channel is in state j is Qj ,
qg (t ) = N(cid:29)
the expected value of the single-channel gating charge, qg (t ), is
j=1
The expected value of the single-channel gating current, ig (t ), is
ig (t ) = dqg (t )
dt

γj xj (t )(Vm − Veq ) = g(t )(Vm − Veq ).

Qj xj (t ).

(7.7)

(7.8)

(7.5)

(7.6)

7.3 Numerical Methods

7.3.1 Integration step

The diﬀerential equation for the state occupancy probability (Equation 7.2) is
solved numerically using methods described elsewhere (Colquhoun and Hawkes,
value of the integration step, ∆t .
The value of ∆t needs to be chosen small
1995b). The accuracy and eﬃciency of the numerical solution depends upon the
enough so that the time rate of change in the occupancy probabilities can be re-
The choice of an adequate value of ∆t depends upon the eigenvalues of the state
solved accurately and so that the random variables are represented accurately.
transition rate matrix. Typically, ∆t should be chosen so that ∆t (cid:20) 1/|λmax |,
where λmax is the eigenvalue with the largest magnitude. The smaller ∆t is cho-
sen the more accurate the integration in any one step, but the longer the compu-
round-oﬀ errors. Thus, the choice of ∆t is a compromise between the speed and
tation will take. In addition, long computations can result in the accumulation of
accuracy of the simulation. Solution of the matrix equation (Equation 7.4) deter-
mines the occupancy probabilities of each state. From these probabilities, the
expected values of the conductances, currents and gating charge are computed
using Equations 7.5-7.8.

7.3. NUMERICAL METHODS

179

0.2
0.1
0.05

)
t
∆
λ
(


0.02
0.01
0.005
0.1

more than 1 event in an interval ∆t where
Figure 7.2: The probability of occurrence of
the rate of events is λ and the events are dis-
tributed according to a Poisson distribution.

0.2

λ∆t

0.5

1

Random variables are computed from state transition probabilities. Tran-
yij (t + ∆t ) ≈ αij ∆t at each instant in time. The time interval for computing
sitions probabilities from state i to state j are computed from the relation
random variables is set equal to the integration step ∆t . The occurrence of a
transition is determined by a random number generator. The sequence of state
transitions determines the sequence of conductance values and gating charges
since each state has a unique conductance and gating charge. The conductance
values determines the current since this current is determined by specifying the
conductance, the membrane potential, and the channel equilibrium potential.
The gating current random variable is represented by impulses at the times of
transition of the gating charge and whose areas equal the discontinuities in gat-
ing charge.
In order to accurately represent the random variables, the time interval must
be chosen suﬃciently brief that the probability of occurrence of more than 1
k events in an interval ∆t with an average rate of events of λ is given by the
change in state in the interval is negligible. The probability of occurrence of
Pr(k, λ∆t ) = (λ∆t )k
e−λ∆t .
Poisson distribution
k!
(λ∆t ) = 1 − Pr(0, λ∆t ) − Pr(1, λ∆t ) = 1 − (1 + λ∆t )e−λ∆t .
Hence, the probability of occurrence of more than 1 event in an interval is
The probability of more than one event in an interval (λ∆t ) is shown plotted
(7.10)
versus λ∆t in Figure 7.2. Note that for λ∆t ≤ 0.2, (λ∆t ) ≤ 0.018.

(7.9)

7.3.2 Initial conditions

In order to obtain a solution to Equation 7.2, initial conditions must be speci-
ﬁed. There are several plausible choices for the initial conditions, i.e., the initial
states of the channel. One choice is simply to specify the initial state determinis-
tically. A second choice is to choose the most probable state as the initial state.
The most probable state can be obtained by solving Equation 7.3 and choos-
ing the initial state as the one with the highest probability. A third choice is

180

CHAPTER 7. VOLTAGE-GATED ION CHANNELS

Figure 7.3: The IC Control ﬁgure after the software is initi-
ated.

to choose the initial state probabilistically according to the equilibrium proba-
bility for state occupancy as determined by Equation 7.3. All three choices are
implemented in the software.

7.4 User’s Guide To The Software

When the software is initiated, 2 ﬁgures are displayed (in addition to MATLAB’s
command window): the IC Control and the IC Parameters ﬁgures. The IC Control
ﬁgure controls the software (Figure 7.3). The IC Parameters ﬁgure allows the
user to design a single channel. Once the channel is designed, the membrane
potential is speciﬁed as a function of time, and the numerical variables chosen,
the simulation can be run, and the statistical properties of the channel variables
can be analyzed.

7.4.1 IC Control

The portion of the IC Control ﬁgure (Figure 7.3) below the menubar is divided
into three panels. The setup panel allows the user to: select Channel parame-
ters which is used to design the channel, Membrane potential which is used to
specify the membrane potential as a function of time, and Numerics which is
used to specify the initial conditions and the integration of the computation. A
panel just below the setup panel controls the simulation. The simulation can
be started, stopped, paused, or continued. Clicking on Open allows results saved
in ﬁles to be read. Clicking on Save allows the user to save the results of the
simulation in a ﬁle; all parameters of the channel design are saved as well as the

7.4. USER’S GUIDE

181

Figure 7.4: The IC Parameters ﬁgure.

simulation results. The analysis panel allows display of the results of a simula-
tion.

7.4.2 IC Parameters

The IC Parameters ﬁgure displays the default channel kinetic diagram as shown
in Figure 7.4. The user can either read a previously stored channel model from
a ﬁle or construct a channel model by editing the default channel model. Edit-
ing entails adding new states, adding or modifying rate constants that link the
states, assigning ionic conductances and gating charges to states, and assigning
an equilibrium potential to the channel model.
Each box in the channel parameters ﬁgure (Figure 7.4) represents a particular
state of the channel and is given a number from 1 to 8 (a maximum of 8 states is
possible). The arrows connecting these states depict the transition rates between
states. Each box also contains the ionic conductance of the channel when the
channel is in that state, i.e., the state ionic conductance. The ionic conductance
can be changed by clicking on it’s value and typing the new value into the text

182

CHAPTER 7. VOLTAGE-GATED ION CHANNELS

edit box. The ionic conductance is expressed in picosiemens (pS). A value of
zero denotes a non-conducting state. Each box also contains the gating charge
valence z of the channel when the channel is in that state; the gating charge
valence can be changed by clicking on it’s value and typing the new value into
the edit box. The gating charge valence can be positive or negative and need not
be an integer. The gating charge is ze, where e = 1.602 × 10
−19 C. The value of
the channel equilibrium potential can be changed by clicking in the text edit box
in the upper right hand corner of the IC Parameters ﬁgure and typing the new
value in the text edit box. A single click on a rate constants displays its voltage
dependence in the IC Parameters ﬁgure.

Add new state

A new state can be added to the diagram by clicking on New. A new state will be
created and positioned in the upper left corner of the ﬁeld. A new state or any
existing state can be repositioned in the window by clicking on the grey region
at the top of the state boxes and dragging the state box to a new position. To
delete a state the user clicks on the red delete box in the upper left-hand portion
of the state box.

Add rate constant

To add rate constants linking state i to state j , the user ﬁrst clicks on Add in the
IC Parameters ﬁgure, then clicks in the state box for state i, and then clicks in
the state box for state j . During this operation, the cursor becomes a cross hair.
A pair of default rate constants is added to link these two states.

IC Specify rate constants

To modify the rate constants that link two states, the user double clicks on the
selected rate constants to obtain the IC Specify rate constants ﬁgure (Figure 7.5).
The user selects which rate constant to modify or to create by clicking on the
appropriate pushbutton. The voltage dependence of the rate constant, can be
speciﬁed numerically by typing numbers into the appropriate text edit boxes or
graphically by using the mouse. Clicking on two locations in the plot of rate con-
stant versus potential puts an exponential function through those two points. A
formula for the dependence of the rate constant on membrane potential is dis-
played in the lower left-hand corner of the IC Parameters ﬁgure. This formula is
also displayed by clicking on a rate constant in the IC Parameters ﬁgure.
Clicking on Delete deletes the pair of rate constant from the IC Parameters
ﬁgure. Clicking on the two curved linked arrows exchanges the two rate con-
stants. Clicking on Revert resets the rate constant to the previously stored value.

7.4. USER’S GUIDE

183

Figure 7.5: The IC Specify rate constants ﬁgure after the user has double clicked on the
rate constants linking states 1 and 2 in Figure 7.4 and changed the parameters of the
the rate constant so that α12 = 2.5e0.01Vm (1/ms) and α21 = 3e−0.04Vm (1/ms), where
Vm is in mV..

184

CHAPTER 7. VOLTAGE-GATED ION CHANNELS

Figure 7.6: IC View rate constant ﬁgure after the rate constants have been deﬁned as in
Figure 7.5.

Miscellaneous features

If Reset Diagram is selected the current channel kinetic diagram is erased and
the default channel kinetic diagram is drawn. A previously stored diagram can
be retrieved by selecting Open. The current diagram can be saved to a ﬁle by se-
lecting Save. Clicking on Save in the IC Parameters ﬁgure saves all the channels
parameters but not the simulation results.

Viewing the voltage dependent parameters

The voltage dependent rate constants can be displayed by clicking on the button
marked V iew RC in the IC Parameters ﬁgure which results in the display of
the IC View rate constants ﬁgure (Figure 7.6). This ﬁgure contains a number of
panels.

7.4. USER’S GUIDE

185

Figure 7.7: The IC Setup view rate constant ﬁgure.

Plot control. The panel in the upper left corner controls plotting in the manner
described below.

Setup. Clicking on Setup in the IC View rate constants ﬁgure displays the
IC Setup view rate constants ﬁgure (Figure 7.7) which allows selection
of the voltage-dependent parameters as a function of the membrane
potential.

Variables. The abscissa is the membrane potential. Shift clicking on
any variable adds it to the collection of selected ordinate vari-
ables. Clicking on any variable, selects that variable and deselects
all others. The variables associated with each pair of rate con-
stants are: αij , αj i , τij = 1/(αij + αj i), xij = αij /(αij + αj i), and
xj i = αj i/(αij + αj i). τij is the time constant for transition be-
tween states i and j provided there are only two states; if there
are more than two states, then τij has no particular signiﬁcance.
Similarly, xij is the probability that the channel will be in state j at
equilibrium provided there are only two states; if there are more
than two states, then xij has no particular signiﬁcance.
Graph. Clicking on Graph results in a plot of the selected data. The
new plot replaces the old plot.

Open. Clicking this button allows plotting of results stored in a ﬁle.

Save. Clicking this button allows the information in the plot to be saved in
a ﬁle. All lines, labels, and annotations are saved.

Print. Clicking on Print prints the ﬁgure.

Cross-line. Clicking on
displays a vertical line, the cross line, in the plot
ﬁeld at the location of the pointer cursor. The line follows the cursor
as it moves across the plot ﬁeld. The values of all plotted variables at
the intersection with the cross line are displayed in the legend. Click-
ing on cross-line button again removes the cross-line values from the
legend and removes the cross line from the plotting ﬁeld.

Annotate. Clicking on A and then on a desired location in the plot area
displays a text edit box at that location. Click in the text edit box, type

186

CHAPTER 7. VOLTAGE-GATED ION CHANNELS

the annotation followed by a <RETURN> when the annotation is com-
pleted. Clicking on the annotation and dragging the mouse moves the
annotation to a desired location in the plot ﬁeld. The text string can
be formatted into mathematical notation by using a LATEX like notation,
e.g., to get α12 type \alpha_{12}.
Zoom. Clicking on + allows the user to magnify a region of the plotting
ﬁeld by clicking on it. Additional magniﬁcation can be achieved by
zooming again.
Unzoom. Clicking on - undoes the eﬀects of all prior zooms.

Axes control. The plot axes can be changed by clicking on any of the axis labels
— either the abscissa or any of the ordinates — which results in the display
of a ﬁgure that allows changing the axis (see Figure 5.8). The axis scale can
be chosen to be linear, logarithmic, and/or reciprocal.
If neither the Log
nor the Inverse (1/) options is chosen, the scale is linear. If Log is chosen,
the scale is the logarithm of the magnitude of the variable. If Inverse (1/) is
chosen then the reciprocal of the variable is plotted either on a linear or on
a logarithmic scale. Clicking on Apply results in a change in the axis. The
plot range can be changed, but the axis labels cannot be edited.

Legend. The legend panel records a list of all data plotted. The following are
recorded.

Line properties. The color, line style, and symbol type are used to encode a
particular variable; this marker is shown in the legend. Clicking on the
marker allows the user to edit the attributes of the plot line/symbol
(see Figure 5.9).
Variable name. The name of the variable that was plotted is shown. Click-
ing on the variable name alternately displays and hides the curve as-
sociated with this entry. When variables are added or deleted, the axis
is auto-scaled if that option is selected — it is selected by default — in
the axis ﬁgure.
Cross-line If the cross-line is used the cross-line values are displayed.
Data-set. The time when the curves were generated are indicated. Click-
ing on the time stamp alternately displays and hides all the curves
associated with this legend item.

7.4.3 Membrane potential

Selection of Membrane Potential in the controls ﬁgure displays the IC Membrane
potential ﬁgure (Figure 7.8). The membrane potential can be a rectangular pulse
of potential superimposed on a steady holding potential. The user can select

7.4. USER’S GUIDE

187

Figure 7.8: IC Membrane poten-
tial ﬁgure after selection of a
pulse of potential.

Figure 7.9:
IC Numer-
ics ﬁgure appropriate for
rate constants shown in
Figure 7.6 and membrane
potential shown in Fig-
ure 7.8.

the holding potential, the duration of the stimulus, the onset time of the pulse
starts, the pulse duration, and pulse amplitude. The parameters of the mem-
brane potential can be read from and saved to a ﬁle.

7.4.4 Numerics

The IC Numerics ﬁgure (Figure 7.9) controls the choice of the integration step
and initial conditions for the simulation. The ﬁgure consists of ﬁve panels. The
two upper panels deal with the eigenvalues of the transition rate matrix. The
middle panes deal with the method for choosing the integration step size. The
bottom panel deals with the choice of initial conditions (initial states).

188

Eigenvalues

CHAPTER 7. VOLTAGE-GATED ION CHANNELS

For a given choice of membrane potential and voltage-dependent rate constants,
the software computes the eigenvalues of the transition rate matrix and dis-
plays these results to the user. These eigenvalues have the dimensions of rate
constants (RC). The user can also choose to display the time constants (TC =
−1/RC) corresponding to these eigenvalues. In addition, the absolute value of
these rate and time constants can also be displayed.

Integration step

The smallest time constant is computed from the fastest eigenvalue and the user
can choose, by editing the text edit box, to make the integration step a fraction
(or a multiple) of this smallest time constant. Alternatively, the user can choose
a ﬁxed integration time. The integration time that results from the user’s choice
is displayed as is the probability of more than one transition during an interval
of time that equals the integration step.

Initial state

The initial state for a simulation can be chosen deterministically to be any of
the allowable states or the most probable state for the given initial values of the
membrane potential. By default, the initial state is chosen probabilistically by
computing the state occupancy probabilities for the chosen initial value of the
membrane potential and choosing the initial state randomly using these proba-
bilities.

7.4.5 Analysis

Clicking on the analysis panel of the IC Control ﬁgure allows access to a variety
of displays of simulation results including such variables as: the state occu-
pancy, the state occupancy probability, the ionic conductance, the ionic current,
the gating charge, and the gating current. Both the random variables and their
expected values can be displayed. Ten channels with similar characteristics can
be examined simultaneously to allow users to relate macroscopic to microscopic
variables. Results of multiple simulations can also be plotted on a single set of
axes for the sake of direct comparison.
Three diﬀerent types of graphs are available. The ﬁrst type allows plotting
a single variable as a function of time in ﬁxed coordinates. An example is the
IC State occupancy ﬁgure shown in Figure 7.10. The top panel shows the sim-
ulation for 10 independent channels, the middle panel shows the results for
channel 1 alone, and the bottom panel shows the state occupancy probabilities
for both states of the channel. A second example of this type of graph is the
IC Ionic current ﬁgure shown in Figure 7.11. Selected for plotting are the ionic

7.4. USER’S GUIDE

189

Figure 7.10: IC State occupancy ﬁgure with all variables selected for display.

190

CHAPTER 7. VOLTAGE-GATED ION CHANNELS

Figure 7.11: IC Ionic current ﬁgure showing the relation between the random variable
and its expected value of the ionic current.

current random variable, its expected value, and the average ionic current of 10
identically distributed but statistically independent channels. Similar plots are
available for the ionic conductance, gating charge, and gating current. These dis-
plays are helpful for relating macroscopic to microscopic variables and random
variables to their expected values.
A second type of graph is the IC Summary ﬁgure which allows comparison
of the time dependence of channel variables to each other in ﬁxed coordinates
(Figure 7.12). Most of the variables are self-evident from the display. However,
the representation of the gating current random variable requires some com-
ment. The gating charge random variable is a random rectangular wave. Hence,
the gating current random variable, which is deﬁned as the derivative of the
gating charge random variable, is a random impulse train (train of Dirac delta
functions). We represent these impulses with vertical arrows. The time of occur-
rence of an arrow equals the time of occurrence of an impulse and the height of
the arrow equals the area of the impulse. On the scale of visibility of the gating
current random variable, the expected value is often too small to see. Hence, in
the plot of the gating current, deselecting the random variable will allow its ex-
pected value to be observed. Clicking on the radio button for Cross line displays
a vertical line that tracks the position of the mouse cursor. The values of the
intersection of the line with each variable is displayed.
The above graphs have limited capability for control of scales. The ordinate

7.4. USER’S GUIDE

191

Figure 7.12: IC Summary ﬁgure with all variables selected for display.

192

CHAPTER 7. VOLTAGE-GATED ION CHANNELS

Figure 7.13: IC Graphics ﬁgure showing the expected value of the ionic current and of
the gating charge for the channel deﬁned in Figures 7.4-7.8.

scale is autoscaled automatically. This is convenient but can be misleading in
that errors inherent in numerical calculations become autoscaled and can ap-
pear large if the scale is not read. For example, if for some set of parameters
some current variable is in principle zero, its numerical value may be limited
−23 pA, a small current.
by the numerical accuracy of the computations to be 10
However, if autoscaled in the above graphs, this current may appear large. The
type of graph described below yields more control over plotting scales and can
help the user to interpret such small currents.
The third type of graph allows comparison of results obtained in diﬀerent
simulations in coordinates deﬁned by the user. Clicking on Graphics in the em
IC Control ﬁgure displays the IC Graphics ﬁgure (Figure 7.13).
This ﬁgure allows plotting most of the results of the simulation; the random
variables are not plotted with the IC Graphics ﬁgure but all the expected values
and probabilities of all variables are plotted. For the allowable variables, any

7.4. USER’S GUIDE

193

Figure 7.14: The IC Setup graph-
ics ﬁgure showing the variables
used to setup Figure 7.13.

variable can be plotted against any other in coordinates chosen by the user. The
control of this ﬁgure is virtually identical to that for the IC View rate constants
ﬁgure (Figure 7.6). Hence, we describe only the diﬀerences. The main diﬀerence
occurs if Setup is selected in the IC Graphics ﬁgure which results in display
of the IC Setup graphics ﬁgure (Figure 7.14). Several dependent variables can
be plotted simultaneously. In addition, results saved in ﬁles can be plotted so
that results for diﬀerent parameters can be compared.
In addition, results of
consecutive simulations can be overlayed. We give two examples of the type
of graphics that are readily available with the IC Graphics ﬁgure. Figure 7.15
shows the state occupancy probabilities of all four states as a function of time.
Figure 7.16 shows the ionic conductances of three diﬀerent channel models — a
two-state, a three-state, and a four-state model.

194

CHAPTER 7. VOLTAGE-GATED ION CHANNELS

IC Graphics ﬁgure showing the state occupancy probabilities for a
Figure 7.15:
four-state channel whose successive states are linked by rate constant such that
α12 = α23 = α34 and α21 = α32 = α43 where α12 and α21 are identical to those in
Figure 7.5.

7.4. USER’S GUIDE

195

IC Graphics ﬁgure showing the ionic conductances of a two-state,
Figure 7.16:
three-state, and a four-state channel where the last state in each of
these
three channel models is a conducting channel with a conductance of 20 pS.
α12 = α23 = α34 = 4e0.04Vm and α21 = α32 = α43 = 0.2e−0.05Vm (ms
−1 ). The mem-
brane potential had at a holding potential of −80 mV and stepped to +40 mV.

196

CHAPTER 7. VOLTAGE-GATED ION CHANNELS

7.5 Problems

Problem 7.1 The purpose of this problem is to explore the properties of a channel
that has one two-state gate that is not voltage gated. This two-state channel has
rate constants that are not a function of membrane potential; this channel is not
voltage-gated. Deﬁne a two-state channel for which state 1 is closed (noncon-
ducting) and state 2 is open (conducting),

1 α12(cid:4)
α21

2 .

Use rate constants that are constant (independent of membrane potential). In all
parts of this problem use rate constants such that α12 + α21 = 10 ms
−1 .

a. Determine opening and closing rate constants such that the channel is
equally likely to be in state 1 or state 2.

b. Determine opening and closing rate constants such that the channel is
three times as likely to be in state 2 than in state 1.

c. Use the same rate constants as in part b. Set the membrane potential so
that it is −50 mV for t < 0.5 ms and +50 mV for t > 0.5 ms. The objective
of this part is to design a channel that has a single-channel current when
the channel is open (I ) of −1.2 pA when the membrane potential is −50
mV and +0.8 pA when it is +50 mV.

i. Determine the equilibrium potential and single-channel conductance
when the channel is open (γ ). Check your answer by running the simu-
lation using the values of the equilibrium potential and single-channel
conductance you determined.
ii. What is the average single-channel current (i) for t < 0.5 ms? What is
the average single-channel current for t > 0.5 ms?

Problem 7.2 The purpose of this problem is to explore the properties of a chan-
nel that has a two-state gate that is voltage gated. This two-state channel has
rate constants that are functions of membrane potential; the channel is voltage-
gated. Deﬁne a two-state channel for which state 1 is closed (nonconducting)
and state 2 is open (conducting),

1 α12(cid:4)
2 .
α21
Set the membrane potential to −60 mV for t < 0.2 ms and to +40 mV for t > 0.2
ms.

7.5. PROBLEMS

197

a. Determine voltage-dependent rate constants such that: the channel is closed
(with probability > 0.8) for t < 0.2 ms; the channel is open (with probabil-
ity > 0.8) for t (cid:25) 0.2 ms; and the channel opens with a time constant of
about 0.2 ms.

b. Determine parameters of the channel such that when the channel is open,
the single-channel current (I ) is +0.5 pA at a membrane potential of +40
mV and is zero when the membrane potential is −10 mV.

c. Is this an activation gate or an inactivation gate?
d. Change the equilibrium potential to −70 mV. Repeat the simulation. Could
this channel describe the kinetics of the potassium channel in the Hodgkin-
Huxley model? In what ways does it resemble the potassium channel? In
what ways does it diﬀer from the potassium channel?
e. Change the equilibrium potential to +50 mV. Repeat the simulation.

i. Is the average channel conductance a continuous function of time?
Explain!

ii. Is the average channel current a continuous function of time? Explain!

iii. Could this channel describe the kinetics of the sodium channel in the
Hodgkin-Huxley model? In what ways does it resemble the sodium
channel? In what ways does it diﬀer from the sodium channel?

Problem 7.3 The purpose of this problem is to explore the properties of two two-
state voltage-gated channels that diﬀer only in their state conductances. This
problem deals with two channels that each have two states with the same kinetic
diagram, namely

1 α12(cid:4)
α21

2 ,

where the rate constants are
α12 = 4e0.04Vm and α21 = 2e−0.01Vm .
Each channel is subject to a membrane potential proﬁle that is −60 mV from
t = 0 to t = 1 ms after which the membrane potential is +10 mV for 2 ms. The
equilibrium potential for each channel is +40 mV. The channels diﬀer only in
the conductance assigned to each state. Channel 2 has γ1 = 0 and γ2 = 20 pS;
Channel 2 has γ1 = 20 pS and γ2 = 0.
a. Which channel opens in response to a depolarization? Explain.

b. Which channel closes in response to a depolarization? Explain.

198

CHAPTER 7. VOLTAGE-GATED ION CHANNELS

c. Does the time-dependence of the probability that the channel is in state 1
diﬀer for these two channels? Explain.

Problem 7.4 The purpose of this problem is to explore the eﬀect of scaling the
rate constants on the kinetic properties of a channel. The kinetic diagram has the
form

1 α12(cid:4)
2 .
α21
The membrane potential is −60 mV from t = 0 to t = 1 ms and +10 mV for 2
ms. The equilibrium potential is +40 mV. The channel conductances are γ1 = 0
and γ2 = 20 pS.
a. Set the voltage dependence of the rate constants as
α12 = 4e0.04Vm and α21 = 2e−0.01Vm ,

and run the simulation. Plot the ionic conductance and ionic current.
Record the values of eigenvalues.

b. Next double the rate constants so that the voltage dependence of the rate
constants becomes

α12 = 8e0.04Vm and α21 = 4e−0.01Vm .

Run the simulation again. Plot the ionic conductance and ionic current.
Record the values of eigenvalues.

c. Next halve the rate constants so that the voltage dependence of the rate
constants becomes

α12 = 2e0.04Vm and α21 = 1e−0.01Vm .

Run the simulation again. Plot the ionic conductance and ionic current.
Record the values of eigenvalues.

d. Examine the results and draw conclusions about the eﬀect of scaling the
rate constants without otherwise changing their voltage dependence. Focus
both on the random variables and on the expected values of both the ionic
conductance and the ionic currents. Be as quantitative as possible.

Problem 7.5 The purpose of this problem is to explore the eﬀect of the choice of
initial state on the properties of a channel with a simple, two-state gate.

a. Start the simulation with the default parameters. Examine the Summary
plot and the State occupancy plot.

7.5. PROBLEMS

199

b. Now display the IC Numerics ﬁgure. Note that the default initial state is
Random. Now change the initial state to be state 1. Start the simulation.

i. Describe the diﬀerences between the results obtained with a random
initial state and an initial state of 1. What accounts for this diﬀerence.
ii. Carefully display the time course of the state occupancy probability
using the Graphics ﬁgure and determine the time constant of the time
course of the state occupancy probability.
iii. Compare the time constant you estimated in part ii with the eigenvalue
(expressed as a time constant) from the Numerics ﬁgure.

Problem 7.6 The purpose of this problem is to explore the gating charge of a
channel that has one two-state gate. The rate constants of the channel are α12 = 1
and α21 = 2 ms
−1 . The gating charge of state 1 is 0 and that of state 2 is 2eC.
a. Run the simulation and determine the expected value of the gating charge.
Explain its value.

b. Without changing any other parameter, determine a value of α12 such that
the expected value of the gating charge is 1eC.
c. Set both α12 = α21 = 2 ms
−1 and set the gating charge of both state 1 and 2
to 2eC. Run the simulation. Explain the expected value of the gating charge.
[Hint — you may ﬁnd it convenient to use the Graphics plots (which you
can select from the IC Control ﬁgure. This option allows a great deal of
control over axes scales which may be important to interpret the results.]

Problem 7.7 The purpose of this problem is to explore the relation among ionic
conductance, ionic current, gating charge, and gating current for a channel that
has one two-state gate. The rate constants are α12 = 1 and α21 = 2 ms
−1 . The
gating charge of state 1 is 0 and that of state 2 is 2eC. The ionic conductance
of state 1 is 0 and that of state 2 is 20 pS. Run the simulation.
[Hint — for
some parts of this problem, you may ﬁnd it convenient to use the Graphics plots
(which you can select from the IC Control ﬁgure). This option allows a great deal
of control over axes scales which may be important to interpret the results. The
other plots have autoscaled axes in which small errors, inherent in numerical
calculations, are autoscaled to appear large.]

a. Examine the expected value of the ionic conductance.

i. Describe the ionic conductance.
ii. Explain its value.

b. Examine the expected value of the ionic current.

200

CHAPTER 7. VOLTAGE-GATED ION CHANNELS

i. Describe the ionic current.
ii. Explain its values.

c. Examine the expected value of the gating charge.

i. Describe the gating charge.
ii. Explain its value.

d. Examine the expected value of the ionic current.

i. Describe the ionic current.
ii. Explain its value.

e. Note that the expected value of the ionic conductance and gating charge are
non-zero constants, the expected value of the gating current is zero, and
the expected value of ionic current is not constant. Explain these results.

Problem 7.8 The purpose of this problem is to explore the physical properties of
the gating charge. The kinetic diagram for the channel has the form
1 α12(cid:4)
α21

2,

where

α12 = 4e0.04Vm and α21 = 2e−0.01Vm ,
The membrane potential is −60 mV from t = 0 to t = 1 ms and +10 mV for 2
ms. The stimulus duration is 3 ms. The equilibrium potential is +40 mV. The
channel conductances are γ1 = 0 and γ2 = 20 pS.
a. Perform simulations using the following state gating charges. Plot both the
expected value of the gating charge and the expected value of the gating
current.
i. Q1 = 0 and Q2 = 2eC.
ii. Q1 = 0 and Q2 = −2eC.
iii. Q1 = 2eC and Q2 = 0.
iv. Q1 = −2eC and Q2 = 0.
b. Give a quantitative account of the key properties of the gating charge and
gating current waveforms — the initial values, ﬁnal values, and time con-
stants.

c. Of the results obtained in part a, which are physically plausible results.
Explain.

7.5. PROBLEMS

201

Problem 7.9 The purpose of this problem is to explore the eigenvalues of channel
models.
a. Consider a two-state channel with the rate constants α12 = 1 and α21 = 2
−1 ) and the default membrane potential shown in Figure 7.8.
(ms

i. What are the eigenvalues for the two values of the membrane poten-
tial?
ii. Why are the eigenvalues at the two membrane potentials the same?
Check your explanation by changing the membrane potential and de-
termining the eigenvalues.
iii. What is the relation of the eigenvalue to the rate constants? Check
your relation by changing the rate constants and determining the eigen-
value.
iv. Design a simulation experiment that computes the temporal change
of some variable of the two-state model to reveal the signiﬁcance of
the eigenvalue.
b. Consider a two-state channel with the rate constants α12 = 1.6818e0.008664Vm
and α21 = 2 (ms
−1 ) where Vm is in mV and the default membrane potential
is shown in Figure 7.8.

i. What are the eigenvalues for the two values of the membrane poten-
tial?
ii. Why are the eigenvalues at the two membrane potentials diﬀerent?
Check your explanation by changing the membrane potential and de-
termining the eigenvalues.
iii. What is the relation of the eigenvalues to the rate constants? Check
your relation by changing the rate constants and determining the eigen-
value.
iv. Design a simulation experiment that computes the temporal change
of some variable of the two-state model to reveal the signiﬁcance of
the eigenvalue. Which eigenvalue determines the temporal response?
c. Consider a three-state channel with the default rate constants α12 = 1,
α21 = 2, α23 = 2, and α32 = 1 (ms
−1 ) and the default membrane potential
shown in Figure 7.8.

i. What are the eigenvalues for the two values of the membrane poten-
tial?
ii. Why are the eigenvalues at the two membrane potentials the same?
Check your explanation by changing the membrane potential and de-
termining the eigenvalues.

202

CHAPTER 7. VOLTAGE-GATED ION CHANNELS

iii. Determine a relation that computes the eigenvalues from the rate con-
stants? Check your relation by changing the rate constants and deter-
mining the eigenvalues.

Problem 7.10 The purpose of this problem is to explore the properties of a three-
state channel whose rate constants are not a function of membrane potential; this
channel is not voltage-gated. Deﬁne a three-state channel with the following
kinetic scheme

2 α23(cid:4)
1 α12(cid:4)
α21
α32
where states 1 and 2 are closed and state 3 is open.
In all parts of this prob-
lem, make the rate constants independent of membrane potential, and use rate
−1 .
constants in the range 0.1-10 ms

3 ,

a. Determine a set of rate constants such that the channel is equally likely to
be in any one of its three states.
b. Try a set of rate constants such that αij = αj i . What are the probabilities
of occupying each state? Try another such set having this property. What
are the probabilities of occupying each state with this new set? What can
you conclude about this case?

c. Determine a set of rate constants such that the probabilities that the chan-
nel is in states 1:2:3 are approximately 0:0.5:0.5.

d. Determine a set of rate constants such that the probabilities that the chan-
nel is in states 1:2:3 are approximately 0:0.25:0.75.

e. Determine a set of rate constants such that the probabilities that the chan-
nel is in states 1:2:3 are approximately 0.2:0.3:0.5.

Problem 7.11 The purpose of this problem is to explore the properties of voltage-
gated channels with two, three, and four states. Assume that the equilibrium
potential of each channel is 40 mV and that the membrane potential starts at
−60 mV and switches to +10 mV at 1 ms and is maintained at this value for 2
ms. The three channels are deﬁned as follows:
• The two-state voltage-gated channel has a kinetic diagram
1 α12(cid:4)
α21

2 ,

where the rate constants are
α12 = 4e0.04Vm and α21 = 2e−0.01Vm .

203

7.5. PROBLEMS
• The three-state voltage-gated channel has a kinetic diagram
2 α23(cid:4)
1 α12(cid:4)
3 ,
α21
α32

where the rate constants are
α12 = α23 = 4e0.04Vm and α21 = α32 = 2e−0.01Vm .
• The four-state voltage-gated channel has a kinetic diagram
3 α34(cid:4)
2 α23(cid:4)
1 α12(cid:4)
4 ,
α21
α32
α43

where the rate constants are
α12 = α23 = α34 = 4e0.04Vm and α21 = α32 = α43 = 2e−0.01Vm .

In exploring the following issues, it is instructive to examine graphs that show
the membrane potential as well as both the random variables and mean values or
probabilities associated with the record of state occupancies, the conductance,
and the current through the channel.

a. For each of the channels, make the last state (the state with the highest
state number) the conducting state with a conductance of 20 pS and make
all other states non-conducting. Compare the mean conductance of the
two-state, the three-state, and the four-state channels. What can you say
about the eﬀect on channel conductance of increasing the number of closed
states that precede the open state?

b. Now consider the four-state channel. Compute the mean conductance
when state 1 has a conductance of 20 pS and all other states are non-
conducting. Repeat this computation except make state 2 the conducting
state with all others nonconducting. Repeat again with state 3 and then
state 4. Compare the mean conductance for these four conditions. Which
of these conductances most closely resembles the sodium conductance of
squid axon? Explain.

Problem 7.12 The purpose of this problem is to design a three-state channel that
activates and then inactivates. The channel activates at about 0 mV at a rate that
is three times as fast as it inactivates.

a. Consider a channel that must open before it inactivates, e.g.
2 α23(cid:4)
1 α12(cid:4)
α21
α32
where both states 1 and 3 are closed and state 2 is open.

3 ,

b. Consider a channel that need not open before it inactivates.

204

CHAPTER 7. VOLTAGE-GATED ION CHANNELS

Chapter 8

PEDAGOGICAL METHODS

205

206

CHAPTER 8. PEDAGOGICAL METHODS

8.1 Introduction

This chapter describes the pedagogical methods that were developed to teach
cellular biophysics using the software described in this text. The chapter is
aimed primarily at instructors who wish to use this material in teaching although
students may ﬁnd the material helpful. The description given here expands that
available previously (Weiss et al., 1992).

8.2 Uses Of The Software

The software has become an integral part of teaching cellular biophysics. It is
used throughout the subject, wherever it can be didactically eﬀective. The soft-
ware is used in lecture to motivate, engage, and inform students. The software is
helpful to visualize and to intuit dynamic processes. Use of the software in spe-
cial classes held in an electronic classroom is an eﬀective way to get students
away from solving problems by pattern recognition (Mazur, 1997) and forcing
them to confront the material in a diﬀerent way. Use of the software in projects
can deepen students understanding of the subject material and can be used to
teach students how to go about a research project.

8.2.1 Lectures
We have used a lecture room with a large screen (13.6’×18’) for projecting a
computer monitor screen. Thus, students are able to see all the interactions of
the lecturer with the computer. We have used the software in a variety of ways:
to help students to visualize concepts, to build intuition, to motivate, and to
engage the students’ intellect. We illustrate some of these techniques.
Some concepts are grasped instantly when presented graphically. The intu-
ition that results is complementary to that which results from a mathematical
exposition. The combination of an intuitive, visual grasp of a concept and the
precise, abstract mathematical description is powerful. Computer simulations
can be especially helpful with building intuition.

Example 8.1 In the random-walk model of diﬀusion with an unbi-
ased random walk, each particle moves one step to the left or to the
right with equal probability; the particle has no preferred direction of
motion. Yet a population of diﬀusing particles tends to move down
the particle concentration gradient. Thus, there is an apparent para-
dox between the undirected motion of individual particles and the
directed motion of a population of particles. This apparent paradox
is resolved in an instant by viewing a population of particles under-
going random walks (Figure 8.1). By watching the simulation, the user

8.2. USES OF THE SOFTWARE

207

Figure 8.1: Random walk in two regions. The initial distribution of particles (upper left)
shows 50 particles in the left region and none in the right region. After 35001 steps,
the particles have been dispersed in the two regions (upper right). The number of
particles in the right region (lower) zero when the step number is zero and approaches
25 at a large step number. The rate of increase of particles in the right region is a
measure of the ﬂux of particles from the left to the right regions. This simulation also
demonstrates how long it takes for the two regions to come to equilibrium.

208

CHAPTER 8. PEDAGOGICAL METHODS

develops an intuition for the way in which the random motions of par-
ticles lead to their diﬀusive spread. Furthermore, this demonstration
sets the stage for a precise derivation of Fick’s ﬁrst law (which relates
particle ﬂux to concentration gradient) starting from a random-walk
model of diﬀusion (Weiss, 1996a, Section 3.2.1).

Some models of biological phenomena are diﬃcult to teach not because the
mathematics is diﬃcult, but because the mathematics is messy with a large num-
ber of parameters. Thus, students can get lost in the notation and in the messi-
ness of the description. A software package that allows manipulation of the
model parameters can cut through the messy description and build intuition
very quickly to expose the inherent simplicity of the underlying model.

Example 8.2 Even the simplest models of carrier-mediated transport
involve a number of parameters and several physical processes.
In
our experience in teaching this topic, there is a great tendency for
students to get lost. The derivations of the relations of ﬂux to con-
centration are simple, but take some time and do not give a great deal
of insight into the workings of this class of models. We have found
that time spent in lecture using the carrier-mediated transport pack-
age gives students an immediate intuition into the workings of these
models. Students are then motivated to follow the derivations and to
appreciate the precise description that results.

Simulations are especially helpful to motivate students to grapple with con-
cepts that may be diﬃcult and to foster a sense of intellectual engagement. Prop-
erly used in lecture, the simulations promote an active participation in learning
rather than the more passive participation that comes from simply listening to
a lecture (Mazur, 1997). Asking students question in lecture gets them to partic-
ipate intellectually.

Example 8.3 The simplest diﬀusion processes result when both par-
ticle ﬂux and concentration are time independent. To motivate stu-
dents to think about such processes it is helpful to ask them to pre-
dict the steady-state spatial distribution of particles when the ﬂux is
a constant in space and time. Is the distribution constant? Is it expo-
nential? Is it Gaussian? After the students have made their guesses
— and perhaps after a tally of all the guesses has been made — the
simulation of the random-walk model can be begun with a constant
source of particles at one end of a rectangular ﬁeld and a sink at the
other. The derivation of the steady-state distribution can proceed on
the blackboard while the simulation is in progress. The parameters
of the simulation can be chosen so that the spatial distribution of
particles approaches its steady-state distribution in about the time it

8.2. USES OF THE SOFTWARE

209

Figure 8.2: Steady-state distribution for random walks in a single compartment. The
compartment was initially empty as shown in the upper left panel and the step size was
set to 5. There was a source at 0 and a sink at 195. One particle per step was generated
by the source. After 4001 steps, the particles were distributed as shown in the upper
right panel with the histogram shown in the lower left panel. Except right near the
source, the spatial distribution is linear. The number of particles is plotted versus
step number in the lower right panel. The results show that the number of particles is
approaching a constant for this number of steps indicating that the distribution is near
its steady-state distribution.

takes to complete the derivation. From time to time during the deriva-
tion, the lecturer can check the progress of the simulation by exam-
ining the dependence of the number of particles in the ﬁeld on time.
This number approaches an asymptotic steady-state value. Hence,
this plot gives a quantitative estimate of whether the spatial distribu-
tion has reached its steady state (Figure 8.2). When the derivation is
complete and the simulation is complete the two can be compared.
This usage of the computer is fun and motivates students to follow
the derivation which solves this problem rigorously.

Example 8.4 Diﬀusion between two ﬁnite compartments through a
separating membrane is an important transport process in biological
systems. It can model, for example, diﬀusion between the cytoplasm
of a cell and the extracellular ﬂuid, across the plasma membrane.
There are two important time scales for two-compartment diﬀusion
through a membrane: the time for the concentration in the membrane
to reach its steady-state distribution and the time for equilibration of
the two compartments. For thin membranes, the spatial distribution

210

CHAPTER 8. PEDAGOGICAL METHODS

of concentration in the membrane reaches its steady-state distribu-
tion much more rapidly than the time it takes the two compartments
to equilibrate. Thus, it is adequate to relate ﬂux and concentration
by a steady-state relation even though concentrations in the two com-
partments are changing in time; a point that can be somewhat tricky
for students to understand. This conceptual diﬃculty is removed if
the solution to the two-compartment diﬀusion problem can be dis-
played for a membrane of arbitrary thickness. Simulation experi-
ments make these two time scales clear (Figure 8.3). Furthermore,
there is a general lesson to be learned about the nature of approxima-
tions to be made for a system with many kinetic processes, but where
one process is rate-limiting.

Example 8.5 A deﬁning characteristic of electrically excitable cells is
their sharp threshold for excitation. Sub-threshold current stimuli
produce no action potential; super-threshold currents do. The diﬀer-
ence in current level between sub- and super-threshold stimuli can
be very small. The Hodgkin-Huxley model possesses such a sharp
threshold which can be demonstrated (Figure 8.4) by showing that a
small increase in a subthreshold stimulus current can result in an ac-
tion potential. The mathematical basis for the threshold is subtle. We
have found that demonstrating the sharp threshold in the Hodgkin-
Huxley model in a dramatic fashion will motivate students to exam-
ine the mathematical basis of sharp thresholds in such diﬀerential
equations (Weiss, 1996b, Section 4.4.1). By preparing in advance, the
threshold can be bracketed so that an increase of one unit in the
least signiﬁcant digit changes a sub-threshold stimulus to a supra-
threshold stimulus. This raises the student’s curiosity about the na-
ture of a threshold in a diﬀerential equation and motivates them to
follow the lecture devoted to this property.

Another use of computers in lecture is to perform “What if” experiments as
a way to build intuition. A typical and obvious use is to ask the class to pre-
dict what will happen if some system under study is perturbed in some way.
This type of “audience participation” breaks the formality of the lecture, puts
students at ease, and engages their intellect. A simulation can be run and the
outcome of the experiment can be obtained instantly. There is then an opportu-
nity to discuss the relation between the outcome of the simulation experiment
and the students’ expectations. Changing almost any parameter of any of the
simulations can lead to valuable discussions and deeper insights.

Example 8.6 Suppose we have two solutes that can bind to a trans-
porter in a chemically-mediated transport mechanism. What if ... we
change the dissociation constant for the second solute on the inside

8.2. USES OF THE SOFTWARE

211

Figure 8.3: Time constants in two-compartment diﬀusion. The left bath initial concen-
tration was 10 µmol/cm3 with a width of 0.5 cm; the right bath initial concentration
was 5 µmol/cm3 with a width of 1 cm; the membrane width was 0.01 cm and the ini-
tial concentration was drawn as shown in the upper left plot. The upper three plots
show the spatial distribution of concentration (membrane view with a bit of each bath
on each side) at three times: 0, which shows the initial distribution; 15 seconds, which
shows the distribution is linear in the membrane but the two baths are not equilibrated;
3705 seconds, which shows the baths and membrane near equilibration. The lower two
plots show the concentration as a function of time. The left plot vs. time shows the
concentration as a function of time in the left bath and for a point in the membrane.
The concentration in the membrane has not changed appreciably over a time span for
which the concentration in the membrane has nearly reached steady-state. The right
plot shows the concentration as a function of time in the two baths over a time scale
that shows the concentration equilibrating.

212

CHAPTER 8. PEDAGOGICAL METHODS

Figure 8.4: The threshold for
eliciting an action potential
in the Hodgkin-Huxley model.
The stimulus is a current pulse
of 1 ms duration;
the sub-
threshold amplitude is 14.3820
and the suprathreshold ampli-
tude is 14.3821 µA/cm2 .

of the membrane? How will the ﬂuxes of the ﬁrst and second so-
lutes change? How will the fraction of transporters bound to the ﬁrst
and second solutes on the inside of the membrane change? How will
the fraction of transporters bound to the ﬁrst and second solutes on
the outside of the membrane change? Such questions are answered
quickly by use of the chemically-mediated transport package and the
answers invite further discussion.

As will be described in further detail below, lectures can also be used to
perform a research project live with audience participation. Thus, the lecturer
and the students are working on the project together. This lends a quite diﬀerent
atmosphere to lectures.
The uses of computation described above have become integral, and now
essential, parts of lectures and are performed live in the lecture room.
It has
proved both an eﬀective and an enjoyable part of teaching and learning.

8.2.2 Electronic classroom and homework problems

We hold several classes in an “electronic classroom” in which each student has
access to a computer workstation and is free to work either from prepared home-
work problems or in a self-directed manner. We have found that most students
prefer to work on the homework problems and only a few will work indepen-
dently. Some students ﬁnish that portion of the homework assignment in the
session in the electronic classroom. Others start on the problems and ﬁnish
them at a later date.

8.2. USES OF THE SOFTWARE

213

Students and staﬀ members work together in this setting. The objective is
for everyone to arrive at the solution to the problems, each of which is chosen
to illustrate some important issue in the subject matter. This mode of work is
noncompetitive, cooperative, and self-paced. It also provides a good opportunity
for students and staﬀ to interact in a more informal setting than is possible in a
lecture or a recitation.
Some of the problems we have frequently assigned for homework and used
successfully in an electronic classroom are described below.

Example 8.7 In connection with two-compartment diﬀusion, we use
Problem 3.4 to make sure students understand the diﬀerence between
the time constant to reach steady state in a membrane and the time
constant to reach equilibrium between the two baths that are sepa-
rated by the membrane (see Example 8.4).

Example 8.8 We often assign Problem 4.1 to give students some feel-
ing for the relation between ﬂux and concentrations for the simple,
symmetric, four-state carrier model. This is the simplest of the mod-
els for carrier-mediated transport through membranes and it is a
stepping stone for understanding more complex models.

Example 8.9 The Hodgkin-Huxley model is diﬃcult for undergrad-
uate students to comprehend. Therefore, we start students think-
ing about the model in the voltage-clamp conﬁguration by assigning
Problem 5.1. Part a is straightforward but part b requires that stu-
dents perform simulations iteratively to arrive at a solution. They
learn about the interaction of activation and inactivation to yield the
sodium conductance in a voltage-clamp conﬁguration.

Example 8.10 We usually assign one part of Problem 5.11 to get stu-
dents thinking about the Hodgkin-Huxley model in the current-clamp
conﬁguration. The assignment is in the form of a puzzle. Students
enjoy the challenge of ﬁguring out the puzzle. With a set of default
model parameters and stimulus current parameters, the Hodgkin-
Huxley model gives rise to an action potential. A change in one of
many diﬀerent parameters of this model leads to no action potential
in response to the same current stimulus. Students are given prob-
lems in each of which one parameter (e.g., temperature, membrane
capacitance, an ion conductance, and ion concentration) has been
changed to block the occurrence of the action potential. Students are
asked to ﬁnd a compensatory change in parameters that will restore
the action potential to be identical (within certain bounds) to that
obtained with the default parameters. This type of problem forces
students to examine the interactions of internal model variables in a
critical manner.

214

CHAPTER 8. PEDAGOGICAL METHODS

Example 8.11 Understanding the kinetic behavior of single channels
is challenging for students. We usually assign Problem 7.1, which
deals with a two-state channel that is not voltage gated, and Prob-
lem 7.2, which deals with a two-state channel that is voltage gated.
Both of these problems ask students to design a channel that opens
at a particular value of the membrane potential and has prescribed ki-
netic properties. Students learn about the diﬀerences between voltage-
gated and ungated channels. Also, these problems exercise the stu-
dents’ intellect in a very diﬀerent manner than do the traditional
problem sets that are a routine part of homework assignments.
In
a traditional homework assignment, students are asked to analyze
problems that are completely deﬁned. The software problems can be
less well deﬁned so that the deﬁnition of the problem is part of the
assignment.

8.2.3 Projects

We have found it educationally eﬀective to require that students complete a
project of their choice using the Hodgkin-Huxley model software. The exercise
aﬀords students an opportunity to formulate a hypothesis about a theoretical
topic, to write a proposal, to test the hypothesis, to reach a conclusion, and
to communicate their results in writing. Although these projects can be quite
time consuming (for both students and faculty), they have been very popular
with the vast majority of students. For many of the students, this is the ﬁrst
learning activity that has the ﬂavor of a research project. To emphasize the
importance of this educational activity, performance on the project is graded
and accounts for 15% of the grade in the subject, a percentage that is comparable
to the importance of one of the examinations in the subject.
During one semester when enrollment in the subject was unusually high, it
was necessary to pair up students to make the management of projects accept-
able.1 Perhaps not surprisingly, we found that the quality of the work seemed
to improve. Thus, we have asked students to work in teams of two ever since
although we do not require it.
We also found that as the years went by, reports got longer and longer. Thus,
to encourage the students to be concise we placed limits on the lengths of report.
We give the following instructions to students about the rules for the project.

“Students may do projects individually or in pairs.
If a pair of stu-
dents collaborate on a project they should submit a single proposal
and a single report which identiﬁes both members of the team and
gives both email addresses. Proposals will be returned as soon as

1 Interacting with students to help them write acceptable proposals and to conduct these
projects takes considerable time. Assessing a single ﬁnal project report takes over one hour.

8.2. USES OF THE SOFTWARE

215

possible so that students may revise them. Only the ﬁnal, accepted
proposal will be given a grade.

The demonstration project performed in lecture cannot be the basis
of a student project. The report should be at most 10 pages of text
and at most 10 ﬁgures and tables.”

We describe the steps involved in the project in detail.

The proposal

Students are required to write a proposal, which must be approved before they
start the project. Sometimes students write as many as 4 proposals before an
adequate project is deﬁned. Interestingly, the impetus for rewriting proposals
comes as often from the student wanting to get it right as it does from the in-
structor. The main task for the instructor is to help students to deﬁne a project
that is challenging but still feasible taking into account the student’s interests
and knowledge. The project involves formulating and testing a hypothesis about
some property of the Hodgkin-Huxley model, preferably one that has physiologi-
cal signiﬁcance. It is desirable, although not necessary, that students read papers
in the literature concerning their topic.
Students are given the following instructions:

“The proposal should contain a brief statement of the hypothesis you
propose to test, as well as your proposed method of procedure. In-
clude a list of the computations you will perform and the measure-
ments you plan to make. Indicate how the measurements will be used
to help you come to a conclusion. The proposal should be written on
one 8 1/2 × 11 sheet of paper. A sample proposal is shown in Fig-
ure 8.5.”

Demonstration project

We have found it helpful to give a one-hour lecture on how to do a research
project, by doing a project live in the lecture room. An acceptable proposal for
the project is distributed at the beginning of the lecture (such as the one in Fig-
ure 8.5). The lecture involves two members of the instructional staﬀ who act as
a student pair working on a project. To make it run smoothly, the staﬀ mem-
bers rehearse brieﬂy. Simulations are performed in front of the class and the
two instructors argue about what is to be done next and on how to interpret the
results. They worry out loud about their grade on the project, etc. The project
is chosen so that results obtained in an initial range of parameters are plausible
and simple to interpret, but something unexpected happens when the parameter
is outside this range. One project that has been used successfully is based on

216

CHAPTER 8. PEDAGOGICAL METHODS

PROPOSAL: HODGKIN-HUXLEY MODEL PROJECT
• Name: Hy I.Q. Student
• Email address: hiqstudent
• Hypothesis: The diﬀerence in observed action potential shape between
the giant axon of the squid and the node of Ranvier of the rat is due to a
diﬀerence in temperature.
• Background: The rate constants that determine the variables m, n, and
h in the Hodgkin-Huxley model increase as the temperature is increased.
Hence, I would expect that with increased temperature the time course
of the action potential would be briefer. The observed action potential
◦
C. is briefer than the action
of the rat node of Ranvier measured at 37
◦
C. Hence, I will determine
potential of the squid giant axon measured at 16
whether this diﬀerence in temperature is adequate to explain the diﬀerence
in action-potential waveform. In this study, I will assume that the Hodgkin-
Huxley model accounts for action potentials in both preparations. Since the
intracellular and extracellular ionic concentrations of sodium, potassium
and calcium also diﬀer in these two preparations, if time permits I will also
investigate the eﬀect of this diﬀerence.
• Procedure: I will obtain the intracellular and extracellular concentrations
of sodium and potassium ions for the rat node of Ranvier from the liter-
ature. I will perform a series of simulation studies with a single pulse of
membrane current whose amplitude will be set at a constant suprathresh-
old value. I propose the following series of simulations

# Temp.
◦

C

1

2

3

4

16

37

16

37

Ion Concentrations

default values for squid giant axon

default values for squid giant axon

values found for rat node

values found for rat node

The waveforms of the action potentials obtained under the various condi-
tions will be compared on the graphics display and the summary statistics
for each condition will be examined. If condition 4 yields an action poten-
tial that resembles that which is measured on the rat node of Ranvier, then
the hypothesis will be supported by these calculations. If they diﬀer, then
I will investigate the bases of the diﬀerences.

Figure 8.5: Sample proposal for a project.

8.2. USES OF THE SOFTWARE

217

the hypothesis “Increasing the temperature increases the rate of change of the
action potential at its onset.” Simulations are performed ﬁrst for a range of tem-
perature that support this hypothesis. Using the blackboard, one member of the
staﬀ plots the maximum rate of change of the potential (obtained conveniently
by measuring the peak of the capacitance current) for each temperature after
each simulation is performed. However, at a suﬃciently high temperature, the
action potential is blocked. The staﬀ members argue about whether to ignore
this eﬀect or to go on and to confront this unexpected ﬁnding. They consider the
possibility that they have found a bug in the software or that this phenomenon
results from problems of numerical integration. By performing further simula-
tion experiments, it is made clear that these explanations are not plausible. The
instructors propose various circular arguments of the type students frequently
propose. “The action potential is blocked because the sodium conductance is
small.” Of course, the sodium conductance depends upon the membrane poten-
tial. Hence, the sodium conductance is small because the membrane potential
is small. Pursuit of this circular argument (on which some students get stuck
each year in their own projects) can have the class in hysterics. In any case, the
analysis of the basis of thermal block now becomes the focus of the project.
Simulation experiments performed for small changes in temperature below the
temperature at which the action potential is blocked, reveals the interplay of
kinetic processes that result in thermal block. Since these same processes are
involved in the excitation of the action potential, the analysis can give great
insight into the mechanism of initiation of an action potential (Weiss, 1996b,
Section 4.4.8).

The computations

Students are given the following instructions on how to perform the computa-
tions.

“After carefully deﬁning the computations needed to determine the
validity of your hypothesis, you should perform the necessary com-
putations. You should keep careful track of the computations you
perform by entering relevant information in a notebook. The note-
book should indicate the date of each computational session as well
as the identity of the computer you used (make and model). Keep
an accurate record of each computation so that you can reconstruct
what you did at a later date. Save your results in ﬁles. Make com-
posite plots to summarize a series of measurements. For example, to
show the eﬀect on the action potential of some parameter, plot the
action potentials for selected values of the parameter on one set of
axes. Arrange you work so that you have time for some ﬁnal com-
putations after you begin writing the report. You may ﬁnd that new
questions will arise as you write the report.
If you leave adequate

218

CHAPTER 8. PEDAGOGICAL METHODS

time, you may be able to resolve these questions.”

The report

Many undergraduate students have never read a scientiﬁc paper and do not
know how to write a project report. Hence, we devised the following descrip-
tion of the report.

“The Project Report is an opportunity for you to work on your ability
to express yourself concisely. Do not repeat material that is easily
referenced. For example, there is no need to reproduce any ﬁgure
from readily-available texts: simply refer to it. Technical writing is
necessarily directed at some particular intended audience. Write the
Project Report as though it were to be published in a journal that is
read primarily by students who have taken this subject. Thus, you
may assume that your audience has some working knowledge about
the subject matter, but no detailed knowledge of your speciﬁc project.
The Project Report should contain the following sections.

Cover Page. On the cover page include the title of the project and the
author’s/authors’ names, and the date.
Abstract. The abstract is a one paragraph (< 100 words) summary
of the report including the hypothesis investigated, the methods
used, and the principal results and conclusions. This section
should be written last.
Introduction. This is a brief section (about 1 page) designed to mo-
tivate the reader to read your report. Include background infor-
mation on the problem, hypotheses to be tested, signiﬁcance of
the work, etc. You may give citations to texts where appropri-
ate. The introduction should be directly relevant to your report
and should not discuss neurophysiology or the brain in general
terms.
Methods. Explain any methodological or procedural issues that are
not obvious. For example, if you measured the time of the peak
of the action potential as a function of some parameter, explain
how you measured the time of the peak and how you deﬁned
when an action potential occurred, i.e., how did you separate the
action potential from the local response.
Results. Describe your computational results (whether or not they ﬁt
with expectations) in the results section. Generally, results can
be communicated more eﬃciently and accurately with pictures,
graphs, and tables than with words alone (e.g., see Figures 5.16,
5.18, 5.19, and 8.4). However, a collection of printed graphs

8.2. USES OF THE SOFTWARE

219

without a written description of their relevance is unacceptable
as a Results section. Students frequently err on the side of in-
cluding a large number of graphs and little description of their
relevance. The Results section should be organized to lead the
reader through a logical sequence of results that terminates inex-
orably in a conclusion. Your objective is to construct an airtight
case for some conclusion whether or not it supports or rejects
your original hypothesis. This is not the place to interpret or to
discuss the results.
Discussion and conclusions. State your conclusions concisely and point
out how your results support your conclusions. You might also
suggest additional computations to further test your hypothesis.
Your conclusions and discussion should be focussed on the re-
lation between your results and your hypothesis. The discussion
section can include relevant speculations.
Appendix. The appendix should include a copy of the protocol taken
during the computational sessions.”

Grade for the project

Grading of the project reports has evolved since its inception in 1984. After
using these project for a few years, we noted that many, but still less than a
majority, of the projects focussed on a relatively small number of topics. The
quality of these reports also improved markedly with time. We felt that the
graded reports from previous years were available through student archives. To
encourage students to choose new topics and to reward originality we added
an assessment for originality.
In addition, we found that a hard deadline for
accepting reports was hard to enforce so we made the deadline somewhat soft
assessing a numerical penalty for lateness by a formula that the students knew
ahead of time. The following grading scheme has emerged by trial and error and
is satisfactory.

“The grade will not depend on whether the project was an individual
or a team project. Both members of the team will get the same grade
on the project. The grade for the computer project will be based on
the proposal and on the report using the following criteria:

Proposal (10%) The proposal should be concise and clearly deﬁne the
project in the form of a hypothesis.
It should include a brief
description of the methods to be employed. A late proposal will
get a grade of 0.
Report Structure (15%) All the sections of the report should be present
and each should contain the relevant information.

220

CHAPTER 8. PEDAGOGICAL METHODS

Clarity/Conciseness (20%) A good report is easy to read. The con-
tent of each paragraph and each graph should be clear. Every-
thing included in the report should be there for a reason. Points
will be deducted for extraneous material such as a large number
of graphs without explanation in the text.
Conceptual Correctness (30%) Correctness will be judged by the an-
swers to several questions. Are there clear conceptual errors?
Are the results confused? Are the results (i.e. which follow di-
rectly from the simulations) confused with the interpretations
(which rely on information other than the simulations)?
Originality (25%) This grade will assess the degree of diﬃculty, nov-
elty, and imagination of the project. The simpler projects, such
as many of those suggested in Section 5.6 and used by many
students in the past, will receive ≤ 10%, more intellectually chal-
lenging, novel projects will receive 25%.

Reports that are not turned in on time will be penalized by the follow-
ing formula — the grade of the report will be multiplied by a lateness
factor L, where L = 0.3e−t/4 + 0.7e−t/72 and t is the number of hours
late.”

Electronic interactions

Students are invited to interact with the teaching staﬀ via electronic mail. This
has been an increasingly eﬀective means of teaching and learning. For example,
some students prefer to submit proposals for projects electronically. The staﬀ
responds to these electronically, sometimes within minutes but certainly by the
next morning. The rapid turnaround time between submission, critique, and re-
submission can make writing an acceptable proposal, which some students ﬁnd
challenging, more eﬃcient. Students use electronic messages to seek help on
independent projects as they are conducting them. They send queries electron-
ically and receive responses electronically. This type of interaction, in which
the individuals involved may be located at opposite ends of the campus, is an
eﬀective way to achieve individualized instruction.

8.3 Assessment

8.3.1 Cost of development

We estimate that it has taken about 5 person-years to develop the software.
Although harder to estimate, it has taken perhaps an additional person year of
faculty time to design software packages, thoroughly test each software package,

8.3. ASSESSMENT

221

design problems and projects, write documentation, and to investigate pedagog-
ical methods.

8.3.2 Extent of software usage

Our use of the software in teaching has increased over the years. Our current
usage is summarized as follows: There are 37 lectures (classes attended by all
the students simultaneously) in the subject and the software is used in about
8-10 lectures. There are 24 recitations (classes attended by students in groups
of about 25) and the software has not been used in any of these; in part due
to the lack of availability of appropriate classrooms with network connections
in the past. This has now been rectiﬁed and we expect in the future to use the
software routinely in recitation classes. Several recitations devoted to using the
software are held in electronic classrooms. Typically, there are 13 problem sets
assigned during a semester; ﬁve or six problem sets include parts that involve
the software. There is one laboratory session, which requires a formal laboratory
report but does not involve the software. There is one project that involves the
software which requires a formal report. There are about 9 short quizzes and
two long examinations; none use the software.
This assessment shows that use of the software represents a small but appre-
ciable fraction of the teaching and learning in this subject. Since we have found
that use of the software is labor intensive both for the staﬀ and the students, we
have been reluctant to increase the use of the software.

8.3.3 Informal assessment of impact on learning

We have not conducted a careful experiment with controlled groups to test ob-
jectively the eﬀectiveness of the software in promoting students’ comprehen-
sion of the material. Subjectively, it was clear at the outset that the students
enjoyed using the software and that the staﬀ felt that use of the software was
pedagogically eﬀective. Thus, it did not seem fair to exclude some students
from the software for the sake of conducting a scientiﬁc experiment. Surveys of
student opinions on the eﬃcacy of the software have been predominantly very
positive with opinions ranging from those who thought we should develop soft-
ware packages for every topic in the subject to a few who found the software
confusing. Each year, several students make valuable suggestions on software
improvements or on methods for software use. These student inputs have been
important for the evolution of the software. This subject matter was taught for
20 years before the software became available and for 15 years after it became
available. The staﬀ has little doubt that students learn the material more eﬃ-
ciently and to a greater depth with the use of the software than they had before
the software became available.

222

CHAPTER 8. PEDAGOGICAL METHODS

There are other signs of student interest in the software. Students clearly
enjoy working on the software, especially on their own projects, despite the
great eﬀort that is required. The impressions of the staﬀ are that while most
students get some beneﬁt from using the software, the very best students have
an experience that most resembles a small research project. This can be seen
in the reports students write to complete their projects. Some of these reports
resemble undergraduate theses in scope and in content. Another indication of
student interest is that several students have written software on their personal
computers to emulate some of the software we have provided. This was done
just for their own interest. There is a ﬁnal and most important indication of
student interest. As a result of using the software in this subject, students
have been interested to work on the development of educational software. Since
1984, nine undergraduate and three graduate students have been involved in
this eﬀort. They have written all the software packages.

8.3.4 Surveys and focus groups

Since 1984, surveys of students who have used the software have been con-
ducted routinely. Sometimes these surveys were done at the end of the semester
and sometimes immediately after students completed an assignment that in-
volved the software. Surveys were done by having students ﬁll out forms as well
as via email. In recent years, an independent evaluator conducted the surveys
and ran focus groups. The feedback we have received has been valuable and
has helped us focus on problems students were having with the software.
In
general, assessments of student have been very positive. Most students ﬁnd the
software pedagogically eﬀective and some ﬁnd the software critical to under-
standing complex topics such as the Hodgkin-Huxley model. Students felt they
received the most educational beneﬁt from those software packages with which
they spent the most time. In particular, the projects were universally praised as
educationally eﬀective.

8.3.5 Impact on teaching

It has often been assumed that one beneﬁt of the use of computers in teaching
is to conserve faculty time, and that a cost was isolation of students from each
other and from the faculty.
In our experience, neither the presumed beneﬁt
nor the cost have materialized. Our use of computers in teaching has increased
contact between students and faculty and among students. The main beneﬁt has
been more eﬀective teaching and learning. The main cost has been an increased
work load for both students and faculty.

8.4. CONCLUSIONS

8.4 Conclusions

223

We have used computers to teach biophysics and physiology since 1984. Our use
has been exclusively to develop software that simulates some physical, chemi-
cal, and biological process that is reasonably well understood. We have invented
no new models, but we have explored extant models that underlie our under-
standing of transport and electrical processes in cells. In teaching this material,
we have learned some lessons — both pedagogical and practical — which are
summarized below.

8.4.1 Pedagogical matters

Development of educational software must be driven by pedagogy

We have evolved a simple strategy for educational software development. We
identify important topics in biophysics and physiology that pose some concep-
tual diﬃculties for students and examine whether comprehension could be im-
proved by the use of computational methods. Once we identify such topics, we
design and then implement the software.

Software complements other pedagogical vehicles

Software cannot replace a good lecturer or an incisive derivation in a lucid text-
book. A simulated experiment cannot replace a real laboratory experience. How-
ever, software represents an additional pedagogic vehicle that can, if appropri-
ately used, complement other vehicles.

Students should have access to the software

While lecture demonstrations can be pedagogically eﬀective, the potential for
learning is greatly enhanced when students use the software themselves. The
educational beneﬁts of student usage of the software as opposed to exposure to
it in lecture are similar to the beneﬁts derived when students solve problems in
homework as opposed to watching a problem solved in class.

The software must be integrated into the subject

The software should be an integral part of lectures, recitations and homework
and used only where it enhances learning and never used simply because it is
available and because the staﬀ has invested a great eﬀort in its production. Soft-
ware homework and projects must be assigned and graded with the grade con-
tributing to the student’s grade in the subject. If the grades on software assign-
ments do not count toward the student’s ﬁnal grade in the subject, the student

224

CHAPTER 8. PEDAGOGICAL METHODS

will correctly conclude that the software is secondary in importance to those
assignments that do count toward the ﬁnal grade.

The software should have layers of complexity

Students approach the software with diﬀerent levels of sophistication in their
understanding of the subject matter.
It is essential to devise the software so
that all students can receive some educational beneﬁt. This requires that the
software be simple to use at the outset but contain suﬃcient depth to challenge
the more sophisticated students and even the staﬀ.

8.4.2 Practical matters

Even slightly ﬂawed software should be avoided

The software must aid students to learn the material and should not impede
that objective. Software with ﬂaws, even minor ﬂaws, is a distraction. Students
will remember even a minor ﬂaw in the software and will forget the point of the
demonstration. Undergraduate students, in particular, will lose conﬁdence in an
assignment that involves software with even inconsequential ﬂaws. Since they
are quite busy, it is easy to rationalize avoiding a diﬃcult assignment by report-
ing that the software doesn’t work even if the ﬂaws should not distract them
from the main point of the assignment. The more mature graduate students
seem more tolerant of minor ﬂaws and are willing to endure them to derive ed-
ucational beneﬁt. But bugs, no matter how minor, should be avoided so that
students can concentrate fully on the didactic material.

Expect some complications

A computer in the classroom increases the range of pedagogical tools available
to the instructor. But it also complicates the instructor’s task. If the instructor
is prepared and competent and both a blackboard and chalk are available, not
much can go wrong with a lecture. With a computer in the classroom, things can
go wrong although the number of episodes has actually been extremely low. It
is necessary to be prepared for the possibility of a computer problem so that
valuable class time is not lost. The availability of overhead transparencies that
cover the relevant material that would have been covered with the computer is a
good backup strategy.

Design of the user interface is critical

Most of our time spent in software development is devoted to the design of user
interfaces that allow students to focus on the subject material and avoid arcane
“computerese”. A great deal of the students’ time can be conserved if the user

8.4. CONCLUSIONS

225

interface is graphic, intuitive, and common to all the software. The user interface
cannot be too transparent!

Good documentation is important

We have placed a great deal of emphasis on writing comprehensive documenta-
tion for all the software. The documentation gives some background informa-
tion on the subject matter and contains a detailed user’s manual for the software
plus a list of suggested problems and projects. Remarkably, some students learn
to use the software by reading the manual; others experiment with the software.
There are diﬀerent learning styles for using software. To reach a maximum
number of students, a variety of modalities are helpful.

Development of good educational software is time-consuming and iterative

All our successful packages have been rewritten many times in response to staﬀ
and student input. There is no shortcut to the development of good educational
software.

Use of educational software increases contact with students

Early advocates of the use of computers in teaching suggested that one beneﬁt
was a saving in faculty time. Eﬀective use of computers could replace faculty
in certain tasks. Some educational theorists worried about the isolation of stu-
dent from faculty resulting from this use of computers. Our experience with
our method of use of computers has given the opposite result. It has greatly in-
creased contact with students to the mutual advantage of students and faculty;
the interactions have been very rewarding.

Maintenance of software

Changes in operating systems or in higher level languages on which the soft-
ware is based will continue to require some maintenance. In addition, student
suggestions can help to improve the software if the resources for maintenance
are available.

Projection systems

Projection systems for use of computers in the classroom have until quite re-
cently been only marginally adequate. However, the technology is improving
rapidly and the cost is decreasing rapidly as well. However, this is not a place
to skimp. An inadequate display system, where the students cannot really see
what is being depicted, defeats all the eﬀort required to develop the software.

226

CHAPTER 8. PEDAGOGICAL METHODS

8.4.3 Bottom line

Our experience indicates that the development, usage, and maintenance of a suc-
cessful educational software package is a diﬃcult and time-consuming process
— several iterations have been required to bring our most successful packages to
their current level of performance. However, we have also found that computers
are a powerful vehicle for teaching. They can be used to: engage the student’s
intellect, to motivate learning, to allow students to test their understanding of
a topic, to make learning self-paced and fun. With the aid of software, students
take intellectual ownership of a topic rather than experiencing it vicariously.
Once eﬀective software has been used in teaching and learning, it becomes an
indispensable tool.

Bibliography

Aidley, D. J. (1989). The Physiology of Excitable Cells. Cambridge University
Press, Cambridge, Great Britain.

+
-induced anomalous rectiﬁcation
Armstrong, C. M. (1966). Time course of TEA
in squid giant axons. J. Gen. Physiol., 50:491–503.

Armstrong, C. M. and Binstock, L. (1965). Anomalous rectiﬁcation in the squid
giant axon injected with tetraethylammonium chloride. J. Gen. Physiol., 48:859–
872.

Athena (1990a). Computation and Educational Community: A Background Pa-
per. Committee on Academic Computation for the 1990s and Beyond, Mas-
sachusetts Institute of Technology.

Athena (1990b). Computing for Education at MIT: Final Report. Committee on
Academic Computation for the 1990s and Beyond, Massachusetts Institute of
Technology.

Baker, P. F., Hodgkin, A. L., and Shaw, T. I. (1961). Replacement of the proto-
plasm of a giant nerve ﬁbre with artiﬁcial solutions. Nature, 190:885–887.

Balestri, D. (1988). Ivory towers, silicon basements. Infor. Tech. Quaterly, 7:5–
17.

Berkenblit, S. I. (1990). Design of a software diﬀusion simulator and analysis
of a problem in two-compartment diﬀusion. Master’s thesis, Massachusetts
Institute of Technology, Cambridge, MA.

Carruthers, A. (1984). Sugar transport in animal cells: The passive hexose trans-
fer system. Prog. Biophys. Mol. Biol., 43:33–69.

Chapman, R. A. (1967). Dependence on temperature of the conduction velocity
of the action potential of the squid giant axon. J. Physiol., 213:1143–1144.

Colquhoun, D. and Hawkes, A. G. (1977). Relaxation and ﬂuctuations of mem-
brane currents that ﬂow through drug-operated channels. Proc. R. Soc. London,
Ser. B, 199:231–262.

227

228

BIBLIOGRAPHY

Colquhoun, D. and Hawkes, A. G. (1995a). The principles of the stochastic in-
terpretation of ion-channel mechanisms. In Sakmann, B. and Neher, E., editors,
Single-Channel Recording, pages 397–482. Plenum Press, New York, NY.

Colquhoun, D. and Hawkes, A. G. (1995b). A Q-matrix cookbook. How to write
only one program to calculate the single-channel and macroscopic predictions
for any kinetic mechanism.
In Sakmann, B. and Neher, E., editors, Single-
Channel Recording, pages 589–633. Plenum Press, New York, NY.

Cooley, J. W. and Dodge, F. A. (1966). Digital computer solutions for excitation
and propagation of the nerve impulse. Biophys. J., 6:583–599.

Cox, D. R. and Miller, H. D. (1965). The Theory of Stochastic Processes. John
Wiley and Sons, New York, NY.

Easton, D. M. and Swenberg, C. E. (1975). Temperature and impulse velocity in
giant axon of squid loligo pealei. Am. J. Physiol., 229:1249–1253.

Einstein, A. (1906). Sur theorie der brownschen bewegung. Ann. Physik, 19:371–
381. [For translation see Einstein (1956)].

Einstein, A. (1956).
Investigations on the Theory of the Brownian Movement.
Dover Publications. R. Furthe and A. D. Cowper, eds. [Translation of original
publications].

Fick, A. (1855). On liquid diﬀusion. Philos. Mag., 10:30–39.

Fitzhugh, R. and Antosiewicz, H. A. (1959). Automatic computation of nerve
excitation — detailed corrections and additions.
J. Soc. Indust. Appl. Math.,
7:447–458.

Frankenhaeuser, B. and Hodgkin, A. L. (1957). The action of calcium on the
electrical properties of squid axons. J. Physiol., 137:218–244.

George, S. A., Mastronarde, D. N., and Dubin, M. W. (1984). Prior activity in-
ﬂuences the velocity of impulses in frog and cat optic nerve ﬁbers. Brain Res,
304:121–126.

Gerald, C. F. and Wheatley, P. O. (1989). Applied Numerical Analysis. Addison-
Wesley, Reading, MA.

Hanselman and Littleﬁeld (1997). Mastering MATLAB 5: A Comprehensive Tu-
torial and Reference. Prentice-Hall, Englewood Hills, NJ.

Hille, B. (1992). Ionic Channels of Excitable Membranes. Sinauer Associates Inc.,
Sunderland, MA.

BIBLIOGRAPHY

229

Hines, M. (1984). Eﬃcient computation of branched nerve equations.
Bio-Med. Comput., 15:69–76.

Int. J.

Hines, M. and Carnevale, N. T. (1998). Computer modeling mehtods for neurons.
In Arbib, M. A., editor, The Handbook of Brain Theory and Neural Networks,
pages 226–230. MIT Press, Cambridge, MA.

Hodgkin, A. L. (1964). The Conduction of the Nervous Impulse. Charles C.
Thomas, Springﬁeld, IL.

Hodgkin, A. L. (1977). Chance and design in electrophysiology: An informal
account of certain experiments on nerve carried out between 1934 and 1952.
In The Pursuit of Nature, pages 1–21. Cambridge University Press, Cambridge,
England.

Hodgkin, A. L. and Huxley, A. F. (1952). A quantitative description of membrane
current and its application to conduction and excitation in nerve. J. Physiol.,
117:500–544.

Hodgkin, A. L. and Katz, B. (1949a). The eﬀect of sodium ions on the electrical
activity of the giant axon of the squid. J. Physiol., 108:37–77.

Hodgkin, A. L. and Katz, B. (1949b). The eﬀect of temperature on the electrical
activity of the giant axon of the squid. J. Physiol., 109:240–249.

Huxley, A. F. (1959). Ion movements during nerve activity. Ann. N.Y. Acad. Sci.,
81:221–246.

Huxley, A. F. (1964). Excitation and conduction in nerve: Quantitative analysis.
Sci., 145:1154–1159.

Johnston, D. and Wu, S. M. S. (1995). Foundations of Cellular Neurophysiology.
MIT Press, Cambridge, MA.

Joyner, R. W., Westerﬁeld, M., Moore, J. W., and Stockbridge, N. (1978). A nu-
merical method to model excitable cells. Biophys. J., 22:155–170.

Kandel, E. R., Schwartz, J. H., and Jessell, T. M. (1991). Principles of Neural
Science. Elsevier, New York, NY.

Katz, B. (1966). Nerve, Muscle and Synapse. McGraw-Hill Inc., New York, NY.

Keynes, R. D. and Aidley, D. J. (1991). Nerve and Muscle. Cambridge University
Press, Cambridge, Great Britain.

Kulik, C. C. and Kulik, J. A. (1986). Eﬀectiveness of computer-based education
in colleges. AEDS J., pages 81–108.

230

BIBLIOGRAPHY

Mascagni, M. V. and Sherman, A. S. (1998). Numerical methods and neuronal
modeling.
In Koch, C. and Segev, I., editors, Methods in Neuronal Modeling,
pages 569–606. MIT Press, Cambridge, MA.

Mazur, E. (1997). Peer Instruction: A User’s Manual. Prentice Hall, Upper Saddle
River, NJ.

Moore, J. W., Ramon, F., and Joyner, R. W. (1975). Axon voltage-clamp simula-
tions. Biophys. J., pages 11–24.

Neher, E. and Sakmann, B. (1976). Single-channel currents recorded from mem-
brane of denervated frog muscle ﬁbres. Nature, 260:799–802.

Nicholls, J. G., Martin, A. R., and Wallace, B. G. (1992). From Neuron to Brain: A
Cellular and Molecular Approach to the Function of the Nervous System. Sinauer
Associates, Sunderland, MA.

Pearlmutter, B. A. and Zador, A. (1999). Sparse matrix methods for modeling
single neurons. In Koch, C., editor, Biophysics of Computation, pages 487–502.
Oxford Univ. Press, New York, NY.

Plonsey, R. and Barr, R. C. (1988). Bioelectricity, A Quantitative Approach.
Plenum Press, New York, NY.

Press, W. H., Flannery, B. P., Teukolsky, S. A., and Vetterling, W. T. (1986). Nu-
merical Recipes. The Art of Scientiﬁc Computing. Cambridge University Press,
Cambridge, Great Britain.

Press, W. H., Flannery, B. P., Teukolsky, S. A., and Vetterling, W. T. (1988). Nu-
merical Recipes in C. The Art of Scientiﬁc Computing. Cambridge University
Press, Cambridge, Massachusetts.

Shah, D. M. (1990). Computer simulation of the random walk model of diﬀusion.
Bachelor’s thesis, Massachusetts Institute of Technology, Cambridge, MA.

Shampine, L. F. and Reichelt, M. W. (1997). The MATLAB ODE suite. SIAM J. Sci.
Comput., 18:1–22.

Smith, G. D. (1985). Numerical Solution of Partial Diﬀerential Equations: Finite
Diﬀerence Methods. Clarendon Press, Oxford, Great Britain.

Stein, W. D. (1986). Transport and Diﬀusion Across Cell Membranes. Academic
Press, New York, NY.

Tasaki, I. and Hagiwara, S. (1957). Demonstration of two stable potential states
in the squid giant axon under tetraethylammonium chloride. J. Gen. Physiol.,
40:859–885.

BIBLIOGRAPHY

231

Weiss, T. F. (1996a). Cellular Biophysics. Volume 1: Transport. MIT Press, Cam-
bridge, MA.

Weiss, T. F. (1996b). Cellular Biophysics. Volume 2: Electrical Properties. MIT
Press, Cambridge, MA.

Weiss, T. F., Trevisan, G., Doering, E. B., Shah, D. M., Huang, D., and Berkenblit,
S. I. (1992). Software for teaching physiology and biophysics. J. Sci. Ed. Tech.,
1:259–274.

Wilson, J. M. and Redish, E. F. (1989). Using computers in teaching physics.
Physics Today, pages 34–41.

Index

Absolute reaction rate, 177
Absolute temperature, 90, 131
Accommodation, 114
Action potentials
eﬀect of sodium concentration, 120
eﬀect of temperature, 120
electrically excitable cells, 88, 126
examples, 119
Activation factor, 91
All-or-none principal, 113
Analytic solutions, 37, 40, 48
Anode, 129
Anode-break excitation, 114

Backward Euler approximation, 93, 132,
134–136, 171
Binding reaction, 61–63, 66, 67, 86
Boundary conditions, 135, 137, 139
Hodgkin-Huxley model, 133, 169
random walk model, 13, 16–17,
21
reﬂecting, 37, 40, 48, 54, 56
transparent, 37, 40, 48, 54

Cable properties, 164
Capacitance current density, 89, 130,
166
Carrier-mediated transport
axis scale, 77
binding reaction, 61–63, 66, 67,
86
carrier density, 61
chemical reaction, 60
CMT Control ﬁgure, 69, 70, 70
CMT Parameters ﬁgure, 69, 71, 71–
73, 73–74

232

CMT Setup steady state plot ﬁg-
ure, 76
CMT Setup transient plot ﬁgure,
80
CMT State ﬁgure, 69, 71, 71–73,
74–75
CMT Steady state plot ﬁgure, 76
CMT Transient plot ﬁgure, 79
CMT Transients numerics ﬁgure,
80
CMT Units ﬁgure, 70
comparison of simple and general
carriers, 84
competitive inhibition, 63
dissociation constant, 62, 63
eigenvalues, 67, 69, 80, 85, 86
exchange diﬀusion, 83
ﬁle handling, 73, 75, 78
ﬂux, 61, 63, 65, 68
ﬂux arrows, 75
general, four-state carrier, 66–68,
71
schematic diagram, 66
steady-state equations, 68
transient equations, 67
transient response, 85, 86
intereactive steady-state analysis,
71
kinetic equations, 61, 63, 66
matrix diﬀerential equation, 67
matrix equation, 62, 64, 68
modiﬁable parameters, 74
Modify line properties ﬁgure, 78
numerical solutions, 69
overview, 2
parameter values, 69

INDEX

233

principle of detailed balance, 74
problems, 81–86
properties, 60
simple, four-state carrier, 61–63,
71, 81–84
eﬀect of asymmetry, 81, 82
ﬂux vs. concentration, 83
schematic diagram, 61
steady-state equations, 62
simple, six-state carrier, 63–65, 71
dependence of ﬂux on concen-
trations, 84
dependence of ﬂux on parame-
ters, 85
schematic diagram, 63
steady-state equations, 64
user’s guide, 69–81
Cathode, 129
Cell radius, 128
Centered diﬀerence, 132
Chemical reaction, 35, 38–40, 44, 60
CMT, see Carrier-mediated transport
Collision of action potentials, 168
Competitive binding, 63
Complementary error function, 39
Concentration, 11, 34, 90, 131
Conductance, 175, 178
Conduction velocity, 163, 170, 171
Continuity relation, 12, 34
Control ﬁgure
CMT, 69
HH, 94
IC, 180
MD, 41
PAP, 140
RW, 18
Core conductor equations, 126
Core conductor model, 127–128
Crank-Nicolson algorithm, 40, 136–
138, 171
Current clamp, 89, 95, 112
Current per unit length, 128
Cytoplasm resistivity, 128

Darcy’s law, 11
Depolarization block, 114
Diﬀusion, see Random walk model of
diﬀusion, see Macroscopic dif-
fusion processes
concentration, 11, 34
continuity, 34
equilibration time, 57–58
equilibrium, 30, 54
equilibrium time constant, 55
Fick’s ﬁrst law, 11, 34
ﬂux, 11, 34
macroscopic laws, 11, 12
microscopic laws, 12
steady state distribution, 26, 55
steady state time constant, 55
two compartments, 28, 30, 37, 54–
56
Diﬀusion coeﬃcient, 11, 13, 34, 44,
53
Diﬀusion equation, 34
Diﬀusion in a well, 57
Dirac delta function, see Unit impulse
function
Directional probabilities, 15
Discretization, 131, 132
Dissociation constant, 62, 63
Drift velocity, 34, 38, 39, 44, 54

EDUCOM/NCRIPTAL, iv, v
Eigenvalues, 67, 69, 80, 85, 86, 177,
188, 201
Electrically excitable cells, 88, 126
Equilibration time, 57–58
Equilibrium, 54, 213
Equilibrium potential, 175, 181, 196,
197
Equilibrium time constant, 55, 209
Exchange diﬀusion, 83
Expected value, 174, 177, 178, 188,
190, 192, 198, 199
Explicit method, 133
External potential, 128, 130
External resistance, 128

234

INDEX

Extracellular potential, 165

Faraday’s constant, 90, 131
Fick’s ﬁrst law, 11, 34, 208
File handling, 7, 18, 20, 41, 42, 44,
73, 75, 78, 95, 97, 102, 104,
107, 142, 147, 150, 152, 180,
181, 184, 185, 187, 193
Finite diﬀerences, 40
Finite-diﬀerence method, 131
Finite-element method, 131
Flux
carrier mediated, 61, 63, 65, 68
diﬀusive, 11, 34
Forward Euler approximation, 93, 132–
134, 171
Fourier’s law, 11

Gating charge, 174, 175, 177, 178,
182, 188, 199
Gating current, 174, 175, 178, 188,
199, 200
Gating variable, 174
Gaussian function, 38
General, four-state carrier, see Carrier-
mediated transport
Giant axon of the squid, 88, 126
Green’s function, 38, 39

HH, see Hodgkin-Huxley model — space
clamped
Histogram, 23
Hodgkin-Huxley model
accommodation, 114
activation factor, 91
all-or-none principal, 113
anode-break excitation, 114
cable properties, 164
calcium concentration, 115
capacitance current density, 89,
130, 166
collision of action potentials, 168
conduction velocity, 163, 170, 171
conﬁguration

current clamp, 89, 94, 95
relation of voltage to current clamp,
112
space clamp, 89
voltage clamp, 89, 94, 95, 111–
112
default parameters, 92, 131
depolarization block, 114
eﬀect of calcium concentration, 91
equilibrium values, 92
extracellular potential, 165
inactivation factor, 91
ion concentrations, 90
ionic current density, 89, 130
kinetic equations, 91
leakage current density, 90
local response, 167
longitudinal current, 166
measurement method, 112–113
membrane capacitance, 90, 115,
130
membrane current density, 89, 130,
166
membrane potential, 90, 128, 165
Nernst equilibrium potential, 90,
131
polarity of excitatory current, 167
potassium conductance, 90, 115
potassium current density, 90
rate constants, 91
refractory period, 113
repetitive activity, 114
sodium conductance, 90
sodium current density, 90
space and time waveforms, 165
space clamp, 164
space constant, 169
step response, 164
strength-duration relation, 115
sub-threshold oscillations, 114, 169
temperature, 90, 91, 95, 107, 113,
115–117, 119, 121, 123, 147,
170, 171

INDEX

235

temperature factor, 91
threshold, 115, 122, 123, 210
time constants, 92
valence, 90
voltage dependent parameters, 91,
97–101, 147–148
Hodgkin-Huxley model — propagated
action potential
backward Euler approximation, 132,
134–136, 171
boundary conditions, 169
capacitance current density, 166
cell radius, 128
color-coded space-time evolution,
144
conduction velocity, 163, 170, 171
core conductor equations, 126–128
Crank-Nicolson algorithm, 136–138,
171
current per unit length, 128
derived parameters, 147
external potential, 128, 130
external resistance, 128
extracellular potential, 165
ﬁle handling, 142, 147, 150, 152
forward Euler approximation, 132–
134, 171
history, 126
internal potential, 128, 130
internal resistance, 128
longitudinal current, 128, 129, 166
membrane current density, 166
membrane potential, 165
numerical solution, 131–140
overview, 3, 126–127
PAP 3D Plots ﬁgure, 155–156
PAP Comparison Plots ﬁgure, 156–
162
PAP Control ﬁgure, 140–142
PAP Numerics ﬁgure, 141, 150–
152
PAP Parameters ﬁgure, 144

PAP parameters vs. potential ﬁg-
ure, 147–148
PAP Space-Time evolution ﬁgure,
153–155
PAP Stimulus ﬁgure, 149–150
PAP Variable summary ﬁgure, 153
PAP Voltage recorder ﬁgure, 152
PAP Workspace ﬁgure, 140, 142–
144
positioning electrodes, 143
problems, 163–170
projects, 170–171
resistivity of cytoplasm, 128
restrictions on parameters, 147
space constant, 169
spatial resolution, 132, 144, 151
specifying numerics, 151
staggered increment Crank-Nicolson
algorithm, 138–140, 171
stimulating electrodes, 128–129
sub-threshold oscillations, 169
temperature, 171
temporal resolution, 132, 151
user’s guide, 140–163
Hodgkin-Huxley model — space clamped
accommodation, 114
action potential waveform, 113
anode-break excitation, 114
axis scale, 100, 105
calcium concentration, 115
default parameters, 95
depolarization block, 114
derived parameters, 95
ﬁle handling, 95, 97, 102, 104,
107
HH Axis ﬁgure, 100
HH Control ﬁgure, 94–95
HH Graphics ﬁgure, 106–107
HH Numerics ﬁgure, 95
HH Parameters ﬁgure, 94–95
HH Parameters vs. potential ﬁg-
ure, 97–101
HH Plots vs. time ﬁgure, 104–105

236

INDEX

HH Stimulus ﬁgure, 94, 101–102
HH Variable summary ﬁgure, 105–
106
membrane capacitance, 115
model description, 89–92
numerical solution, 93–94
overview, 3, 88
potassium conductance, 115
problems, 111–117
projects, 118–124
refractory period, 113
repetitive activity, 114
scripts, 107–111
software history, iii
strength-duration relation, 115
sub-threshold oscillations, 114
temperature, 115–117
temporal resolution, 93, 104
threshold, 113–115
user’s guide, 94–107

IC, see Voltage-gated ion channels
Implicit method, 135
Inactivation factor, 91
Inactivation gates, 203
Initial conditions, 133, 135, 137, 139
Integration time, 48, 93, 178, 187, 188
Internal potential, 128, 130
Internal resistance, 128
Ion concentration, 90, 131
Ionic conductance, 174, 181, 188, 193,
198, 199
Ionic current, 174, 175, 178, 188, 190,
198, 199
Ionic current density, 89, 130

Kinetic equations, 61, 63, 66, 91
Kirchhoﬀ’s laws, 127, 128, 133

Leakage current density, 90
Longitudinal current, 128, 129, 166

Macroscopic diﬀuision processes
steady state, 213
Macroscopic diﬀusion processes

axis scale, 43, 51
bath view, 51
boundary conditions
reﬂecting, 37, 40, 48, 54, 56
transparent, 37, 40, 48, 54
chemical reaction, 35, 38–40, 44
concentration, 34
continuity relation, 34
diﬀusion coeﬃcient, 34, 53
diﬀusion equation, 34, 44
diﬀusion parameters, 44
drift velocity, 34, 38, 39, 44, 54
equilibration time, 57–58
equilibrium, 54
equilibrium time constant, 55, 209
Fick’s ﬁrst law, 11, 34, 208
ﬁle handling, 41, 42, 44
ﬂux, 34
Green’s function, 38, 39
initial distribution
arbitrary, 36, 46, 51–52
discontinuity, 36, 39, 45–46
impulse, 36–38, 44, 53–54
sinusoid, 36, 38–39, 44–45, 53,
56–57
markers, 42, 51
MD Analytic parameters ﬁgure, 48
MD Control ﬁgure, 41–42
MD Initial concentration proﬁle,
41–42
MD Numeric parameters ﬁgure, 48
MD Parameters ﬁgure, 44
MD Plots vs. position ﬁgure, 41,
48
MD Plots vs. time ﬁgure, 41, 51
membrane view, 51
method of images, 56
modiﬁed diﬀusion equation, 35
numerical solutions, 40, 48
analyic parameters, 48
numeric parameters, 48
overview, 2, 35–37
problems, 53–58

INDEX

237

reaction rate, 35
spatial resolution, 40, 48
steady state distribution, 55
steady state time constant, 55, 209
temporal resolution, 40, 48
two compartments, 37, 48, 51, 54–
56, 209–210
user’s guide, 41–52
Markov process, 175
MATLAB, iv, v, 3–5
Matrix diﬀerential equation, 67, 176
Matrix equation, 62, 64, 68
MD, see Macroscopic diﬀusion pro-
cesses
Mean, 23
Membrane capacitance, 90, 115, 130
Membrane current density, 89, 130,
166
Membrane potential, 90, 128, 175, 177,
182, 185, 186, 201
Method of images, 56
Modiﬁed diﬀusion equation, 35
Molar gas constant, 90, 131
Multiple-state gates, 202

National Science Foundation, vi
Nernst equilibrium potential, 90, 131
Numerical solutions, 37, 40, 48, 69,
93–94, 131–140, 178–179, 187–
188

Ohm’s law, 11

PAP, see Hodgkin-Huxley model — prop-
agated action potential
Particle lifetime, 15
Pedagogy
audience participation, 210
extent of software usage, 221
impact on learning, 221
impact on teaching, 222
intellectual engagement, 208
intuition, 206, 210
lessons learned, 223–226

motivation, 210
research project, 212
surveys, 222
visualization, 206
what-if experiments, 210
Plotting
annotate, 77, 100, 161, 185
axis scale, 24, 43, 51, 77, 100,
105, 186
cross-line, 78, 100, 101, 161, 186
customized plots, 111
legend, 77
line properties, 78, 101, 186
overlay, 75, 97, 107
speciﬁc software
CMT, 75–81
HH, 97–101, 104–107
IC, 184–186, 188–193
MD, 48–51
PAP, 147–148
RW, 23–26
zoom, 77, 100, 186
zooom, 161
Potassium conductance, 90
Potassium current density, 90
Principle of detailed balance, 74
Project Athena, iii–v
Projects, 118–124, 170–171, 214–220
demonstration, 215–217
electronic interactions, 220
grade, 219–220
hypotheses, 118, 121–123, 170–
171
proposals, 215
report, 218–219
teams, 214

Random variable, 174, 179, 188, 190,
198, 203
Random walk model of diﬀusion
axis scale, 24
boundary conditions, 16–17, 21
diﬀusive spread, 208
directional probabilities, 15, 21

238

INDEX

equilibrium, 30
Fick’s ﬁrst law, 208
ﬁeld, 13
ﬁle handling, 18, 20
grid, 13
initial distribution, 20
overview, 2, 12–13
particle lifetime, 15, 22, 28
problems, 26–31
region, 13
region size, 14, 20
RW Control ﬁgure, 18
RW Graph ﬁgure, 25–26
RW Histogram ﬁgure, 23–24
RW Parameters ﬁgure, 20–22
RW Particle ﬁgure, 18
RW Summary ﬁgure, 22–23
sink, 22
sinusoidal, 30
source, 21–22
statistics, 25
steady state, 208
steady state distribution, 26
step size, 14, 20
three regions, 28, 30
unbiased random walk, 16
user’s guide, 18–26
Rate constants, 91
Rate-limiting processes, 210
Refractory period, 113
Repetitive activity, 114
Resistivity of cytoplasm, 128
RW, see Random walk model of dif-
fusion

Scripts, 107–111
Simple, four-state carrier, see Carrier-
mediated transport
Simple, six-state carrier, see Carrier-
mediated transport
Sodium conductance, 90
Sodium current density, 90
Software
directories, 5

ﬁle handling, 7
printing, 7
startup, 6–7
Software history, iii
Software overview
Carrier-mediated transport, 2
Hodgkin-Huxley model — propa-
gated action potential, 3, 126–
127
Hodgkin-Huxley model — space
clamped, 3, 88
Macroscopic diﬀusion processes,
2, 35–37
Random walk model of diﬀusion,
2, 12–13
Voltage-gated ion channels, 3, 174
Software usage
electronic classroom, 212–214
lectures, iii, 206–212
problems, 26–31, 53–58, 81–86,
111–117, 163–170, 196–203,
212
projects, iii, 118–124, 170–171, 214–
220
Space clamp, 89, 164
Space constant, 169
Spatial frequency, 44
Spatial radian frequency, 39
Spatial resolution, 40, 48, 132, 144,
151
Staggered increment Crank-Nicolson
algorithm, 138–140, 171
Standard deviation, 23, 38
State, 174, 175, 181
Steady state, 26, 55, 208, 213
Steady state time constant, 55, 209
Sub-threshold oscillations, 114, 169

Temperature, 90, 91, 95, 107, 113,
115–117, 119, 121, 123, 147,
170, 171
Temperature factor, 91
Temporal resolution, 40, 48, 93, 104,
132, 151, 178, 187

INDEX

239

Thin membrane approximation, 55,
209
Three-state gates, 202
Threshold, 113–115, 122, 123, 210
Trapezoidal rule, 137
Two-state gates, 196–201

Unit impulse function, 37, 44, 129
Unit step function, 46, 129
User’s guide
carrier-mediated transport, 69–81
Hodgkin-Huxley model — prop-
agated action potential, 140–
163
Hodgkin-Huxley model — space
clamped, 94–107
macroscopic diﬀusion processes,
41–52
random walk model of diﬀusion,
18–26
voltage-gated ion channels, 180–
193

Valence, 90, 131
Voltage clamp, 89, 95, 111–112
Voltage-gated ion channels
absolute reaction rate, 177
axis scale, 186
conductance, 178
eigenvalues, 177, 188, 199, 201
equilibrium potential, 175, 181,
196, 197
equilibrium state occupancy prob-
ability, 176
expected value, 174, 177, 178, 188,
190, 192, 198, 199
ﬁle handling, 180, 181, 184, 185,
187, 193
gating charge, 174, 177, 178, 182,
188, 199
gating current, 174, 175, 178, 188,
199
gating variable, 174
IC Control ﬁgure, 180–181

IC Graphics ﬁgure, 192
IC Ionic current ﬁgure, 190
IC Membrane potential ﬁgure, 187,
188
IC Parameters ﬁgure, 180–182
IC Specify rate constants ﬁgure,
182
IC State occupancy ﬁgure, 189
IC Summary ﬁgure, 191
IC View rate constants ﬁgure, 184–
186
inactivation gates, 203
initial conditions, 179–180
initial state, 188, 198
integration time, 178, 188
ionic conductance, 174, 181, 188,
193, 198, 199
ionic current, 174, 175, 178, 188,
198, 199
line properties, 186
Markov process, 175
matrix diﬀerential equation, 176
membrane potential, 175, 177, 182,
185, 186, 201
model description, 175–178
multiple-state gates, 202
numerical solutions, 178–179, 187–
188
overview, 3, 174
problems, 196–203
random variable, 174, 179, 188,
190, 198, 203
state, 174, 175, 181
state conductance, 175
state gating charge, 175
state ionic current, 175
state occupancy probability, 175
temporal resolution, 178, 187
three-state gates, 202
transition probability, 175
two-state gates, 196–201
activation and inactivation gate,
197

240

INDEX

eﬀect of scaling rates, 198
gating charge, 199
gating current, 200
relation of ionic and gating vari-
ables, 199
ungated, 196, 199
user’s guide, 180–193

