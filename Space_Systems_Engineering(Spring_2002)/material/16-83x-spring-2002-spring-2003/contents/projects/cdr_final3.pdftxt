ElectroMagnetic Formation Flight Of Rotating Clustered Entities 
EMFFORCE 

Critical Design Review 
December 5, 2002 
33-116 
Department of Aeronautics and Astronautics 
MIT 

<ALS>


Welcome to the Critical Design Review for the EMFFORCE team.


1 

Introduction 

André Bosch 

05 December 2002 

EMFFORCE - CDR 

2 

2


EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

CDR Purpose 
Present design progress to date 
Identify and address concerns for 
completion of project 
Demonstrate plans for 
implementation and operation
phases 
Show budget and schedule trends 
and predictions 
Get approval to enter build phase 

• 
• 

• 

• 

• 

05 December 2002 

EMFFORCE - CDR 

3 

<ALS> 

The purpose of the Critical Design Review is mainly to present the team’s 
design progress and identify and address concerns regarding the team’s 
ability to complete the project.  In addition, the team will present plans for the 
final phases of the project (to take place over the next term), show trends of 
the budgets and schedules, and get approval to enter the build phase. 

3 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Presentation Overview 

• 

• 

• 

• 

Introduction 
– Background, requirements, overview 
Subsystems Reports 
– Actuation, Electronics, Testbed 
Systems Report 
– Budgets, Integration, Schedule 
Q&A and laboratory tour 

05 December 2002 

EMFFORCE - CDR 

4 

<MAS> 

The EMFFORCE CDR presentation consists of three parts:  introduction, 
progress reports on each subsystem, and a progress report from the 
Systems team.  Following the presentation the EMFFORCE team will 
answer any further questions before leading guests on a tour of the lab, 
where team members will demonstrate aspects of their subsystems through 
tests and explanations. 

4 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Background and Motivation 

• 

• 

• 

Space-based telescopes limited in 
size by launch constraints 
Can increase resolution by using 
multiple small apertures widely 
spaced 
Formation flight one solution to 
holding widely spaced apertures 
together 

05 December 2002 

EMFFORCE - CDR 

5 

<MAS>


5 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Application: NASA TPF 
Terrestrial Planet Finder: multi-satellite 
formation detecting extrasolar planets 
by interferometry and spectral analysis 
One concept: rotating system 
– 
5 spacecraft 
– 
2m diameter optics 
–  12.5m and 25m 
separations 
Design architecture 
chosen by 2006 

• 

• 

• 

Image is taken from NASA's Web site: 
http://www.nasa.gov
. 

05 December 2002 

EMFFORCE - CDR 

6 

<MAS> 

“TPF will take the form of either a coronagraph operating at visible wavelengths or a large-
baseline interferometer operating in the infrared. 
“During almost 20 years of study, design concepts have alternated between interferometeric 
arrays and coronagraphs. In recent years alternative architectures have emerged with the 
potential to achieve similar science goals. These opened up the possibility of new mission 
concepts and additional precursor missions. 
“In December of 2000, JPL and four study teams consisting of aerospace industry 
companies and university investigators, with advice from the Science Working Group, 
selected the most promising architectures for more detailed definition and analysis. These 
architectures were studied in detail, and the results were presented during a Final Technical 
Review a year later. 
“Final selection of a TPF architecture will occur in 2006, based on the science and 
technology progress of the next four years.” 
-from “What is TPF?” 
http://planetquest.jpl.nasa.gov/TPF/tpf_what_is.html 

“Design Concept: Interferometer (Lockheed Martin) Light from four or more telescopes on a 
common structure (right) or separate, free-flying spacecraft will be combined to suppress, or 
null, starlight in Lockheed Martin's interferometric mission concept. “ 
-from “Sample Mission Concepts” 

http://planetquest.jpl.nasa.gov/TPF/tpf_sample.html


6 

EMFFORCE Mission 

feasibility 
Demonstrate the 
of 
electromagnetic control 
for 
formation flying satellites 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

05 December 2002 

EMFFORCE - CDR 

7 

<MAS> 

EMFFORCE is a proof-of-concept project.  Its purpose is to develop 
technology for application to future space-based systems.The two most 
important concepts EMFFORCE must link are electromagnetic control of 
satellites, and untethered formation flying vehicles. 

The mission of Project EMFFORCE reflects this goal. 

7 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Electromagnetic Control 

Electromagnets and momentum 
storage device replace thrusters 

Advantages 
No obscuring plumes 
Independence from fuel 
Small adjustments easy 

Challenges
Coupled control law
Relative control only
Electromagnets 
unconventional 

05 December 2002 

EMFFORCE - CDR 

8 

<MAS> 

Electromagnetic control requires two-part actuation:  electromagnets to provide the force 
and system torque for repositioning, and a reaction wheel to hold angular momentum, which 
provides restoring torque to the vehicles. 

There are distinct advantages and also some challenges to EM control. 
Advantages: 
•Regular thrusters produce plumes from gas jets used to reposition vehicles.  These plumes 
could damage the system optics as well as interfere with imaging precision. 
Electromagnetic control produces no such plumes. 
•The lifetime of thruster-based propulsion systems is limited by the amount of propellant on 
board.  Electromagnetic propulsion is infinitely renewable (assuming a solar power supply). 
•Thrusters are difficult to use in small increments; the jet bursts are often quite imprecise 
and therefore impractical for the station-keeping required by a formation-flying cluster. 
Electromagnetic control is ideal for this kind of small, gradual repositioning maneuvers. 
Challenges: 
•The control law governing an EM control system is highly complex due to coupling. 
•Since there is no external force involved with electromagnets, the system can control only 
relative degrees of freedom (DoF) – not inertial. 
•Electromagnetic control of free-flying vehicles is an untested technology and requires 
extensive experimentation to understand the behavior of the system. 

8 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Formation Flight 

• 

• 

• 

• 

Geometry is adaptable; expands 
mission capability 
Formation is able to overcome failure of 
a single vehicle 
Vehicles eas er to launch, replace, 
i
reconfigure 
Control of many satellites difficult 
–  Large amounts of fuel consumed by 
“station-keeping” maneuvers and array 
rotation 

05 December 2002 

EMFFORCE - CDR 

9 

<MAS> 

There are several advantages to using a formation of free-flying satellites 
over using a rigid framework of multiple apertures for a large space-based 
telescope. 

•Adaptable geometry 
•Robustness – overcome partial failure 
•Ease of launch (weight reduction); replacement and reconfiguration 
possibilities 
•Conventional control of a formation-flying group of satellites is very difficult 
due to thruster imprecision. 

9 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Functional Requirements 

• 

System must complete tests 
representative of application 
7 minute rotational maneuver 
2 or 3 vehicles 
– 
– 
2 minutes spin-up, 2 minutes spin-down 
3 revolutions at 1 RPM 
– 
– 
2 meters minimum separation 
Other tests: disturbance rejection in 
linear arrangement 

• 

05 December 2002 

EMFFORCE - CDR 

10 

<MAS>


Functional requirements - based on MIT SSL technical documents


10 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Operational Requirements 

• 

• 
• 

• 

gas carriage and power must support 
vehicle for 20 minutes of operation 
– 
1 or 2 tests plus margin 
Vehicles must operate freely: no tethers 
ing and 
System must remain intact dur
after tests without causing damage to 
i
operators or env ronment 
System must be portable in preparation 
for field operation 

05 December 2002 

EMFFORCE - CDR 

11 

<MAS> 

Operational requirements – based on application as well as on facilities and 
resources available to the EMFFORCE team 

11 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Constraints and Optimization 

• 

• 

Observe constraints: labor, cost limits 
– 
Work force: 180 student hrs/week 
– 
Cost cap: $50,000 
Optimize EMFFORCE vehicle 
(considering associated resources): 
– 
Mass (EM strength, power supply, gas 
carriage support) 
Power (battery life) 
Computation (processor speed, memory) 

– 
– 

05 December 2002 

EMFFORCE - CDR 

12 

<MAS> 

Constraints imposed on funding and labor require the EMFFORCE team to 
optimize certain characteristics of the system. 

12 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

• 

• 

• 

• 

• 

05 December 2002 

Testbed Summary 

3 vehicles, each having: 
19 kg mass, 20 min power duration, 2 electromagnets, 1 
– 
l 
i
react on whee
Gas carriage: 20 min duration supporting a 19 kg 
vehicle 
Operational environment 
– 
l
1.2m x 1.8m g ass surface at MIT 
– 
5m x 10m fac lity at Lockheed 
i
Communication and processing 
2 internal microprocessors (metrology, avionics/control
– 
) 
– 
l 
i
Inter-vehicle communication v a RF channe
– 
External “ground station” computer (operations, records) 
Metrology per vehicle 
– 
1 rate gyro 
l
– 
3 u trasonic  US) receivers synchronized using infrared 
(
IR) pulses 
(
EMFFORCE - CDR 

13 

<MAS>


A high-level summary of the EMFFORCE testbed.


13 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

EMFFORCE Vehicle 

Magnet and cryogenic 
containment 

Metrology and 
communications 

Reaction wheel 

Base and 
gas carriage 

Gas supply 
tank 

Electronics 
boards 

Batteries 

05 December 2002 

EMFFORCE - CDR 

14 

<ALS> 

This is a computer rendering of one of the EMFFORCE vehicle.  All physical 
subsystems are noted on the drawing. 

14 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Subsystem Breakdown 

Electronics 
• Av on cs  
i
i
Communications 
• 
Metrology 
• 

Actuation 
Electromagnet 
• 
Reaction wheel 
• 
• Power  
• 
Structure 

Testbed 
Control 
• 
i
• Operat ons  
• 
Systems 

05 December 2002 

EMFFORCE - CDR 

15 

<ALS> 

The subsystems have been divided into three main groups.  The 
subsystems within each group work closely together and share the most 
critical interfaces.  The electronics group consists of the avionics, 
communications, and metrology subsystems.  The actuation group consists 
of the electromagnet, reaction wheel, power, and structure subsystems.  
Together these two groups form the hardware and software of the vehicle.  
To achieve the project mission, a third group is required to implement these 
vehicles in a testbed.  The testbed group consists of the control, operations, 
and systems subsystems. 

15 

Electromagnet 

Jesus Bolivar 

05 December 2002 

EMFFORCE - CDR 

16 

16


Overview 

• 

• 

• 

2 Perpendicular 
Electromagnet Coils 
– 
Superconductor Wire 
Coil Casing 
Liquid nitrogen cooling 
– 
system for 
superconductor coils 
id Nitrogen 
Liqu
Reservoir 
Provides system w
– 
ith 
supply of liquid nitrogen 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

05 December 2002 

EMFFORCE - CDR 

17 

<MSW> 

The electromagnet subsystem is composed of 2 large perpendicular electromagnet 
coils oriented vertically, the coil casing, and the liquid nitrogen reservoir. 

The electromagnet coils produce the force and torque necessary to spin up the 
system.  The coils are made of superconductor wire that must be operated below 
110K so they are contained within a casing that immerses the coil in liquid nitrogen 
at 70K.  The liquid nitrogen reservoir contains the supply of liquid nitrogen to 
replenish the nitrogen that boils off during operation. 

17 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

• 

• 

Requirements 
Electromagnet coils must produce force and 
torque for 
– 
Translational movement 
Disturbance rejection 
– 
Steady state rotation rate of 1 rpm for 3 rotations 
– 
– 
Vehicle separation distance of 2 meters 
Electromagnet casing must 
Maintain superconductor coils at temperature 
– 
below 110K for duration of test 
Provide structural rigidity for vehicle 
• 
Hardware mounted to  nner casing, outer casing, and 
i
id ni
liqu
ir 
trogen reservo

– 

05 December 2002 

EMFFORCE - CDR 

18 

<MSW> 

The electromagnet coils must produce force and torque necessary for translational 
movement, disturbance rejection and rotation of the vehicles.  The system is 
required to rotate at 1 rotation per minute (or 6 degrees of arc per second) at steady 
state for a minimum of 3 rotations.  The separation distance of the vehicles is 2 
meters measured from the centerline of a vehicle to the centerline of adjacent 
vehicle(s). 

The electromagnet casing is required to keep the superconductor coils at 
temperatures below 110 K in order for the wire to exhibit superconducting properties 
(0 resistance).  To do so, it keeps the coil immersed in 70K liquid nitrogen for the 
duration of the test.  The electromagnet casing is also required to provide structural 
rigidity for the vehicle since it is the outer structure.  The casing must provide mount 
points for other subsystem hardware (such as metrology transmitters and receivers, 
gas carriage, reaction wheel, etc.).  The casing will be made out of insulating foam 
and epoxy.  To strengthen the foam against damage and for vehicle structural 
rigidity, the foam is wrapped with fiberglass and epoxy.  

18 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

EM Design History 

• 

• 

– 

Ferromagnetic core 
wrapped with copper coil 
Steel core extremely 
– 
heavy 
Difficult to model field 
strength 
Large copper coil 
Eliminated heavy core 
– 
Eas er to mode
– 
l 
i
Could not meet 
– 
requirements due to 
current limitations 
ire 
through copper w

05 December 2002 

EMFFORCE - CDR 

19 

<MSW> 

The original design for the electromagnet was a ferromagnetic iron core wrapped 
with a copper coil.  This design was eventually discarded for several reasons.  The 
iron core was extremely heavy.  The last mass estimate for the iron core alone was 
nearly 8 kg.  It was also very difficult to model the near-field effects of this 
ferromagnetic core design. 

The next design for the electromagnet was a large copper coil.  This eliminated the 
heavy ferromagnetic core from the original design.  Additionally, it is much easier to 
model the B-field around the coreless coil design.  However, the copper was unable 
to carry safely the amount of current necessary to satisfy the requirements due to 
resistance and heating issues.  In order to alleviate this problem, a different material 
for the coil had to be found that allowed much higher levels of current to be passed 
through the wire. 

19 

• 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

EM Design History 

High-temperature 
Final Design:  
superconductor coil 
– 
Eliminated heavy core 
–  High current 
Almost no resistance in w
ire 
• 
at temperatures below 110K 
Easier to model than 
ferromagnetic core 
electromagnet 
Needs cooling system to keep 
superconductor below 110K 

– 

– 

05 December 2002 

EMFFORCE - CDR 

20 

<MSW> 

The final electromagnet design uses high-temperature superconductor wire instead 
of copper in the large coreless coil design.  This eliminated the heavy ferromagnetic 
core which is a design more translatable to space application.  It would be costly 
and inefficient to launch a satellite using a large, heavy core as part of its actuation 
system.  This coreless design, like the previous copper wire design, is easier to 
model than the electromagnet with a ferromagnetic core. 

The superconductor can safely carry over 10 times the amount of current that the 
copper wire can due to its superconducting properties below 110K.  At those 
temperatures, the wire has zero resistance negating the current and heating 
problems that caused the copper wire design to not meet the requirements.  
However, this does add the additional requirement that the superconductor wire be 
encased in a container that will keep it at a temperature below 110K. 

20 

• 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

EM Coil Design 

American Superconductor Bi-2223 Reinforced 
High Temperature Superconductor Wire 
Dimensions 
– 
ide 
• 
4.1 mm w
0.3 mm thick 
• 
• 
85 m length pieces 
Critical Current 
115 amps, 9.2 kA cm
• 
/
– 
Below 110 K 
Coil properties driven by requirements. Next step: 
Solve for the coil properties using equations of 
motion 

– 

– 

2 

05 December 2002 

EMFFORCE - CDR 

21 

<MSW> 

The wire that was chosen for the electromagnet coil was American 
Superconductor’s Bi-2223 Reinforced High Temperature Superconductor 
Wire.  They are the only large American manufacturer of high-temperature 
superconductor wire applicable to the project.  For added strength, the 
decision was made to go with the reinforced wire. 

The wire is tape-like with a width of 4.1 mm and a thickness of 3 mm.  85 m 
lengths of wire were obtained from the manufacturer. 

The primary reason that the superconductor was chosen was for the high 
amount of current that could be safely passed through the wire.  For this 
wire, 115 amps may be passed through the wire below a temperature of 
110K since the wire does not have resistance at low temperatures. 

21 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

EM Coil Design 
• Radial Force 
3 
µ µ µ 
F 
BA
o 
= 
x 
s 
4 
4 
π 
• Tangential Force 
3 
µ µ µ 
F 
(
A
o 
B
y 
s 
4 
4 
π 
µo = 4π * 10-
T-m/A:  permeability constant 
7
magnetic moment 
µ: 
 dipole angles 
α, β: 
separation distance between vehicle centerl nes 
i
s: 
N 

cos 
sin
2 
βα

sin

= 

N 
α 

s 

y 

x 

S 
Vehicle A 

(

cos
sin
sin
)
cos 
2 
βαβα
−

−

cos
)
βα

β 
S 
Vehicle B 

05 December 2002 

EMFFORCE - CDR 

22 

<MSW> 

In order to determine the necessary size of the coil, consider the radial and 
tangential force acting on two vehicles at a separation distance of s 
(between vehicle centerlines).  Each vehicle is simply modeled as a dipole. 
The dipoles are oriented at angles alpha and beta from their connecting 
centerline.  

Force is dependent on the electromagnet properties (number of turns, 
current, and loop radius), separation distance, and dipole angles. 

22 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

EM Coil Design 

• 

Set radial force equal to centripetal 
force due to spinning cluster 

Fx 

ma
= 
l
centripeta 

(2  s 
m
)
ω=
2

• 

Tangential force required to provide 
angular acceleration 
s 
• 
mFy 
=  ω 
2 

05 December 2002 

EMFFORCE - CDR 

23 

<MSW> 

Set the radial force (magnetic) equal to the centripetal force due to the 
spinning cluster in order to counteract it.  

The tangential force is what is required to provide angular acceleration.  Set 
the tangential force (magnetic) equal to the mass times the angular 
acceleration times the radius (1/2 separation distance). 

23 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

EM Coil Design 
•  Solve for magnetic moment µ 
–  Both vehicles identical 
–  Perpendicular configuration 
1 
2
⎞ 
⎛ 
5 
2
s m 
⎛ 
⎞
• 
⎟ 
⎜ 
4
4 
ωω
+
⎜
⎟
32 
⎟
⎜
2 
π 
⎝
⎠
µ 
= 
⎟
⎜
3 
⎟
⎜
⎟
⎜
⎠
⎝
•  Solve for µ at required steady-state rotation
rate of 1 rpm 
–  Mass estimate:  m = 20 kg 
–  Separation distance requirement: 
s = 2m 
turns * m22]]
= 2418 [Amp -- turns * m
µµ = 2418 [Amp

µ 
o 

05 December 2002 

EMFFORCE - CDR 

24 

<MSW>,<JB> 

Assuming that the dipoles are in a perpendicular configuration (Beta = 0 
degrees) and that both vehicles have identical coils, we obtain the above 
equation for magnetic moment.  This equation shows that the magnetic 
moment (and thus, the coil properties) are dependent on the mass of the 
vehicle, separation distance, angular velocity, and angular acceleration. 

Solve for the required magnetic moment of the coil for steady state (no 
acceleration) rotation at 1 rpm and a separation distance of 2 meters which 
was set by the requirements.  The required magnetic moment is 2418 Amp-
turns*m^2. 

In order to meet the requirements, the coil must be sized such that it 
exceeds this required magnetic moment. 

24 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

EM Coil Design 

• 

• 

• 

Allowing for a 25% increase in mass 
and separation distance: 
= 4723 [Amp-turns * m
2] 
µ 
Determine coil properties by solving for 
where µ = nIA.  
µ 
–  n
: number of wire turns. 
enclosed by coil. 
The max current was set to I=100 A. 
Safety margin from the critical current of 
15A. 

I: current. A:  area 

05 December 2002 

EMFFORCE - CDR 

25 

<MSW>,<JB> 

Taking a look at the magnetic moment dependency on mass and separation 
distance, we find that the required strength is dependent on separation 
distance to the 2.5 power.  Thus, an increase in separation distance greatly 
increases the required strength of the coil.  Likewise, mass increases the 
required magnetic moment but only to the ½ power.  

Allowing for a 25% increase in mass and separation distance for safety, the 
required magnetic moment is 4723 Amp-turns*m^2. 

Having found the required magnetic moment for a coil at steady-state 
rotation of 1 rpm, we then solve for the coil properties where the magnetic 
moment is equal to the number of turns of the coil times the current times 
the area of the coil. 

Since the superconductor critical current is 115 amps, we set the current at a 
lower value of 100 amps. In order to have a safety gap of 15 amps. 

25 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

• 
• 

• 

EM Coil Design 
2 perpendicular coils to vary field direction 
Outer Coil 
– 
.835 m diameter 
–  100 turns 
µ = 5476 [Amp-turns * m2] 
Satisfies requirements w th margin allow ng for 25% 
i
i
i
increase  n mass and separation distance. 
Inner Coil 
.67 m diameter 
– 
– 
120 turns (same length of wire as outer coil) 
µ = 4231 [Amp-turns * m2] 
Satisfies requirements 

• 

• 

05 December 2002 

EMFFORCE - CDR 

26 

<MSW> 

The final design incorporates 2 perpendicular, vertically-oriented coils into 
each vehicle in order to increase the ability to vary the direction of the 
magnetic field. 

Both the outer and inner coil are sized such that they exceed the magnetic 
moment necessary to meet the requirements.  Additionally, the outer coil 
exceeds the required magnetic moment for the mass and separation 
distance increased by a 25% margin for safety. 

The outer coil has a diameter of .835 m with 100 turns.  This gives it a 
magnetic moment of 5476 [Amp-turns*m^2] with 100 amps of current.  The 
inner coil has a diameter of .67 m with 120 turns.  This gives it a magnetic 
moment of 4231 [Amp-turns*m^2]. 

26 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

EM Coil Design 

• 

• 

Each coil comprised of 3 “stacks” of 
superconductor wire 
– 
More compact containment system 
Wire insulated with Kapton adhesive 
tape to prevent shorting 
Inner Coil 

Outer Coil 

Superconductor 
l
wire ayered with 
l
Kapton insu ator 

1.5 cm 

1.3 cm 

Spacers 

2 cm 
120 turns (40 per stack) 

2 cm 
99 turns (33 per stack) 

05 December 2002 

EMFFORCE - CDR 

27 

<MSW> 

Each coil is comprised of 3 “stacks” of superconductor wire instead of 1 tall 
“stack” of wire.  This allows for a more compact containment system to 
surround the rings keeping in mind that the inner ring must fit entirely inside 
the outer ring. 
The stacks are separated by spacers and they are tightly attached to the 
container at certain points. The separation between the stacks allows the 
liquid nitrogen to be in contact with more surface area of the wire, providing 
a more uniform distribution of temperature inside the coil. This is critical for 
the operation of the wire, due to the fact that if the temperature goes above 
110k the wire’s resistance will increase. 

27 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Containment System Design 

• 

Requirements: 
– Keep the wire immersed in liquid 
nitrogen. 
– Insulate from the env
ironment the 
wire and the liquid N2. 
• 
Non-conductive material. 
– Stiff enough to support liquid N
container and its own weight. 

2 

05 December 2002 

EMFFORCE - CDR 

28 

<JB> 

The superconducting wire must be immersed in liquid N2, in order to operate 
as desired. To do this a containment system is needed for the wire and for 
the liquid N2. 

The containment system must keep the the liquid nitrogen, as isolated as 
possible from the environment. Because better insulation will allow for slower 
boil off, less liquid nitrogen will be needed and thus the EM subsystem will 
be lighter. 

For the same reason as above and because of the high current going 
through the superconducting wire, the material of the container needs to be 
non-conductive. 

Finally, due to the size of the coil, most of the subsystems will be attached in 
some form to the container. The containment system will be the main 
structural component of the system, therefore it needs to have attach points 
and be strong enough to support the weight of the different components. 

28 

Containment System Design 

• 

Foam with fiber 
glass wrapped 
around it. 

Cross section of inner coil 
) 
(units in inches

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

05 December 2002 

EMFFORCE - CDR 

29 

<JB> 

Foam is a very good insulator and easy to machine into complex shapes. 
Fiber glass wrapped around it adds rigidity, which helps satisfy the  

requirement for the structure of the system.

Manufacturing software (Mastercam 8) was used with a milling machine.


29 

Containment System Design 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

05 December 2002 

EMFFORCE - CDR 

30 

Section of container 

<JB> 

In this picture, the details of the spacers on the side and bottom are shown. 
This is the male part of the container. Another part that has the mirror shape 
of this one, attaches to the top creating more space for the liquid N2. 

30 

Containment System Design 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Top vi
ew of half of 
the Container 

05 December 2002 

EMFFORCE - CDR 

31 

<JB> 

In the picture on the left, the black lines are due to the epoxy. The container 
is manufactured in 4 pieces because the milling machine that we are using is 
not big enough to cut the whole container in one piece. 

The picture on the right show’s the details of the spacing left for the wire’s 
clamp, where the interface with the power subsystem will be located. 

31 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

EM Coil Testing 

B-field measurements 
– Inner coil stack 
• 
.67 m inner diameter 
•  40 turns 
I = 30 amps 
• 
– Axial and Radial B-field 
measurements taken at 
varying radii. 

05 December 2002 

EMFFORCE - CDR 

32 

<JB> 

The purpose of the first test was to make sure that the wire could super 
conduct at the operating temperature of 77K and to compare our model for 
the B field of a coil against the actual B field produced by the super 
conducting wire in the coil. 

To accomplish this, the axial and radial B field was measured using a gauss 
meter. The tested coil was the size of the inner coil but it was just one stack 
with 40 turns. Finally a current of 30 amps was used in the test. 

32 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

EM Coil Testing 
• Magnetic field measurements at varying radii 
• B-field in radial direction 

Bradial vs. Radius 

40 

30 

20 

10 

]
s
s
u
a
g
[
 
B

Gaussmeter 

Inner coil 
stack 

0.1 

0.2 
0.3 
Radius [m

0.4 
] 

0.5 

0.6 

05 December 2002 

EMFFORCE - CDR 

33 

<MSW> 

B-field (magnetic field) measurements were taken for the component in the 
radial direction of the coil.  To do so, the gauss meter was held parallel to 
the plane of the coil.  The height was held constant at .055 meters, and the 
radius was varied from the center (at 0) to .60 meters (outside of the coil). 

The experimental data is plotted against the model for the radial component 
of the B-field for the given parameters. 

The red line denotes the coil which has a radius of .335 meters.  As 
expected, the radial component of the field is greatest nearest to the coil. 

33 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

EM Coil Testing 
• Magnetic field measurements at varying radii 
• B-field in axial direction 

 
]
s
s
u
a
g
[
 
B

30 

20 

10 

-10 

Baxial 

vs. Radius 

Gauss meter 

0.1 

0.2 

0.3 

0.4 

0.5 

0.6 

Inner coil 
stack 

Radius [m] 

05 December 2002 

EMFFORCE - CDR 

34 

<MSW> 

B-field (magnetic field) measurements were taken for the component in the 
axial direction of the coil.  To do so, the gauss meter was held perpendicular 
to the plane of the coil.  The height was held constant at .055 meters, and 
the radius was varied from the center (at 0) to .60 meters (outside of the 
coil). 

The experimental data is plotted against the model for the axial component 
of the B-field for the given parameters. 

The red line denotes the coil which has a radius of .335 meters.  As 
expected, the radial component of the B-field switches direction from the 
inside of the coil to the outside of the coil. 

34 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

EM Coil Testing 

• 
• 

Magnetic field measurements at varying axial distances 
B-field in axial direction 

Baxial  vs. Axial Distance 

25 

20 

15 

10 

5 

 
]
s
s
u
a
g
[
 
B

0.1 

0.2 
0.5 
0.4 
0.3 
Axial Distance [m] 

0.6 

0.7 

Gaussmeter 

Inner coil 
stack 

05 December 2002 

EMFFORCE - CDR 

35 

<MSW> 

B-field (magnetic field) measurements were taken for the component in the 
axial direction of the coil.  To do so, the gauss meter was held perpendicular 
to the plane of the coil.  The measurements were taken at the center of the 
coil along its axis, and the height was varied from the center of the coil (0) to 
.65 m. 

The experimental data is plotted against the model for the axial component 
of the B-field for the given parameters. 

35 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

• 

• 

• 

EM Container Testing 
Open foam cup 
Foam contracted but contained the 
– 
liqui
d nitrogen 
Two-part square foam container, 
no epoxy 
– 
Foam did not maintain tight seal, 
liquid N2  leaked 
Warping from contraction occurred 
– 
Two-part ring-shaped foam 
container, standard epoxy 
– 
Container leaked at epoxy seal; 
epoxy was brittle and cracked 
Warping from contraction occurred 

– 

05 December 2002 

EMFFORCE - CDR 

36 

<MSW>,<JB> 

After the testing of the magnetic field, the development of the containers 
started. First, a simple cup of foam was filled with liquid N2, in order to make 
sure that the foam would not chatter and leak during operation. Although it 
shrank a bit, it did contained the liquid and did not have any leaks. 

After a successful first test, a Two-part square foam container with no epoxy 
was tested to see if with just a press fit of the two parts would be enough to 
create a seal. From this test, It was concluded that there is a lot of warping 
and contraction, and that the press fitting does not create a seal. 

For the next round of testing, 5-minute epoxy was applied to the fins located 
on the edges. The system contained the liquid for about 2 minutes before 
the epoxy chattered and leaked. Warping was not observed in this test, 
thanks to the ring shape. 

36 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

EM Container Testing 

• 

• 

• 

Two-part open cup, cryogenic epoxy 
Conta ned liquid N
– 
i
2 
– 
Epoxy did not crack or become brittle. 
Two-part toroid, cryogenic epoxy, 
fiberglass wrapped 
Conta ned liquid N for 10 minutes 
– 
i
2 
Failure attributed to holes in the seal 
– 
due to uneven foam edges 
Fiberglass added significant rigidity 
to 
container 
Two-part open container, cryogenic 
epoxy, two copper pipes 
Conta ned liquid N
– 
i
2 
– 
Seal around pipes did not fail 

– 

05 December 2002 

EMFFORCE - CDR 

37 

<MSW>,<JB> 

In the last test it was determined that the 5 minute epoxy could not sustain 
the cryogenic shock. The epoxy was shrinking at a higher rate than the foam 
and this broke the seal in the fins. 

The purpose of the next test was to make sure that the new epoxy could 
withstand the cryogenic shock. A small cup glued with epoxy on one side 
was built and tested and it worked well. 

After the epoxy problem was solved, the shape of the container needed to 
be improved for the fiber glassing process. Considering this issue, a toroid 
shape container was built and tested. Due to uneven edges the seal failed. 
But in this test, the machining process for the new shape and the fiber 
glassing process were learned. 

Finally, our last test consisted of the container on top of the coils with the 
extra liquid N2. The purpose was to check for leaks and test the piping 
adhesiveness to the epoxy, which turned out to be quite good in making a 
seal. 

37 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

EM Container Testing 

• 

Results 
– Foam and cryogenic epoxy can 
contain liquid N2  for the duration of 
test and more. 
– Fiberglass can be used to provide 
added rigidity and to allow mount 
points to be secured to container. 
– Cryogenic epoxy may be used to 
secure copper pipes to foam. 

05 December 2002 

EMFFORCE - CDR 

38 

<MSW>,<JB> 

The results of our tests helped us a great deal in the design of the container. 
Not only was our selection of materials tested to guarantee that it was the 
right one, but the shapes and different ways to machine and wrap the foam 
were learned by the group in the process. 

From the test it was concluded that the foam and the cryogenic epoxy can 
contain liquid N2  for the duration of test. The only problem with the epoxy is 
that the curing time is from 16 to 24 hours. Also the epoxy may be used to 
secure the copper pies to the foam, and in this configuration the epoxy did 
not break. 

The fiberglass is strong enough to provide the rigidity needed from the 
containers and it allows mount points to be secured to container in any place 
were it is needed. 

38 

Concerns and Mitigations 

• 

• 
• 

Heat paths in sealed container. 
– Epoxy  
– Soldering and connections between 
stacks of wire. 
Robustness of containers. 
Schedule 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

05 December 2002 

EMFFORCE - CDR 

39 

<JB> 

The part that needs the most work is the containment system of the EM. From the last test that we performed we 
observed that there foam is effective insulating the inside of the container, but a relatively large amount of heat coming from 
the epoxy joints was observed (we observed more bubbles in this section in the liquid nitrogen). 
This could have an impact on the weight of the system, since the liquid nitrogen would boil at a faster rate and therefore 
more volume would be needed to keep the wire submerged at all times during operation. 
On the other hand, if we decide to pressurize the container and use the boiling nitrogen to drive the gas pucks. The 
epoxy’s heat path could be an advantage since we could need a greater mass flow of nitrogen than with the current 
configuration. 
In case the container needs to be insulated better, a different kind of epoxy could be use. An epoxy that can be exposed 
to the same temperatures and with worse conductive properties was found. 
The soldering between the wires does not have superconductive properties. This brings up two issues that are highly 
coupled. One is that it will cause a rise in the resistance of the overall coil, and the second is that there will be a heat 
produced in the soldering spots. As it was mentioned before, the second issue might not be a problem but an advantage, 
depending if we decide to go later with the pressurization of the container or not. 
The problem with the increase in resistance is that we might not have enough voltage to drive the current through the 
coils. To solve this two options are being considered, the voltage into the coils could be raised the soldering could be 
eliminated and instead the ends of the wires could be overlapped a certain distance and clamped together. 
The amount of soldering material used will directly impact the amount of the extra resistance added to the coils, and since 
there is no way to determine this with enough precision. This will not be determined until the coils are tested with the 
soldering on them. 
Another issue that it is important to pay attention to, is the robustness of the containers. The EM subsystem is composed 
of different material, which are exposed to a variation of temperature from room temperature to 40 K. This variation will make 
these materials shrink and expand every time they are used. It s important to determine how many times the containment 
system can withstand this cycle without failing. 
The manufacturing of the containers is a time consuming process. For every container tested there at least six to ten 
hours of only manufacturing time. There is also the time to epoxy the different parts which is about an hour and finally the 
curing time which is from sixteen to 24 hours for every layer of epoxy. Due to this the schedule could become a problem for 
us. In order to deal with this issue, it would be possible to hire someone to do the machining so that the manufacturing time 
can be reduced. Also, a convection oven could be used to heat the parts after the epoxy is applied in order to reduce the 
curing time. For every 10 K of temperature increase the curing time is reduced by 50%. 

39 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Cost Budget 

Development
Item 
Cost ($)
250 
Plexiglas 
100 

Pipes, Fittings, Tools 

Kapton Insulator Tape 

Final Product (System)
Item
Cost ($)
23,715
Superconductor Wire 
294
100 
600 
24,709
25,059

Pipes, Fittings 

Cryogenic Epoxy 
350 
SUBTOTAL: 
SUBTOTAL: 
TOTAL SUBSYSTEM BUDGET: 

05 December 2002 

EMFFORCE - CDR 

40 

<MSW>,<JB> 

For our cost budget, $350 were spent in development. That includes pipes, 
fittings, tolls and plexiglas for the wrapping of the coils. 

The cost for the final product for the whole system is of $24,709. Most of the 
cost is driven by the high temperature superconductor wire, which is an 
expensive technology but it was needed for the functioning of our 
subsystem. 

40 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Mass Budget 

Item 

Unit Mass 
(kg) 

Qty. 

Per 
Vehicle 
(kg)

/ 
Superconductor Wire 
Kapton EM Coil 
Coil Container 

Liquid N Reservoir 
2 
Pipes, fittings 

TOTAL Subsystem Mass: 

2.9

1.0 

.5

N/A 

2 

2 

1 

N/A 

5.8

2.0

.5

.4

8.7 

05 December 2002 

EMFFORCE - CDR 

41 

<JB>


41 

Reaction Wheel 

Jesus Bolivar 

05 December 2002 

EMFFORCE - CDR 

42 

42


EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

RWA Overview 

• 
• 
• 

Urethane Fly Wheel 
Electric Motor 
Mounting Frame 

• Purpose  
– Store angular momentum 
– Provide counter-torques to electromagnets 
– Provide angular control authority 

05 December 2002 

EMFFORCE - CDR 

43 

<WDF> 

The reaction wheel assembly (RWA) consists of three 
components. First, a fly-wheel molded from a high density urethane (the 
large yellow disk). Second, an electric motor (the silver cylinder) 
manufactured by AstroFlight Inc. Finally, an aluminum mounting frame that 
will attach the motor to the main vehicle structure. 
The reaction wheel assembly is designed to achieve three 
specific tasks. First, the assembly must store the angular momentum 
created during the spin-up of the system. Thus conserving the total angular 
momentum of the system. Second, in order to keep the electromagnetic 
poles aligned in the appropriate orientation the RWA must provide torques to 
counter the torques generated by the electromagnet forces. Finally, the 
RWA provides the control algorithm with a method for controlling the angular 
position of each vehicle. 

43 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

RWA Requirements 

• 

• 

Flywheel Requirements 
– Store system angular momentum (H) 
– Maximum wheel velocity at 7000 
RPM 
– Maximum wheel diameter of 0.5 m 
– Non-metallic 
Motor Requirements 
– Generate initial torque of 0.1 Nm 

05 December 2002 

EMFFORCE - CDR 

44 

<LLW> 
The angular momentum for the system is that generated when the system is at a two-vehicle 
configuration, with 2m separation distance between the vehicle centers.  The system will be 
rotating at 1 RPM. 

The maximum angular velocity of the wheel is set to preserve the structural integrity of the 
flywheel.  The tensile strength of the flywheel is such that it is not capable of sustaining 
speeds above the set maximum RPM. 

The flywheel diameter is limited by the size of the electromagnetic coils and the packaging 
of the vehicles.  At the height in the vehicle where the RWA is stored, the maximum 
available diameter for the flywheel is 0.5m. 

It is essential that the flywheel be constructed of non-metallic material due to the fact that it 
will be spinning in an electric field.  It has been determined that eddy currents will be 
induced in any conductive material placed within the magnetic coils.  The presence of these 
eddy currents will stop the relative rotation of the fly-wheel, similar to a “viscous effect.” 

The motor must be able to provide the “start-up” torque, the maximum torque required by 
the system during operation.  The start-up torque for a two-vehicle configuration spinning at 
1 RPM has been determined to be 0.02 Nm.  Torques can also be controlled by adjusting 
current flow through the electromagnetic coils. 

44 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Wheel Design 

I

veh

(

I 
tot 

=

+

m
veh

Determine Angular Momentum stored for 2 
vehicles, 2 m separation, 1 RPM 
s 
⎞
⎛
2)
2 
⎜
⎟
2
⎝
⎠
Given vehicle mass is 18 kg and moment of 
2: 
inertia for a vehicle is approx. 0.9 kg m
Itot  is 37.8 kg m2 
I
H 
=  tot
Ω⋅
tot 
Total angular momentum is 3.96 kg m2/s 

05 December 2002 

EMFFORCE - CDR 

45 

<WDF> 

The design of the fly wheel is dictated by the angular momentum that it must 
store for a given maneuver. Our current test plan calls for the ability to 
perform a spinup with two vehicles at a separation of two meters rotating at 
1 RPM. The first step is to develop an estimate of each vehicles mass 
moment of inertia about the z/2 (spin) axis perpendicular to the plane of the 
array. This was done by estimating the mass moment of inertia of each of 
the vehicles components about the center of rotation of the vehicle. For the 
current vehicle design the mass moment of inertia is approx. .9 kg m^2. 
Using the parallel axis theorem allows the calculation of the system mass 
moment of inertia from the vehicle mass and vehicle mass moment of 
inertia. By multiplying the system mass moment of inertia by the spin rate of 
the system we arrive at the total angular momentum that must be stored by 
reaction wheel. 

45 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

• 

• 
• 

Wheel Design (cont) 

H
I
H 
2 
2
⋅= 
⋅=
Ω⋅
tot 
wheel
wheel
wheel
Max speed of the wheel is limited by material 
properties 
σ 
max 

3 
+ 
ν
4 
Failure occurs at 15,000 RPM 
– 
– 
Deformation occurs at 7,000 RPM 
Chose system operating point at 2,000 RPM 
Mass moment of inertia of wheel is 0.01 kg m

1
ν
−
R
3 
ν 
+ 

(
2 
wheel 

R 
2
o

)

2
I

2 

= 

ρ
Ω⋅
⋅ 

+

05 December 2002 

EMFFORCE - CDR 

46 

<WDF> 

The moment of inertia created by the spinning vehicles must be stored in the 
two vehicles reaction wheels. For the purpose of these calculations, it is 
assumed that the spin-up maneuver chosen equally distributes the angular 
momentum between the two reaction wheels. If different maneuvers are 
performed we intend to spin the two wheels at different operating speeds. 
The maximum spin rate of the wheels is limited both by the motor 
performance and the wheels material properties. Our motors are capable of 
spinning at upwards of 20,000 RPM and thus the limiting factor is the wheel 
material properties. Using the above equation for the stress found in  a 
spinning disk and the known material properties of the wheel it can be 
calculated that the wheels will fracture at 15,000 RPM and begin to deform 
at 7,000 RPM. In order to remain well below this limit, we chose a system 
operating point of 2,000 RPM. This limit keeps the wheels well below any 
failure limit and still allows for margin to provide any necessary control 
authority. At this operating point the mass moment of inertia of each wheel 
must be approximately .01 kg m^2. This value was thus used to set the 
geometry of the wheel. 

46 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Wheel Design (cont) 

• 

Moment of Inertia of the wheel set by 
geometry 
[ 
π ρ 
⋅ 
( 
)
r
h
h
r
I 
4
4 
= 
−
+
⋅ 
disk
disk
wheel 
ring
rw
2 
= 0.01 kg m2 
• For Iwheel 
– rrw 
= 0.124 m 
= 0.100 m 
– rdisk 
= 0.015 m 
– hdisk 
= 0.030 m 
– hring 

⋅

r
4
disk

] 

hring 

rdisk

rrw 

hdisk 

05 December 2002 

EMFFORCE - CDR 

47 

<WDF> 

The mass moment of inertia of the wheel is calculated from the wheel’s 
geometry. The most efficient use of mass to achieve a high mass moment of 
inertia is to position as much mass as possible far from the center of the 
disk. Taking into consideration practical manufacturing capabilities the 
following dimensions were chosen to provide the necessary geometry. 
Wheels of the following dimensions were ordered from Advanced Urethane 
Solutions who are casting the wheels from high density urethane and will 
ship the completed wheels to us. 

47 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Motor Torque Requirement 

• 

Definition for 
magnetic moments: 

µ µ 
BA 

= 

2 
32 
π 
. 
mr 
5  4
4 
+ 
ωω
3 

µ 
0 

•  Dipole angle: 

⎛ 
⎜ 
cos 
1 
− 
α 
− = 
⎜ 
⎜ 
⎝ 

2 
ω
2 
. 
4 
4 
ωω 
+ 

• 

• 

Torque: 

1 
µ µ µ 
− = 
BA
0 
τ 
) 
(
3 
4 
r 
2
π
Boundary conditions: 
(  ) 
0
0 
ω 
= 
) 
(
2 
πω 
= 

2
π
60 

⎞ 
⎟ 
⎟ 
⎟ 
⎠ 
4  mrωτ 
− = 
. 
3 

2 

2 
sin 
α

02.0 
= τ 

Nm 

05 December 2002 

EMFFORCE - CDR 

48 

<LLW> 
The first equation gives the definition for the product of the magnetic moments of two 
dipoles.  The electromagnets used in the project are not dipoles, but the coreless coils 
create fields like “effective dipoles,” so dipole modeling techniques are used here. 

The second equation gives the relationship for the dipole angle, alpha.  This angle measures 
the rotation of the dipole from the x-axis.  Alpha is depicted in the diagram at the bottom of 
slide 21.  For these calculations, it was assumed that beta (the other dipole angle) is zero. 

Assuming that the dipoles are only able to translate and rotate in the x-y plane, the torque 
relationship shown above can be derived.  In the x-y-z coordinate system, the torque is 
about the z-axis.  Using the relationships for magnetic moment and dipole angle, the torque 
equation was simplified. 

Finally, boundary conditions were applied to give a quantitative value for the torque required 
by the RWA motor.  It was assumed that in the initial state (before spin-up) there is no 
angular velocity.  According to the system requirements, the system will spin at a rate of 1 
RPM, which drives the end boundary condition.  Applying these conditions gives a required 
torque of 0.02 Nm.  Margin was built into this calculation, and the motor was selected under 
a requirement to provide 0.1 Nm of torque. 

48 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Selected Motor 

• 

Astroflight Direct Drive Cobalt 
Airplane Motor 
Specifications: 
• 
35 Amps 
Max Current 
Max Shaft RPM 
12,000 – 15,000 
Torque (at 10 A) 
0.1 Nm
Mass 
0.31 kg
Length 
0.0635 m
Diameter 
0.0427 m

05 December 2002 

EMFFORCE - CDR 

49 

<LLW>

The selected motor is an Astroflight Astro Cobalt 25 Airplane motor.  A  

complete list of the motor’s specifications can be found online at:   

http://astroflight.com/sport1020.html.  The selected motor is p/n 625.


At 10 Amps the motor is capable of providing 0.1 Nm of torque (see next  

slide for the calculation).  At the maximum current of 35 Amps, the motor is  

capable of providing 0.34 Nm.  These estimates are found using the given  

torque constant of the motor.


At a mass of 0.31 kg, the selected motor is the least massive of the motors  

researched.


49 

Motor Power Requirement 
ki=τ 
Torque drives current requirement: 
i 
2.10 
Amps 
Required current: 
= 
V
V 
V
= 
+
tot 
BackEMF
iR
V  = 
armR 
Voltage: 
, 
093.0 
=V 
95.0 
= 
Ω
2.06 Volts 
Voltage due to Back EMF:  
totV
01 
Volts 
.3 
= 
Required voltage: 

V 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

• 
• 
• 
• 
• 
• 

• 

Required power: 

=P 

 Watts 
31 

05 December 2002 

EMFFORCE - CDR 

50 

<LLW>

The required current determined here is based on a required torque  

requirement of 0.1 Nm.  This is five times the calculated required torque,

building in an operational margin for the motors.


The voltage due to back EMF was calculated using a design angular velocity

(maximum) for the wheel of 2000 RPM and the motor speed provided in the  

manufacturer specifications, 971 RPM/Volt.  This is a peak voltage, as the  

maximum value for angular velocity was used to calculate it.


The total required voltage is the voltage required to overcome the armature  

resistance at the operational current plus the voltage required to overcome  

the back EMF.  The value for the resistance in the armature is provided by  

the motor manufacturer.  


The required power is then calculated using the relationship P = iV.  Again,  

this is a peak power requirement, as the voltage and current calculated are  

those required for situations with maximum torque and maximum wheel 

angular velocity.


50 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Testing – Voltage Profile 
Motivation:  Confirm motor specifications 
ity using a strobe 
Measured angular veloc
Better performance than provided specs 
RPM  v s Vo ltage  

• 
• 
• 

M
P
R

16000 

14000 

12000 

10000 

8000 

6000 

4000 

2000 

0 

0 

Tes t   dat a 
S pec  da ta 

2 

4 

6 

8 

10

 12

 14

 

V o l ts  

05 December 2002 

EMFFORCE - CDR 

51 

<LLW> 
It was important to verify the provided motor performance specifications 
because these specs are used as variables for control inputs.  The torque 
output of the motor is also an essential parameter, and testing is in progress 
to obtain a torque-current profile. 

This test was done by clamping the motor to a table and varying the voltage 
input to the motor.  The motor angular velocity was measured using a strobe 
light. 

The spec data was found from the given 971 RPM/volt.  Although the motor 
is designed to operate with up to 18 volts input, the range was limited here to 
that which will be practically used in the EMFFORCE project.  Although this 
test found that the actual motor performance is better than the specified 
performance, the specifications were still used as the basis for calculations, 
again adding margin to the design. 

51 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

• 

• 

Testing – EM Field 
Motivation:  
Verify that motor 
performance does not vary during 
operation in an EM field 

Varied current 
through coil from 
0 – 30 Amps 

• 

No var
iation in 
performance 

05 December 2002 

EMFFORCE - CDR 

52 

<LLW> 
The motor was placed in a foam holder, and then in the liquid nitrogen bath 
that holds the electromagnetic coil.  The motor was turned on by itself.  
Current was then applied to the electromagnetic coil.  Both the voltage 
supplied to the motor and the current applied to the magnet were varied, in 
turn.  The motor was also rotated so that it was aligned perpendicular to the 
induced B-field.   No difference in motor performance was noted in any of 
the different conditions.  

52 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

RWA Mass/Power Budgets 

Item 

Flywheel 
Motor 
Subsystem 
TOTALS: 

Mass Per 
Vehicle 
(kg) 
1.2
.31

1.51 

Voltage 
(V) 

Current 
(A) 

Power 
(W) 

-
3.01 

3.01 

-
10.2 

10.2 

-

31 

31 

05 December 2002 

EMFFORCE - CDR 

53 

<LLW>

The masses per vehicle represent one flywheel and one motor per vehicle.   

The budgets for voltage, current, and power reflect the calculations shown in  

the previous slides.  The system totals shown here fit into the system

requirements set for the vehicles.


53 

RWA Cost Budget 

Item 

Development 
($) 

Cost Per 
Item ($) 

Qty. 

Total 
($) 

432 

Fly 
Wheel 
Motor 
27 
Subsystem TOTAL: 

47 

140 

3 

3 

573 

420 
1020 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

05 December 2002 

EMFFORCE - CDR 

54 

<LLW> 
The cost budget shows development costs for the flywheel.  This was a fixed 
rate to cover the set-up for the manufacture of the wheel.  After this initial 
set-up fee, the wheels cost $47 each, as shown in the chart.  There were no 
developmental costs for the motors. 

54 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

RWA Concerns 

Concern 

Wheel Fracture 

Safety Hazard of Wheel 

Wheel Saturation 

Motor Overheating 

Mitigation
Design Margin, physical 
limits on motor inputs
Addressed by Ops 
Margin designed into H 
storage calculations
Long duration testing 
planned

05 December 2002 

EMFFORCE - CDR 

55 

<LLW> 
The concerns listed mainly involve the flywheel.  Testing on the wheels has 
not yet been done because the wheels have not yet been delivered.  
Throughout the design process of the wheel, extra margin was built into the 
design to assure that the wheel will neither fracture nor saturate during 
operation. 

In terms of the safety of the wheel, the Operations team has addressed this 
problem.  The wheel will have a guard around it to prevent injury to anyone 
on the test floor. 

Motor overheating is not an expected problem, but a possible one.  A long 
duration test will be completed by the end of the term to address this issue. 

55 

Power 

Geeta Gupta 

05 December 2002 

EMFFORCE - CDR 

56 

56


• 

• 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Power Subsystem 
Objective: provide necessary 
voltage and current levels to other 
subsystems 

Two distinct designs: 
– Actuation: Electromagnet, Reaction
Wheel 
Electronics
– 
: Avionics, 
Communications, Metrology 

05 December 2002 

EMFFORCE - CDR 

57 

<TAS> 
The objective of the power subsystem is to provide the necessary levels of 
voltage and current to each of the other subsystems.  The power is 
separated into three branches: electromagnet, reaction wheel, and 
electronics.  The electromagnet and reaction wheel branches are the 
actuation branches. The electronics branch is responsible for providing 
power to the avionics, communications, and metrology subsystems. 

57 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Requirements 

• 

• 
• 

• 

Must be completely self-contained 
(no external cords) 
Batteries must be rechargeable 
Battery lifetime must be at least 20 
minutes 
Electronics branch must continue 
to operate even if EM & RW 
(actuation) batteries are drained 

05 December 2002 

EMFFORCE - CDR 

58 

<TAS>

These are the four main requirements for the power subsystem.


-The power supply must be completely contained within the structure of each  

vehicle.  This implies that the power must be supplied from an on-board  

source (i.e. batteries)

-Any batteries used must be rechargeable.  The purpose of this requirement  

is to lower the overall cost by avoiding the need to purchase thousands of  

batteries over the lifetime of the project.  Rechargeable batteries are also  

more environmentally friendly than disposable batteries.

-The subsystem must provide sustained power for at least twenty minutes. 

This lifetime corresponds with initial estimates for the expected lifetime of the  

gas bearing system.  It also allows for several tests to be run without having  

to replace the batteries.

-The electronics branch must continue to function even if the actuation  

branch batteries are drained.  The electronics subsystems must be able to  

pass commands and record data regardless of the status of the actuation  

branches.  This requirement implies that there will be two distinct, separate  

power systems on board each vehicle.


58 

Battery Selection 

• 

Important characteristics: 
– Total energy per battery [mAh] 
– Energy density [mAh/kg] 
– Maximum current discharge capacity 
for each battery type 
– Charge/discharge characteristics, 
memory effects 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

05 December 2002 

EMFFORCE - CDR 

59 

<TAS>

The main selection criteria for the batteries was the total energy per battery.   

Because of the twenty minute lifetime requirement, the batteries had to have  

enough stored energy to be able to last that long.  

There were also other issues important in the battery selection.  Choosing  

batteries with the highest energy density minimizes the total battery mass.   

The maximum current discharge capacity was also important.  The  

electromagnet requires up to 100 Amps of current, so finding batteries with a  

high enough discharge rating was essential.  Finally, the charging and  

discharging characteristics of the batteries was important.  Some batteries  

can be permanently damaged if they are over-charged, so these were  

avoided.  Also, some batteries have what is known as a “memory effect.”  A  

battery has a memory effect if complete discharge is required before re­
charging.  Finding batteries with no memory effect was desirable.


59 



• 

• 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Actuation Battery Selection 
Battery selection:  
9000mAh 
rechargeable 
NiMH D-cells 

Features: 
–  High energy density (53 mAh/kg) 
– 
45 Amp max. continuous current discharge, 
up to 120 Amps momentarily 
No memory effects, long service life (300 ­
1000 charge/discharge cycles) 

– 

05 December 2002 

EMFFORCE - CDR 

60 

<TAS>

After researching different battery chemistries, Nickel Metal Hydrides (NiMH)  

offered the highest energy densities.  The design of the actuation branches was 

dominated by the requirements for the electromagnet.  The batteries chosen for this  

were 9000mAh D-cells manufactured by GoldPeak Industries.  The maximum  

current for the electromagnet is estimated to be 100 Amps.  These D-cells have a

maximum current rating of 35 Amps, which is higher than any of the other batteries  

researched.  Connecting three D-cells in parallel will provide over 100 Amps to the

electromagnet when needed.  These batteries have no memory effect, meaning  

they can be recharged at any time without any decrease in performance.  Their 

service life is long – they can undergo several hundred charge/discharge cycles 

without a decrease in performance. 

The reaction wheel requires a much lower maximum current (on the order of 10-20

Amps).  Although it would be sufficient to use slightly less powerful and lighter

batteries, the reaction wheel will use the same batteries as the electromagnet.  This 

will permit interchangeability of individual batteries between the two branches,

which is more beneficial than the small amount of weight that could be saved.  In

the event that weight became a more important issue, then lighter batteries could 

be substituted in for the reaction wheel branch.


60 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

EM Branch Design 

• 
• 
-

100 Amps required @ 2 – 5 Volts 
Combine in series and parallel: 
3.6 V  
+ 

35 Amps 
35 A 
35 A 

> 100 Amps 

• 

MOSFET controller – pulse width 
modulated signal to drive current 

05 December 2002 

EMFFORCE - CDR 

61 

<TAS> 
The electromagnet will require up to 100 Amps of current.  Because of its 
superconducting properties, there is virtually zero resistance across the 
magnet.  This means that only a small voltage (2-5 Volts) is required to drive 
the current through the magnet.  (In fact, most of the resistance in the 
system is due to the internal wiring and circuitry).  The power requirements 
for the electromagnet can be met by placing the batteries in combinations of 
series and parallel.  Placing three batteries in series produces a voltage 
difference of 3.6 volts, which is sufficient to drive the magnet.  Since this 
“cell” can still only output 35 amps, wiring three cells in parallel will allow 
three times as much current, thus providing over 100 Amps when necessary. 
The EM branch uses a MOSFET controller to control the current to the 
magnets.  This is shown on the next slide. 

61 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

EM Branch Design 
MOSFET controller – uses H-bridge 
circuit to control current through gates 

• 

1 

3 

Electromagnet 

2 

4 

• 

• 

Gates 2+3 open, 1+4 closed 
forward direction (pictured) 
Gates 1+4 open, 2+3 closed 
reverse direction 

Æ current in 

Æ current in 

05 December 2002 

EMFFORCE - CDR 

62 

<TAS> 
This is a simple representation of the H-bridge circuit used to control the 
direction of current through the magnet.  The gates are driven by the pulse-
width modulated signal from the controller.  The PWM signal fluctuates 
between “up” and “down” at a certain frequency.  The signal has a duty cycle 
between 0 and 100%.  At 50% duty cycle, the PWM is up 50% of the cycle 
and down 50% of the cycle.  A 75% duty cycle would be up 75% of each 
cycle and down 25%.  When the signal is in the up position, the current is 
commanded to flow forward through the magnet.  This is accomplished by 
closing gates 1+4 and opening gates 2+3 in the diagram above.  When the 
signal is in the down position, the current flows backwards through the 
magnet.  This is accomplished by closing gates 2+3 and opening gates 1+4. 
For duty cycles above 50%, the net flow of current through the magnet is in 
the forward direction.  For duty cycles below 50%, the net flow of current is 
in the reverse direction. 

62 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

RW Branch Design 

• 

10 Amps required @ 3 – 5 Volts 

-

4.8 V  

+ 

20 Amps 

•  If higher voltage needed, add more 
batteries in series 
Uses same MOSFET controller as 
EM branch 

• 

05 December 2002 

EMFFORCE - CDR 

63 

<TAS> 
The design of the reaction wheel branch is almost identical to the 
electromagnet branch.  The same MOSFET controller will be used to drive 
the current with the PWM signal.  The expected current draw for the reaction 
wheel is 10 amps, so a single cell of batteries in series will be sufficient.  The 
estimated voltage requirement is between 3 and 5 volts, which will be 
satisfied by connecting four batteries in series.  If it is determined that a 
higher voltage is required, more batteries can be added in series. 

63 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

• 

Electronics Branch Design 
Battery selection: 1800mAh 
rechargeable 
NiMH AA-cells 

• Features:  
– High energy density (69 mAh/kg) 
– 5 Amp max. current discharge 
– No memory effects, long service life 
(500-1000 charge/discharge cycles) 

05 December 2002 

EMFFORCE - CDR 

64 

<TAS> 
Nickel Metal Hydrides were also chosen for the electronics branch.  The 
electronics branch requires around 1 Amp of total current, at three separate 
voltages.  The batteries chosen for this were 1800mAh AA-cells 
manufactured by GoldPeak Industries.  Approximately 12 AA batteries will 
be wired in series, and will be connected to three voltage regulators: 3.3, 5, 
and 12 Volts.  These batteries also have no memory effect and a long 
service life (over 500 charge/discharge cycles). 

64 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Electronics Branch Design 

• 
• 

<1 Amp required @ 3.3, 5, 12 Volts 
Use 12 batteries in series, voltage 
regulators 

Electronics 
Batteries 

3.3 V 
Regulator 

5 V 
Regulator 

12 V 
Regulator 

Comm. Board 

Avionics, Sensors 

Gyros 

05 December 2002 

EMFFORCE - CDR 

65 

<TAS>


65 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Test Results 

• 

Validate manufacturer’s lifetime specifications 

• 
• 

• 

0.8 Volts considered stopping point 
Lifetime specs matches well, despite lower voltage levels 
than expected 
Voltage data matches better when using multiple batteries 
in series 

05 December 2002 

EMFFORCE - CDR 

66 

<TAS>

This is a test of the maximum battery lifetime.  


66 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

• 
• 

Test Results 

V o ltage  vs .  T ime  
3  b a tte ries , C u rren t = 28A

(

) 

 
e
g
a
t
l
o
 
)
V
s
 
t
d
l
o
e
V
z
(
i
l
a
m
r
o
N

1 .5  
1 .4  
1 .3  
1 .2  
1 .1  
1 
0 .9  
0 .8  

0  

5  

10  

40  

50  

55  

15  

20  

35  

45  

25  
30  
Time m in
(
) 
Lifetime requirement far exceeded 
Extended lifetime due to due to battery 
recharging on “down” part of duty cycle 

05 December 2002 

EMFFORCE - CDR 

67 

<TAS>


67 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Power Subsystem Budgets 

Qty. 

Item 

Unit Mass 
(kg) 
13
D-cells 
0.170 
12 
0.027 
AA-cells 
Controllers 
3
0.1 
0.1 
3 
Volt. Regs. 
0.1 
Sensors 
2
Misc. 
-
-
TOTAL MASS PER VEHICLE: 
TOTAL SUBSYSTEM BUDGET: 

Mass per 
vehicle (kg) 
2.21 
.33 
.3 
.3 
.2 
.1 
3.44 

Total 
Cost ($)
1200
250
450
100
200
300
-
2500 

05 December 2002 

EMFFORCE - CDR 

68 

<TAS>


68 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Power Concerns 

Concern
Difficulties with running 
100 Amps through 
circuitry 
Buildup of heat in circuit 
components, batteries 
Long charge time for D-
cell batteries (~16 
hours) 

Mitigation
Use separate 
controllers for each 
battery cell if needed 
Use heat sinks 
wherever possible 
Have extra complete 
sets of batteries on had 
(and charged) 

05 December 2002 

EMFFORCE - CDR 

69 

<TAS>


69 

Structure 

Geeta Gupta 

05 December 2002 

EMFFORCE - CDR 

70 

70


EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

• 

• 

• 

Structure Overview 
Physical interfacing of subsystems 
– 
Provide structural “backbone” of vehicle 
Subsystem packaging/magnetic 
shielding 
Prevent magnet from interfering with 
– 
electronics and vice versa 
Gas carriage provides pressurized 
cushion of gas for near frictionless 
translation over a flat floor 

05 December 2002 

EMFFORCE - CDR 

71 

<GG, ALS> 

The EMFFORCE packaging is meant to hold together the various 
subsystems of the total system in a functional manner that allows for efficient 
use of volume and mass, as well as practical interfaces.  The packaging 
must ensure that all subsystems have the necessary physical conditions to 
function correctly; the electromagnet must not interfere with the electronics, 
and the metrology subsystem must have a 360 degree unobstructed view of 
the vehicle’s surroundings. 

The gas carriage portion of the structure will provide near frictionless 
translation over the test facility floor.  It is important to minimize external 
forces on the vehicle so that the system’s force balance is undisturbed and 
also so that a space environment is simulated.  The test facility floor may 
have a variety of surface finishes: very smooth, such as glass or Lockheed’s 
flat floor facility; or not as smooth, such as the floor of MIT’s Lobby 7.  Lobby 
7 could provide a valuable test surface for pre-Denver testing. 

71 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Requirements 
Feasible Packaging 
– 
Rotational symmetry; keep center of mass 
to within 1cm of center of EM field. 
– 
Center of mass kept low for stability 
Shielding 
– 
Provide sufficient shielding to prevent 
interference from electromagnet generating 
field strength up to 0.03 Tesla. 
gas Carriage 
– 
Must provide gas supply sufficient for 20 
minutes of operation 

• 

• 

• 

05 December 2002 

EMFFORCE - CDR 

72 

<GG, ALS> 

The requirements associated with the EMFFORCE packaging relate to the 
feasibility of the design.  In order to maintain simplicity in maneuvering and 
handling, as well as to avoid control problems the packaging must be 
rotationally symmetric.  The structures team must avoid a top-heavy design 
in order for stability, as well as take into consideration where the forces will 
act on the vehicles. 

The packaging must include some sort of shielding (if necessary) to avoid 
magnetic interference between the magnet, electronics and other 
subsystems on board. 

The gas carriage must provide as long a test duration as possible.  The 
minimum requirement is 20 minutes. 

72 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Design History 
Symmetrical Design 
• 
• 
Use volume inside rings to 
package subsystems 

• 

Obstacles 
– 
Four attachment points on 
rings vs. three attachment 
points due to pucks 
Mounting methods 
•  Rings on base 
• 
Subsystems inside rings 
Keep mass MINIMAL 

– 

– 

05 December 2002 

EMFFORCE - CDR 

73 

<GG> 

In order to fulfill the requirements the preliminary conceptual design used a 
spherical volume formed by the two electromagnet rings to house the 
reaction wheel and other subsystems.  The rings sat on a triangular plate 
attached to gas pucks. 

Although the conceptual design maintained rotational symmetry and kept the 
reaction wheel in the center of the generated force field, mounting methods 
that kept the mass minimal needed to be developed.  A geometrical location 
for the power subsystem batteries also needed developing. 

73 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Design History 

• 

• 

Circular base used to decouple four-point to three point 
attachment. 
Provides ample space for mounting batteries 
selected des
ign 
rejected design 

• 

• 

Mount cross braces directly to       
ber-glassed foam containers 
fi
with L-brackets 
Use similar fiber-glassed brackets to mount gas tank 
ngs to base. 
to rings and ri

05 December 2002 

EMFFORCE - CDR 

74 

<GG> 

To find four points at which to connect the rings and base plate and maintain 
as much rotational symmetry as possible we designed a circular ring base 
plate.  In order to overcome attachment point obstacles and keep minimal 
mass, L brackets were specially designed to attach four connection points 
on the rings to a circular base.  L brackets will be attached to the foam rings 
using cryogenic epoxy as well as fiber glass strips.  These L brackets will 
also support braces suspended inside the rings to hold the avionics board, 
and reaction wheel assembly. 

74 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Packaging Design – 
Attach Points 
Metrology attach point   
– flat eyelet bracket 
Gas tank attach point      
– flat eyelet bracket 

RWA attach point 
– L shaped eyelet bracket
A
vionics attach point      
– L shaped eyelet brackets  

s 

PWR attach point    
– Velcro 

EM / Gas Carriage Base attach pts.   
– L shaped eyelet brackets 

05 December 2002 

EMFFORCE - CDR 

75 

<GG> 

All the attachment points are described above.  Special brackets are 
designed and attached to the rings using the previously described method 
for the metrology system, gas tank, RWA, avionics, and base plate attach 
points.  The power subsystem will be secured using Velcro to the base plate 
for easy replacement between tests. 

75 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Gas Carriage Design 
2  gas supply:
• CO
rechargeable compressed
gas tank 
High pressure regulator: 
reduces 860 psi to 30-60 
psi 
Three 100 mm diameter 
pucks evenly spaced
around base ring 
Pucks not rigidly attached 
Backup tanks 

• 
• 

• 

• 

05 December 2002 

EMFFORCE - CDR 

76 

<ALS> 

The final gas carriage system consists of several components.  The gas supply 
source is a tank of compressed CO2.  These tanks are rechargeable.  The tanks 
discharge high pressure CO2 gas at approximately 860 psi.  This high pressure is 
then reduced to operational pressure of 30-60 psi by a regulator.  The lower 
pressure gas is then pushed through three single-aperture, 100 mm diameter pucks 
evenly spaced around the base ring. 

The circular base of the packaging allows the gas carriage pucks to interface with 
the rest of the vehicle.  The pucks are attached to the ring by two 6-32 screws. 
However, they are not rigidly attached.  Rather, they are loosely screwed on and 
then separated from the ring by springy “shock-absorbing” washers.  This allow the 
gas carriage puck to maintain coplanarity despite any mass or force imbalance that 
may occur in the vehicle above.  A similar system was employed on the SPHERES 
earth-bound testbed with great success. 

EMFFORCE owns several backup tanks should a sequence of testing be required 
without time to recharge the tanks. 

76 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Puck Designs 

• 

• 

• 

Motivation: increase vehicle mass, test 
time, and/or gap height by optimizing 
puck design 
Varied puck design parameters: 
– 
Number of outlet apertures 
– 
Radius of apertures 
–  Diameter of puck 
Designed a cap for ease of plumbing 
multiple aperture pucks 

05 December 2002 

EMFFORCE - CDR 

77 

<ALS> 

The structures team hoped to choose a puck design that would optimize the 
critical design variables.  To do this, a matrix of prototype pucks were 
manufactured varying those parameters affect performance: number of 
apertures, the radius of those apertures, and the overall puck diameter.  To 
ease the plumbing of multiple aperture pucks, a cap adapter was devised to 
require only one fitting per puck, regardless of aperture size. 

77 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Puck Prototypes 

•1 aperture, 
Vary puck 
diameter 
•3 apertures, 
vary radius 
•5 apertures, 
vary radius 
•6 apertures, 
vary radius 

05 December 2002 

EMFFORCE - CDR 

78 

<ALS>


All of the prototype pucks are shown here.   


78 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Cap Configuration 

•Single aperture: simplifies 
plumbing 
•3.175 mm circular recess 
to give all apertures 
access to gas supply 
•O-ring seals gasflow 
inside recess 
•Cap attaches to puck with 
5 screws 

05 December 2002 

EMFFORCE - CDR 

79 

<ALS> 

The cap was designed to simplify plumbing to a multi-aperture puck.  This 
cap design is a universal adapter for any of the prototypes created.  There is 
a recess so the gas can flow freely to all of the apertures in the puck, and an 
o-ring seals the cap so that there is no leakage.  The cap attaches to the top 
of the puck with five screws. 

The top photo shows the underside of the cap, the side that would face the 
puck.  The bottom photo shows a top view of the cap attached to a puck. 

79 

• 
• 

• 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Puck Test Results 
Chatter experienced with all capped designs 
Possible explanations 
Aerodynamic disturbance in recess 
– 
– 
Apertures too large 
– 
Prototype pucks unpolished 
Able to test with single aperture pucks 
– 
Unpolished 100 mm diameter puck at 70 psig 
Gap (mm)
Weight (kg) 
6 
0.13 
7 
0.08 
0.03 
10.5 

• 
Indicates that design sufficient for 31.5kg 
vehicle on glass, potential for rougher surface 

05 December 2002 

EMFFORCE - CDR 

80 

<ALS> 

Unfortunately, a chattering phenomenon was experiences with all of the 
developed designs using the cap configuration.  This phenomenon was a mode of instability 
predicted by previous research on gas lubricated bearing called “pneumatic hammer.”  The 
structures team was unable to determine the exact source of the instability.  The most probable 
explanation is that the cap design introduced some form of aerodynamic instability.  This 
explanation is supported by the fact that the baseline design (used by SPHERES quite reliably) 
also experienced chatter when coupled with the cap. 
Other contributing factors could have been the fact that the apertures in the multi-
aperture pucks were too large or that the pucks were unpolished.  Every aperture was the same 
diameter as the one aperture in the single aperture pucks.  This made the total area available to 
the gas flow three, five, or six times that of the one aperture pucks.  Further prototype and testing 
would have included multi-aperture pucks with apertures sized proportionally to the number of 
apertures.  The surface finish of the pucks is less likely of a problem, as unpolished pucks 
functioned perfectly well in later testing. 
In light of test results and schedule constraints, multi-aperture puck designs were 

ruled out. 
When the structures team ruled out the cap configuration, the single aperture pucks (of varying 
diameters: 80mm, 100mm, 120mm) were threaded and tested.  No chatter was experienced with 
any of these designs.  It was shown that the weight-carrying capacity of the puck increased with 
diameter, but the 100mm puck was more than sufficient for this project.  It was determined that a 
larger diameter would be a waste of material.  Shown above is the gas cushion gap height for 
different weights.  Six kg per puck implies an 18 kg vehicle – currently the mass estimate.  This 
indicates that there is plenty of margin with regard to the gas carriage capability in the vehicle 
mass. 

80 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Shielding Test Results 

• 

• 

Tested Electronics in magnetic field 
–  1500 Amp-turns, 30 cm diameter magnet 
Tested various combinations for effects on 
– 
DR2000 transmission 
DR2000 and TT8 located singly and jo ntly in 
i
• 
magnetic field 
Varied orientations and rotational veloc
• 
No discernable effect on packet 
transmission 
Agrees with theoretical conclusion 
– 

ities 

05 December 2002 

EMFFORCE - CDR 

81 

<ESS> 

Shielding Test

Goal: determine if DR2000 and TT8 can function normally in magnetic field in order to evaluate need  

for shielding of electronic components 

Results: shielding should not be required for the Avionics or Communications subsystems

Procedure:

We ran the communications initial system test in the presence of a strong magnetic field created by

the preliminary super-conducting magnet model.  This test consists of two nodes, each with a laptop,  

a TT8 microprocessor, and a DR2000 comm board.  One TT8 runs a packet transmission program  

that requires a keyboard input to send a string through the attached DR2000.  The other node  

receives the packet, processes it, and outputs it to the laptop.

The magnetic field was created by a super-conducting magnet of 40 turns running at approximately  

40 amps.

In various phases of the test, the TT8, the DR2000, and then both boards together were placed in the  

magnetic field, rotated within the field, and held in different orientations.

The packet transmissions were not distorted or interrupted.  This indicates that no shielding will be 

required.  However, we are not sure if the increased field strength present in the real magnet will  

affect this determination. 

This result agrees with the theoretical assessment that the magnetic field should not affect the  

operations of the solid state electronics present in these electronics components.  The sizes of the 

electrical channels are so small that no discernable eddy currents are expected.  The board

manufacturer, OnSet Computer, also indicated that no magnetic field effects would be expected 


81 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

1
1
1
-

Base Plate 
Brace 1 (av onics
) 
i
Brace 2 (RWA
) 
Brackets + Assembly 
Hardware 
1 
Tank 
Regulator 
0.32 
Pucks 
0.25 
Plumbing 
0.75 
TOTAL Subsystem Mass: 

Structures Mass Budget 
Per Vehicle (kg) 
Qty. 
Item
Unit 
Mass (kg) 
0.90 
0.15 
0.3
0.35 

0.90 
0.15 
0.30 
0.35 

1
1 
3
-

1.0
0.32 
0.75 
0.75 
4.52 

82 

05 December 2002 

EMFFORCE - CDR 

<ALS, GG> 

Above is the mass budget for the entire structure subsystem. 

Packaging mass includes the base plate, the two braces, brackets as 
previously described and nuts and bolts 

The gas carriage contributes tank, regulator, pucks, and plumbing fittings to 
the total mass.  The tank is aligned along the axis or rotational symmetry so 
that it contributes minimum to the moment of inertia of the vehicle. 

82 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Structures Cost Budget 
Development
Final Product (System)
Item 
Item 
Qty 
Qty 
Cost ($) 
Cost ($) 
Dry Ice 
Tanks 
1 
250
40 
1 
Airman 
Regulators
1
3
110
10
compressor 
Fee er Gages 
l
¼” a uminum 
l
sheet metal 
Shielding 
Sample Kit 
sc Plumb
Mi
200
ing 
SUBTOTAL: 
SUBTOTAL: 
957 
TOTAL SUBSYSTEM BUDGET: 

Plumbing 
” a uminum 
1/8
l
sheet metal 
1/16
l
” a uminum 
sheet metal 

975
1932

195
100

68
150

1 
2

1 

1

1 
1

1

189

100

05 December 2002 

EMFFORCE - CDR 

83 

<GG, ALS> 

Above is the monetary budget for the structures system. 

Research and development expenditures were largely due to some different 
ideas for gas supply that were tested and rejected over the summer.  The 
regulators turned out to be a more significant cost than originally predicted. 

The quarter inch aluminum was used for prototyping and found to be too 
heavy for the actual system.  Instead eighth inch aluminum will be used for 
the base providing enough rigidity.  The sixteenth inch aluminum will be used 
for the fabrication of the eyelet brackets. 

83 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Structure Concerns 

Concern
Foam rings may not support 
cross-braces and 
subsystems 
Electromagnet may interfere 
with electronics when field is 
stronger 

Tanks may not provide 
estimated test time with new 
pucks, different pressures 

Mitigation

Run tests; have back-up 
design

Keep shieldi
ng kit to use if 
necessary (+0.2 kg) 

Test full gas carriage for 
new time estimate, 
experiment with pressure 
control 

05 December 2002 

EMFFORCE - CDR 

84 

<GG, ALS> 
There are still a few remaining concerns from the structures team.  The biggest concern is 
that the foam rings will not be able to support the cross braces and the torque exerted on 
them due to the forces and torques generated by the electromagnet and reaction wheel. 

In the case that the electromagnet does interfere with the electronics when the EM field is 
stronger the structures will utilize the shielding kit originally purchased to block and 
interfering forces. 

The puck is the one component of the gas carriage that has changed significantly in design. 
The EMFFORCE pucks are larger than the pucks used for SPHERES.  Because the fluid 
dynamics of lubrication theory are so complicated, analytical model development was not 
possible under the given time constraints.  There is concern that a trade has been made 
between mass carrying capability and test time.  Since the larger pucks are able to carry 
more mass, the structures team hypothesizes, based on qualitative analysis of the fluid 
dynamics and previous lab experience, that gas flow will need to be increased to maintain 
sufficient gap height.  If the gas flow is increased, the tank gas will be depleted in a shorter 
amount of time.  To determine the possible range of operation, the structures team’s next 
step is to conduct tests in order to gain new time estimates for varying operating pressures. 
During these tests it will also be beneficial to measure the separation gap height to 
determine what operating pressure (and correlating test time) is required for alternative 
surfaces.  The ability to float the vehicle over a coarser surface allows the EMFFORCE team 
greater flexibility in test facility. 

84 

Metrology 

Oscar Murillo 

05 December 2002 

EMFFORCE - CDR 

85 

85


EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Metrology Overview 
Determine position and orientation of each 
vehicle within the system 
Uses IR and ultrasonic transmitters and 
receivers on each vehicle 
1 ultrasonic transmitter and 3 ultrasonic receivers 
– 
– 
4 IR transmitter arrays and 3 IR receiver arrays 
Time difference of IR receive and ultrasonic 
receive determines distance 
Orientation of ultrasonic receivers determines 
angle 
Rate gyros are used to supply angular rates 
about vertical axis 

• 

• 

• 

• 

• 

05 December 2002 

EMFFORCE - CDR 

86 

<OM> 
The general goal of the Metrology system is to determine the position and 
orientation of each vehicle in the system.  The system design uses IR and 
Ultrasonic transmitters and receivers to do these estimations.  The basic algorithm 
for the system uses the time difference of the IR and Ultrasonic signals to determine 
the distance of the other vehicles.  In addition, the orientation of the 3 receivers help 
determine the angle from which the signal came. 

86 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Requirements 
Determine separation distance 
– 
Goal:  sense to 1 cm 
Determine relative attitude (direction) of 
vehicle 
– 
Resolution of distance sets angle resolution to 0.7° 
Full field of view : 360 degrees in the 
horizontal plane 
Detect other vehicles at distances compatible 
with field tests 
– 
Max of 4 meters 
Refresh rate compatible with control system 
requirements 
– 
Timing sequence of system refreshes at 

10 Hz 

• 

• 

• 

• 

• 

05 December 2002 

EMFFORCE - CDR 

87 

<OM> 
Extracted from the requirements of the overall project, the goal of the metrology 
system is to accurately calculate relative distance and attitude of each vehicle and 
the orientation of the system.  Per the requirements document, accurately is defined 
as 1/10 of the control tolerance for both distance and angular readings.  In addition, 
the metrology system needs to have a field of view of 360º in a 2-D plane.   Next, 
the system needs a detection range compatible with test facilities.  These test 
facilities include the test facility at MIT and the Lockheed flat floor facility in Denver, 
CO.  Finally, the system needs to meet refresh rate requirements set forth by the 
control team, currently set at 10 Hz. 

87 

Hardware Design: Receiver 
Circuit 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

05 December 2002 

EMFFORCE - CDR 

88 

<AA>

The Receiver board will contain both the ultrasonic and infrared receivers.


The Ultrasonic signal is first amplified, then rectified, amplified again, and  

finally put through a comparator, so that the analog audio signal is sent to  

the tattletale as a digital signal.  Since the metrology system determines,  

time of flight, the only data of importance is the time of the initial reception of  

the US signal.


At least one IR receiver will also be on the receiver board. More may be  

added to ensure detection of IR pulse.


Capacitors have been placed across the power bus to decrease noise.


88 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Hardware Design: Reflective 
Cones 
Reflective cone 

Incoming 
signal 

Focus of 
parabola 

Ultrasonic 
receiver 
Reflects incoming US waves and 
focuses them into receiver 

• 

05 December 2002 

EMFFORCE - CDR 

89 

<AA>

The reflective cones reflect the planar wave emitted by the ultrasonic  

transmitter and focus it on the receiver.  The purpose of the cones is to  

make directional receivers effectively omni directional (in the plane).

The shape of the reflective cone is made by rotating a section of a parabola  

around the y axis.  The equation of the parabola is   

y^2=4(7.059mm)(x+4.906mm)  from x=0 to x=39mm  (x will be the radius of  

the cone).  This equation is taken from the basic formula for a parabola,  

using measurements of the reflective cones from the Mimio electronic  

whiteboard system to solve for the constants.

This exact shape has not been made and tested, but initial testing seems to  

indicate that minor differences in shape should not greatly effect the  

efficiency of the reflective cones.

Initial testing indicates that the cones decrease the range of the receivers by  

about 30%.  

Changes in angle do not appear to effect the range readings for the  

receivers  (cones do make accurate omnidirectional receivers).


89 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Hardware Design: Transmitters 
High-Power 
40kHz Omni-Directional 
Infrared Emitters 
Ultrasound Transmitter 
PDI-E804 
US40KT-01 

•1 per vehicle 
•Sound pressure 
output: 0.025 Pa/V 
•Max Voltage: 300 V 

•4 arrays of 4 to 6 transmitters 
•Power Dissipation 160 mW 
•Peak Forward Current  3.0 A 
•Beam directionality ~120 deg 

05 December 2002 

EMFFORCE - CDR 

90 

<AA> 
The transmitter board will consist of one ultrasonic transmitter and 4 arrays 
of infrared emitters.  The arrays will consist of 4 to 6 emitters depending on 
final range requirements.  Boards will be designed to hold up to 6, but will 
only be populated with enough to meet requirements. 

The transmitter board will be laid out to attach to the communications board 
because they share a mounting point at the center of the top of the vehicle. 

The Transmitter board will take signals output by the metrology tattletale.  
The US signal will be amplified through a transformer before being used to 
actuate the Piezo Electric transmitter.  

The US transmitters will be taken from Mimio pens.   The Infrared emitters 
will be purchased. 

90 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Hardware Design: Rate Gyro 

• 

• 

Gyro determines 
inertial angular rate 
of individual vehicle 
– Rate data used for 
ithm 
control algor
Gyro connects to 
avionics tattletale 
(not metrology) 

Bandwidth (-90°) 
>50 Hz 
Threshold/ Resolution 
0.004°/sec 
Output voltage     
0 to +5 Vdc 

05 December 2002 

EMFFORCE - CDR 

91 

<AA>

We will be using the BEI Gyrochip II.  This gyro was donated by project  

SPHERES.


The gyro is 25.65mm wide by 25.65mm high by 68.58mm long.


The rate gyro will be polled directly by the avionics tattletale rather than the  

metrology board.  This allows the control algorithm to poll the gyro as often  

as necessary.  It won’t need to wait for the MSA.  The gyro will be polled at  

between 1 to 10 Hz, depending on processing load on avionics board.


91 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Hardware Design: Structure 

Transmitter 

Rece ver 
i

.38m 

.22m 

Attachment 
bolt hole 

Rece ver 
i

• 

• 

Maintains proper 
orientation for 
receivers 
Provides 
attachment to main 
vehicle 

05 December 2002 

EMFFORCE - CDR 

92 

<AA> 
The structural support for of the metrology system is part of the metrology 
subsystem.  The structure is a large Y shape.  The US transmitter is placed 
at the center along with the communications board.  The US receivers are 
placed at the ends of the Y. The receivers and transmitter will be bolted to 
the structure. 

The size of the structure is determined by the size of the vehicle.  Increasing 
the distance between the receivers increases the resolution of the system.  
Thus it was decided to put the receivers as far from the center as possible 
without extending past the edges of the vehicle.  

The final material down select has not yet been completed.  The structural 
support will either be 1/8 inch aluminum stock or ¼ inch balsa wood struts.  

92 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Software Design: Timing 
Sequence 

IR Trans 
US Trans 
IR Rcv 
US Rcv 

US Trans 
IR Rcv 
US Rcv 

US Trans 
IR Rcv 
US Rcv 

US Timer 

usSeq 
usStateSeq 

Parent 

Child 1 

Child 2 

Time 
(ms) 

0 
0 

0  5 

10

1 
0 

 

0 
1 

25 

30

1 
1 

 

0 
2 

45 

50

1 
2 

 

0 
3 

65 

70

1 
3 

 

05 December 2002 

EMFFORCE - CDR 

0 
4 

100 

93 

<OM> 
The  current  design  of  the  system  uses  a  Tattletale  8  processor  (TT8),  which  is 
capable  of  handing  ultrasonic  and  infrared  transmitters  and  receivers.  All  code  is 
written  in C, which  is easily uploaded on  the TT8 via a serial connection with a PC. 
The  following  timing  sequence was  created  to map  out  the  sequence  of  events  for 
the metrology system. 

The  first  even  begins  with  the  master  vehicle.    Each  vehicle  is  assigned  master, 
slave 1, or slave 2 prior  to  the  test.  This  label  is available  to each  vehicle and  can 
be  set  prior  to  each  test  over  the  communications  port  or  prior  to  software  load. 
The  master  vehicle  emits  an  IR  pulse.    Each  vehicle  then  receives  the  pulse 
(assumed  to  be  instantaneous  since  the  speed  of  light  is  much  greater  than  the 
speed of sound) and causes an interrupt to be triggered on the TT8. 

The  IR  triggered  interrupt begins a  timer  that  sets  the TPU pin high or  low at given 
times.  When  the  TPU  pin  is  set  high,  a  second  interrupt  is  triggered  causing  the 
TT8 to do a sequence of events based on timing and vehicle ID. 
Two  counters  are  used  to  track  the  sequence  of  events.  One  counter,  usSeq, 
oscillates between 0 and 1, switching back and forth each time the timer  interrupt  is 
triggered.  A second counter, usStateSeq,  increments by 1 each  time usSeq  resets 
to 0. 

93 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Software Design: Distance 
Determining Algorithm 
Calc distance 
Rotate, translate 
Determine 2 
nates 
Calc coordi
in sensor frame 
closes sensors 
to body frame 
and ang
le 

Start 

End 

A 

y 

d1 

B 

C 

A 

x2 

C 

d2 

x

A 

B 

C 

x 2  + y 2  = d1 
2 
( x − x 2 ) 2  + y 2  = d2 
2 

x = 

x 2 
2  − d2 
2  + d1 
2 
2 x 2 
y =  d1 
2  − x 2 

05 December 2002 

EMFFORCE - CDR 

94 

<OM> 
As a result of the transmitter and receiver code, each sensor will have a 
distance to each (3 sensors x 2 vehicles = 6 distances).  These distances 
will then help the vehicle to determine a distance and angle from center of 
the vehicle sending the signal to the center of itself.  The following algorithm 
is then used to determine the distance and angle. 

Since only two sensors are needed to determine the two unknowns 
(distance, r, and angle, θ) the two sensors that read the closest distance are 
used.  By eliminating the 3rd  sensor we are able to get an initial idea of 
where the signal came (reducing the signal origin to a certain range).  A 
temporary frame of reference is set to the two sensors, with the origin at one 
sensor and the second sensor (x2,0) away.  Since the distance is know to 
each sensor, you can determine the coordinates of the originating signal 
relative to the temporary frame.  Once that coordinate is determined, the 
frame is then rotated and translated so that the frame of reference is 
centered at the center of the vehicle.  The coordinates are then converted 
from Cartesian to polar so that an r and θ are known. 

94 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

• 

• 

• 

Testing/Verification 
Range test, required range 4 m 
With an array of 5 IR emitters, range 
– 
exceeds 4 m 
Time of flight measurement test 
–  Distance correlates linearly with time of
flight (I.e. no ring up effects) 
Timing error due to angular offset 
– 
No noticeable effect on time of flight due to 
rotation of transmitter or changing bearing 
angle over 180 deg 

05 December 2002 

EMFFORCE - CDR 

95 

Range test: using oscilloscope to read outputs of IR and US receivers, 
moved transmitter away until signal was undetectable 

Time of flight measurement test:  using oscilloscope read outputs of IR and 
US receivers and measure time difference between reception of IR and US 
compare that to the distance between receiver and transmitter.  The relation 
proved to be linear over the test range. 

Timing error due to angular offset: first rotated the transmitter to verify that 
no variation in signal reception.  Then placed the transmitter at 1 meter from 
receiver at various angles from original time of flight test.  The time of flight 
correlated exactly (within accuracy of test) to the time of flight test.  Thus 
there seems to be no effect on range determination due to angle changes.  

Upon review, tests may not have been accurate enough, further testing is 
suggested. 

95 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Mass Budget 

Item

Reflective Cone 
i
US Rece ver 
i
US Rece ver Circuitry 
Adjustment Screws 
(3/receiver) 
Transmitter with Circuit 
Structure 
Rate Gyro 
TOTAL Subsystem Mass: 

Unit Mass 
(kg) 
0.040 
0.012
0.025
0.009 

Per Vehicle 
(kg) 
0.120 
0.036 
0.075 
0.081 

0.034 
0.103
0.040 

0.034 
0.103 
0.040 
0.489 

05 December 2002 

EMFFORCE - CDR 

96 

<OM>

The overall mass of the system is less than 1/2 a kilogram.  The biggest  

contributor to this weight is the reflective cones and the main structure.  


96 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Cost Budget 

Development
Item 
Cost ($) 
60 
Material for Cones 
Material for 
20 
Support 
Wire, Nuts, bolts, 
etc 

Final Product (System)
Item 
Cost ($) 
0
Rate Gyro (donated) 
IR Emitters (up to 
75 
) 
24/vehicle
US/IR Receiver 
(
) 
donated
US/IR Receiver 
icle) 
Circuits (3/veh
US/IR Transmitter 
Circuits 
SUBTOTAL:
SUBTOTAL: 
100
TOTAL SUBSYSTEM BUDGET: 

195
685

20 

0 

90 

30

05 December 2002 

EMFFORCE - CDR 

97 

<OM> 
The financial budget is much smaller than expected.  The rate gyro was 
obtain from the Spheres Team. In addition, the Virtual Ink Corporation was 
generous enough to donate the US/IR transmitters and receivers.  What's 
left is the procurement of the circuit boards needed to the US and IR 
sensors.  We’ve include development costs to construct reflective cones 
(allows the US receivers to be omni-directional), support materials, and 
additional wire, nuts and bolts. 

Testing indicated that the IR emitters on the Mimio pen are not strong 
enough to work at the range we need.  Using other emitters (which were 
used on SPHERES) does achieve the range we need.  The new IR emitters 
will be arranged in arrays of 4-6 emitters facing in 4 directions.  This calls for 
16 to 24 emitters per vehicle.  The emitters cost approximately $1 each.  

97 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Metrology Concerns 

Concern
Timing is set in clock 
cycles but cycles do not 
correspond directly to time 
Reflective cone 
prototyping incomplete 

Rate gyros can only be 
polled at 1 Hz 

Mitigation
Allocate time for 
calibration of 
metrology code 
Mimio cones used for 
testing until prototypes 
compete 
Low angular rates 
may not require higher 
polling freq 

05 December 2002 

EMFFORCE - CDR 

98 

<AA> 
In code, timing is set in clock cycles, but the time for one clock cycle varies 
depending upon the processing requirements of the program.  Someone will 
need to load the code on a tattletale and read the output with an 
oscilloscope, and alter the code until the timing is correct  (i.e..  The master 
and slave vehicles will stay in synchronization) 

98 

Avionics Software 

Oscar Murillo 

05 December 2002 

EMFFORCE - CDR 

99 

99


EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Overview and Requirements 

• 

• 

Avionics software coordinates vehicle 
computation processes, managing CPU time 
and computer memory 
Requirements flow from control: 
1. 
Run control loop at 2-10Hz 
2. 
Build vehicle “operating system” 
Get metrology data (Primary Vehicle Array, PVA) 
• 
Pass data to/from communication software 
• 
Provide correct format for control input 
• 
(Master State Array, MSA) 
Process control output (Master Actuation Array, 
MAA) – send to power/actuators 
Monitor vehicle health/safety at 0.5-5Hz 

3. 

• 

05 December 2002 

EMFFORCE - CDR 

100 

<MAS> 

The avionics software is the brain of each EMFFORCE vehicle.  The purpose of the avionics 
software is to manage all processes that occur on an individual vehicle, and distribute 
computational resources among those processes.  

Avionics software requirements include the following considerations: 
1.	 The control loop must run at a frequency of at least 2Hz, because the rotation rate 
prescribed by the system requirements is 1 RPM (1/60 Hz).  To be accurate, the control 
law designed by the Control team needs feedback and input more frequently than one 
order of magnitude less than the rotation cycle length.  
2.	 The operating system is basically a sequence of commands that both prioritizes and 
temporally orders the central computer processes.  It is a short main program, but calls 
every other function used on board the vehicles (except the metrology code) in turn. 
3.	 The software system must keep some processing time available for acknowledging 
safety feedback, e.g. current level from the magnets or speed of the reaction wheel, to 
help the team decide if the vehicle needs to be shut down or removed from the testing 
area. 

100 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

• 

Operating System Design 
Avionics computer processes: 
5. Convert 
PVA Æ MSA 
(met) 

1. Check health 

2. Load 
metrology PVA 

3. Modify 
PVA 

6. Call control 
loop 
(wait) 

7. Call comm
. II 
(wait) 

4. Call comm. I 
(wait) 

8. Select commands, 
actuators 
signal 

05 December 2002 

EMFFORCE - CDR 

101 

<MAS> 
The operating system design plans for a single thread of computation, running all processes sequentially. 
Because the control, communication, actuation and health modules all run on the same processor, only 
one action can be processed at a time.  The “wait” noted in steps 4, 6, and 7 delineates when the 
processor runs subsystem-specific code (either control or comm.) and cannot process other information 
simultaneously. 
1. Check health. The OS must call a function (written by Avionics) to obtain these health data at the 
beginning of every cycle; the levels are feedback required by the control loop. 
2. Load metrology PVA.  The avionics computer must receive the most recent local position and angle data 
from metrology (PVA).  Intra-vehicle communication is done via a digital serial line. 
3. Modify PVA. Before the PVA can be released to the other vehicles for further calculation, it must also 
include the local angular rate.  The module to import the rate gyro reading and append it to the PVA is part 
of the avionics software; the vehicle OS must call this module in turn. 
4. Call Communication I.  After the PVA is complete, the OS calls the communication software to begin its 
cycle.  The communication system updates the foreign PVAs on each vehicle. 
5. Convert PVA to MSA.  The Master State Array (MSA) contains all the information about the entire 
system at one time; it is the set of data used by the control loop as input.  The Metrology team is actually 
responsible for writing the module to calculate the MSA from multiple vehicle PVAs. 
6. Control loop.  The control loop is the reason for the OS and is projected to be the most complicated 
calculation. The true control code will be implemented during January 2003. 
7. Call Communication II.  This comm sequence shares the MSA, which is sent to the ground station from 
all vehicles as a check against errors and discrepancy among the vehicle calculations. 
8. Command Actuators. Processes the output from the control into a signal of the type accepted by the 
actuators. 

101 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Other Avionics Processes 
Communication with Metrology 
computer to transfer data 
Command signal to actuator power 
– Actuator controller accepts pulse-
width modulated signal (PWM) 
– PWM available as embedded 
function of the Tattletale computer 
Integration of startup/shutdown 
and health maintenance code 

• 

• 

• 

05 December 2002 

EMFFORCE - CDR 

102 

<MAS> 

In addition to writing the vehicle operating system, the Avionics team is 
responsible for any software not under direct control by another subsystem.  
This includes several modules that link subsystems together, such as the 
communication process for the two Tattletale computers to talk with each 
other.  (This is not a Communications team responsibility because it is 
contained within each individual vehicle; Comm team manages RF channel 
communication.)  Other avionics modules are the control-actuation interface, 
the code that brings in the rate gyro data, and some interaction with health 
and warning signals provided by the Operations team. 

102 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Avionics SW Testing 

Test 

Objective 

1 

PWM function code 

Command actuators 

2 

Metrology interaction 

TT8-TT8 comm, gyro

3 

Empty OS  oop 
l

Find max system speed 

4 

Begin comm sequence 

Electronics integration 

Hi

gher-level tests 

System/ops integration 

• 

Tests planned for Dec 2002 - Feb 2003 

05 December 2002 

EMFFORCE - CDR 

103 

<MAS> 

There are four major SW integration tests planned by the Avionics team for 
completion in January 2003.  Each module that the avionics team writes 
must interface successfully with any related hardware (e.g. the rate gyro) as 
well as with the operating system.  The operating system itself must be 
tested for functionality and efficiency; as we will see in concerns, the 
Avionics team must be absolutely certain that each vehicle has enough 
memory to run the test sequences required! 

103 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Test 1: PWM Function 

Control 
output 

Extract 
actuation 
command 

PWM 
code 

• 

• 

Implements Tattletale library 
function with Avionics code 
Tests avionics/power/actuation 
integration 

Avionics 
hardware 

Power 
controller 

Feedback 
devices 

Actuator 
(EM, RWA) 

Actuation 
power 

05 December 2002 

EMFFORCE - CDR 

104 

<MAS> 

1. Control output.  The control module produces the Master Actuation Array (MAA), a two-
dimensional array that contains commanded voltage levels for the two electromagnets and 
reaction wheel in all vehicles.  This is stored in the avionics computer memory. 
2. Extract actuation command.  The local vehicle control-actuation software module must 
extract the commanded levels for itself from the MAA according to the vehicle ID (set at 
system startup).  It then translates the commanded level into a percentage of maximum 
voltage supply in preparation for the PWM signal.  To do this, the module incorporates 
feedback from the magnets monitoring the actual current induced by a voltage supply and 
expresses the new commanded voltage as a percent of the maximum safe voltage allowed. 
3. PWM code.  The control-actuation module uses embedded functions from the avionics 
computer to (a) set up a designated I/O pin to carry a digital signal out, and (b) produce the 
PWM signal.  The percent voltage determined in the previous step becomes the percent 
high time of the PWM signal; the period of the signal will be fixed. 
4-8. Avionics hardware, power controller, power, actuators and feedback.  The digital signal 
then goes to the MOSFET controller for the actuation power, which regulates the voltage 
supplied to each actuator.  The actuators respond to the voltage supply (albeit delayed in the 
electromagnets due to their large time constant) and the effectiveness of the batteries is 
reported back to the loop via health feedback gathered by the operating system. 

104 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Test 2: Tattletale Interaction 

• 

• 
• 

Tattletale communication over 
serial line uses packaged library 
functions – verify functionality 
Test data transmission rate 
Debug timing issues (inter-TT8) 

Serial transmit 
& receive 
) 
(Metrology

Data flow 

Serial receive 
& transmit 
) 
(Avionics

05 December 2002 

EMFFORCE - CDR 

105 

<MAS> 

The metrology access module utilizes embedded computer functions to 
designate two I/O pins on the computer as serial transmit/receive lines; the 
two computers communicate and transfer data over those lines.  

The module polling the rate gyro checks a designated pin for an incoming 
signal voltage; prior to that the gyro signal passes through an analog-to-
digital (A/D) converter, which is embedded in the computer as well. 

105 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

More Avionics Tests 

• 

• 

• 

Test 3: Run operating system (OS) with 
“dummy” scripts 
Model control, comm, metrology, actuation 
– 
interaction 
imum cycle frequency 
– 
Determine max
Test 4: Integrate OS with comm 
processes 
Higher level tests: continue replacing 
“dummy” scripts with true subsystem 
functions 

05 December 2002 

EMFFORCE - CDR 

106 

<MAS> 

Remaining subsystem tests beyond the four noted have yet to be designed 
in detail; these will be finalized after CDR. 

106 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Avionics SW Concerns 

Concern 

System timing 

Variable tracking 

Control code mapping 

Mitigation
Optimize code
Cut out extra functions 
Naming standards 
Master list
Work with Control team 
over IAP to integrate

• 

Budgets combined with Avionics hardware section 
(follows Communications) 

05 December 2002 

EMFFORCE - CDR 

107 

<MAS> 

Concern:  Timing and Maximum Update Rate

Possible mitigation: 

1. Optimizing code (for timing). 
2. Buying more RAM.  
3. Adding a Tattletale.  
4. Switching computers (to one more powerful) – not practical due to time constraints. 
5. Reducing the system rotation rate.  The characteristic of the system that dictates the 2 ­
10Hz cycle update requirement is the system speed of rotation in a representative spin-up 
maneuver.  (For more information on control and the representative system tests, see 
related EMFF progress reports by André Bosch and Leah Soffer.[i])  If the target system 
rotation rate is slowed to less than one revolution per minute, the control updates may occur 
less frequently and still effectively complete the maneuver.  However, this option is not 
appealing because slowing the system rotation rate weakens the connection between the 
representative test maneuver and the real system upon which it is based. 
Concern: Space and Memory Allocation 
Mitigation: Like reducing run time, there are multiple options for streamlining module size to 
accommodate storage in Flash memory. 
1. Optimizing code (for space). 
2. Cutting out functions. 
3. Expanding flash memory. As of 03 December 2002, this has not been researched; it is 
part of the software integration scheduled for early January 2003. 

107 

Communications 

Jennifer Underwood 

05 December 2002 

EMFFORCE - CDR 

108 

108


EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Overview 

• 

• 

RF network links vehicles 
– 3 vehicle nodes 
– 1 Ground Station node 
Each node includes 
– DR2000 communications prototyping 
board 
– Software modules included in 
Avionics processor 

05 December 2002 

EMFFORCE - CDR 

109 

<ESS> 

Essential to the successful performance of this testbed and indeed of any satellite 
cluster system is the ability to pass information between the member vehicles within 
the cluster and the controlling ground station.  A radio frequency network in the 900 
MHz band has been implemented to accomplish this function. 

The communications subsystem is comprised of the RF Monolithics DR2000 
communications system prototyping board and associated software located in the 
avionics processor. 

109 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Requirements 

• 

• 

Provide RF link between three vehicles 
and ground station 
– 
Effective range: > 8 meters 
Transmit data required by other 
subsystems 
Cycle time: < 150 ms @ 19.2 kbps 
– 
Control and Ops are end users 
• 
• 
Metrology and Avionics provide data 
Currently need 7 packets of 43 data bytes each 
• 
(350 total bytes per cycle) 
Archive data for later analysis 

• 

05 December 2002 

EMFFORCE - CDR 

110 

<ESS> 

The communications subsystem requirements flow down from the overall  

subsystem function: to pass all necessary information wirelessly among the three  

vehicles and the ground station.

The RF transmitters and receivers must have an effective range of greater than 8  

meters in order to ensure they cover the entire test area, including the operations  

laptop.

The system nodes must send and receive information determined by other  

subsystem teams to be essential to or desirable for their assigned functions.  This  

information was placed under configuration control by the Communications and  

Operations Team in November 2002 in order to solidify the requirement.  The cycle  

time for the communication system must be less than 150ms in order to ensure the  

control lag is acceptable.  The cycle time is a function of the packet length, number  

of packets, and the processing time to encode and decode the data.


110 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Requirements 
Autonomously transmit and receive 
required data 
Respond to commands from ground 
station 
Test initiation 
– 
– 
State changes 
– 
Emergency intervention 
System reliability of no fatal errors for 
95% of 7-minute tests 
Ensure vehicle interchangeability 

• 

• 

• 

• 

05 December 2002 

EMFFORCE - CDR 

111 

<ESS> 

There must be direct and automatic communications from vehicle to vehicle in order  

for the system to automatically maintain its formation.  The required update rates  

are several hertz, much faster than a human controller could monitor or direct.

However, the system is not completely autonomous on a larger scale.  The ground  

station must be able to send commands to the cluster in order to begin  

preprogrammed tests and, if necessary, shut the system down when failures occur.

It is unacceptable for the subsystem to fail with significant frequency during the  

course of normal operations.  Fatal errors include timeouts and internal processor  

errors.  The subsystem must have some degree of fault-toleration built in, so that  

one incorrect bit in a transmission does not cause the entire system to fail.  A failure  

rate of 5% for ten-minute tests will be considered acceptable.


111 

Current Design 

• 

Hardware 
– DR2000 
ÅÆ 

TT8 interface 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

05 December 2002 

EMFFORCE - CDR 

112 

<JEU> 
As the design currently stands, the only hardware design involves the interface 
between the DR2000 and the TT8 processor.  The current layout is shown in the 
picture above. To save weight, the black serial cable will likely be replaced with a 
handmade insulated wire cable that would run directly to the  communication board 
on top of the vehicle (reference structure slides). 

112 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

• 
Data 
handling 

Network 
data 
flow 

Current Design 
/ 
Sensors
Instruments 
T2  T3  
T4 
T1 

Cmds 

Avionics 
SW 
Node 2 

Comm. 
SW

RF 

Node 3 

RF 

RF Channel (Broadcast) 

Node 4 

Comm. 
SW 

Real-Time GUI 

On- Li
ing 
ne Monitor

Hard Disk 
Archive 
Off- Lne Monitor
i
ing 

Plotting and 
DH SW 

Ground 
Station 
(Node 1) 

05 December 2002 

EMFFORCE - CDR 

113 

<JEU>

Another aspect of the communication subsystem design is data handling.  Data  

handling involves how the data is passed through the system as well as any  

archiving system that may be installed at the ground station.

The diagram above illustrates the data flow through the network. Only one node  

schematic is shown since all three vehicles are designed to be interchangeable.   

Instruments and sensors send their information to the TT8 board which is  

interpreted by the avionics software.  The information is packaged in various data  

arrays which are saved as global variables to be picked up by the communication  

software.  The communications software then packages the data for transmission  

and ensures it is sent across the channel when the vehicle has the token.

On the ground station side, the communications software will be interfaced with the  

real-time operations GUI (Graphic User Interface).  Additionally, the

communications software will save all data packets sent across the broadcast  

channel to a hard disk archive, which could be accessed by an off-line mission  

monitor. With all the data stored, it is then possible to run plotting and data handling  

software to analyze the data from the various missions.


113 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Current Design 

• 

Data handling 
– 
Packet structure 

To 
1 Byte 

Length  Data
From 
Pkt # 
Cmd 
1 Byte  1 Byte  1 Byte  1 Byte 
43 Bytes 

CRC 1 
1 Byte 

CRC 2 
1 Byte 

– 

Telemetry 
• 
Data that other subsystems need to transmit 
Packets assigned Application ID #’s (APID) 
• 
– 
Vehicles (transmit 2 types) 
Ground Station (transmits 1 type
) 
– 

05 December 2002 

EMFFORCE - CDR 

114 

<JEU>

Besides network data flow, data handling also involves packet structure and  

telemetry.  Since the DR2000 has built in data framing, most of the job has already

been done.  However, the data size (currently 43 bytes) and what is sent within the  

packets are left up to the discretion of the communication subsystem team  

members.

Telemetry involves what is being sent within the packets, or the data that the other  

subsystems need to transmit.  Currently, all vehicles will transmit 2 packets when  

they have the token, while the ground station will only transmit 1. Since there are  

multiple kinds of packets (3 in total) and vehicles sending packets with information  

tailored to them (3), it was decided to use an Application ID numbering system to ID  

the packets.

Vehicle A (Node 2) has APID01 and APID02 assigned to it.

Vehicle B (Node 3) has APID03 and APID04 assigned to it.

Vehicle C (Node 4) has APID05 and APID06 assigned to it.

The ground station (Node 1) uses APID07 to send commands.

The next slide will detail what is contained within these APID’s.


114 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Current Design 

• 

Token ring 
architecture 
– 
Odd APID except 
APID07 
le 
Primary Vehic
• 
Array (PVA) + 
State Actuation 
Array (SAA) + 
Health array 
calculated by
vehicle 
Even APID 
• 
Master State 
Array (MSA) 
calculated by
vehicle 
–  APID07 
• 
Commands from 
ground station 

– 

Node  1: 
Ground 
Stat on: 
i

Node  2: 
AP ID01 
AP ID02 

Node  4: 
AP ID05 
AP ID06 

Node  3: 
AP ID03 
AP ID04 

05 December 2002 

EMFFORCE - CDR 

115 

<JEU> 
Odd APID’s contain: the Primary Vehicle Array (PVA) of the vehicle (which contains the 
position and rates of the vehicle as determined by the metrology subsystem), the State 
Actuation Array (SAA) of the vehicle  (which contains the commanded actuation – currents 
and rates – of the entire system as calculated by the vehicle), and the Health array of the 
vehicle (information that the real-time operator needs in order to monitor the health of the 
system).  These APID’s also contain the token and APID flags, as well as a timestamp for 
when the packet was made, based on the real-time clock counter (in ms) on the TT8. 
Even APID’s contain: the Master State Array (MSA) of the vehicle (which contains the 
positions, rates, and other vital state information for ALL vehicles in the array). The MSA is 
compiled from the PVA’s received over the channel plus the PVA of the vehicle 
The current token ring architectures acts as follows: 
The ground station transmits first, initializing the system.  When operations is done 
initializing the system, an APID07 packet is sent telling node 2 it has the token. Node 2 
transmits APID01 and APID02. APID02 contains the token flip telling node 3 it has the 
token. Node 3 transmits APID03 and APID04.  APID04 contains the token flip telling node 4 
it has the token.  Node 4 transmits APID05 and APID06. APID06 has the token flip telling 
Node 1 (the ground station) that is free to send out commands.  APID07 is sent out 
beginning the cycle again. 

115 

Verification 

• 

Step-by-step unidirectional testing 
successfully completed 
Transmission over DR2000’s 
– 
•  LaptopÆ
ÆWS 
Æ--Æ
DR2000
DR2000
Transmission with TT8 in the loop 
Æ ÆWS 
•  LaptopÆ
DR2000
Æ--Æ
DR2000 TT8
DR2000
• WS TT8 DR2000
Æ--Æ
ÆLaptop 
Æ Æ

– 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

05 December 2002 

EMFFORCE - CDR 

116 

<JEU> 
Step-by-step unidirectional testing occurred in two phases: Transmission over just 
the DR2000’s and transmission with the TT8 processor included in the loop. 
After many hours of debugging, transmission over just the DR2000’s was 
successfully implemented and repeated.  At this point, the team learned how to 
write code to package the information in such a way that the DR2000’s would 
recognize it and successfully transmit and receive data. 
When the TT8 was added into the loop, it was discovered that there were interface 
issues between the TT8 and the DR2000. It took many hours to find ways around 
the problem.  Once those issues were mitigated, one-way transmission was 
successful with the TT8 in the loop (receiving end as well as the transmission end).  
Now the team knew how to write code that would run on the TT8 to send and 
receive desired information. 

116 

Verification 

• 

• 

Node software testing 
– 
Tested major portions using Visual Studio 
C to ensure important functions worked 
correctly 
Step-by-step bi-directional testing 
Node 2 
ÅÆ Node 3 
– 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

05 December 2002 

EMFFORCE - CDR 

117 

<JEU>

Once the communications team knew how to send and receive information with the  

TT8 processor in the loop, it was then possible to test software for a single network  

node. The software was written and major portions of it were tested using Visual  

Studio.  Visual Studio allows one to easily see the results of functions without  

having to run the program on the TT8.  This software included the functions that  

mapped between arrays and data packets. (Tested the Encode and Decode  

functions).

Once the single network node code was working, it was time to test the token ring

architecture between two nodes.  After several hours of debugging, the software  

worked! However, there were buffer overflow issues that were apparent (will discuss  

with concerns/mitigations).

The team now knew how to implement a token ring architecture between two  

nodes… 


117 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Results 

• 

• 

Overall results 
– Found methods to achieve des
ired 
results in network communication 
– Current working implementation a 
processor hog, may not achieve 
desired bit rate 
Conclusions 
– Streamlining of system required 

05 December 2002 

EMFFORCE - CDR 

118 

<JEU>

Overall, the testing to date of the communications subsystem has resulted in

methods that achieve the desired results in network communication.  However, the  

current implementation is a processor hog; it will be necessary to find ways to  

decrease the processing time necessary to achieve the desired results.   

Now that it is known how to implement the communications subsystem, streamlining  

is required to ensure that the subsystem is able to achieve the desired bit rate.


118 

Cost Budget 

Development 
Item 
Cost ($)
DR2000 (x2) 
495 
Misc. expense 
50 

Final Product (System)
Item
Cost ($)
DR2000 (x4) 
975

SUBTOTAL: 
545 
SUBTOTAL: 
TOTAL SUBSYSTEM BUDGET: 

975
1520

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

05 December 2002 

EMFFORCE - CDR 

119 

<ESS> 

The DR2000 purchasing process is complete.  Two extra boards were 
purchased to have as spares because of the long (4-6 week) lead times 
associated with the boards.  Other RDT&E costs are accounted for under 
the operations subsystem budget. 

119 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Mass and Power Budgets 

Item 
DR2000 
Cabling 
TOTAL Subsystem Mass: 

Unit Mass
0.05
0.01

Per Vehicle
0.05
0.01
0.06 

Item 

DR2000 
TOTAL: 

Per Unit 
A
V 
3
0.05
3
.05

Vehicle
V
A
0.05
0.05

3
3

All measurements in kg, volts and amps. 

05 December 2002 

EMFFORCE - CDR 

120 

<ESS> 

DR2000 mass is negligible as a percentage of the rest of the system.  
Volume and placement are more urgent budget concerns. 

The power required by the communications boards is negligible; the board 
will run on the same 3V circuit as other avionics components. 

120 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Concerns/Mitigations 

Concern

Current problem with buffer 
overflow (missed data) in 2 
node network 

Mitigation
–Add strategic delays Æ 
transport layer mitigation 
–More nodes may 
alleviate problem 

Current code uses too much 
processing time 

Optimize and simplify code 

System may not achieve 
required data throughput 

–Find ways to increase 
the effective bit rate 
–Streamline packets 
–Minimize processing 
time 

05 December 2002 

EMFFORCE - CDR 

121 

<JEU>

The communications subsystem has three major concerns.

First: It was found when testing the 2-node network that there appears to be a  

problem with buffer overflow since data would not show up on the receiving end on  

occasion.  This is a transport layer problem, so one way to mitigate it is to add  

strategic delays in the software to give the buffers enough time to clear.   

Furthermore, adding more nodes to the system may alleviate the problem by adding  

in more delay and allowing the buffers to clear.

Second: The current code eats up too much processing time.  The obvious solution

is to optimize and simplify the code.

Third: The throughput of the system is low. There data rate isn’t sufficient currently  

to meet control requirements.  There may be ways to increase the effective bit rate.  

The subsystem team will look into this. Also, streamlining the packets will help to  

reduce the problem. Finally, once the processing time is minimized, the throughput  

should increase considerably.


121 

Avionics Hardware 

Jennifer Underwood 

05 December 2002 

EMFFORCE - CDR 

122 

122


EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Hardware Overview 

Avionics hardware entails the overall 
physical integration of the vehicles. 
Allocation of I/O channels and pins 
Design of avionics board 
Wiring of subsystems to board 
Ensuring signals are being sent 
and received as needed via testing 

• 
• 
• 
• 

05 December 2002 

EMFFORCE - CDR 

123 

<SJS> 

The Avionics team is responsible for all hardware design integration in the 
EMFFORCE project.  This includes but is not limited to the I/O channel and 
pin allocation, the design of the Avionics board, the creation of a prototype 
avionics board for use until finalized boards are procured, and all wiring and 
other hardware integration.  The bulk of this hardware integration occurs 
after each subsystem is completed. 

123 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Hardware Conceptual Design 

Comm./Ops 

PWR (D) 

V Reg. 
MOSFETs 

RWA 

EM 

V 
Reg. 

Computer 
(CPU/TPU) 

PWR 
(AA) 

timing 
. 
TT8-TT8 Comm
Metrology 
Metrology 
Sensors 
Preprocessor 

05 December 2002 

EMFFORCE - CDR 

124 

<SJS> 

The Avionics hardware design layout is as follows: 
•Central to the avionics subsystem is the computer – a Tattletale Model 8 
(TT8) with Motorola CPU and TPU. 
•The computer interfaces directly with four other pieces of hardware: 
•Voltage regulator – supplies 5V power to TT8 from AA batteries – 
Power Team 
•Metrology – supplies Primary Vehicle Array updates through signal 
channel (wire).  The metrology computer is also a TT8 computer. 
•Comm./Ops – sends/receives all data going in/out of the immediate 
vehicle system from/to TT8.  
•Utilizes a serial cable connection (RS232). 
•MOSFETs – takes the actuation signal output from TT8 to implement 
needed current (using power from D cell batteries) 

124 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

• 

• 

• 

Electronics Board Design 
4-layer board (avionics board, ground 
) 
plate, avionics power board
Avionics TT8 
Inputs: SerialA1 (code loading), TT8-TT8 
– 
Rx, A/D Rate Gyro, EM Amperage (2), 
power, SerialA2 (comm. and code loading) 
Outputs: EM (2), RW, TT8-TT8 Tx 
– 
Metrology TT8 
– 
Inputs: IR, US (3), Serial 1&2 (code 
loading), TT8-TT8 Rx, power 
Outputs: IR, US, TT8-TT8 Tx 

– 

05 December 2002 

EMFFORCE - CDR 

125 

<SJS> 

The overall electronics board design shall be a 4-layer board design.  The 
top layer will be the main avionics board, the bottom side will house the 
electronics power board, and the two shall be separated by a ground plate.  
This design conserves both mass and volume for the vehicle. 

125 

Electronics Board Design 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

05 December 2002 

EMFFORCE - CDR 

126 

<SJS> 

The following is the Avionics board design:

•The Metrology and Avionics TT8s shall be attached to the Avionics board via one 
TSW-116-07-SS connector and one TSW-120-07-SS connector per Tattletale 
computer. 
•4 RS232 jacks, (corresponding to the Serial1 and Serial2 lines for each computer) 
shall be placed on the board, in a manner such that code loading can easily occur. 
•The Digital Ground (DGND), -MCLR, and –IRQ3 lines shall have male connectors 
such that a female connector can be used to load programs (DGND must be paired 
with either –MCLR and –IRQ3 to load either FLASH or ROM) 
•. 
•The Comm. Board shall be connected to the main Avionics board via a RS232 
cable (requiring from Avionics:  Tx, Rx, and DGND). 
•3 US signals shall all be inputs to the Metrology TT8. 
•The 3 IR signals shall converge through an OR gate before metrology computer 
processing.  This single IR signal shall also be sent to the Avionics TT8 for time 
synchronization purposes. 
•The 2 Tattletales communicate via one Tx line and one Rx line. 

126 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Prototype Testing 

• 

• 

• 

• 

The board design theory shall be tested 
via prototype boards to: 
– 
Verify that board design is correct 
– 
Determine if software functions as desired 
Board design includes: 
– 
2 PR-8 boards 
– 
1 breadboard with OR gate 
Randomly generated transmission code 
shall be sent from TT8 to TT8. 
Actuation signals sent to EM/RW upon 
completion and actuation levels shall be 
measured. 

05 December 2002 

EMFFORCE - CDR 

127 

<SJS> 

The board design theory shall be verified via prototype board design. 
This prototype board shall be comprised of 2 Tattletale PR-8 boards and 
other breadboards. 

Testing shall occur as software and EM and RW are completed. 

127 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Avionics Cost Budget 

Final Product (System)
Item
Cost ($)
Avionics board 
1200
TT8 Repair/New 
400

Development 
Item 
Cost ($)
PR-8 Proto-board 
190
TT8 Repair/New 
200 
35 
Cables etc. 
SUBTOTAL: 
825 
SUBTOTAL: 
TOTAL SUBSYSTEM BUDGET: 

1200
2025

05 December 2002 

EMFFORCE - CDR 

128 

<MAS> 

The avionics item of most significant cost is the circuit board holding the two 
Tattletales and other electronics.  Other than that, the only significant 
expenditure for the Avionics team is the cost of repairing of replacing 
Tattletale computers.  EMFFORCE does not have to pay for the Tattletale 
computers new because the SPHERES project has more extra Tattletales 
than we need for testing, operation and backup. 

128 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Avionics Mass and Power 

Mass Item 

Unit Mass 
(kg) 

Qty. 

Circuit board (no TT8) 
Tattletale Model 8 
Wires, etc. 
TOTAL Subsystem Mass: 

0.05 
0.03 
N/A 

1 
2 
N/A 

Per 
Vehicle 
(kg) 
0.05
0.03
0.03
0.11 

Power Item 
Tattletale Model 8  (x 2 per vehicle) 

V-supply 
5.0 

Amps 
0.30

05 December 2002 

EMFFORCE - CDR 

129 

<MAS> 

There are two Tattletale computers per vehicle:  one for metrology and one 
for avionics/comm./control.  Both are mounted on the avionics board; 
therefore, both are part of the Avionics team mass budget.  

129 

Avionics HW Concerns 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Concern
Board design does not 
satisfy all integration needs 

Improper board layout 

Learni

ng Curve 

Board fabrication problems 

Mitigation
Prototype boards used for 
integration testing until arrival 
of avionics board 
Review OrCAD plans with 
experienced faculty prior to 
board fabrication 
Begin final wi
ring end of IAP 
(as soon as boards arrive
) 
Order boards by beginning of 
January, so that they can be 
tested and reordered in time 
for second term if necessary 

05 December 2002 

EMFFORCE - CDR 

130 

<SJS> 

The hardware concerns mainly involve the learning curve.  OrCAD layout 
has taken a great deal longer than originally anticipated, and this is due to 
the learning process involved with both the software and with circuit design.  
Therefore, the Avionics team intends to address the team’s concerns by 
designing a prototype board to ensure that the board is complete in theory, 
and will send in the boards by the end of the Fall 2002 term to be fabricated.  
This way, if there are any problems in the board design/fabrication, problems 
can be fixed by the beginning of the Spring 2003 term. 

130 

Control 

Leah Soffer 

05 December 2002 

EMFFORCE - CDR 

131 

131


EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Control Overview 

Preprogrammed 
Trajectory 

+ 
-

Controller 

Plant

Actual 
Trajectory 

Metrology 
Algorithm 

Sensors 

The purpose of the control system is to send commands 
to the actuators (electromagnets and reaction wheel) 
based on preprogrammed inputs and metrology sensor 
data. 

05 December 2002 

EMFFORCE - CDR 

132 

<LS> 


132 

Requirements 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

• 

• 

• 

• 
• 

05 December 2002 

Must exhibit control in two modes 
– 
Steady state 
– 
Spin-up/de-spin 
Robust controller 
– 
Disturbance rejection 
– 
Trajectory following 
Rotation rate in steady state of 
system to be 1 RPM 
Displacement error 15 cm 
Maximum relative angle 
error 5 degrees 
EMFFORCE - CDR 

133 

<LS> 
These requirements are derived from the requirements document.  A maneuver is 
stated in the requirements document that the vehicles must begin at rest, spin-up to 
steady state, and de-spin to rest in a total of seven minutes.  The steady state 
rotation must be 1 RPM.  These numbers were chosen to limit testing time to allow 
for limited resources such as gas supply and battery life.  The requirement of 1RPM 
may be relaxed due to a slow time constant of the magnets. 

The maximum displacement error is determined from examination of the linear 
model.  A 15 cm error in displacement creates a 10% change from the non-linear to 
linear model.  Also, this requirement is derived from the metrology sensing which is 
accurate to 1 cm.  The controller can not be more accurate than the sensors.  The 
angle error was determined in a similar fashion.  Examining the linear model 
showed that an error in 5 degrees produced a 10% change.  Also, metrology is 
accurate to 3 degrees at a 2 meter separation distance, so our control error is again 
outside of the metrology error. 

133 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

1. 

2. 

3. 

Test Cases 
One vehicle (only RW control) 
Disturbance rejection 
a. 
b. 
Trajectory following 
Two vehicles (RW and EM control) 
One vehicle fixed – disturbance rejection 
a. 
One vehicle fixed – slewing, trajectory follow
b. 
Both vehicles free – disturbance rejection 
c. 
d. 
Both vehicles free – slewing, trajectory following 
e. 
Spin-up 
Three vehicles (RW and EM control) 
Middle vehicle fixed – disturbance rejection 
a. 
b. 
Middle vehicle fixed – slewing, trajectory follow
All vehicle free – disturbance rejection 
c. 
All vehicles free – slewing, trajectory follow
d. 
e. 
Spin-up 

ing 

ing 

ing 

05 December 2002 

EMFFORCE - CDR 

134 

<LS> 
Because the final goal of spin up is quite advanced and complicated, a series of test 
cases have been developed to step slowly through the learning process from simple 
to more complicated problems.  Test case one with one vehicle has already been 
performed on a mock-up vehicle.  Test case two will be performed next term at MIT. 
These two tests are the nominal test cases.  Test case three is extra and may be 
performed on the Denver flat floor where there is room for three vehicles. 

134 

F 
EM 

2 
mh 
3 
s 

Steady State Spin Modeling 
(3 Vehicles) 
• 
Force Balance 
2 
mv
2 
Fcent 
sm 
=Ω=
= 
. 
s 
c 
c 
2 
µ
0 
avg 
avg
0 
= 
s 
)2(  s 
4 
4 
•  Perturbation Analysis 
2 
2 
c 
c 
µ 
µ
avg
avg 
0 
0 
sm 
sm && 
2 
= 
Ω−
s 
s 
)2( 
4 
4 
Yields 
h
unstable 
2 
0s 
poles at 
EMFFORCE - CDR 

3  0 
µ 
2 
π 
µµµµ 
= 
=
=
A 
B
C
avg

± 

Ω ± = 

+

+

c 
0 

= 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

05 December 2002 

135 

<BAB> 
This slide demonstrates the modeling done for the electromagnetic forces.  We 
looked at the forces in the steady state spin mode first because we noticed that the 
system is unstable.  Modeling the system confirmed our initial thoughts.  We 
decided to tackle this unstable system first. 

This slide shows the electromagnetic forces acting as the system’s centripetal force, 
accelerating the vehicles into steady state orbit.  These forces define the equation 
of motion for the system along the axis of the vehicles of the array.  Performing a 
perturbation analysis and dropping off the higher order terms, on the assumption 
that they are small, we were able to calculate the poles of the system.  As 
suspected, one of the poles lies in the right half plane indicating an unstable 
system. 

We also noticed that the poles of the system are the array rotation rate.  This 
means that the system’s time constant is the inverse of Ω or about 10 second, 
assuming the rotation rate is 1 RPM.  This becomes important when analyzing the 
time elapsed before the B field of the magnet changes with a commanded voltage 
change.  As long the latter time constant is faster than the former the system is 
controllable. 

135 

EM Control for 
Disturbance Rejection 

• 

• 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Last term EM control 
on airtrack 
Unstable setup like 
steady state spin 
Two approaches 
– 
• 
Classic Control 
Phase Lead 
– 
State Space 
LQR to minimize cost: 
– 
∞ 
[
]
∫
x
u
u
x 
R
R
dt
T 
T 
+
0 
– Rxx 
– Ruu 

weights state 
weights control 

• 

J 

= 

xx 

uu 

Stable Setup 

Unstable Setup 

05 December 2002 

EMFFORCE - CDR 

136 

<LS> 
An air track was built by two students, Richard Cross and Farmey Joseph, in the 
16.62x class last term to be used to demonstrate electromagnetic control.  There 
are two setups on the air track, a stable and unstable configuration.  In modeling the 
system, it was found that there are two poles on the imaginary axis at +/- 1.5i in the 
stable configuration where the fixed magnet is on the bottom.  The poles in the 
unstable case, where the fixed magnet is on the top of the air track, are at  +/- 1.5 
on the real axis.  Controlling the electromagnets in the unstable configuration in very 
similar to controlling our vehicles during steady state rotation.  For this reason, 
controllers were explored for this case. 

First, a phase lead controller was designed using SISOTOOL.  The results were 
successful with small steady state error and small overshoot.  However, state space 
design is more practical for the final system due to its complexity.  A state space 
model was developed and a linear quadratic regulator (LQR) was implemented 
assigning high cost to state, and more specifically the position.  This as well 
provided a successful controller as shown in the following video. 

136 

Magnet Test Video 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

05 December 2002 

EMFFORCE - CDR 

137 

<BAB> 

This video is a demonstration of the controller built by Ms. Laila Elias for the linear  

air track testbed.


137 

RW Control for 
Disturbance Rejection 

Disturbance rejection controller: 
Feedback gyro rate data to drive 
vehicle angular rotation rate to 
commanded input through LQR gains. 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

05 December 2002 

EMFFORCE - CDR 

138 

<LS> 

This term we modeled and designed controllers for test case one.  We built a model  

vehicle consisting of an gas carriage, reaction wheel, motor, CO2 supply, and rate  

gyro.  We built controllers finding optimal gains using LQR.

For the disturbance rejection controller, we weighted the angular rate greater than  

position to find the gains, and weighted the states more than the control.  The  

simplified version of the simulink model shows that an angular rate can be  

commanded and the controller drives the difference between the command and  

sensor data to zero.


138 

Reaction Wheel Video 1 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

05 December 2002 

EMFFORCE - CDR 

139 

<BAB> 

This video is a demonstration of the controller built by the Control team for test 1a.   

It shows the vehicle rejecting disturbances to keep the rotation rate at zero.


139 

Reaction Wheel Video II 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

05 December 2002 

EMFFORCE - CDR 

140 

<BAB> 

This video is a demonstration of the controller built by the Control team for test 1a.   

It shows the vehicle rejecting disturbances to keep the rotation rate constant.


140 

RW Control for Tracking 

Tracking controller: 
Problem! Need angle data for full state 
feedback! 
Attempts at using an estimator were 
i
unsuccessful, so an ntegrator was used. 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

05 December 2002 

EMFFORCE - CDR 

141 

<LS> 
To control position, we needed position information.  The sensors only provided rate 
data.  First, we tried implementing an estimator that would predict the position 
based on past data.  There were problems with the implementation and due to time, 
we moved to using an integrator.  Originally, we were cautious to use an integrator 
because integrating sensor data integrates noise, but we were able to adjust a 
constant to minimize the error that is integrated.  We again used LQR to find optimal 
gains, this time weighting position greater than rate.  This controller successfully 
commanded inputted angles. 

141 

Reaction Wheel Video III 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

05 December 2002 

EMFFORCE - CDR 

142 

<BAB> 

This video is a demonstration of the controller for test 1b.  This controller moves the  

vehicle from its initial angular position to a commanded one.


142 

Modeling for RW and EM 

•Force Balance (with coordinate system fixed on vehicle B) 
F 
F
xm && 
F
F
F
F
F
F
+
+
+
+
= 
+
+
+
BA
BA
A 
CA
CA
BA
CA
CA
BA
2/1
1/1 
1/1
2/1
2/2
1/2
2/2
1/2
•Similar for 
&& 
&& 
&& 
y
y
and
x 
,
,
,
, 
θ,
θ θ 
&& 
&& 
&& 
C 
A
C
A
B
C
•Linearize with respect to magnetic moments, separation 
distances, and rotation angles, dropping the higher order terms 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

•This process gives the A and B matrices for a state space 
x 
Ax
Bu
analysis where 
+
= 
& 
EMFFORCE - CDR 

143 

05 December 2002 

<BAB> 
To model the system we start with force balancing equations.  To accomplish this, 
the electromagnetic forces for each dipole pair must be calculated and summed.  
Using these equations of motions we can do a perturbation analysis and linearize 
with respect to the magnetic moments, the separation distances, and the rotation 
angles.  This was done using Mathematica.  Dropping the higher order terms, the A 
and B matrices can easily be found.  These equations are then used to design the 
controller using a Linear Quadratic Regulator (See XXX slide). 

143 

Control Design for Test 
Cases 2 and 3 
LQR used (2a optimal gains shown below) 
Ay &
Ax & 
Ay 
Ax 
2
0.001
-0.006 
-24
24 
2
34
0.006
0.001 
34 
Ax
0.006
0.001
0
0 

Aθ 
0
0
0.009

Aθ& 
0
-0.001
3 
3

1Aµ 
2Aµ 
RWτ 
1,

For disturbance rejection, rates are 
weighted more.  For tracking, positions are 
weighted more 
In all cases, EM is weighted more than RW 
Input trajectories for spin-up being 
calculated. 
EMFFORCE - CDR 

144 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

• 

• 

• 
• 

05 December 2002 

<LS> 
LQR produces gains for every state and actuator combination.  EM is more 
expensive control, so its weight is greater than that of RW.  For disturbance 
rejection, the gains associated with rates are greater.  For tracking the gains 
associated with position are greater.  Limits will be built into the controller so that 
commands will never be sent to the actuators which are outside of the operating 
range. 

Several approaches to spin-up are being considered.  In one, a constant input will 
be given to EM and a torque profile is generated as the input to the reaction wheel.  
In another approach, both an EM and torque profile are created to spin-up in one 
minute.  Other ideas will be explored to meet the requirements and optimize spin-
up. 

Preliminary learning about coding the controllers has been done, but the majority of 
the coding will be done over IAP. 

144 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Control Concerns 

Concern 
Near field effects of the 
magnets 
Slow time constant of the 
EM 

Designing a working 
controller for spin-up 

Learning to code on the 
TT8 

Mitigation
Use far field approximation 
and try to fix
Slow down array rotation 
rate or model inductive 
delay in controller 
Design multiple possible 
controllers using different 
spin-up approaches 
Focus on this task for IAP 

05 December 2002 

EMFFORCE - CDR 

145 

<BAB> 
Our first concern is the near field effect of the magnets.  In our models we used the far field equations 
to model the forces and torques supplied by the magnets.  The far field assumption does not exactly 
hold that the separation distances we intend to operate.  We have the equations that supply the 
forces and torques at the separation distance we intend to operate but they involve elliptical integrals. 
Have the TT8 compute these integrals repeatedly would introduce significant time lag into our 
system.  To mitigate this risk we will continue to use the far field assumption and we will later modify 
the controller once empirical data exists  until the controller is functional.  If this approach does not 
work then we will attempt to construct a “look-up” table for the elliptical integrals.  This way the TT8 
would know what to output given the inputs without having to compute the elliptical integral. 

Our second concern comes from the fact that the time constant of the electromagnet is what drives 
the array rotation rate.  This time constant is, by preliminary calculations, very slow.  To ensure that 
the system has sufficient control authority to complete its mission we might need to loosen the 
requirement of one array rotation per minute.  By loosening this requirement, the mission will be 
more easy to achieve. 

Another concern is that designing a working controller for spin-up may prove to difficult.  There is so 
much that can go wrong in spin-up, and there are so many different ways to design a controller that 
accomplishes this mission.  To mitigate this concern we intend to analyze and design controllers for 
different spin-up scenarios.  

Our last is that we have yet to learn to code on the TT8.  Software often times is the Achilles heel of 
any project and we have had to push the task of learning and experimenting with the TT8 until IAP. 
This tasks need to be accomplished by the end of IAP in order for the project schedule to be met. 

145 

Operations 

Leah Soffer 

05 December 2002 

EMFFORCE - CDR 

146 

146


Operations Overview 

• 

The “O” in CDIO 
– 
Operate the system at MIT during various 
stages of development 
Operate the completed system at the 
Denver Flat Floor Facility 
• Demonstrate  the feasibility of EMFF 
outside the development labs 
Guide development toward these ends 

– 

• 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

05 December 2002 

EMFFORCE - CDR 

147 

<ESS> 

The ultimate goal of the CDIO program is to operate the completed testbed at  

Lockheed Martin’s Flat Floor Testing Facility in Denver.  All subsystems must not  

only work as designed, but must come together into a complete operational system

that can perform useful research in a bare-lab location.

The EMFFORCE mission is to _demonstrate_ the feasibility of EMFF, and this can  

only be done through planned experimentation with coordinated data collection and  

analysis. 

Everyone must know exactly what is going on, and be able to perform the mission  

and overcome whatever setbacks may occur in real-time while EMFFORCE is

deployed to Denver.


147 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Ops Requirements 
Maintain safety 
– Personnel – no mishaps 
– Protect test facilities and equipment 
Validate mission completion 
– Demonstrate all operational 
requirements of integrated system 
– Record relevant data to validate 
functionality 
Optimize operations for efficiency 

• 

• 

• 

05 December 2002 

EMFFORCE - CDR 

148 

<ESS> 

The following priorities are set forth by Operations Team to guide all operational  

planning and implementation:

1. The well-being of our team members is vital.  We must also safeguard the testing 
facility and associated equipment against damage from system malfunction.  
Personal injury or severe infrastructure damage will negate any mission successes 
that may have been achieved. 
2. Mission completion, which includes the satisfaction of all operational 
requirements listed for the system (given in the introduction) and is evaluated under 
the framework of the Test Program Plan.  A demonstration of full system 
performance is required. 
3. Efficiently planning and conducting operations will save time and money.  We 
should do as little work and spend as little money as possible without jeopardizing 
the above priorities. 

148 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Required Capabilities 
Operations-oriented development 
User interface with physical 
system 
System interface with test 
environment 
System health monitoring 
Telemetry recording 
Real-time teamwork and 
coordination 

• 
• 

• 

• 
• 
• 

05 December 2002 

EMFFORCE - CDR 

149 

<ESS> 
In order to meet the requirements of safety, operational validation, and efficiency, the Operations 
Section must implement the following subsystems, documentation and capabilities. 
1.	 Guide the development of the EMFFORCE project while looking out for operational 
considerations.  We should not build a vehicle that is too complicated or fragile to operate in the 
field or that does not meet operational requirements. 
2.	 Develop the user interface with the physical system that will guide how it is operated.  This 
includes the hardware and software by which the user will control the system and the System 
Operator Manual, that directs the user in how to use these interfaces and troubleshoot 
components. 
3.	 Consider the system interface with the test environment that will be the means by which 
performance is demonstrated and validated.  Constraints posed by the various testing 
environments at MIT and the Lockheed Martin facility must be addressed in the Test Program 
Plan. 
4.	 The system must provide some feedback to the operator and to the decisionmaking components 
of the autonomous control system.  These are interfaces between Operations and other 
subsystems. 
In order to accomplish the validation mission, data from the sensor systems and inter internal 
processes of the computers must be transmitted and recorded for analyisis 
6.	 Finally, the class team must be sufficiently prepared with a knowledge of the system and of its 
operational characteristics to effective operate it in real-time outside the lab after system 
integration. 

5.	

149 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Current Design Deliverables 

– Ground Stat on  
i
• 
Telemetry software and data logging 
• 
Command and Control capability 
icl
– Veh e Ops  
• 
System health monitoring 
– Documentation 
System Operations Manual 
• 
Test Program Plan 
• 
Field Operations Plan 
• 

05 December 2002 

EMFFORCE - CDR 

150 

<ESS> 

From the desired capabilities of the subsystem, the following deliverables were 
extracted.  The operations subsystem is unique in that it has physical and 
procedural components external to the individual test vehicles 
The ground station is the link between users and the vehicles.  It participates in the 
RF network along with the vehicles.  It primary functions are C2 and data logging. 
Operations team will monitor the health of the vehicles through several sensors that 
are now in procurement. 
Several documents also needed to be created in order to guide operations at MIT 
and in the field.  The System Operations Manual is the user’s manual for the 
system, including all assembly instructions standard functions, and troubleshooting 
assistance. 
The Test Program Plan is the means by which tests are tracked against the 
requirement to validate all the operational requirements of the integrated system. 
The Field Operations Plan describes in detail the method for moving all necessary 
equipment and personnel to the Denver lab and back again. 

150 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

• 

Ground Station Design 
Occupies node 4 on Comm Network, transmits 
APID07 
– 
Command vehicles to begin test 
Change vehicle identities 
– 
– 
Despin or shut down system 
LabView GUI runs embedded C Code that 
decodes all RF data packets passing over the
network 
Processes these data to provide description of 
system functionality 
•  Displays NRT health data 
•  Logs all data for system performance analysis 

• 

• 

05 December 2002 

EMFFORCE - CDR 

151 

<ESS>

The Ground Station occupies node 4 on the cluster communications network  

token ring architecture.  Every comm cycle, it will have an opportunity to  

pass commands to the vehicles.  These commands are necessary to tell the  

system to start spin-up and spin-down, to change vehicle identities in

software and to command a controlled halt to a test.

The Ground Station consists of a laptop running LabView with a DR2000  

attached to its serial port.  It will receive and decode all RF traffic that  

passes over the RF network

This data is then analyzed and catalogued by the LabView program to  

provide near real-time information on the state of the system, and should  

identify many problems several seconds before they cause system failure,  

thus providing the safety monitors with an opportunity to manually arrest the  

vehicles.

Eventually the data that is saved will be needed to analyze the performance  

of the control system and validate the system as a whole.


151 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Vehicle Ops Design 

• 

• 

Monitor health variables and provide 
control feedback from actuators 
Current measurement in each coil 
– 
– 
Reaction Wheel driving current 
– 
Battery voltages in actuation and avionics 
circuits 
Operations hardware 
– 
LED bank indicates health data 
– 
Switches break actuation and avionics 
circuits 

05 December 2002 

EMFFORCE - CDR 

152 

<ESS> 

The power and actuation subsystems provide hardware monitoring through the  

avionics processor.  In the case of the actuation subsystems, the data from the  

actuators of their actual state can be compared against their commanded state to  

provide feedback for the controller.

An inductive ammeter near the coils will measure their current flow.  A sudden  

uncommanded drop in coil current would likely signal a failure of the cryogenics  

subsystem and would require immediate shutdown to protect the system.

Similarly, should the reaction wheel approach saturation speed, the operator needs  

to know in case the system needs to be shut down.   

Battery voltages for both power circuits are monitored to provide the operator  

warning of impending power failure.


When any of these items approach failure, a red LED will light on the ops board,  

prompting the controller to either despin or shut down.  Switches in the circuis of  

power and actuation may also be uses as a means to influence system state.


152 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

System Operations Manual 

• 
• 
• 
• 

• 

Assembly 
Safety 
Troubleshooting 
Subsystem operations descriptions 
with ORM summary 
System Operational States 
– Software and user actions 

05 December 2002 

EMFFORCE - CDR 

153 

<ESS> 

The Operating Manual is a reference source used by the operators in the field when  

the engineer who built the system is not available.  As such, it needs to be as nearly  

a complete description of the behavior of the system as possible in order to  

maximize the probability of a successful mission.

Standard operating procedures (SOP) are implemented to hold constant those  

variables that might cause unforeseen reactions from the system.  These  

procedures also reflect lessons learned in the development cycle for how to prevent  

problems.  Once the system has reached operational status, it is no longer  

appropriate to just guess about how to do things.

Operational Risk Management (ORM) is the practice of minimizing the likelihood  

and consequences of mishaps and accidents by understanding their causes and  

functional mechanisms.  The various subsystem teams will identify risks and work  

with the Operations Section to implement countermeasures as part of the system

SOP.

Chapters include the following:  General  

Considerations,  Assembly/Disassembly,  Batteries,  Cryogenics, Avionics, Test  

Operations and Monitoring, Troubleshooting, Components List


153 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

System Operational States 

itiali
i
zat on  
• In
– 
Turn on: Avionics, Comm, Metrology 
–  Off: Electromagnet, RW, Gas Carriage 
Run diagnostics and report status 
– 
• Dep oyment
l
 
Manually place on floor 
– 
Turn on: Gas Carriage 
– 
– 
Manually place vehicles in initial position 
Metrology assists placement 
– 
– 
Turn on: Control 

05 December 2002 

EMFFORCE - CDR 

154 

<ESS> 

Initialization powers up the electronics and checks for faults before placing the  

vehicle on the floor.


Deployment activates the Gas Carriage and guides the vehicles to their initial  

positions.  EMFFORCE personnel will be able to place the vehicles manually on the  

floor.  Metrology will take data and guide the vehicles to the commanded starting  

position by providing cues to the operators


154 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

• 

System Operational States 
Spin-up (Series IT-2E and IT-3E) 
– Run Control diagnositcs 
– Turn on: Electromagnet, RW 
– Control algorithm in Spin-up mode 
Steady State Rotation 
– Control algorithm in Steady State 
mode 
• De-sp
in 
– Control algorithm in De-spin mode 

• 

05 December 2002 

EMFFORCE - CDR 

155 

<ESS> 
Spin-up confirms that the Control system is talking to the Actuation devices, and 
then powers on the devices.  The Control system commands Actuation to steer the 
system towards the steady state goal by using the Spin-up algorithm. 

For tests other than IT-2E and IT-3E, other control modes are activated in order to 
fulfill control testing requirements.  

In Steady State, the system maintains the desired rotational velocity and monitors 
variables. 

De-spin switches the Control algorithm again to attempt to bring the vehicles to rest.  
This is the stopping state that is used while control is still possible. 

155 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

System Operational States 

• 

• 

Shut down 
– Turn off: Electromagnet, RW, Contro
l 
– Vehicles may be manually arrested 
by safety team 
Recovery 
– Manually move the devices to the 
edge of the floor 
– Turn off: Gas Carriage, Comm, 
Metrology, Avionics 

05 December 2002 

EMFFORCE - CDR 

156 

<ESS> 
Shut down turns off the magnet, reaction wheel, and Control system, leaving the 
vehicles “dead in the water.”  Hopefully the vehicles will be close to rest, having 
completed the De-spin actions.  If not, an emergency shutdown will allow operators 
to secure the vehicles manually without further damage. 

156 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Ops Cost Budget 

Final Product (System)
Item
Cost ($)
120
Ops Electronic 
Ops Laptop 
1843

Development 
Item 
Cost ($)
Liquid N2 
300 
397 
Plate Glass 
357
TT8 Repair 
100
Ops Random 
SUBTOTAL: 
1154 
SUBTOTAL: 
TOTAL SUBSYSTEM BUDGET: 

1963
3117

05 December 2002 

EMFFORCE - CDR 

157 

<ESS>

Development costs.

Operations is responsible for testing facility support and resource  

procurement activities during development.

Liquid N2 is an expendable resource that must be purchased.  Plate glass  

provides a flat and smooth surface for testing of gas-carriage-supported

vehicles.  As Tattletales break during routine development, they can be  

cheaply repaired by the manufacturer.   


System Costs.

Operations requires a small number of electronic components for the user

interface on the vehicles.  Most of the operations system cost come from the  

laptop used for the ground station.  However, this laptop is being utilized  

during development by several teams and the amount of money allocated to  

this category is misleading; the Laptop is a valuable development resource  

not accounted for in any development budget.


157 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Ops Mass and Power Budget 

Item 
Ops Board 
TOTAL Subsystem Mass: 

Unit Mass (kg)
0.05

Per Vehicle (kg)
0.05
0.05

Item 

Ops Board 
TOTAL: 

* All measurements in kg. 

Per Unit 
A
V 
3
0.01
3
.01

Vehicle
V
A
0.01
0.01

3
3

05 December 2002 

EMFFORCE - CDR 

158 

<ESS> 

Operations requires very little mass and power resources.  The Ops board 
contains switches, some solid state electronics to perform comparisons, and 
LED’s to display error indicators. 

158 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Concerns/Mitigations 

Concern
Inadequate testing of spin-
up algorithm before Denver 
tests 

Loss of control failure may 
occur during tests 

Superconductor or reaction 
wheel may become 
unusable during tests 
leading to safety issue 

Mitigation
research Lobby 7 as 
possible test site for IT ­
2E 
Plan for non-catastropic 
control failure 
Detect instabilities early 
through health 
monitoring 
Practice arresting 
vehi
cles after planned 
actuation system 
shutdown 

05 December 2002 

EMFFORCE - CDR 

159 

<ESS> 

The control program for the spin-up state needed for Integrated Test 2E cannot be tested 
on the tabletop facilities available at MIT.  Due to the likelihood that this will not function 
properly the first time it is attempted, we want to find some other way to test it at MIT.  The 
floor of Lobby 7 is locally smooth enough to float a vehicle, but further research is needed 
to determine if the gaps between marble tiles, slope deviations of the floor, or cryogenic 
safety considerations might prohibit testing there. 

Since the control system is experimental for any given series of tests, it is likely that the 
system will exit the region of control stability and become uncontrollable.  This will lead to 
the vehicles either coming together or floating off in a random direction.  This failure mode 
will be addressed by manually stopping the vehicles after departure from stability and by 
trying to provide warning of impending departure from system health monitoring 

Similarly, a temperature increase or other disturbance may cause a failure of the actuation 
system.  Safety requires that the actuation system be shut down once the vehicles become 
uncontrollable.  The safety personnel tasked to arrest the free moving vehicles need to 
practice this in a planned test so they can do it when the loss of control happens 
unexpectedly. 

159 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Concerns/Mitigations 

Concern

Denver Test Site may not be 
available or cost effective 

Mitigation
Evaluate alternative sites 
at Lobby 7, Lockheed 
Palo Alto, NASA MSFC 
and NASA JSC 

Ferromagnetic material in 
Flat Floor prohibi
ts testing 

Test in Lobby 7 or 
alternative site

Field Operations planning 
errors 

Ensure materiel 
accountability 
Comprehensive plan for 
actions on site 

05 December 2002 

EMFFORCE - CDR 

160 

<ESS> 

If for some reason the trip to Denver does not happen, another site will have to be 
found for Integrated Test 2E and all of Test Phase 3. 

The floor in any of the flat floor facilities has yet to be evaluated for magnetic 
properties.  If this is an issue, we will have to move testing to an alternative site. 

Errors and oversights in the Field Operations Plan can make any field test trip 
worthless.  This concern will be addressed by providing a comprehensive field 
operations plan, carefully reviewed to ensure all necessary spare parts, test 
equipment, and maintenance equipment is included. 

160 

Systems 

Will Fournier 

05 December 2002 

EMFFORCE - CDR 

161 

161


EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

System Budget: Mass 

Subsystem 
Electromagnet 
RWA 
Power 
Structure 
Metrology 
Comm. 
Avionics 
Operations 
TOTAL: 

Mass per vehicle (kg) 
8.70
1.51
3.54
4.52
0.45
0.05
0.11
0.05
18.93

05 December 2002 

EMFFORCE - CDR 

162 

<MAS> 

•Control subsystem is not represented on this slide because Control team 
has mass budget of zero (no physical subsystem) 
•Because the slide addresses vehicle mass only, additional Operations 
budget is not included (e.g. laptop computer) 

•System is approaching the budgeted limit due to changes in subsystem 
reports as follows: 
-EM: + 2.1 kg (increase in coil size) 
-Str: + 1.0 kg (new items: base plate, hardware) 
-Pwr: - 0.9 kg (reduced need for D cell batteries) 
-Met: + 0.25 kg (included frame, reflective cones) 
-C-O: - 0.1 kg (originally overestimated board mass) 
-Avi: -0.08 kg (also originally overestimated board mass) 
-Total, this increases our mass by approximately 2.8 kg from 
where it was (just above 16 kg).  

162 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

System Budget: Power 

Powered Subsystem 

EM 
 (2 coils)  (D cells) 
RW 
) 
(D cells

Metrology 
    (AA cells) 
        (AA cells
Comm. 
) 
) 
Avionics
   (AA cells
Operations 
  (AA cells) 
Electronics TOTAL: 

Volts per 
vehicle 

Amps per 
vehicle 
200.00
10.20

1.36
0.05
0.15
0.01
1.57

0.00
3.01

5.00
3.00
5.00
3.00
N/A

05 December 2002 

EMFFORCE - CDR 

163 

<MAS>


163 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

System Budget: Code 

RAM (Data) 
Variable Pkg. 
PVA (x3 vehicles) 
MSA 
MAA 
Comm. transfer 
Control work 
Other processes 
TOTAL: 
Available: 

Flash (program) 
Module
LOC
OS
1000
Control 
2000
Met access 
1000
Comm.
2000
Ops/startup
1000
Tests
1000
TOTAL:
8000
Available: 
64000 

Size (kB)
4
8
4
8
4
4
32
256 kB

Size
0.5 kbits
0.5 kbits
0.5 kbits
5.0 kbits 
5.0 kbits 
20.0  kB
20+ kB
256  kB 

05 December 2002 

EMFFORCE - CDR 

164 

<MAS>


164 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

System Budget: Cost 
Remaining ($) 
Subsystem 
Spent ($)
Allocated ($)
16,610 
8,450 
25,060 
EM 
0 
1,020 
1,020 
RWA 
2,130 
2,500 
370
Power 
2,080 
Structure 
600 
1,450 
Metro
10
460
logy 
450 
1,470 
1,520 
Comm 
50 
2,030 
370
Avionics 
1,660 
2,270 
5,690 
3,420 
Operations 
14,560 
40,360 
TOTAL: 
25,770 

• 
• 

EMFFORCE budget cap:  $50,000 
$45,000 
With margin at CDR:  

05 December 2002 

EMFFORCE - CDR 

165 

<MAS>


165 

System Budget: Cost 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

05 December 2002 

EMFFORCE - CDR 

166 

<MAS>


166 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Field Test Travel Budget 

Personnel
Item 
Cost ($)
Travel (12) 
4500 
Lodging (12) 
1200 
Food (12) 
480 

Materiel
Item
Cost ($)
2000
FedEx 
500
Packaging 
300
Van (Cargo) 
Van (12 Pax) 
500
Spare Parts 
300
SUBTOTAL: 
3600
SUBTOTAL: 
6180 
TOTAL COST PER TRIP (3 nights): 
9780

05 December 2002 

EMFFORCE - CDR 

167 

<ESS> 

This is an estimate of the cost of a trip from Boston to Denver for 4 days and 3 
nights, including two days of testing at the Lockheed Facility. 
Travel and Lodging plans for 12 personnel (8 students and 4 faculty) at the 
prevailing available rate on Expedia.com.  The food budget is a subsidy of $10 per 
day for each team member. 
Most of the system will be shipped via commercial freight carrier rather than carried 
by the EMFFORCE team on the commercial airline.  The $2000 estimate is based 
on the cost of shipping the SPHERES system to the NASA microgravity facility in 
Texas.  The materiel will also have to be packaged securely to protect fragile 
systems from damage en route. 
Once in Denver, two vans will be needed to transport personnel and materiel to and 
from the test site.  A small amount is also allocated for spare parts purchase on 
site; this should also cover the necessary liquid nitrogen expenses. 
The total cost of a trip to Denver with half the project personnel and the entire 
system is thus $10000.  A significant portion of this might be saved by either 
reducing personnel in attendance or using the MIT travel office to buy cheaper 
tickets.  Currently two field test missions are in the high level schedule.  The utility 
of the trips must be weighed against their high cost before the final decision to go 
can be made. 

167 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

System-Wide Concerns 
Concern
Mitigation
Inefficient 
•Systems plans and allocates 
allocation of labor 
schedule by the hour 
resources 
•Restructure teams next semester 
•Systems members have no other 
program responsibilities 
•Student work during IAP 
•Optimize labor allocation 
•Descope tests to only two vehicles 

Schedule Overrun 

05 December 2002 

EMFFORCE - CDR 

168 

<WDF>

There are several concerns of the current system’s team which if left unchecked may cause  

the failure of the project. The greatest concern is that student resources are being poorly 

allocated and thus some students are being overworked far beyond a level that is  

acceptable in this academic setting. Because next spring students are only allocated 6 hours

per work for this class the problem is likely to become exacerbated. This problem can be  

alleviated with greater authority and flexibility given to the system’s team. The root cause of  

the current problem is the limitation of students to a particular sub-system. However, not all 

sub-systems require an equivalent amount of resources. Detailed planning of individuals and 

the task they need to accomplish set from the top instead of schedules created from below

can help alleviate this problem. In order for this reallocation to be done effectively those

responsible for setting the system resources should not be responsible for other elements of 

the program. 

The second critical concern for the project is that the current schedule design leaves little

margin for schedule delays. Because the end date of the project is fixed by the graduation of

the work force it is not possible to create more margin in the tasks that must be  

accomplished. The best solution to this problem is the same as the solution to the previous  

concern. Better allocation of program resources from a dedicated management authority can 

help to bring the system back ahead of schedule and reestablish margin in the schedule. If 

the system falls further behind schedule the program will be forced to evaluate the necessity  

of two system tests on the flat floor facilities in Denver. It may be possible to conduct more  

extensive testing at MIT that can be arranged within a more flexible scheduling environment. 


168 

System-Wide Concerns 
Concern
Mitigation
Control – Code mapping 
Dedicate heavy resources 
during IAP 
•Optimize Code 
•Slow down control update 
rate and system spin rate 
•Student Hours during IAP 
•Hire out machining 

Coil Containment 
Manufacture 

Software timing 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

05 December 2002 

EMFFORCE - CDR 

169 

<WDF> 
There are also several program elements that may cause unaffordable delays in the project 
schedule. Most of these delays revolve around software concerns. First, there is no student 
experience on the project with writing control algorithms in C. Therefore, mapping the control laws 
from D-Space to C code capable of running on the vehicles’ processors maybe difficult. Our hope 
for managing this problem is to provide the control team with extra people to help alleviate the 
coding burden and have this work performed during IAP (when time is more abundant). 

Avionics and Communications are finding their codes are running to slowly. This will in effect delay 
the update rate for the control inputs. The groups are hoping to optimize their codes in order to 
speed them up. However, it remains unclear at the moment if it will be possible to function at a 
rate that is acceptable to the control group. All teams need to examine more closely the 
requirements of the system in order to clarify the full extent of the problem. If necessary the 
vehicles can be spun at a slower rate and this would alleviate some of the burden. This however, 
does place and added burden on the vehicles consumables (gas supply, and batteries). This issue 
will be examined in greater detail. 

The final component that has the potential to cause serious delays in the schedule is the 
manufacture of the coil containment system. Current estimates note that approximately 80 hours 
of machine time is needed to manufacture the containers for three vehicles without spares. It will 
be very difficult to complete all of this manufacturing using the currently available student 
resources during the semester. Depending on student availability, we hope to have the 
containment all manufactured during the Independent Activities Period in January either with 
students of the class or undergraduate research assistants. 

169 

Integration 

• 

Three Components 
– 
Electronics 
Actuation 
– 
– 
Vehicle Assembly 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

05 December 2002 

EMFFORCE - CDR 

170 

<WDF> 
The culmination of this semester’s work occurs with the final integration of 
the various sub-systems into one complete vehicle. There are three major 
elements to the integration process. Integration will occur in a incremental 
process with two parrallel branches. The electronics sub-systems, which 
include Avionics, Metrology, Communications, and Power, will perform their 
own integration bridging the interfaces in both software and hardware. The 
first stage of the software integration has already begun and full electronics 
integration will be completed by Friday Jan. 17, 2003 during Independent 
Activities Period (IAP). The second branch includes all of the actuation sub­
systems; Reaction Wheel Assembly, Electromagnets, Power, and Structure. 
The integration with Power and the Reaction wheel is already complete and 
the integration with the electromagnet will be completed by the end of the 
semester. The integration of the actuation system with the vehicle structure 
will occur during the first weeks of IAP. When both the electronics and 
actuation systems are complete they will integrate together to complete the 
final vehicle assembly. Finally, the class will test the completed vehicle and 
verify that it performs as required. Any necessary modifications will be noted 
and incorporated into the manufacture of the next vehicle to start at the 
beginning of the spring semester. 

170 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

Test Program 

• 

• 

• 

Will validate the integrated system 
against operational requirements 
Scheduled Tests 
MIT Tests through Integrated Test 2E 
– 
– 
Denver Tests 3A-3E schedule TBD 
Testing operations support 
– 
Procured plate glass for Integrated Tests 
1A through 2D. 
Researching utility of MIT lobby 7 as 
alternative test site for Integrated Test-2E 

– 

05 December 2002 

EMFFORCE - CDR 

171 

<ESS> 

The test program must be completely specified well before deployment to ensure  

that it will accomplish the mission objectives, which are laid out in the requirements  

document.

We are going to Denver because the flat floor facility there is the only one in the  

country that will let us adequately evaluate the complete system w.r.t. its operational  

requirements.

The IT-3X will be the first time the full system has been evaluated, and will be the  

first true check on all the models simultaneously.  While most concepts should have  

been demonstrated in lab, the combination of all systems brings new complexities  

to the planning process.

Similarly, IT-3X will be the first time the planning and craftsmanship of the fill system  

have been evaluated, and the results, if positive, will be a good indicator that EMFF

is indeed feasibl 


171 

Schedule Spring 2003 

EMFFORCE 
Introduction 
Subsystems 
EM 
RWA 
Power 
Structure 
Metrology 
Avionics SW 
Comms 
Avionics HW 
Control 
Operations 
Systems 

05 December 2002 

EMFFORCE - CDR 

172 

<WDF> 
With the start of the spring semester in February 2003, the class will need to 
shift focus. The current sub-system teams will no longer be relevant, as all 
sub-system design and manufacture should be completed. The Control team 
will continue to work parallel to this schedule, working to develop accurate 
control algorithms and coding them into the vehicle processors. The rest of 
the class will focus on vehicle assembly and testing. Each student is limited 
to six working hours per week for this project, therefore the necessary work 
must be divided up evenly among the available resources. This will require a 
detailed testing and operations plan that will be created during IAP. The 
important no slip milestones are the Acceptance Review on March 20, 2003 
and the field tests in Denver Colorado Scheduled for the weeks of March 31 
–April 4 2003, and April 13-20 2003. 

The field tests will demonstrate the feasibility of electromagnetic control for 
formation flying satellites. With the completion of the proof of concept for 
electromagnetic control the system can then be evolved to work in a 3-D 
plane, and finally upgraded to an actual satellite formation of vehicles. We 
are confident that the hard work and determination of the class will allow us 
to accomplish our mission. 

172 

Questions? 

05 December 2002 

EMFFORCE - CDR 

173 

173


BACKUP SLIDES 

05 December 2002 

EMFFORCE - CDR 

174 

174


Structures Backups 

05 December 2002 

EMFFORCE - CDR 

175 

175


EMFFORCE 

Backup Design 

05 December 2002 

EMFFORCE - CDR 

176 

<GG>


176 

EMFFORCE 

• 

• 

Liquid Nitrogen Gas Supply 
Motivation: Determine if usage of LN
2  as 
Gas supply is feasible 
Proof of concept, 17 September 2002: 
Uninsulated tank filled with LN
– 
2 
– 
At “steady state,” boil off sufficient to float 
a 4.5 kg carriage on glass for 18 minutes 
Results sufficient for design development 
– 
Heating element for increased boil off 
• LN gas supply design deemed infeasible 
2 under schedule and manpower
constraints 

• 

05 December 2002 

EMFFORCE - CDR 

177 

<ALS> 

When the cryogenic system was introduced to the project, it was proposed that the 
gas from the LN2 boil off be used as the gas supply to power the pucks.  A proof of 
concept test was designed and conducted to determine whether or not it was 
feasible. 

To conduct the test, an uninsulated tank of the same size as the CO2 tanks was 
cooled to “steady state” and then filled with LN2.  This tank was then capped and 
hooked up to an gas carriage.  The pressure indicator used was later found to be 
broken, so there is no pressure data from the test.  However, the gas produced was 
sufficient to float approximately 4.5 kg across three pucks on glass for 18 minutes. 
The favorable results of this test induced the structures team to pursue the design 
of an gas supply system using the nitrogen gas.  Included in such a design was the 
idea that a heating element could be used to increase the boil off rate, and 
therefore, the pressure, should the insulated steady-state boil off not be sufficient 
for the desired mass or test time. 

After some design iterations and consultation with the electromagnet team, this 
design was deemed infeasible for the project due to schedule and manpower 
constraints. 

177 

Metrology Backups 

05 December 2002 

EMFFORCE - CDR 

178 

178


Metrology Software Design: 
Timing Algorithm 

2 

EMFFORCE 

Start 

IR Rcv 

Setup US Timer 
5 ms 
usSeq = 0 
usStateSeq = 0 

usSeq 
= 1 

Yes 

1 

No 

0 

0 

Yes 
usStateSeq > 3 

usStateSeq = 
le ID
vehic

No 

Setup 
US Rcv 

≠ 0
usStateSeq

Yes

Read 
US Rcv 

No 

Yes 

Setup 
US Xmt 

No 

usStateSeq 
= 0 

usSeq = 0 

eID = 0 
Vehicl

Yes 

IR Xmt 

No 

2 

Setup 
mer 
US Ti
15 ms 

usSeq = 1 

05 December 2002 

EMFFORCE - CDR 

179 

<OM> 
As mentioned, the IR signal triggers an interrupt.  The interrupt begins the 
timer,usTimer, which periodically triggers another interrupt.  The following 
sequence is followed each time the timer triggers the usTimerRcv interrupt. 

The code does one of two things based off usSeq counter.  When usSeq = 0 
the system prepares to transmit or receive (depending on vehicle ID and 
location in timing sequence).  It next reads in the time the US receiver read a 
signal from the previous US transmission.  Last it resets the timer to trigger 
the next timed interrupt.  These events occur each time except the last state 
(usStateSeq = 4).  In this case, both counters are reset to zero and if the 
vehicle is the master vehicle, an IR pulse is sent out. 

179 

Metrology Software Design: 
Timing Algorithm(cont) 

EMFFORCE 

1 

usStateSeq = 
vehic
le ID

Yes 

US Xmt 

usStateSeq 
<  3 

Yes

Setup 
mer 
US Ti
5 ms 

No 

No 

Dist Calc 
Construct PVA 

Send 
Data 

Setup 
IRRcv 

Setup 
mer 
US Ti
30 ms 

usSeq = 0 

05 December 2002 

EMFFORCE - CDR 

2 

180 

<OM> 
When usSeq = 1 the vehicle transmits a US signal if the vehicle ID matches 
the usStateSeq timer.  It then resets the US timer to trigger the next 
interrupt.  If all three vehicles have transmitted (corresponding to usStateSeq 
> 3), the program begins the distance calculation to provide the information 
needed to construct the PVA.  If the avionics TT8 is ready to receive the 
PVA, the data is transmitted over a serial line.  Next, the program resets the 
IR interrupt and allows the IR receiver to trigger that interrupt.  Lastly, the US 
Timer is again reset to trigger the last timer interrupt of the sequence. 

180 

Communications Backups 

05 December 2002 

EMFFORCE - CDR 

181 

181


EMFFORCE 

• 

Comm: What’s next 
Future design implementation 
– 
Data Handling 
Archive system on ground station 
• 
• 
Integrate with Ops 
Software 
Optimization 
• 
• 
Test full interchangeability 
– Network  
• 
3- and 4-node network 

– 

05 December 2002 

EMFFORCE - CDR 

182 

<JEU>

Communications has the following tasks remaining:

Data Handling: The archiving system needs to be developed and tested on the  

ground station.  Once that is done, it needs to be integrated with the operations GUI  

and tested. Finally, it everything will be tested as a whole to ensure the entire  

subsystem works as designed and meets all the requirements.

Software: The ground station software needs to be written.  ALL code needs to be  

optimized to minimize processor time and hard drive space. Finally, the software  

needs to be tested for interchangeability.

Network: The 3- and 4- node network structures still need to be tested.  The 3-node  

network is expected to be tested and debugged before the end of the term.  The 4­
node network can’t be tested until the ground station software is written and  

debugged.


182 



EMFFORCE 

• 

• 

– 

Comm Tests 
Test motivations 
– 
Need to phase in knowledge of communication and 
network implementation 
Hardware/software interface between DR2000 and 
TT8 demanded it 
Test sequence 
– 
Test software to transmit and receive data 
• 
Step-by-step unidirectional testing 
Test software functions written for a single network 
node 
Test software to transmit and receive data both 
ways 
• 
Step-by-step b -direct ona testing 
l 
i
i
Test network implementation 
• 
Step-by-step addition of network nodes 

– 

– 

– 

05 December 2002 

EMFFORCE - CDR 

183 

<JEU>

The communications subsystem has implemented many tests.  Most of the tests  

have been done to aid in learning how the hardware works and how the hardware 

and software can be interfaced. In this sense, testing must occur to phase in

knowledge of the communication and network implementation.  Furthermore, early  

issues with the interface between the DR2000 and the TT8 demanded that careful  

testing occur.

To implement testing phase in, the following sequence was devised:

Write and test software to transmit and receive data 
Write and test software functions for a single network node 
Write and test software to transmit and receive data both ways (need 
two nodes to accomplish this) 
Test network implementation by carefully adding network nodes 

183 

EMFFORCE 

Comm Schedule 

•Schedule for completion of the communications 
subsystem. 
•Software completion currently the greatest risk. 

05 December 2002 

EMFFORCE - CDR 

184 

<JEU> 
The communications subsystem team has laid out a scheduling plan to catch up on some of the software 
development that needs to occur.  The remaining DR2000 development kits are currently in SPHERES hands.  
The company assumed that these DR2000s were to be built according to the SPHERES specifications.  
However, those specifications do not meet EMFFORCE needs. Thus, the SPHERES team is being very 
generous in making the necessary adjustments before handing them over.  The communications team expects 
the last few DR2000 boards to arrive before the end of the semester. 
The communications team hopes to finish testing the 3-node network by the beginning of 
December.  However, recent complications will most likely push this schedule back another week or two to 
coincide with the testing of the 4-node network.  Either way, the team plans to have a working 4-node system by 
the end of the semester. 
Software optimization will be an ongoing project, most likely lasting until the beginning of 
spring semester.  Some optimization work has been accomplished, but the results of the changes will not be 
known until the end of the semester at the earliest. 
In order to facilitate full testing of a two vehicle system, specific software will be written to 
enable the necessary 3-node network prior to the start of said test. 
The Operations lead, Erik Stockham, will be developing the GUI interface and archiving 
software over IAP in time for full system testing in February.  Likewise, Erik will complete the necessary 
operations electronics board (Vehicle health LED’s) by the end of this week.  Erik will also be completing the 
Test Plan and Operations Manual before the end of the semester and the beginning of second term 
respectively.  The Field Operations Plan will be developed after the Test Plan and the Operations Manual are 
complete. 

Avionics and communications software integration has been ongoing.  Full integration will not 
be complete until more of the individual subsystem software has been developed and tested. 
Since the communications hardware is more or less complete, hardware integration should 
occur as soon as the other participating subsystems are ready. 

184 

EMFFORCE 

• 

• 

• 

Comm Software 
Functions map between arrays (12 bit data) 
and packets (need bytes) 
Modularity 
Software functions apply for any vehicle 
– 
Will enable full interchangeability of vehicles 
– 
• 
Each vehicle defaults to a node 
• 
Command packet can assign any node to any vehicle 
Token ring implementation 
“I have token” 
Token = 1 
– 
Æ 
– 
Token = 0 
“I’m passing token” 
Æ 
i
– 
Combined w th APID of packet tells vehicle when it 
should send or listen 

05 December 2002 

EMFFORCE - CDR 

185 

<JEU> 

The communications software does several things.

First, it contains functions that are capable of “mapping” between the data arrays that

avionics is storing to global variables (PVA, MSA, SAA) which are 16 bit element arrays 

containing 12 bit data, and the data bytes the communications board transmits, which must

all be 8 bits.

Second, the software functions will be written such that the software for all the vehicles are

virtually identical.  Thus, software functions will be as general as possible.  Keeping the  

functions general will help to enable the full interchangeability of the vehicles.  The software 

will be written such that each vehicle defaults as a certain node.  The initialization 

commands can then assign any node to any vehicle, effectively swapping nodes. This can 

be done by writing sections of the software within loops that will only be tripped by a certain 

flag.

Third, the software enables the token ring implementation.  The token switch (1 for “I have 

token” and 0 for “I am passing token”) combined with the APID of an incoming packet 

should be able to tell the vehicle that it has the token. When a vehicle does not have the

token, it listens and stores the incoming packets to a buffer. When it has the token, the 

vehicle decodes the stored packets, saves as data arrays and passes the processor to

avionics which does its thing. Once avionics is done, the communications code encodes its 

packets and transmits them.


185 

EMFFORCE 

• 

Comm History 
Hardware 
i
– Metr cs  
• 
EM rejection (frequency) 
Bandwidth/data rate 
• 
Size, weight, power, range 
• 
• 
Ease of interface 
• Cost  
Trades 
LAN vs. RF 
• 
• 
AC5124C-10 vs RFM DR3000-1 
Selection 
RF: DR3000-1 
• 
Later changed to DR2000 
• 
– 
Built in data framing and error correction 

– 

– 

05 December 2002 

EMFFORCE - CDR 

186 

<JEU> 
During the preliminary design phase, the communications team considered 8 metrics to 
down-select to an appropriate communications board. They were: EM rejection, 
bandwidth/data rate, size, weight, ease of interface, cost, power consumption, and range. 
After researching the various high-level options (LAN and RF), it was determined that LAN 
was less favorable for our system than RF (reference PDR). 
The next step was to choose an RF board. The two boards that were originally considered 
were the AC5124C-10 and the RFM DR3000-1. The AC5124C-10 meets all requirements 
and even comes with a development kit.  However, it’s on the expensive side and the 
company resides in Europe, which may add to shipment time.  The power consumption is 
quite a bit more than that of the DR 3000-1 (which also meets all requirements and comes 
with a development kit).  Finally, the DR3000-1 is familiar to many of the staff as it was 
used in SPHERES.  One possible downside to the DR3000-1 is that some EMFFORCE 
operations may occur outside of its operating range (but this is unlikely). The brief trades 
analysis used above determined that the better option was the DR3000-1. 
Near the beginning of Fall semester 2002, a better option was found: the RFM DR2000. 
The DR2000 has built in data framing and error correction and still meets EM rejection, 
interface, range, bandwidth/data rate, size, weight, and power consumption requirements. 
It also comes with it’s own development kit.  Built-in error correction has significantly 
decreased the amount of development and test time of the communications system. One 
downside is that it costs more per board than the DR3000-1. 

186 

EMFFORCE 

• 

Comm History 
Architecture (assumed 2 RF channels) 
– 
Trades 
• 
Sequential 
– 
Pass token to determine who talks and to whom 
– 
Hub makes calculation 
l
Simu taneous 
Pass token to determine who talks to everyone 
– 
l
– 
All vehic es make calculations 
Hybrid 
– 
Combination of Sequential and Simultaneous 
Selection 
• 
Hybrid w th 2 RF channels 
i
Later changed to simultaneous w th 1 RF channel 
• 
i
Control decision 
– 
– 
l
Need on y 1 channel 

– 

• 

• 

05 December 2002 

EMFFORCE - CDR 

187 

<JEU> 
There were originally two communication lines since it was thought that in order to maintain 
autonomous formation the hub and the ground station had to communicate independently. 
Sequential: The vehicle that has the token communicates to the hub vehicle on the second 
communication line while the remaining vehicle is silent and awaits its turn. Once the vehicle with the 
token completes its communication, the hub takes the token and passes is to the other vehicle. Once 
the states have been collected, the hub makes control calculations and broadcasts the state 
updates. 
Simultaneous: The vehicle with the token communicates to the hub  and the third vehicle 
simultaneously (broadcast) on the second channel while they remain silent (channels are half 
duplex). The token is then passed to third vehicle, which broadcasts its information over the second 
channel.  Then the token is passed to the hub which communicates its information to the other 
vehicles.  Finally, all vehicles make control calculations independently and move accordingly. 
Hybrid: The token is passed exactly as described for the simultaneous architecture.  All vehicles 
make independent control calculations. The hub is the only vehicle to transmit the new state vector. 
If there is a disagreement between any vehicles on the new state, steps can be taken to determine 
the correct new state. 
Originally, the decision was to use the hybrid architecture with 2 RF channels because it met the 
control subsystems requirements as they were known at that point. It was later determined that only 
1 RF channel was necessary. The control subsystem team then decided that the vehicles would be 
fine operating independently.  At that point, the architecture moved more toward a simultaneous 
network design with 1 RF channel, with the ground station as a member of the token ring 

187 

Control Backups 

05 December 2002 

EMFFORCE - CDR 

188 

188


Separation Error Requirement 

EMFFORCE 

• 

Create a performance measure 
α 
where: 
4 
r 
δ 
⎞
⎛ + 
11 
⎟
⎜
r 
⎠
⎝
= 
r 
δ
41 
− 
r 

non 
linear
− 
linearized 

= 
α 

05 December 2002 

EMFFORCE - CDR 

189 

<BAB> 
This slide shows our mathematical derivation of the maximum separation distance 
at which our modeling assumptions, mainly that the higher order terms are small, 
still hold.  To accomplish this we create a performance measure, α, such that it 
calculates the ratio of the non-linear force to our linearized model.  When this ratio 
is 1.1 the non-linear force is 10% greater than the modeled force.  It is at this point 
where we say that the assumption does not hold and draw the requirement.  We 
chose 15 cm, a separation error smaller than the graph indicates, as the 
requirement.  The Control team feels while the requirement is generous yet valid 
since it indicates less than 10% error in our model. 

189 

Lessons Learned from Modeling 

EMFFORCE 

•For all test cases, except for spin-up, one veh
had to have a constant field on both magnets 

icle 

•The number of state variables and control variables 
increases when a vehicle is added or when a fixed 
vehicl
e is freed 

05 December 2002 

EMFFORCE - CDR 

190 

<BAB> 
The first lesson we quickly learned is that without holding a constant field on one of 
the magnets the system is not controllable.  In this case the vehicles would be 
placed on the testbed without any initial field in the magnets.  As the system is 
disturbed, the magnets have no field on which to push or pull and thus have no 
means by which to hold their position.  Both dipoles must be energized because one 
cannot achieve motion in two dimensions with only one dipole energized.  For the 
purposes of modeling, we made the made the horizontal magnet’s magnitude ten 
times that of the vertical magnet.  

The next lessons we learned is that the further we got into modeling the test cases 
the larger the state and control vectors got.  This growth was caused by either of 
two reasons:  increasing the number of vehicles on the testbed or freeing up a 
formerly fixed vehicle.  Increasing the number of vehicles naturally leads to more 
states because the state of the new vehicle – x, y, and theta – have to be 
accounted.  In addition, it also leads to more control variables since now there are 
two more magnets and an extra reaction wheel the controller can use to control the 
system.  Freeing up a fixed vehicle allows that vehicle to move making the x, y and 
theta states important.  It also allows that vehicles reaction wheel to have an effect 
on the vehicles motion adding a new control variable. 

190 

Increase in states demonstrated 

EMFFORCE 

•For test cases 2a and 2b 
x 
⎡ 
⎤ 
A 
⎢ 
⎥ 
y 
⎢
⎥
A 
⎢
⎥
θ 
A 
⎢
⎥
x 
& 
⎢
⎥
A 
⎢
⎥
y 
& 
A 
⎢
⎥
& 
θ
⎢
⎥
⎣
⎦
A 

µ 
⎡ 
⎤ 
A 
1 
⎢ 
⎥ 
B 
+ 
µ
⎢
⎥
A 
2 
⎢
⎥
α
⎣
⎦
A 

Ax 
= 
& 

•For test cases 2c and 2d 
–Increase in states and 
control variables 

Ax 
= 
& 

x 
⎤ 
⎡ 
A 
⎢ 
⎥ 
y 
⎥
⎢
A 
⎥
⎢
θ 
A 
⎢
⎥
θ
⎥
⎢
B 
⎢
⎥
x 
& 
A 
⎥
⎢
y 
& 
⎥
⎢
A 
⎥
⎢
& 
θ
A 
⎥
⎢
& 
θ
⎢
⎥
⎦
⎣
B 

µ 
⎡ 
⎤ 
A 
1 
⎢ 
⎥ 
µ
⎢
⎥
A 
2 
B 
+ 
⎢
⎥
α
A 
⎢
⎥
α
⎣
⎦
B 

05 December 2002 

EMFFORCE - CDR 

191 

<BAB> 

This slide shows the state and control vectors for test 2a and 2b and contrasts them  

against the vectors for test 2c, 2d, and 2e.


191 

