10.34, Numerical Methods Applied to Chemical Engineering 
Professor William H. Green 
Lecture #27: Models vs. Data Recapitulation. Monte Carlo. 
 

Least Squares Fit 
Ymodel = Σθifi(x) 

χ2 = const 

θ2

θbest

θ1

χ2

min

Use probability (χ2 > χ2
consistent. 

 
measured) > tol to set contour boundary for consistent or not 

Nonlinear Least Squares 
Away from “θbest”, no idea about contours. Close to minima, looks like ellipses. Nonlinear 
case can have numerous local minima and arbitrary shape. It is possible for the problem to 

be poorly constrained, to have multiple minima, and to have bad directions. The result is big 

error bars and a complete mess. 

Ymodel(θ, x) ≈ Ymodel(θbest) + ∂Ymodel/∂θ(θ-θbest) + O((∆θ)2) 

 

 

θ2

 

 

 

close to θbest will be linear                 neglect  

don’t know 
parameter 
values well in 
this direction 

θ1

can have 
more minima 

 
Standard confidence intervals – covariance matrix, assume ellipses for confidence intervals. 

To tell the actual shape of the region, use Bayesian view: report probability distribution of 

the region. Can cut across the region to get more information. 

Experimental Error Sources (Causes for Irreproducibility) 
-  human error, typographic errors 
-  variables out of control, often unknown to researcher 
o  building vibrations 
- 
calibration discrepancies: instrument drift (error bars, can control) 
-  actual matter intrinsically varies (molecules are always in motion); have some 
control in terms of knowledge of the phenomena 
o 
o 
o 
With least squares fitting (nonlinear), might find local minima but might miss global minima. 

impossible (Heisenberg Uncertainty Principle) 

impractical to measure/record 

turbulent – perfectly random 

Monte Carlo Integration 
xE
x
Tk
,...,
(
b/)
e
−
23
10
1
N

P(x1,x2,…,x10

23) ~ 

 

         q 

U = <E> over some ensemble 
∫∫
∫∫
dqqEqp
)(
)(
L
∫∫
∫ ∫
dqqp
)(
L
Ideal Gas – Integral is easy to work out 

=<

E

>

 

Liquids and polymers - difficult 

Monte Carlo 

f(x) 

 

 

 

 

 

 

 

 

 

 

 
dxxfb
∫
)(
a
I

∫=

a 

 

b 

=

ab
(
−

)

<

f

>

       Choose enough points 

dqqfqp
)(
)(

                  p(q) is the distribution function 

10.34, Numerical Methods Applied to Chemical Engineering 
Prof. William Green 
 

Lecture 27 
Page 2 of 2 

