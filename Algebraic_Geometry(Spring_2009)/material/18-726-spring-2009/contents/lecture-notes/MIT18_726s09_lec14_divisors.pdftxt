MIT OpenCourseWare
http://ocw.mit.edu 

18.726 Algebraic Geometry 
Spring 2009 

For information about citing these materials or our Terms of Use, visit: http://ocw.mit.edu/terms . 

18.726:  Algebraic  Geometry  (K.S.  Kedlaya,  MIT,  Spring  2009) 
Divisors,  linear  systems,  and  pro jective  embeddings  (updated  1  Apr  09) 

We  conclude  the  ﬁrst  half  of  the  course  by  translating  into  the  language  of  schemes  some 
classical  notions  related  to  the  concept  of  a  divisor. This  will  serve to  explain (in part)  why 
we  will  be  interested  in  the  cohomology  of  quasicoherent  sheaves. 
In order to facilitate giving  examples, I  will  mostly  restrict to  local ly  noetherian  schemes. 
See  Hartshorne  II.6  for  divisors,  and  IV.1  for  Riemann-Roch. 

1  Weil  divisors 

Introduce  Hartshorne’s  hypothesis  (*): 
let  X  be  a  scheme  which  is  noetherian,  integral, 
separated,  and  regular  in  codimension  1.  The  latter  means  that  for  each  point  x  ∈  X  whose 
local  ring  OX,x  has  Krull  dimension  1,  that  local  ring  must  be  regular. 

Lemma.  Let  A  be  a  noetherian  local  ring  of  dimension  1.  Then  the  fol lowing  are  equivalent. 

(a)  A  is  regular. 

(b)  A  is  normal. 

(c)  A  is  a  discrete  valuation  ring. 

(This  is  why normalizing  a  one-dimensional  noetherian  ring  produces  a  regular  ring.) 
Warning:  for  a  noetherian  integral  domain,  normal  implies  regular  in  codimension  1  but 
not  conversely.  You  have  to  add  Serre’s  condition  S2:  for  a  ∈  A,  every  associated  prime  of 
the principal ideal (a)  has  codimension 1  when  a  is  not  a  zerodivisor,  and  has  codimension 
0  when  a  = 0. 
A  prime (Weil)  divisor  on  X  is  a  closed integral (irreducible  and  reduced)  subscheme  of 
codimension  1.  A  formal  Z-linear  combination  of  prime  divisors  is  called  a  Weil divisor.  If 
only  nonnegative  coeﬃcients  are  used,  we  say  the  divisor  is  eﬀective. 
For  example,  let  K (X ) be the  function  ﬁeld  of  X ,  i.e.,  the  local  ring  of  X  at its generic 
point. 
(This  equals  Frac(O(U ))  for  any  nonempty  open  aﬃne  subscheme  U  of  X .)  For 
f  ∈  K (X )  nonzero,  we  can  deﬁne  a  principal divisor  associated  to  f  as  follows.  For  each 
prime divisor  Z  on  X , let  ηZ  be  the  generic  point  of  Z .  Then  OX,ηZ  is  a  discrete  valuation 
ring;  let  vZ  be  the  valuation.  Now  deﬁne  the  divisor 
 
vZ (f )Z ; 

(f ) =  �
Z 

this  makes  sense  because  only  ﬁnitely  many  vZ (f ) are  nonzero.  (That’s  because f  restricts 
to  an  invertible  regular  function  on  some  nonempty  open  subscheme  U  of  X ,  and  vZ (f ) = 0 
whenever  Z 
6⊆  X  − U .) 
Let Div X  be  the  group  of  Weil  divisors  of  X .  The  principal  divisors  form  a  subgroup 
(since (f ) + (g ) = (f g ));  the  quotient  by  this  subgroup  is  called  the  divisor  class  group  of 

1


X , denoted Cl X .  For  example,  if  X  = Spec(A) with  A  a Dedekind domain, then Div X  is 
the  group  of  fractional  ideals,  and  Cl X  is  the  ideal  class  group.  We  say  two  divisors  which 
diﬀer  by  a  principal  divisor  are  linearly  equivalent. 
There  are  a  number  of  examples  in  Hartshorne.  One  of  my  favorites  is  that  of  an  el liptic 
curve ; here is a summary.  Let k  be an algebraically closed ﬁeld (for starters).  Let P (x, y , z) ∈ 
k [x, y , z ] be a homogeneous polynomial of degree 3 deﬁning  a nonsingular subvariety  C  of  P2 
k . 
Pick  a  point  O  ∈  C (k).  There  is  a  surjective  map  Div X  →  Z  mapping  each  prime  divisor 
P  to  1,  called  the  degree.  This  map  factors  through  Cl X  because  each  principal  divisor  has 
degree  0.  The  kernel  of  the  degree  map  Cl X  →  Z  is generated by (P ) − (O) for  P  ∈  C (k). 
In fact it is  equal  to  the  set  of  such  elements:  given  P , Q  ∈  C ,  we  ﬁrst  draw  the  line  through 
P , Q  in  P2 
k  and  ﬁnd  its  third  intersection  point  R  with  C . We then draw the line through  R 
and  O  in  P2 
k  and  ﬁnd  its  third  intersection  point  S  with  C . Then 

so 

(P ) + (Q) + (R) ∼  (R) + (S ) + (O), 

(P ) − (O) + (Q) − (O) ∼  (S ) − (O). 

2  Cartier  divisors 

When  the  scheme  X  is  not  regular,  there  is  a  more  restrictive  notion  of  divisors  that  turns 
out  to  be  more  useful  in  many  cases. 
Let  K  be  the  locally  constant  sheaf  associated  to  the  function  ﬁeld  K (X ).  A  Cartier 
divisor  on  X  is a section of the sheaf  K (X )/O×  . Using  the construction of principal divisors, 
we  obtain  a  map  from  Cartier  divisors  to  Weil  divisors:  if  the  Cartier  divisor  is  represented 
on  some  open  subset  U  of  X  by  the  rational  function  f  ∈  K (X ),  then  the  Weil  divisor 
we get  should  agree  with (f ) when  restricted  to  U  (i.e.,  only  keep the  components  of  those 
prime divisors meeting  U ).  This map is injective if  X  is normal, because  an integrally  closed 
noetherian  domain  is  the  intersections  of  its  localizations  at  minimal  prime ideals. 

Proposition  (Hartshorne,  Proposition  II.6.11).  Suppose  X  is  local ly  factorial  (i.e.,  each 
local  ring  OX,x  is a unique factorization domain).  Then the previous map is an isomorphism. 
(In particular, this holds if X  is  regular,  because  a  regular  local  ring  is  factorial  by  a  not-so­
easy  theorem  of  commutative  algebra.) 

Example:  if  X  = Spec k [x, y , z ]/(xy  − z 2 ), the ideal (x, z) deﬁnes  a  Weil  divisor  which  is 
not  a  Cartier  divisor. 
Again,  there  is  an  obvious  notion  of  a  principal Cartier divisor,  namely  one  deﬁned  by 
a  single  element  of  K (X ).  The  group  of  Cartier  divisors  modulo  principal  divisors  is  called 
the  Cartier  class  group  of  X , denoted CaCl X . 

2


3  The  Picard  group 

The  Cartier  class  group  is  “usually”  the  same  as  the  Picard group,  namely  the  group  of 
invertible  sheaves  on  X  under  the  tensor  product.  Namely,  if  D  is  a  Cartier  divisor  on  X , 
let  L(D) be  the  subsheaf  of  K  such that 

L(D)(U ) =  {f  ∈  K (X ) : ((f ) + (D))|U  ≥  0}. 

Assuming  that  X  is normal, this is locally free of rank 1, hence an invertible sheaf.  This gives 
a homomorphism from Cartier divisors to the Picard group,  which  we  see kills the principal 
divisors.  The  resulting  homomorphism  is  always  injective,  even  without  any  hypotheses  on 
X  (Hartshorne,  Corollary  II.6.14) but  may  not  be  surjective;  however,  it  is  surjective  if  X 
is integral (Hartshorne, Proposition II.6.15). 
Note that if  D  is  eﬀective,  then  the  function  1  deﬁnes  a  global  section  of  L(D).  Since  L 
is locally principal,  we  can locally identify  L  with  OX ;  when  we  do  so,  the  subsheaf  of  L(D) 
generated  by  1  goes  into  correspondence  with  an  ideal  sheaf  of  OX ,  which  doesn’t  depend 
on  any  choices.  This  ideal  sheaf  deﬁnes  D  as  a  closed  subscheme.  In  other  words,  D  is the 
zero  locus  of  a  certain  section  of  L(D).  More generally,  even if  D  is  eﬀective,  we  can  view  D 
as the zero locus of  a  meromorphic  section  of  L(D) (meaning a zero locus of  L(D) ⊗OX  KX ), 
and  indeed  the  zero  locus  of  any  meromorphic  section  of  L(D) is  linearly  equivalent  to  D . 

4  Linear  systems 

Suppose  X  is  an  integral  separated  scheme  of  ﬁnite  type  over  a  ﬁeld  k  (which  need  not  be 
algebraically  closed).  Let  L  be an invertible  sheaf  on  X . A  linear  system  deﬁned by  L  is the 
set  of  zero  loci  of  some  k -linear  subspace  H  of  H 0(X, L).  If  we  take  the  entire  space,  that  is 
called  the  complete  linear  system  deﬁned by  L. 
n , where  n  = dimk (H )−1. 
We can attempt to use the elements of H  to deﬁne a map  X  →  P
k
This  might  fail  to  give  a  morphism  because  H  may  have  a  base point,  i.e.,  a  point  in  the 
intersection  of  all  of  the  divisors  in  the  linear  system.  In  fact,  we  get  a  morphism  X  →  Pn
k 
if  and  only  if  H  has  no  base  points. 
Suppose  now  that  k  is  algebraically  closed,  and  that  X  is  one-dimensional,  pro jective, 
irreducible, and nonsingular (i.e., a  “curve”).  Consider the complete linear system associated 
to  L(D) for  some  divisor  D . 

(a)  We get a map  X  →  Pn
k  if and  only if for each  closed point  x  ∈  X , we have dimk  H 0(X, L(D− 
x)  =  dimk  H 0(X, L(D)) −  1.  (In  other  words,  there  must  be  a  section  of  L(D)  not 
vanishing  at  x.) 

(b)  The map in (a) is injective as a map  of  sets if  and  only if for each pair of distinct  closed

points x, y  ∈  X , we have dimk  H 0(X, L(D − x − y )) = dimk  H 0(X, L(D)) − 2.  (In other

words,  there  must  be  a  section  of  L(D) vanishing  at  x  but  not  at  y ,  and  vice  versa.)


3 

(c)  The  map in (b)  is  a  closed immersion if  and  only if for  each  closed point  x  ∈  X ,  we 
have dim H 0(X, L(D − 2x)) = dimk  H 0(X, L(D)) − 2.  (In  other  words,  there  must  be 
a  section  of  L(D) not  vanishing  at  x,  and  a  section  vanishing  to  exact  order  1  at  x.) 

(Condition (c) is needed to ensure that the tangent  space at  x  embeds into the tangent  space 
at  the  image  of  x.  See  Remark  7.8.2.) 
Since we would like to know under what  circumstances  X  embeds into a pro jective space, 
we  would  like  to  be  able  to  compute  at  least  the  dimension  of  H 0(X, L(D)) for  each  divisor 
D .  This  quest  is  greatly  abetted  by  the  Riemann-Roch  theorem,  more  on  which  next  time. 

4


