6.042/18.062J Mathematics for Computer Science
Srini Devadas and Eric Lehman

May 12, 2005
Lecture Notes

Special Topics

1 Streaks

Was the table of H ’s and T ’s below generated by ﬂipping a fair coin 100 times, or by
someone tapping the H and T keys in a what felt like a random way?

H T T T H T H T T H T T H T H T H T H T
T T T HH T HH T H T H T T HHH T H T
HH T HH T T T HHH T H T T HHHH T
T H T T HH T H T H T H T H T T H T HH
H T T HHH T H T HHH T H T HHH T H

There is no way to be sure. However, this sequence has a distinctive feature that is com-
mon in “random” human-generated sequences and unusual in truly random sequences:
namely, there is no long streak of H’s or T’s.
In fact, no symbol appears above more
than four times in a row. How likely is that? If we ﬂip a fair coin 100 times, what is the
probability that we never get ﬁve heads in a row?

1.1 From a Probability Problem to a Counting Problem

The sample space for this experiment is {H, T }100 ; that is, the set of all length-100 se-
quences of H’s and T’s. If the coin tosses are fair and independent, then all 2100 such se-
quences are equally likely. Therefore, we need only count the number of sequences with
no streak of ﬁve heads; given that, the probability that a random length-100 sequence
contains no such streak is:

Pr (sequence has no HHHHH ) =

# sequences with no HHHHH
2100

This is a common situation. We have reduced a probability problem to a counting
problem. Unfortunatley, we have no hope of solving the counting problem by direct
computation. No computer can consider all 2100 sequences of H ’s and T ’s, keeping track
of how many lack a streak of ﬁve heads. But, on the bright side, there is a big bag of
In this case, we’ll use a recurrence
mathematical tricks for solving counting problems.
equation. The recurrence equation approach involves two steps:

2

Special Topics

1. Solve some small problems.

2. Solve the n-th problem using preceding solutions.

Let’s see how this approach plays out in the analysis of streaks.

1.2 Step 1: Solve Small Instances

Let Sn be the set of length-n sequences of H ’s and T ’s that do not contain a streak of ﬁve
heads. Our eventual goal is to compute |S100 |. But for now, let’s just compute |Sn | for
some very small values of n:

|S1 | = 2
|S2 | = 4
|S3 | = 8
|S4 | = 16
|S5 | = 31

(H and T )
(HH , H T , T H , and T T )

(HHHHH is excluded!)

These are called base cases.

1.3 Step 2: Solve the n-th Problem Using Preceding Solutions

We can classify the sequences in Sn into ﬁve groups:

1. Sequences that end with a T .

2. Sequences that end with T H .

3. Sequences that end with T HH .

4. Sequences that end with T HHH .

5. Sequences that end with T HHHH .

Every sequence in Sn falls into exactly one of these groups. Thus, the size of Sn is the sum
of the sizes of these ﬁve groups.

How many sequences are there in the ﬁrst group? That is, how many sequences in Sn
end with T ? The preceding n − 1 symbols in such a sequence can not contain a streak of
ﬁve heads. Therefore, those n − 1 symbols form a sequence in Sn−1 . On the other hand,

Special Topics

3

putting a T at then end of any sequence in Sn−1 gives a sequence in Sn . Therefore, the
number of sequences in the ﬁrst group is exactly equal to |Sn−1 |.

How many sequences are there in the second group? Arguing as before, the preceding
n − 2 symbols in each such sequence must form a sequence in Sn−2 . On the other hand,
appending T H to any sequence in Sn−2 gives a sequence in the second group. Therefore,
there are exactly |Sn−2 | sequences in the second group.

By similar reasoning, the number of sequences in the third group is |Sn−3 |, the number
in the fourth is |Sn−4 |, and the number in the ﬁfth is |Sn−5 |. Therefore, we have:

|Sn | = |Sn−1 | + |Sn−2 | + |Sn−3 | + |Sn−4 | + |Sn−5 |

(for n > 5)

This recurrence equation expresses the solution to a large problem (|Sn |) in terms of the
solutions to smaller problems (Sn−1 , Sn−2 , . . .).

By combining the base cases and the recurrence equation, we can compute |S6 |, |S7 |,
|S8 |, and so forth until we reach |S100 |.

|S6 | = |S5 | + |S4 | + |S3 | + |S2 | + |S1 |
= 31 + 16 + 8 + 4 + 2 + 1
= 62
|S7 | = |S6 | + |S5 | + |S4 | + |S3 | + |S2 |
= 62 + 31 + 16 + 8 + 4 + 2
= 123
|S8 | = . . .

Computing |S100 | still requires about 500 additions, so a computer helps. Plugging the
value of |S100 | into our earlier probability formula, we ﬁnd:

Pr (sequence has no HHHHH ) = 0.193 . . .

Thus, four out of ﬁve sequences of 100 coin tosses contain a streak of ﬁve heads. By
symmetry, we also know that four out of ﬁve sequences contain a streak of ﬁve tails. If
we suppose that these two events are nearly independent, then only about one random
sequence in twenty-ﬁve contains no streak of ﬁve heads or ﬁve tails. This is the situation
for the sequence given at the start of this section. Sure enough, I made up that sequence
up by “randomly” tapping keys!

4

2 The Truel

Special Topics

Three gunﬁghters meet for a truel, a three-person duel. Gunﬁghter A hits his target 50%
of the time, gunﬁghter B hits 75% of the time, and gunﬁghter C hits 100% of the time.
The gunﬁghters take turns shooting in the order A, B, C, A, B, C, etc. Of course, a dead
gunﬁghter misses his turn. The last one standing is the winner.

What is A’s best strategy? If A kills C, then B will probably kill A on the next shot. On
the other hand, if A kills B, then C will certainly kill A on the next shot. This does not
look good. But there is a another possibility: A could intentionally miss, let B and C shoot
it out, and then try to kill the winner! Let’s evaluate that strategy, assuming that B and C
actually try to hit each other.

C kills A
1

C WINS

A miss

1/2

C kills B
1

B miss

1/4

3/4

1/2

B kills C

A WINS

A kills B

A kills C

1/2

A WINS

B WINS

x = prob. that
B wins from this
state

1/2

3/4

A miss

B kills A

1/4
B miss

. . .

From the tree diagram, we have:

1
2

· 1

Pr (C wins) =

=

· 1 ·

1
4
1
8
= 12.5%

Now let x be the probability that B eventually wins in the situation where C is dead and
A has the next shot. This situation arises at two different points in our tree diagram. We
can exploit that fact to obtain an equation expressing x in terms of itself:

x =

1
2

·

3
4

+

1
2

·

1
4

· x

Solving this equation, we ﬁnd that x = 3/7. The probability that B wins overall is:

Special Topics

5

Pr (B wins) =

=

· x

3
4
9
28
≈ 32.1%

Finally, we have:

Pr (A wins) = 1 − Pr (B wins) − Pr (C wins)
≈ 55.4%

Amazingly, the worst shooter has the best chance of winning, and the best shooter has
the worst chance of winning!

Of course, an explicit assumption in this analysis was that B and C are both shooting to
kill, unlike A in the ﬁrst round. If B and C have no such requirement, then the problem is
underspeciﬁed; there is no deﬁnite mathematical solution. Every gunﬁghter might reason
that he is better off not shooting and the whole lot might go toast smores over a campﬁre.

3 Penney-Ante

Let’s play a game! We repeatedly ﬂip a fair coin. You have the sequence HH T , and I have
the sequence H T T . If your sequence comes up ﬁrst, then you win. If my sequence comes
up ﬁrst, then I win. For example, if the sequence of tosses is:

T T H T H T HH T

then you win. This problem is tricky, because the game could go on for an arbitrarily long
time. Draw enough of the tree diagram to see a pattern, and then sum up the probabilities
of the (inﬁnitely many) outcomes in which you win.

A partial tree diagram is shown below. All edge probabilities are 1/2.

6

Special Topics

T

H

T

H

same

T

etc.

same

I win!

H

T

T

T

H

H

H

T

you win
(eventually)
pr = 1/4

H

you win
pr = 1/16

I win!

etc.

you win
pr = 1/64

Let’s ﬁrst focus on the subtree shown in bold. Note that if two heads are ﬂipped in a
row, then you are guaranteed to win eventually. The sum of the probabilities of all your
winning outcomes in this subtree is:

1
4

+

1
16

+

1
64

+ . . . =

=

·

1
1 − 1/4

1
4
1
3

The upppermost subtree marked same is the identical to the one shown in bold, except
that each outcome probability is reduced by 1/2, because it is one edge farther from the
root. Thus, the sum of your winning outcomes in this subtree is 1/6. Similarly, the sum of
your winning outcomes in the next subtree marked same is 1/12, and so forth. Overall,
your probability of winning is:

1
3

+

1
6

+

1
12

+ . . . =

=

·

1
1 − 1/2

1
3
2
3

In fact, as long as you pick a sequence ﬁrst, and I pick a sequence second, I can always
have at least a 2/3 probability of winning the game.

How is this possible? We know that each sequence of length three is equally likely, so
therefore there should be no advantage to one sequence over another, and certainly no
disadvantage to picking a sequence ﬁrst. However, as we’ve already seen, this does not
appear to be true.

Special Topics

7

One way to observe that I can always win with probability of at least 2/3 is if you ﬁrst
select the sequence HHH . I then select the sequence T HH . I claim that in this situation,
my probability of winning is 7/8.

Why is this true? In the case where the ﬁrst three tosses are HHH , with probability
1/8, you win immediately. The remaining 7/8 of the time, the game continues.

Suppose at some point later on, say starting at toss 30, the sequence HHH ﬁnally
appears for the ﬁrst time. This means that nowhere earlier than toss 30 do we observe
HHH . So, toss 29 must have been a T . However, this means that the sequence T HH
appeared before the sequence HHH , and I won! Using this logic, no matter when in the
series of ﬂips HHH appeared, T HH must have appeared ﬁrst, except when HHH is the
ﬁrst three coin ﬂips.

So, 7/8 of the time T HH occurs before HHH , and I win! Pretty good odds.

Similar logic can be used for each sequence of length three selected by my opponent.
The key is that I must pick my sequence after my opponent selects his sequence in order to
guarantee that I have the advantage. Table 1 contains the relevant information to ensure
you continued success.

Table 1: In Penny-ante, your best response to your opponent’s choice, and the corresponding
chance that your pattern appears ﬁrst
Opponent’s Choice Your Choice Chance of Winning
7/8
THH
HHH
HHT
THH
3/4
2/3
HHT
HTH
2/3
TTH
THH
2/3
HHT
HTT
THT
TTH
2/3
3/4
HTT
TTH
TTT
HTT
7/8

