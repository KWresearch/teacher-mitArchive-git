LECTURE  NOTES  FOR   18.155,  FALL  2004 

RICHARD  B.  MELROSE 

Contents 

Introduction 
1.   Continuous  functions 
2.   Measures  and  σ ­algebras 
3.   Measureability  of  functions 
4.  
Integration  
5.   Hilbert  space 
6.   Test  functions  
7.   Tempered  distributions 
8.   Convolution  and  density 
9.   Fourier   inversion 
10.  Sobolev   embedding 
11.  Diﬀerential  operators. 
12.  Cone   support  and  wavefront   set  
13.  Homogeneous  distributions  
14.  Wave  equation 
15.  Operators  and  kernels  
16.  Spectral  theorem  
17.  Problems 
18.  Solutions   to   (some  of )  the  problems  
References 

1 
2 
10 
16 
19 
30 
34 
42 
47 
58 
63 
67 
83 
96 
97 
98 
99 
103 
130 
136 

Introduction  

These  notes  are  for  the  course  the  graduate  analysis  course  (18.155) 
at  MIT  in  Fall   2004.   They  are  based  on   earlier   notes  for  similar   courses  
in  1997,  2001   and  2002.  In  giving  the  lectures  I  may  cut  some  corners! 
I  wish  to  particularly  thank  Austin  Frakt  for   many  comments  on, 
and  corrections  to,  an  earlier  version   of  these  notes.  Others  who  made 
helpful  comments  or  noted   errors  include  Philip  Dorrell,  .... 
1 

2 

RICHARD  B.  MELROSE 

1.   Continuous functions 

(1.1)	

A  the   beginning   I  want   to  remind  you  of  things  I  think  you  already 
know  and  then  go  on  to   show   the   direction  the  course  will  be  taking. 
Let  me  ﬁrst  try  to  set  the  context.  
One   basic  notion  I  assume   you  are  reasonably  familiar   with  is  that  
of  a  metric  space  ([5]  p.9).  This  consists  of  a  set,  X,   and  a  distance 
function 
d :  X × X  =  X 2  −→  [0, ∞) , 
satisfying   the  following   three	 axioms: 
i)  d(x, y)  = 0  ⇔ x =  y ,  (and   d(x, y)  ≥ 0) 
ii)  d(x, y) =  d(y , x)  ∀  x, y ∈ X 
iii)  d(x, y)  ≤ d(x, z ) +  d(z , y)  ∀  x, y , z  ∈ X.  
The  basic  theory  of  metric  spaces  deals  with  properties  of  subsets 
(open,   closed,   compact,   connected),   sequences   (convergent,  Cauchy)  
and  maps  (continuous)   and  the  relationship  between   these  notions. 
Let  me  just   remind  you  of  one  such  result. 
Proposition  1.1.  A  map  f  :  X  →  Y  between   metric  spaces  is   con­
tinuous  if  and  only  if  one  of   the  three  fol lowing  equivalent   conditions  
holds 
(1)  f −1 (O)  ⊂ X  is  open  ∀  O ⊂ Y  open. 
(2)  f −1 (C )  ⊂ X  is  closed  ∀  C ⊂ Y  closed. 
n  → 
(3)  limn→∞ f (xn ) =  f (x)  in  Y  if  x
x  in  X .
The  basic  example  of  a  metric  space  is  Euclidean   space.  Real  n­
dimensional  Euclidean  space,  Rn ,  is  the  set  of  ordered  n­tuples   of  real 
numbers  

x = (x1 , . . . , xn )  ∈ Rn  ,  xj  ∈ R ,  j = 1, . . . , n . 
It  is  also  the  basic  example  of  a  vector  (or  linear)  space  with   the  oper­
ations 

x +  y = (x1  +  y1 , x2  +  y2 , . . . , xn  +  yn ) 
cx  = (cx1 , . . . , cxn ) . 
� 
The  metric  is  usually  taken   to  be   given   by  the  Euclidean  metric 
n
|x| = (x1  +  · · · +  xn )1/2  = (  
2 
2
2
xj )1/2  , 
j=1 

in  the  sense  that 

d(x, y) =  x − y .
|
| 

LECTURE  NOTES  FOR  18.155,   FALL  2004 

3 

Let  us  abstract  this  immediately  to  the  notion   of   a  normed  vector 
space,  or   normed  space.   This  is  a  vector  space  V  (over   R or  C) equipped 
with  a  norm,  which  is  to  say  a  function  
� � :  V  −
→ [0, ∞)

satisfying  

(1.2) 

i)  �v� = 0 
⇐⇒
v  = 0,
ii)  �cv� =  c| | �v� ∀ c  ∈ K, 
w� ≤ �
v� +  �w�
iii)  �v  + 
.
�
This  means  that   (V , d),  d(v , w) =  v  − w� is   a  vector  space;  I  am  also 
using  K  to  denote  either   R  or  C  as  is   appropriate. 
The  case  of  a  ﬁnite  dimensional  normed   space  is  not  very  interesting 
because,   apart   from  the  dimension,  they  are  all  “the  same”.  We  shall 
say  (in  general)  that  two   norms  � • �
1  and  � • �
2  on  V  are  equivalent 
of  there  exists  C >  0  such  that  
v�
�
v�2  ≤ C �v�1  ∀ v  ∈ V 
1  ≤ �
1 
C

.

Proposition  1.2.  Any  two  norms   on  a  ﬁnite  dimensional  vector  space 
are  equivalent. 

So,   we  are  mainly  interested  in  the  inﬁnite  dimensional  case.  I   will 
start  the  course,  in  a   slightly  unorthodox  manner,  by  concentrating  on 
one  such  normed  space   (really  one  class).  Let   X  be  a  metric  space. 
→
R  (or   C)   is   a  special  case
The  case  of  a   continuous  function,  f  :  X 
of  Proposition  1.1   above.   We  then  deﬁne 
C (X ) =  {f  :  X  → R,  f  bounded  and   continuous} . 

In  fact  the  same  notation  is  generally  used  for   the  space  of  complex­
valued  functions.  If  we  want   to  distinguish   between   these  two  possi­
bilities  we   can  use  the  more  pedantic  notation  C (X ; R)   and   C (X ; C). 
Now,   the   ‘obvious’   norm  on  this   linear  space  is   the  supremum  (or  ‘uni­
form’)  norm 

=  sup  f (x)| .
|
x∈X 
Here  X  is  an  arbitrary  metric  space.  For  the  moment  X  is   sup­
posed  to  be  a   “physical”   space,  something  like  Rn  .  Corresponding  to 
the  ﬁnite­dimensionality  of   Rn  we  often  assume  (or   demand)  that  X 
is  local ly  compact.   This  just  means   that  every  point  has  a  compact 
neighborhood,   i.e.,  is  in  the  interior   of  a  compact  set.  Whether   locally 

�f �∞ 

4 

RICHARD  B.  MELROSE 

� 
compact  or  not  we  can  consider  
f  ∈ C (X );   ∀ � >  0  ∃ K  � X s.t.  sup  f (x)
C
|
| ≤ � 
(1.3) 
0 (X ) = 
∈Kx /
Here  the   notation  K  � X  means  ‘K   is   a  compact   subset  of  X ’. 
If  V 
is  a  normed  linear   space   we   are  particularly  interested  in   the 
continuous  linear  functionals   on   V  .  Here  ‘functional’  just  means  func­
is  allowed  to   be  ‘large’   (not   like  Rn )  so  ‘functional’  is   used  
tion  but  V 
for  historical   reasons.  

� 

.

Proposition  1.3.  The  fol lowing  are  equivalent  conditions  on  a  linear 
functional  u  :  V  − R  on  a  normed  space  V  .
→
(1)  u  is  continuous. 
(2)  u  is  continuous  at   0. 
(3)  {u(f )  ∈ R ;  f  ∈ V  ,  �f � ≤ 1} is  bounded. 
(4)  ∃ C  s.t.   u(f )
|
| ≤ C �f � ∀ f  ∈ V 
.
Proof.  (1)  = ⇒  (2)  by  deﬁnition.   Then   (2)  implies   that  u−1 (−1,  1)  is 
a  neighborhood  of  0  ∈  V  ,  so  for  some  �  >  0,  u({f  ∈ V  ; �f � <  �})  ⊂
(−1,   1).   By  linearity  of  u,  u({f  ∈ V  ; �f � <  1})  ⊂ (−
1 ) is   bounded, 
1  ,�
so  (2)  = ⇒ (3).   Then  (3)  implies   that  
�
u(f )| ≤ C  ∀ f  ∈ V ,  �f � ≤ 1
|
� 
� 
for  some  C .  Again  using   linearity  of  u,  if  f  =  0, 
�f � ≤ C �f � , 
u(f )| ≤ �f �u
|
f 

giving  (4).  Finally,  assuming  (4),  
u(f ) − u(g) =  u(f  − g)
|
|
|
| ≤ C �f  − g� 
shows  that  u  is  continuous  at  any  point  g  ∈ V  . 

� 

In  view   of  this  identiﬁcation,   continuous  linear   functionals   are  often 
said  to   be  bounded.  One  of  the  important   ideas  that  we  shall  exploit  
later  is  that   of  ‘duality’.  In   particular  this   suggests   that  it  is   a  good  
idea   to  examine  the   totality  of  bounded  linear  functionals   on  V  .  The 
dual  space  is 
V  �  =  V  ∗  =  u  :  V  −→ K , 
linear   and  bounded} .
{
This  is  also   a  normed  linear  space  where  the  linear  operations  are 
∀ f  ∈ V . 

(u  +  v)(f ) =  u(f ) +  v(f )
(cu)(f ) =  c(u(f ))  

(1.4) 

�
LECTURE  NOTES  FOR  18.155,  FALL  2004 
The  natural  norm  on  V  �  is  
u� =  sup  u(f )|.
�
|
�f �≤1 

5 

(1.5) 

This  is  just  the  ‘best  constant’  in  the  boundedness   estimate, 
| ≤ C �f � ∀ f  ⊂ V  } . 
u� =  inf  {C ; u(f )
�
|
One   of  the  basic  questions   I  wish  to  pursue  in  the  ﬁrst   part   of  the 
course  is:  What   is   the  dual  of  C0 (X )  for   a  locally  compact   metric  space 
X ?  The  answer   is  given  by  Riesz’   representation  theorem,  in  terms  of 
(Borel)  measures. 
Let  me  give  you  a  vague  picture  of  ‘regularity  of  functions’  which  
is  what   this  course  is  about,  even   though   I  have  not  introduced   most 
of  these   spaces  yet.   Smooth   functions   (and  small  spaces)   are  towards 
the  top.  Duality  ﬂips  up  and   down  and   as   we  shall  see  L2  ,  the  space 
of  Lebesgue  square­integrable  functions,  is   generally  ‘in  the  middle’. 
What  I  will   discuss  ﬁrst   is  the  right  side  of   the  diagramme,  where  we 
have  the  space  of  continuous  functions  on   Rn  which  vanish  at  inﬁnity 
and  its  dual  space,  Mﬁn (Rn ),   the  space   of  ﬁnite  Borel  measures.  There 
are  many  other  spaces  that  you   may  encounter,  here  I  only  include  test 
functions,  Schwartz  functions,  Sobolev  spaces   and  their  duals;  k  is   a 
general  positive  integer. 
S (Rn ) 
  _ 

w 
UUUUUUUUUUUUUUUUUUUUUU
/ C0 (Rn )
C
 
k c (Rn )
H k (Rn ) 
  _
_ 
ss K sssssss
ys
L2 (Rb )
  _  KKKKKKKKKK
H −k (Rn ) 
? Mﬁn   (Rn )
M (Rn ) 
  _ 
iiiiiiiiiiiiiiiiiiii 
g 
S � (Rn ). 
I  have  set  the  goal  of  understanding   the  dual  space  Mﬁn (Rn ) of  C0 (X ),  
where  X  is  a  locally  compact  metric  space.  This  will  force  me  to  go 
through  the  elements  of  measure  theory  and  Lebesgue  integration.  It  
does  require  a   little  forcing! 
The  basic  case  of  interest  is  Rn  .  Then  an   obvious  example  of  a  con­
tinuous  linear   functional  on  C0 (Rn )  is  given   by  Riemann  integration,  



*
*

/



y
s


%
%


_
o
o
G


t
t
6 

RICHARD  B.  MELROSE 
� 
for  instance  over   the   unit  cube  [0, 1]n : 
[0,1]n 

u(f ) = 

f (x) dx . 

In  some  sense  we  must  show   that  al l  continuous  linear   functionals 
C
0 (X )  are  given  by   integration.   However,  we  have  to  interpret 
on 
integration  somewhat   widely  since  there  are  also  evaluation   functionals. 
If  z ∈ X consider  the  Dirac  delta 
δz (f ) =  f (z ) . 

(1.6) 

f± (x) = 

±f (x) 
0 

)  ≤ |
f (x)| ∀ x ∈ X . 

This  is  also  called  a  point  mass  of  z .  So  we  need  a  theory  of  measure 
and  integration  wide  enough  to  include  both  of  these  cases. 
One  special   feature  of  C0 (X ),   compared   to  general  normed   spaces,  is  
that  there  is  a  notion  of  positivity  for   its   elements.  Thus   f  ≥  0  just 
means  f (x)  ≥ 0  ∀ x ∈ X . 
Lemma  1.4.  Each   f ∈ C0 (X )  can  be  decomposed  uniquely  as  the  dif­
ference  of  its  positive  and  negative  parts  
f =  f+  − f−  , f±  ∈ C0 (X ) , f± (x
� 
Proof.  Simply  deﬁne 

if   ±f (x)  ≥ 0 
if  ±f (x)  < 0 
for  the  same  sign  throughout.  Then  (1.6)   holds.  Observe  that   f+  is  
continuous  at  each  y ∈ X since,  with  U an  appropriate  neighborhood 
of  y ,  in  each  case 
f (y)  > 0 = ⇒ f (x)  > 0  for   x ∈ U = 
⇒
f (y)  < 0 = ⇒ f (x)  < 0  for   x ∈ U = 
⇒
f+  = 0  in  U
f (y) = 0   = ⇒  given   � > 0  ∃ U s.t.  f (x)| < � in   U
|
⇒ |
f+ (x)| < � in   U . 
= 
Thus  f =  f − f
+  ∈ C
0 (X ),   since  both  f+  and  f−  vanish   at  inﬁnity.  �
− 
We  can  similarly  split  elements   of  the  dual  space  into  positive  and 
negative  parts  although  it  is  a  little  bit   more  delicate.  We  say  that 
u ∈ (C
0 (X ))�  is  positive  if 
u(f )  ≥ 0  ∀ 0  ≤ f ∈ C0 (X ) . 
(1.7) 
For  a   general   (real)  u ∈ (C0 (X ))�  and  for   each   0  ≤ f ∈ C0 (X )  set 
g ∈ C
0 (X ) , 0  ≤ g(x)  ≤ f (x)  ∀ x ∈ X } .
u+ (f )  =  sup  {u(g) ; 
(1.8) 

f+  =  f in   U

7 
LECTURE  NOTES  FOR  18.155,   FALL  2004 
This  is  certainly  ﬁnite  since  u(g)  ≤  C �g�∞  ≤  C �f �∞ .  Moreover,  if  
0  < c  ∈  R  then  u+ (cf ) =  cu+ (f )  by  inspection.  Suppose  0  ≤  fi  ∈ 
C
gi  ∈  C
0 (X )  for  i  = 1, 2.   Then  given  � >  0  there  exist  
0 (X )  with
0  ≤ gi (x)  ≤ fi (x)  and 

u+ (fi )  ≤ u(gi ) +  � . 
It  follows  that  0   ≤ g(x)  ≤ f1 (x) +  f2 (x)  if  g =  g1  +  g2  so 
u+ (f1  +  f2 )  ≥ u(g) =  u(g1 ) +  u(g2 )  ≥ u+ (f1 ) +  u+ (f2 ) − 2� . 

Thus 
u+ (f1  +  f2 ) ≥ u+ (f1 ) +  u+ (f2 ).  
Conversely,  if  0  ≤  g(x)  ≤  f1 (x) +  f2 (x)  set  g1 (x)  =  min(g , f1 )  ∈ 
0 (X )  and  g2  =  g − g1 .  Then   0  ≤  gi  ≤  fi  and  u+ (f1 ) +  u+ (f2 )  ≥
C
u(g1 ) +  u(g2 ) =  u(g).  Taking  the  supremum  over  g ,  u+ (f1  +  f2 )  ≤ 
u+ (f1 ) +  u+ (f2 ),  so  we  ﬁnd  
(1.9) 
u+ (f1  +  f2 ) =  u+ (f1 ) +  u+ (f2 ) . 
Having   shown  this  eﬀective  linearity  on  the  positive  functions  we  can  
obtain  a  linear  functional  by  setting 
u+ (f ) =  u+ (f+ ) − u+ (f
− )  ∀ f  ∈ C
(1.10) 
0 (X ) .
Note  that  (1.9)  shows  that  u+ (f ) =  u+ (f1 ) − u+ (f2 )  for   any  decom­
posiiton  of  f  =  f1  − f2  with  fi  ∈ C0 (X ), both   positive.  [Since  f1  + f = −
f2  +  f+  so  u+ (f1 ) +  u+ (f− ) =  u+ (f2 ) +  u+ (f+ ).] Moreover, 
u+ (f ) ≤ max(u+ (f+ ), u(f
− ))   ≤ �u� �f �∞ 
|
|
⇒ �u+� ≤ �
u� .
= 

The  functional  
u =  u+  − u
− 
is  also  positive,  since  u+ (f )  ≥  u(f )  for   all  0  ≤  f  ∈  C0 (x).  Thus  we 
have  proved 
Lemma  1.5.  Any  element  u ∈ (C0 (X ))�  can  be  decomposed, 
u =  u+  − u− 
into   the  diﬀerence   of   positive  elements  with 
u+� ,  �
�
u� .
−� ≤ �
u
The  idea   behind  the   deﬁnition  of  u+  is   that  u  itself  is,  more  or  less, 
“integration  against  a  function”  (even  though   we  do  not  know  how  to 
interpret  this  yet).  In  deﬁning  u+  from  u  we  are  eﬀectively  throwing 
away   the  negative  part  of  that  ‘function.’  The  next   step  is   to  show  that 
a  positive   functional   corresponds   to  a  ‘measure’  meaning  a  function  

8 

χE (x) =

RICHARD  B.  MELROSE 
� 
measuring   the  size  of  sets.  To  deﬁne   this   we  really  want  to  evaluate  u 
on  the   characteristic   function  of  a  set 
if  x ∈ E 
1 
if  x  /∈ E . 
0 
The  problem  is  that  χE  is   not  continuous. 
Instead  we  use   an   idea 
similar  to  (1.8). 
If  0  ≤ u ∈ (C0 (X ))�  and  U ⊂ X is   open,  set1 
(1.11)  µ(U )  =  sup  {u(f ) ; 0  ≤ f (x) ≤ 1, f ∈ C0 (X ) , supp(f ) � U } . 
Here  the  support  of  f ,  supp(f ),   is  the  closure  of  the  set   of  points  where  
f (x)  =  0.  Thus   supp(f )  is   always   closed,  in  (1.11)   we  only  admit  f  if 
its  support  is  a  compact  subset   of   U.  The  reason  for   this  is  that,  only 
then  do  we  ‘really  know’   that  f ∈ C0 (X ).  
Suppose  we  try  to  measure  general  sets  in  this  way.  We  can  do  this 
by  deﬁning  

µ∗ (E ) =  inf  {µ(U ) ;  U ⊃ E , U  open} . 
(1.12) 
Already  with   µ it  may  happen  that  µ(U ) =  ∞,  so  we  think  of 
µ∗  :  P (X ) → [0, ∞] 
(1.13) 
as  deﬁned  on  the  power  set  of  X  and  taking  values  in  the  extended  
positive   real   numbers. 
Deﬁnition  1.6.  A  positive  extended  function,   µ∗ , deﬁned  on  the  power  
set  of  X  is  cal led  an  outer  measure  if  µ∗ (∅)  = 0,  µ∗ (A)  ≤  µ∗ (B ) 

  � 
whenever   A ⊂ B and 
µ(Aj )  ∀  {Aj }∞
j=1  ⊂ P (X )
µ∗ (  Aj )  ≤ 
(1.14) 
j 
j
Lemma  1.7.  If  u  is  a  positive  continuous   linear   functional  on   C0 (X ) 
then  µ∗ ,  deﬁned   by  (1.11),  (1.12)  is  an  outer  measure. 
To  prove  this  we  need   to  ﬁnd  enough  continuous   functions.  I  have 
in  a  local ly  compact  metric  space  and  K � N  Ui  is  a  compact  subset, 
relegated  the  proof  of  the  following  result   to  Problem  2. 
Lemma  1.8.  Suppose  Ui , i = 1, . . . , N is  ,a  ﬁnite  col lection  of  open  sets  
then  there   exist  continuous   functions  fi  ∈  C (X )  with  0  ≤  fi  ≤  1, 
i=1 
� 
supp(fi ) � Ui  and 
(1.15) 
fi  = 1  in  a  neighborhood  of  K . 
i 

.

1See [5]  starting  p.42  or [1]   starting  p.206. 

�
9 

 
LECTURE  NOTES  FOR  18.155,   FALL  2004 
Proof  of  Lemma   1.7.  We  have  to  prove  (1.14).  Suppose  ﬁrst   that   the 
Ai .  If  f  ∈ C (X )  and   supp(f )  � A  then
Ai  are  open,  then  so  is  A  = 
� 
i 
supp(f ) is  covered  by a  ﬁnite   union   of  the  Ai s.   Applying  Lemma  1.8  we 
�  � 
can  ﬁnd  fi ’s,  all  but  a  ﬁnite  number  identically  zero,  so  supp(fi )  � Ai 
� 
i  fi  = 1  in  a  neighborhood   of  supp(f ).  
and 
Since  f  = 
i  fif  we  conclude  that 
u(fif ) = ⇒ µ∗ (A)   ≤ 
µ∗ (Ai ) 
u(f ) = 
i 
i
since  0  ≤ fif  ≤ 1  and  supp(fif )  � Ai . 

  � 

 
In  the  general  case  if  
Thus  (1.14)  holds   when   the  Ai  are  open.  
Ai  ⊂ Bi  with  the   Bi  open  then,  from  the  deﬁnition, 
µ∗ (  Ai )  ≤ µ∗ (  Bi )  ≤ 
µ∗ (Bi ) . 
i 
i 
i
Taking  the  inﬁmum  over  the  Bi  gives  (1.14)  in  general. 

� 

10  

RICHARD  B.  MELROSE 

�

2.   Measures  and  σ­algebras 
An  outer  measure  such   as   µ∗  is   a  rather   crude  ob ject  since,  even  
if  the  Ai  are  disjoint,  there  is  generally  strict   inequality  in   (1.14).  It 
turns  out  to  be  unreasonable  to  expect  equality  in  (1.14),  for   disjoint 
unions,   for  a  function  deﬁned  on  al l  subsets   of  X . We  therefore  restrict  
attention  to  smaller  collections   of  subsets. 
Deﬁnition  2.1.  A  col lection   of  subsets  M of  a  set  X  is  a  σ ­algebra  if 
(2)  E  ∈ M = ⇒ E C  =  
(1)  φ,   X  ∈ M 
X \E  ∈ M 
(3)  {Ei}∞
i=1   ⊂ M = ⇒ 
i=1  Ei  ∈ M
∞
.
For  a  general  outer  measure  µ∗  we  deﬁne  the  notion   of  µ∗ ­measurability 
of  a  set. 
Deﬁnition  2.2.  A  set  E  ⊂ X  is  µ∗ ­measurable  (for   an  outer  measure  
µ∗  on  X )  if 
)  ∀ A  ⊂ X . 
µ∗ (A) =  µ∗ (A  ∩ E ) +  µ∗ (A   ∩ E
(2.1) 
Proposition  2.3.  The  col lection  of  µ∗ ­measurable  sets  for  any  outer 

measure  is  a   σ ­algebra.

Proof.  Suppose  E  is  µ∗ ­measurable,  then  E C  is   µ∗ ­measurable  by  the

symmetry	 of  (2.1).  
Suppose  A,   E  and  F  are  any  three  sets.  Then  
A  ∩ (E  ∪ F )  = (A  ∩ E  ∩ F ) ∪ (A  ∩ E  ∩ F C ) ∪ (A   ∩ E C  ∩ F ) 
A  ∩ (E  ∪ F )C  =  A  ∩ E C  ∩ F C  . 
From  the  subadditivity  of  µ∗ 
µ∗ (A  ∩ (E  ∪ F ))  +  µ∗ (A  ∩ (E   ∪ F )C )

≤ µ∗ (A  ∩ E  ∩ F ) +  µ∗ (A  ∩ E  ∪ F C )

+  µ∗ (A   ∩ E C  ∩ F ) +  µ∗ (A  ∩ E C  ∩ F C ).  
Now,  if  E  and  F  are  µ∗ ­measurable  then  applying  the  deﬁnition   twice, 
for  any  A,  
µ∗ (A) =  µ∗ (A  ∩ E  ∩ F ) +  µ∗ (A   ∩ E  ∩ F C ) 
+  µ∗ (A  ∩ E C  ∩ F ) +  µ∗ (A   ∩ E C  ∩ F C ) 
≥ µ∗ (A   ∩ (E   ∪ F ))   +  µ∗ (A  ∩ (E   ∪ F )C ) . 
The  reverse  inequality  follows  from  the  subadditivity  of  µ∗ ,  so  E  ∪ F 
is  also   µ∗ ­measurable. 

 

LECTURE  NOTES  FOR  18.155,   FALL  2004 
11 
If  {Ei}∞
is  a  sequence  of  disjoint  µ∗ ­measurable  sets,  set   Fn  = 
∞
i=1  
n  Ei  and  F  = 
Ei .  Then  for   any  A,
i=1 	
i=1  
µ∗ (A  ∩ Fn ) =  µ∗ (A   ∩ Fn  ∩ En ) +  µ∗ (A   ∩ Fn  ∩ E C 
n  ) 
=  µ∗ (A  ∩ En ) +  µ∗ (A   ∩ Fn−1 ) . 
� 
Iterating   this  shows  that 
n
µ∗ (A  ∩ Ej ) . 
µ∗ (A  ∩ Fn ) = 
j=1 
From  the  µ∗ ­measurability  of  Fn  and  the  subadditivity  of  µ∗ , 
� 
µ∗ (A) =  µ∗ (A  ∩ Fn ) +  µ∗ (A   ∩ Fn
C ) 
n
≥ 
µ∗ (A   ∩ Ej ) +  µ∗ (A   ∩ F C ) .
j=1 
� 
Taking  the  limit  as  n  → ∞ and  using  subadditivity,  
∞
µ∗ (A)  ≥ 
µ∗ (A  ∩ Ej ) +  µ∗ (A  ∩ F C ) 
j=1 
≥ µ∗ (A  ∩ F ) +  µ∗ (A   ∩ F C )  ≥ µ∗ (A)  
proves  that  inequalities  are  equalities,  so  F  is   also  µ∗ ­measurable. 

 


In  general,  for   any  countable  union  of  µ∗ ­measurable  sets, 
�
∞
∞
j=1  �
�C
Aj  = 
Aj  , 

 

 
�
j=1 
j−1
j−1
Aj  =  Aj \  Ai  =  Aj  ∩ 
Ai 
is  µ∗ ­measurable  since  the  �Aj  are  disjoint. 
i=1 
i=1 
� 
A  measure  (sometimes  called   a  positive  measure ) is  an  extended   func­
tion  deﬁned  on  the   elements  of  a  σ ­algebra  M: 
µ  :  M → [0,  ∞] 
� 
 
� 
� 
µ(∅)  = 0  and 
∞
∞
Ai  = 
µ(Ai )
µ
i=1 
i=1 
if  {Ai}∞
i=1  ⊂ M and  Ai  ∩ Aj  =  φ  i  =  j. 

such that  
(2.3)	

(2.2) 

(2.4)	

�
(2.5) 

.

12  
RICHARD  B.  MELROSE 
E ∈ M
The  elements  of   M with  measure  zero,  i.e., 
,  µ(E )  =  0,  are 
supposed  to  be  ‘ignorable’.   The  measure  µ is   said  to  be  complete  if 
E ⊂ X and  ∃ F ∈ M , µ(F )  = 0 , E ⊂ F
⇒ E ∈ M
See  Problem  4. 
The  ﬁrst  part  of  the  following  important  result   due  to  Caratheodory 
was  shown  above.  
Theorem  2.4.  If  µ∗  is  an   outer  measure  on  X then   the  col lection   of 
µ∗ ­measurable  subsets  of   X is  a  σ ­algebra  and  µ∗  restricted  to  M is  a 
complete  measure. 
Proof.  We  have  already   shown   that  the   collection  of  µ∗ ­measurable 
subsets  of  X 
is  a  σ ­algebra.  To  see  the   second  part,  observe  that 

 
� 
taking   A =  F in  (2.2)  gives 
∞
µ∗ (Ej )  if  F = 
Ej 
j=1 
j
and  the  Ej  are  disjoint  elements  of  M.  This   is   (2.4).  
Similarly  if  µ∗ (E ) = 0 and  F ⊂ E then  µ∗ (F ) = 0.  Thus  it   is   enough  
to  show  that   for  any   subset  E ⊂ X, µ∗ (E )  =  0  implies   E ∈ M.  For  
any   A ⊂ X, using   the  fact   that   µ∗ (A ∩ E )  = 0, and  the  ‘increasing’ 
property  of  µ∗ 

µ∗ (F ) = 

µ∗ (A) ≤ µ∗ (A ∩ E ) +  µ∗ (A ∩ E ) 
C
=  µ∗ (A ∩ E )  ≤ µ∗ (A)  
C
shows  that  these  must  always  be  equalities,  so  E  ∈  M  (i.e.,  is   µ∗ ­
� 
measurable).  

Going   back  to  our  primary  concern,  recall  that   we  constructed  the 
outer  measure  µ∗  from  0   ≤ u ∈ (C0 (X ))�  using  (1.11)   and   (1.12).  For 
the  measure  whose  existence  follows  from  Caratheodory’s   theorem  to 
be   much  use  we  need  
Proposition  2.5.  If  0  ≤ u ∈ (C0 (X ))� ,  for  X a  local ly  compact  met­
ric  space,  then   each  open  subset  of  X is  µ∗ ­measurable  for   the  outer 
measure  deﬁned  by  (1.11)  and  (1.12)  and  µ in  (1.11)  is  its  measure. 
Proof.  Let  U ⊂ X be   open. We  only  need   to  prove  (2.1)  for  all  A ⊂ X 
with  µ∗ (A)  < ∞. 2 

2Why? 

LECTURE  NOTES  FOR  18.155,   FALL  2004 
13 
.  Then  A ∩ U  is
Suppose  ﬁrst  that  A ⊂ X is   open   and   µ∗ (A)  
< ∞
open,  so  given   � > 0  there  exists  f  ∈  C (X )  supp(f )  �  A ∩ U  with 
0  ≤ f ≤ 1  and 

µ∗ (A ∩ U ) =  µ(A ∩ U )  ≤ u(f ) +  � . 
Now,   A\ supp(f )  is  also   open,  so  we  can  ﬁnd  g  ∈  C (X ) , 0  ≤  g  ≤
1 , supp(g) � A\ supp(f )  with 
µ∗ (A\ supp(f ))   =  µ(A\ supp(f ))   ≤ u(g) +  � . 

Since 

A\ supp(f )  ⊃ A ∩ U C  , 0  ≤ f +  g ≤ 1 , supp(f +  g)  � A , 
µ(A)  ≥ u(f +  g) =  u(f ) +  u(g) 
> µ∗ (A ∩ U ) +  µ∗ (A ∩ U C ) − 2� 
≥ µ∗ (A) − 2� 
↓
using   subadditivity  of  µ∗ . Letting  �
0  we  conclude  that 
µ∗ (A) ≤ µ∗ (A ∩ U ) +  µ∗ (A ∩ U C ) ≤ µ∗ (A) =  µ(A) . 
This  gives  (2.1)  when  A is  open. 
In  general,   if  E ⊂ X and  µ∗ (E )  < ∞  then  given  � > 0  there  exists  
A ⊂ X open  with  µ∗ (E )  > µ∗ (A) − �.   Thus, 
µ∗ (E )  ≥ µ∗ (A ∩ U ) +  µ∗ (A ∩ U C ) − � 
≥ µ∗ (E ∩ U ) +  µ∗ (E ∩ U C ) − � 
≥ µ∗ (E ) − � . 
This  shows  that   (2.1)  always  holds,  so  U is   µ∗ ­measurable  if  it   is  open. 
� 
We  have  already  observed  that  µ(U ) =  µ∗ (U )  if  U is   open. 
Thus  we   have  shown  that  the  σ ­algebra  given  by  Caratheodory’s 
theorem  contains  all   open  sets.  You  showed  in   Problem  3  that   the 
intersection  of  any  collection   of   σ ­algebras  on   a  given  set  is  a  σ ­algebra. 
Since  P (X )  is  always  a   σ ­algebra  it  follows  that  for   any  collection 
� 
E  ⊂ P (X )  there   is  always  a  smallest  σ ­algebra  containing  E ,  namely 
, M ⊂ P (X )} . 
ME 
{M ⊃ E ;  M is   a  σ ­algebra
= 
The  elements  of  the   smallest  σ ­algebra  containing  the  open  sets  are 
called  ‘Borel  sets’.   A  measure  deﬁned   on   the  σ ­algebra  of  all  Borel  sets 
is  called  a  Borel  measure.  This  we  have  shown: 
Proposition  2.6.  The  measure  deﬁned  by  (1.11),  (1.12)  from  0  ≤ u ∈ 
(C
0 (X ))�  by  Caratheodory’s  theorem  is  a  Borel  measure. 
Proof.  This  is  what  Proposition  2.5  says!  See  how  easy  proofs   are.  � 

14  

RICHARD  B.  MELROSE 

We  can  even  continue  in  the  same  vein.  A  Borel  measure  is   said   to 
be  outer  regular  on  E ⊂ X if 
µ(E )  =  inf  {µ(U ) ;   U ⊃ E , U open} . 
(2.6) 
Thus  the   measure  constructed   in   Proposition  2.5  is  outer  regular  on   all 
Borel  sets!   A  Borel  measure  is  inner  regular  on  E if 
µ(E )  =  sup  {µ(K ) ;   K ⊂ E , K compact} . 
Here  we  need  to   know   that   compact   sets   are  Borel  measurable.  This  
is  Problem  5. 

(2.7) 

Deﬁnition  2.7.  A  Radon  measure  (on  a  metric  space)  is   a  Borel  mea­
sure  which  is  outer   regular  on  al l  Borel   sets,  inner  regular  on  open   sets 
and  ﬁnite  on  compact  sets. 
Proposition  2.8.	 The  measure  deﬁned  by  (1.11),  (1.12)  from  0  ≤ u ∈ 
(C
0 (X ))�  using  Caratheodory’s  theorem  is  a  Radon  measure.  
Proof.  Suppose  K ⊂ X is  compact.  Let   χK  be  the  characteristic  func­
tion  of  K , χK  = 1 on  K , χK  = 0 on  K C .  Suppose  f ∈ C0 (X ) , supp(f ) � 
X and  f ≥ χK .  Set 

} 
U�  =  x ∈ X ;  f (x)  > 1  − �
{
where  � > 0  is  small.   Thus   U�  is   open,  by  the  continuity  of  f  and 
contains  K .  Moreover,  we  can  choose  g ∈ C (X ) , supp(g)  �  U�  , 0  ≤ 
g ≤ 1  with  g = 1  near3  K .  Thus,  g ≤ (1  − �)−1f and  hence 
µ∗ (K )  ≤ u(g) = (1  − �)−1 u(f ) . 
Letting  � ↓ 0,   and  using   the  measurability  of  K , 
µ(K )  ≤ u(f ) 
⇒ µ(K ) =  inf  {u(f ) ;   f ∈ C (X ) , supp(f )  � X , f ≥ χK } . 
In  particular  this   implies  that   µ(K )  < ∞ if  K � X ,  but  is   also  proves 
� 
(2.7). 

Let  me  now  review  a  little  of  what  we  have  done.  We  used   the 
positive  functional   u to  deﬁne  an   outer  measure  µ∗ ,  hence  a  measure 
µ and  then  checked  the  properties   of  the  latter. 
This  is  a   pretty  nice  scheme;  getting  ahead  of   myself  a  little,  let   me 
suggest  that  we  try  it  on   something  else. 

3Meaning  in   a  neighborhood   of  K. 

(2.8)	

Q = 

(2.10)	

LECTURE  NOTES  FOR  18.155,   FALL  2004	
15 
Let  us  say  that   Q ⊂  Rn  is   ‘rectangular’  if  it  is  a  product   of  ﬁnite 
� 
intervals  (open,  closed   or   half­open) 
n
(or[ai  , bi ]or)   ai  ≤ bi 
i=1 
� 
we  all  agree  on  its  standard   volume: 
n
(bi  − ai )  ∈  [0, ∞) . 
(2.9)	
v(Q) =
i=1 
Clearly  if  we  have  two  such  sets,  Q1  ⊂  Q2 ,  then   v(Q1 )  ≤  v(Q2 ).   Let 
� 
�	
� 

 
us  try  to   deﬁne  an   outer  measure   on  subsets  of   Rn  by 
∞
∞
v(Qi ) ;  A ⊂  Qi ,  Qi  rectangular  
v ∗ (A)  =  inf 
i=1 
i=1 
We  want   to  show  that  (2.10)  does   deﬁne  an  outer  measure.  This  is 
 
pretty  easy;   certainly  v(∅)  = 0. Similarly  if  {Ai}∞
i=1  are  (disjoint)   sets 
and  {Qij }∞
� � 
is  a  covering  of   Ai  by  open   rectangles  then   all   the  Qij
i=1  
together  cover  A = 
Ai  and
i 
v ∗ (A)   ≤ 
� 
v(Qij ) 
i
j  
⇒ v ∗ (A)  ≤ 
v ∗ (Ai ) . 
i 
So  we  have  an  outer  measure.  We  also  want 
Lemma  2.9.  If  Q is  rectangular   then  v ∗ (Q) =  v(Q).  
Assuming  this,  the  measure  deﬁned   from  v ∗  using  Caratheodory’s 
theorem  is  called  Lebesgue  measure.  

. 

Proposition  2.10.   Lebesgue  measure  is  a  Borel  measure. 

To  prove  this  we  just   need   to  show   that  (open)   rectangular   sets  are 
v ∗ ­measurable.  

16  

RICHARD  B.  MELROSE 

(3.1) 

(3.3) 

(3.4) 

3.   Measureability  of  functions  
Suppose  that  M is  a  σ ­algebra  on  a  set   X 4  and  N  is   a  σ ­algebra  on 
another  set  Y .  A  map  f  :  X  → Y  is   said  to  be  measurable  with  respect  
to  these   given  σ ­algebras  on  X  and  Y 
if 
f −1 (E ) ∈ M ∀ E  ∈ N . 
Notice  how  similar  this  is  to  one  of  the  characterizations   of  continuity 
for  maps  between  metric   spaces   in  terms  of  open   sets. 
Indeed  this 
analogy   yields  a   useful   result. 
� 
Lemma  3.1.  If  G  ⊂ N  generates  N ,  in  the   sense  that 
{N
N 
� ; N �  ⊃ G,  N �  a  σ ­algebra}
(3.2) 
= 
then  f  :  X  −→ Y  is  measurable  iﬀ  f −1 (A)   ∈ M for  al l  A  ∈ G. 
Proof.  The  main   point   to  note  here   is   that  f −1  as  a  map   on   power  
→ 
sets,  is  very  well  behaved   for   any  map.  That  is  if   f  :  X
Y  then 
f −1  :  P (Y  ) → P (X ) 
satisﬁes:
� 
� 
f −1 (E C ) = (f −1 (E ))C 

 


∞
∞
f −1 (Ej ) 
� � 
� 
Ej  = 
� 
j=1 
j=1 
∞
∞
f −1 (Ej ) 
Ej  = 
j=1 
j=1 
f −1 (φ) =  φ ,  f −1 (Y   ) =  X . 
Putting  these  things  together  one  sees  that   if  M  is   any  σ ­algebra  on 
� 
� 
X  then 
f∗ (M) =  E  ⊂ Y  ; f −1 (E )  ∈ M 
is  always  a  σ ­algebra   on  Y . 
In  particular  if   f −1 (A)  ∈ M for  all  A  ∈ G  ⊂ N  then  f∗ (M)  is   a  σ ­
algebra   containing   G,  hence  containing  N  by the  generating  condition.  
Thus  f −1 (E ) ∈ M for  all  E  ∈ N  so  f  is   measurable. 
� 
→
Proposition  3.2.  Any  continuous  map  f 
Y   between  metric
:  X
spaces  is  measurable  with  respect  to  the  Borel  σ ­algebras  on   X  and  Y . 

f −1 

f −1 

4Then   X,   or  if  you  want  to  be   pedantic  (X,  M),  is  often  said   to   be   a  measure 
space   or  even  a  measurable   space. 

LECTURE  NOTES  FOR  18.155,   FALL  2004 
17 
Proof.  The  continuity   of  f  shows  that   f −1 (E )  ⊂  X  is   open   if  E  ⊂  Y 
is  open.  By  deﬁnition,  the  open  sets   generate  the  Borel  σ ­algebra  on 
Y  so  the   preceeding  Lemma  shows  that   f  is   Borel  measurable  i.e., 
f −1 (B(Y ))   ⊂ B(X ).  

� 
We  are  mainly  interested  in  functions   on  X.   If  M  is   a  σ ­algebra 
→
R  is  measurable  if  it  is  measurable  with  respect 
on  X  then  f  :  X 
to  the   Borel  σ ­algebra   on   R  and  M  on  X.   More  generally,  for  an  
→  −∞, ∞
extended  function  f  :  X 
[
]  we  take  as  the  ‘Borel’   σ ­algebra 
in [−∞,  ∞] the   smallest  σ ­algebra  containing  all  open  subsets  of  R and 
all  sets  (a,  ∞]  and [−∞,  b);  in  fact  it   is  generated   by  the   sets  (a,  ∞]. 
(See  Problem   6.)  
Our  main  task  is   to   deﬁne  the  integral  of   a  measurable  function:  we 
� 
start  with  simple  functions.  Observe  that  the  characteristic  function 
of  a  set 
1  x  ∈ E 
0  x  /∈ E 
χE  =
is  measurable  if  and  only   if  E  ∈ M.  More  generally  a  simple  function, 
� 
N
aiχEi ,  ai  ∈ R 
i=1 

(3.5)	

f  = 

is  measurable  if  the   Ei  are  measurable.  The  presentation,  (3.5),  of  a 
simple  function  is  not  unique.  We   can  make  it  so,  getting  the  minimal 
presentation,  by  insisting   that  all  the  ai  are  non­zero  and  
Ei  =  {x  ∈ E  ;  f (x) =  ai} 
then  f  in  (3.5)  is  measurable  iﬀ  all  the  Ei  are  measurable. 
The  Lebesgue  integral   is   based  on  approximation   of  functions  by 
simple  functions,   so  it  is  important  to  show  that   this  is  possible. 

Proposition  3.3.  For  any  non­negative  µ­measurable  extended  func­
:  X  −→  [0, ∞]  there  is  an  increasing  sequence  fn  of  simple 
tion  f 
measurable  functions  such  that  limn→∞ fn (x) =  f (x)  for  each  x  ∈  X 
and  this  limit  is  uniform   on   any  measurable  set   on  which  f  is  ﬁnite. 

Proof.  Folland  [1]  page  45  has  a  nice  proof.  For  each  integer  n  >  0  and 
0  ≤ k  ≤ 22n  − 1,   set 
En,k  =  {x  ∈ X ; 2−nk  ≤ f (x)  <  2−n (k  +  1)}, 
E � =  {x  ∈ X ; f (x)  ≥ 2n}.
n 

18  

(3.6) 

RICHARD  B.  MELROSE 
These  are  measurable  sets.  On   increasing  n  by  one,  the  interval  in  the 
� 
deﬁnition  of  En,k  is  divided   into  two.  It   follows  that  the  sequence  of 
simple  functions  
2−nkχEk,n  +  2nχE �
n 
k 
is  increasing  and  has  limit  f  and  that  this   limit   is  uniform  on  any 
� 
measurable  set   where  f  is   ﬁnite. 

fn  =

19 

(4.2) 

gdµ 

LECTURE  NOTES  FOR  18.155,   FALL  2004 
4.  Integration 
� 
� 
The  (µ)­integral  of  a  non­negative  simple  function   is  by  deﬁnition 
aiµ(Y   ∩ Ei ) ,  Y  ∈ M . 
(4.1) 
f dµ  = 
Y
i 
Here  the   convention  is  that   if  µ(Y   ∩ Ei ) =  ∞ but  ai  = 0  then  ai  µ(Y   ∩
·
Ei )  =  0.  Clearly  this  integral  takes  values  in   [0, ∞].  More  signiﬁcantly, 
if  c  ≥ 0  is  a  constant and  f  and  g are  two  non­negative  (µ­measurable) 
� 
� 
simple   functions  then  
� 
� 
� 
cf dµ  =  c 
f dµ 
Y 
Y 
�  Y 
�  Y 
f dµ + 
(f  +  g)dµ  = 
Y 
f dµ  ≤ 
0  ≤ f  ≤ g  ⇒ 
g dµ . 
Y
Y 
(See  [1]  Proposition  2.13  on   page  48.) 
To  see   this,  observe  that   (4.1)  holds  for  any  presentation   (3.5)  of  f 
with  all  ai  ≥ 0.   Indeed,   by  restriction  to  Ei  and  division  by  ai  (which  
� 
can  be  assumed  non­zero)  it  is  enough  to  consider  the  special  case 
bj χFj . 
j 
The  Fj  can  always  be  written  as   the  union   of  a  ﬁnite  number,  N � , 
∪
�  � 
� 
l∈Sj Gl  where  j  = 1, . . . , N  and
of  disjoint  measurable  sets,  Fj  = 
Sj  ⊂ {1, . . . , N � .  Thus 
}
� 
µ(Gl ) =  µ(E ) 
bj µ(Fj ) = 
bj 
l∈Sj 
j
j 
{j ;l∈Sj }  bj  = 1   for   each  j. 
since 
From  this  all  the  statements   follow  easily. 
Deﬁnition  4.1.  For  a  non­negative  µ­measurable  extended  function 
f  :  X  −→ [0, ∞]  the  integral  (with  respect  to  µ)  over  any  measurable 
� 
� 
set  E  ⊂ X  is 
f dµ  = sup{  hdµ;  0  ≤ h ≤ f ,   h  simple  and  measurable.}
� 
E
E 
By  taking  suprema,  E  f dµ  has  the  ﬁrst   and   last  properties   in   (4.2). 
It  also  has  the  middle  property,  but   this  is  less   obvious. To  see  this,  we 
shall   prove  the  basic   ‘Monotone  convergence  theorem’  (of  Lebesgue). 
Before  doing   so  however,   note  what   the  vanishing  of  the  integral  means. 

χE  = 

(4.3) 

� 
20 	
RICHARD  B.  MELROSE 
Lemma  4.2.  If  f  :  X  −→  [0,  ∞]  is  measurable  then  E  f dµ  = 0  for  a 
measurable  set  E  if  and  only  if 
{x  ∈ E ; f (x)  >  0}  has   measure  zero. 
� 
Proof.  If  (4.4)   holds,  then  any  positive  simple  function   bounded  above 
by  f  must  also   vanish  outside   a   set   of   measure  zero,  so  its  integral  must  

 
be  zero   and  hence  E  f dµ  = 0.  Conversely,  observe  that  the  set   in  (4.4) 
can  be  written  as 
{x  ∈ E ; f (x)  >  1/n}. 
En  = 
n 
� 
Since  these  sets  increase  with   n,  if  (4.4)   does  not   hold  then   one  of  these 
must  have  positive  measure.  In   that   case  the  simple  function  n−1χEn 
� 
has  positive  integral   so	 E  f dµ  >  0. 
Notice  the  fundamental  diﬀerence  in   approach  here  between   Rie­
mann  and  Lebesgue   integrals.  The  Lebesgue  integral,  (4.3),  uses  ap­
proximation  by  functions  constant   on  possibly  quite  nasty  measurable 
sets,  not  just   intervals  as  in   the  Riemann   lower  and   upper  integrals. 
Theorem   4.3  (Monotone  Convergence).  Let  fn  be  an   increasing  se­
� 
� 
quence  of  non­negative  measurable  (extended)  functions,  then  f (x) = 
limn→∞ fn (x)  is  measurable  and 
(4.5)	
f dµ  =  lim 
n→∞  E 
E
for   any  measurable  set  E  ⊂ X.  

 
Proof.  To  see  that  f  is  measurable,   observe  that  
f −1 (a,  ∞].
f −1 (a,  ∞] = 
(4.6)	
n 
n 
Since  the   sets  (a,  ∞]  generate  the  Borel  σ ­algebra  this  shows  that  f  is  
measurable. 
So  we   proceed  to  prove  the  main  part   of  the  proposition,  which  
� 
� 
�	
is  (4.5).  Rudin  has  quite  a  nice  proof  of  this,  [5]  page  21.  Here  I 
paraphrase  it.   We  can   easily  see  from  (4.1)   that 
fndµ  ≤ 
α  = sup 
fndµ  =  lim 
f dµ. 
n→∞  E
E
E 
 
Given  a  simple  measurable   function  g  with  0  ≤  g  ≤  f  and  0  <  c  <  1 
consider  the  sets  En  =  {x  ∈ E ; fn (x)  ≥  cg(x)}.  These  are  measurable 
� 
� 
�  n 
� 
and  increase  with  n.  Moreover  E  = 
En .  It  follows  that 
fndµ  ≥ 
fndµ  ≥ c 
aiµ(En  ∩ Fi ) 
En 
E
En 
i 

gdµ  = 

fndµ 

(4.4) 

(4.7)	

21 

f dµ. 

gdµ  = 

(f  +  g)dµ  = 

� 
LECTURE  NOTES  FOR  18.155,   FALL  2004 
in  terms  of  the  natural   presentation   of  g  = 
aiχFi .  Now,  the  fact  
i 
that   the   En  are  measurable  and  increase  to  E  shows  that 
� 
µ(En  ∩ Fi )  → µ(E   ∩ Fi ) 
� 
as  n  →  ∞. 
as  n  →  ∞.  Thus  the  right   side  of  (4.7)   tends  to   c  E  gdµ 
Hence  α  ≥ c  E  gdµ  for  all  0  < c  <  1.  Taking  the  supremum  over   c  and 
� 
� 
� 
then  over  all  such  g  shows   that  
fndµ  ≥ sup 
α  =  lim 
n→∞  E 
E 
E
� 
They  must  therefore   be   equal. 
Now  for  instance  the  additivity  in   (4.1)   for   f  ≥  0  and  g  ≥  0  any 
� 
� 
measurable  functions  follows  from  Proposition   3.3.  Thus  if  f  ≥  0  is  
measurable  and  fn  is  an  approximating  sequence  as   in  the  Proposition 
then  E  f dµ  =  limn→∞ 
fndµ.  So  if  f  and  g  are  two  non­negative 
measurable  functions  then  fn (x) +  gn (x)  ↑  f  +  g(x)  which  shows   not 
E 
� 
� 
� 
only   that  f  +  g  is  measurable  by  also  that 
E 
E
E 
As  with  the  deﬁnition  of  u+  long  ago,  this  allows  us  to  extend  the 
deﬁnition  of  the  integral  to   any  integrable  function. 
−∞,  ∞
Deﬁnition  4.4.  A  measurable  extended  function  f  :  X  −→  [
]
� 
� 
� 
is  said  to  be  integrable  on  E  if  its  positive  and  negative  parts  both  have 
ﬁnite  integrals  over  E ,  and  then  
f+dµ  − 
f−dµ. 
f dµ  = 
E 
E 
E
Notice  if  f  is  µ­integrable  then  so  is   |f |.  One  of  the  ob jects   we   wish 
to  study   is  the  space   of  integrable   functions.  The  fact  that   the  integral 
of  |f |  can  vanish  encourages   us  to  look  at   what   at  ﬁrst   seems   a  much 
more  complicated  ob ject.  Namely  we  consider   an  equivalence  relation 
between  integrable  functions 
f1  ≡ f2  ⇐⇒ µ({x  ∈ X ; f1 (x) 
�=  f2 (x)}) = 0. 
� 
� 
� 
� 
That   is  we  identify   two   such  functions  if  they  are  equal  ‘oﬀ  a  set  of 
measure  zero.’  Clearly   if  f1  ≡ f2  in   this   sense  then  
f1 |dµ  = 
|
|
f2 |dµ  = 0,
f1dµ  = 
f2dµ.
X
X 
X
X 
A  necessary  condition  for   a  measurable  function   f  ≥  0  to  be  inte­
grable  is 
∞} = 
µ{x  ∈ X ; f (x) = 

f dµ  + 

gdµ. 

(4.8) 

0.

22  
RICHARD  B.  MELROSE 
Let  E  be  the  (necessarily  measureable)   set   where  f  =  ∞.  Indeed,  if 
this  does  not  have  measure  zero,  then  the  sequence  of  simple  functions 
nχE  ≤  f  has  integral   tending  to  inﬁnity.   It   follows  that  each   equiva­
� 
lence   class  under   (4.8)   has  a  representative  which   is   an  honest  function, 
i.e.  which  is  ﬁnite  everywhere.   Namely  if  f  is   one  representative  then 
∈ E 
f (x)  x  /
x  ∈ E 
0 

f � (x) = 

is  also  a  representative. 
We  shall  denote  by   L1 (X,  µ) the  space  consisting  of  such  equivalence 
classes  of  integrable  functions.  This  is   a  normed  linear   space  as  I  ask 
you  to  show   in  Problem  11. 
The  monotone  convergence  theorem  often  occurrs  in   the  slightly  dis­
guised  form   of  Fatou’s  Lemma. 
� 
� 
Lemma  4.5   (Fatou).  If  fk  is  a  sequence  of  non­negative  integrable 
functions  then 

lim  inf  fn  dµ  ≤  lim  inf 
n→∞ 
n→∞ 

fn  dµ .  

Proof.  Set  Fk (x)  =  inf  n≥k  fn (x).  Thus  Fk  is   an  increasing  sequence  of 
non­negative  functions  with  limiting  function  lim  inf  n→∞ fn  and  Fk (x)  ≤
� 
� 
� 
fn (x) ∀  n  ≥ k .  By  the  monotone  convergence  theorem 
Fk (x) dµ  ≤  lim  inf 
lim  inf  fn  dµ  =  lim 
n→∞ 
n→∞ 
k→∞ 

fn  dµ. 

� 
We  further  extend  the  integral  to  complex­valued   functions,  just  say­
ing  that 
C→ 
f  :  X 
� 
� 
� 
is  integrable  if  its  real   and  imaginary  parts   are  both  integrable.  Then, 
by  deﬁnition,  
Im  f dµ 
f dµ  = 
Re  f dµ  +  i 
E
E 
E 
� �� �

� �� �

for  any  E  ⊂ X  measurable.   It   follows  that  if   f  is   integrable  then  so  is 
�

�

|
|
f .
Furthermore 
� �

E 
E 
This  is  obvious  if  E	 f  dµ  =  0,  and  if  not  then  
f  dµ  =  Re iθ  R >  0 ,  θ  ⊂  [0,  2π) . 
E 

|
|
f	 dµ .

f  dµ 

≤ 

23 

= 

= 

f  dµ 

=


f  dµ 

Then 

LECTURE  NOTES  FOR  18.155,   FALL  2004 
� �� �

� �� � 
� 
�

� �
�  � �

e−iθ
E 
E 
e−iθ f  dµ 
E 
Re(e−iθ f ) dµ 
� �

E 
� 
�

Re(e−iθ f )  dµ
� �
� �

E 
e−iθ f  dµ  = 
E 
E
The  other  important   convergence  result  for   integrals  is   Lebesgue’s  
Dominated   convergence  theorem. 
Theorem  4.6.  If  fn  is  a   sequence  of  integrable   functions,  fk  → f  a.e.5 
� 
� 
and   fn ≤ g  for   some  integrable  g  then   f  is  integrable  and 
|
| 

|
| 
f dµ

≤ 

≤ 

. 

f dµ  =  lim 
n→∞ 

fndµ .  

Proof.  First  we  can  make  the  sequence   fn (x)  converge  by  changing  all 
the  fn (x)’s  to   zero  on  a  set   of  measure  zero  outside  which   they  converge. 
This  does  not   change  the  conclusions.  Moreover,  it  suﬃces  to  suppose 
that  the  fn  are  real­valued.   Then   consider  
hk  =  g  − fk  ≥ 0 . 
Now,  lim  inf  k→∞ hk  =  g  − f  by  the   convergence  of   fn ;  in  particular   f 
� 
� 
� 
is  integrable.  By  monotone   convergence  and  Fatou’s  lemma 
� 
� 
lim  inf
 hk  dµ  ≤  lim  inf 
(g  − fk ) dµ 
(g  − f )dµ  = 
k→∞ 
k→∞ 
g dµ  − lim  sup 
k→∞ 
� 

� 
Similarly,  if  Hk 

fk  dµ .  
� 

= 

fk  dµ. 

g dµ  +  lim  inf 
k→∞ 
� 

f  dµ  ≤  lim  inf 
k→∞ 

fk  dµ. 

(g  +  f )dµ  = 

� 
=  g  +  fk  then  
lim  inf  Hk  dµ  ≤ 
k→∞ 
� 
� 

fk  dµ  ≤ 

lim  sup 
k→∞ 

It  follows  that 

5Means  on  the  complement  of  a   set   of  measure   zero. 

24  

Thus  in  fact 

� 
� 
RICHARD  B.  MELROSE 

fk  dµ  → 

f  dµ .  

� 
Having   proved  Lebesgue’s   theorem  of  dominated   convergence,  let  
me  use  it  to   show  something  important.  As  before,  let  µ  be  a  positive 
measure  on  X .  We  have  deﬁned   L1 (X, µ);  let  me  consider   the  more 
general  space  Lp (X, µ).  A  measurable  function  
C→ 
f  :  X 
� 
|
|
is  said  to  be  ‘Lp ’,   for  1  ≤ p  <  ∞,  if  f p  is   integrable6,  i.e., 
f p  dµ  <  ∞ .
|
|
X 
As  before  we  consider  equivalence  classes  of   such   functions  under  the 
equivalence  relation 
f  ∼ g  ⇔ µ {x; (f  − g)(x) = 0} = 0 . 
(4.9) 
linear  space  and   the   function  �� 
�1/p 
We  denote by   Lp (X, µ)  the   space  of  such  equivalence  classes.  It  is  a 
�f �p  = 
|f |p  dµ 
(4.10) 
X 
is  a  norm  (we  always  assume  1  ≤ p <  ∞,  sometimes  p = 1  is  excluded  
but  later  p  =  ∞  is  allowed).  It  is   straightforward   to  check  everything 
except  the  triangle  inequality.  For   this   we  start   with 
Lemma  4.7.  If  a  ≥ 0,  b  ≥ 0  and  0  <  γ <  1  then  
a γ b1−γ  ≤ γ a  +  (1  − γ )b  
(4.11) 
with  equality  only  when  a  =  b. 

Proof.  If  b  =  0   this  is  easy.   So  assume  b >  0  and   divide  by  b.  Taking 
t  =  a/b  we  must  show  
tγ  ≤ γ t   +  1  − γ ,  0  ≤ t ,  0  <  γ <  1 . 
(4.12) 
The  function  f (t) =  tγ  − γ t  is   diﬀerentiable  for   t  >  0  with  derivative 
γ tγ−1  − γ ,  which  is  positive  for   t  <  1  and  negative  for  t  >  1.  Thus  
f (t)  ≤  f (1)  with  equality  only  for   t  = 1.  Since  f (1)   = 1  − γ ,  this   is  
� 
(4.12),   proving  the  lemma.  

We  use  this  to   prove   H¨older’s  inequality 
6Check  that  |f |p  is  automatically  measurable. 

�
25 

LECTURE  NOTES  FOR  18.155,  FALL  2004 
�� � � 
�� � � 
� 
Lemma  4.8.  If  f  and  g  are  measurable  then 
≤ �f �p�g�
(4.13) 
f gdµ 
for   any  1  <  p <  ∞,  with  1  +  = 1. 
1
p
q 
Proof.  If  �f �p  = 0   or  �g�q  = 0  the  result  is   trivial,  as  it   is  if  either  is 
� � ��

� � ��

� � ��

� � ��

inﬁnite.  Thus  consider 
p 
q
f (x) 
g(x) 
�g�
�f �
q 
1
and  apply  (4.11)   with  γ  =  p  .  This   gives  
|g(x) q 
|
|f (x) p 
f (x)g(x)|
|
|
≤ 
�f �p�g�q 
p�f �p 
q�g�
p
q
�

q
Integrating   over  X  we  ﬁnd 
1 
�f �p�g�q X 

f (x)g(x)| dµ
|

,  b
 =


a  =


+ 

q

.

p 

� 

Since 

�

≤ 
1 
1
+  = 1 .
q 
p
f g | dµ  this  implies  (4.13). 
≤  X  |

� �
�

� �

X  f g dµ 
The  ﬁnal  inequality  we  need   is  Minkowski’s  inequality. 
Proposition  4.9.  If  1  <  p <  ∞ and  f , g ∈ Lp (X, µ)  then  
p  ≤ �f �
p  +  �g�p  .
�f  +  g�
(4.14) 
Proof.  The  case  p  =  1   you   have  already  done. 
f  +  g = 0  a.e..   If  not  we  can  write 
f  +  g |p  ≤ (|f | +  g ) f  +  g p−1 
|
| | |
|
�1/q 
�� 
�

and  apply   H¨older’s  inequality,  to  the   right  side,  expanded  out, 
|f  +  g q(p−1)  dµ 
f  +  g p  dµ  ≤ (�f �p  +  �g�p )  , 
|
|
|
Since  q(p − 1) 
p  and  1  − q 
�
1 
= 1/p  this  is   just   (4.14). 
= 
So,  now  we  know  that   Lp (X, µ)  is  a  normed  space  for   1  ≤ p <  ∞. In 
particular  it  is  a  metric   space.  One  important  additional  property  that 
a  metric  space  may   have   is   completeness,  meaning  that   every  Cauchy 
sequence  is  convergent. 

It   is   also  obvious  if 

.

26  

RICHARD  B.  MELROSE 

Deﬁnition  4.10.  A  normed  space  in  which  the  underlying  metric  space 
is  complete  is  cal led  a  Banach   space. 

Theorem  4.11.  For  any  measure  space  (X, M , µ)   the  spaces  Lp (X, µ), 
1  ≤ p < ∞,  are  Banach  spaces. 
Proof.  We  need  to   show  that  a  given  Cauchy  sequence  {fn}  converges  
in  Lp (X, µ).  It  suﬃces  to  show  that  it   has  a  convergent   subsequence. 
By  the   Cauchy   property,   for   each   k ∃  n =  n(k)  s.t. 
�fn  − f��p  ≤ 2−k  ∀  � ≥ n . 
(4.15) 
Consider  the  sequence  

� 
n(k)  − f
.

n(k−1)  ,  k > 1
g1  =  f1  ,  gk  =  f
By  (4.15),   �gk �p  ≤  2−k  ,  for  k >  1,  so  the  series 
k  �gk �p  converges, 
� 
� 
say  to   B < ∞.  Now  set 
∞
n
gk (x) ,  n ≥ 1 ,  h(x) = 
|
| 
hn (x) = 
gk (x). 
� 
� 
k=1 
k=1 
Then  by the  monotone  convergence   theorem 
p  dµ ≤ B p  ,
|
|
hp  dµ =  lim 
hn
n→∞  X 
X
where   we   have  also   used  Minkowski’s  inequality.  Thus  h ∈  Lp (X, µ),  
� 
so  the   series 
∞
gk (x) 
� � � �� 
� � � ��

k=1 
� 
converges  (absolutely)  almost   everywhere.  Since 
p 
n
|
|
 = 
≤ hp
p 
f (x)

lim
gk 
n→∞ 
k=1 
with  hp  ∈  L� (X, µ),  the  dominated   convergence  theorem  applies  and  
shows  that  f  ∈ Lp (X, µ).  Furthermore,  
�� 
� �

� �

gk (x) =  fn(�) (x)  and   f (x) − fn(�) (x) 
p  ≤ (2h(x))p
�  � �

k=1 
� �

so  again  by  the  dominated  convergence  theorem, 
0 .→
f (x) − fn(�) (x) 
p
X 
Thus  the  subsequence  fn(�)  → f  in   Lp (X, µ),  proving  its   completeness.  
� 

f (x) = 

LECTURE  NOTES  FOR  18.155,   FALL  2004 

27 

Next  I  want  to   return  to  our   starting  point   and  discuss  the  Riesz 
representation   theorem.  There   are  two  important  results   in  measure 
theory   that  I  have  not   covered  —  I  will  get   you  to  do  most  of  them 
in  the  problems   —  namely  the  Hahn   decomposition   theorem  and  the 
Radon­Nikodym  theorem.   For   the  moment  we  can   do  without  the 
latter,   but  I  will   use   the   former. 
So,   consider  a   locally  compact  metric  space,  X .  By  a  Borel   measure 
on  X ,  or  a   signed  Borel  measure,  we  shall  mean  a  function  on   Borel 
sets 

µ  :  B (X ) → R 
which  is  given  as   the   diﬀerence  of  two  ﬁnite  positive  Borel  measures 
µ(E ) =  µ1 (E ) − µ2 (E ) . 
Similarly  we  shall   say  that  µ  is   Radon,  or   a  signed   Radon   measure,  if 
it  can  be  written  as  such  a  diﬀerence,   with  both  µ1  and  µ2  ﬁnite  Radon 
measures.  See  the  problems  below  for  a  discussion  of  this  point. 
Let  Mﬁn (X )  denote  the  set   of  ﬁnite  Radon   measures   on   X .  This  is 
a  normed  space  with 

(4.16) 

(4.17) 

� µ� 1  =  inf  (µ1 (X ) +  µ2 (X ))  
� 
� 
with  the  inﬁmum  over   all  Radon   decompositions   (4.16).  Each   signed 
Radon  measure  deﬁnes  a   continuous  linear   functional  on  C 0 (X ):  
�−→ 
· dµ  :  C 0 (X )  � f 
f  ·  dµ .  
X 

(4.18) 

Theorem   4.12  (Riesz   representation.).   If  X  is  a  local ly  compact  met­
ric  space  then  every  continuous  linear  functional  on  C 0 (X )  is  given  by 
a  unique  ﬁnite  Radon  measure   on  X  through  (4.18). 
Thus  the  dual  space   of  C 0 (X )  is  Mﬁn (X )  –  at   least   this   is  how   such  
a  result  is  usually  interpreted 
(C 0 (X ))�  =  Mﬁn (X ),  
see   the  remarks  following  the  proof. 

(4.19) 

Proof.  We  have  done  half  of  this   already.  Let   me  remind   you  of  the 
steps.  
We  started  with  u  ∈  (C 0 (X ))�  and  showed  that  u  =  u+  − u−  where 
u±  are  positive  continuous  linear  functionals;  this  is   Lemma  1.5.  Then 
we  showed  that  u  ≥ 0  deﬁnes   a  ﬁnite  positive   Radon  measure  µ.  Here 
µ  is  deﬁned  by  (1.11)  on  open   sets  and  µ(E ) =  µ∗ (E ) is  given  by  (1.12) 

28  

RICHARD  B.  MELROSE 

(4.20) 

on  general   Borel  sets.  It  is   ﬁnite   because 
µ(X )  =  sup  {u(f ) ; 0  ≤ f  ≤ 1 ,  supp   f  � X ,  f  ∈ C (X )} 
u� .
≤ �
From  Proposition  2.8  we  conclude  that  µ  is   a  Radon  measure.  Since 
this  argument  applies  to  u±  we  get   two  positive  ﬁnite  Radon  measures  
µ±  and  hence   a  signed  Radon   measure 
µ  =  µ+  − µ−  ∈ Mﬁn (X ).  
(4.21) 
In  the  problems  you  are  supposed   to  prove  the  Hahn  decomposition 
theorem,  in  particular  in  Problem  14  I  ask  you   to  show   that   (4.21)   is 
the  Hahn  decomposition  of   µ  —  this  means   that   there  is   a  Borel  set 
E  ⊂ X  such that  µ− (E )  = 0 ,  µ+ (X  \ E )  = 0. 
What  we  have  deﬁned  is   a  linear  map 
�−→ µ . 
(C0 (X ))�  → M (X ),   u  
(4.22) 
We  want  to   show  that  this   is  an  isomorphism,  i.e.,  it  is   1 − 1  and  onto.  
We  ﬁrst  show  that  it  is  1  − 1.  That  is,   suppose  µ  =  0.  Given  the 
uniqueness  of  the  Hahn  decomposition  this   implies  that   µ+  =  µ−  =  0. 
So  we  can  suppose  that  u  ≥ 0  and   µ  =  µ+  = 0  and  we  have  to  show 
that  u  =  0;  this  is  obvious   since 
µ(X )  =  sup  {u(f );   supp   u  � X,   0  ≤ f  ≤ 1  f  ∈ C (X )} = 0 
⇒ u(f )  = 0  for  all  such   f . 
(4.23) 
If  0   ≤  f  ∈  C (X )  and  supp   f  �  X  then  f �  =  f /�f �∞  is   of  this   type 
so  u(f )  =  0   for  every  0  ≤  f  ∈  C (X )  of  compact   support.  From 
the  decomposition  of  continuous  functions  into  positive  and   negative 
parts  it  follows  that  u(f )  = 0  for  every  f  of  compact  support.   Now,  if  
f  ∈ C
o (X ),  then  given  n  ∈ N  there  exists  K  � X  such  that   f <  1/n
|
|
on  X  \ K.  As  you  showed   in  the  problems,  there  exists  χ  ∈ C (X )  with  
supp(χ) � X  and  χ  = 1 on   K.  Thus  if  fn  =  χf  then  supp(fn ) � X  and 
�f  − fn� = 
sup( f  − fn <  1/n.   This  shows  that   C0 (X )  is   the  closure 
|
|
of  the  subspace  of  continuous  functions  of  compact   support   so  by  the 
assumed  continuity  of  u,  u  = 0. 
So  it  remains  to   show   that   every  ﬁnite  Radon  measure  on  X  arises 
from  (4.22).  We  do   this  by  starting  from  µ  and  constructing  u.  Again  
� 
we  use   the  Hahn  decomposition  of  µ,  as   in   (4.21)7 .  Thus   we  assume 
µ  ≥ 0  and  construct   u.  It   is  obvious  what  we  want,  namely 
f  dµ  ,   f  ∈ Cc (X ) . 
X 

u(f ) = 

(4.24) 

7Actually we  can   just  take  any  decomposition  (4.21)  into  a  diﬀerence   of  positive  
Radon  measures. 

LECTURE  NOTES  FOR  18.155,   FALL  2004 

29 

(4.26) 

Here  we  need  to  recall  from  Proposition   3.2  that  continuous  functions  
on  X ,  a  locally  compact  metric  space,  are   (Borel)  measurable. Further­
� � ��

� � ��

� 
more,  we  know   that   there  is  an   increasing  sequence  of  simple  functions 
with  limit  f ,  so

f  dµ
 ≤ µ(X ) · �f �∞  . 
(4.25) 
X 
This  shows  that  u  in  (4.24)   is  continuous  and  that  its   norm  �u�  ≤ 
µ(X ).  In  fact 
u� =  µ(X ) . 
�
Indeed,  the  inner   regularity  of  µ  implies  that   there  is  a  compact   set  
c (X ) with  0  ≤ f  ≤ 1 
n ;  then   there  is  f  ∈ C

K  � X  with  µ(K )  ≥ µ(X ) − 1 
and  f  = 1  on  K .  It  follows  that   µ(f )  ≥ µ(K )  ≥ µ(X ) −
1 
,  for  any  n.
n 
This  proves  (4.26).  
u  is   deﬁned   by  (4.24),  with  µ  a  ﬁnite 
We  still  have  to  show  that   if 
positive  Radon  measure,  then   the   measure  ˜µ  deﬁned   from  u  via  (4.24)  
is  precisely   µ  itself. 
This  is  easy  provided  we  keep  things   clear.  Starting  from  µ  ≥  0 a 
��

�

ﬁnite  Radon  measure,   deﬁne  u  by  (4.24)  and,   for   U  ⊂ X  open 
f dµ,  0  ≤ f  ≤ 1,  f  ∈ C (X ),   supp(f )  � U 
.

(4.27)  ˜µ(U ) =  sup 
X 
By  the  properties   of  the   integral,   ˜µ(U )  ≤ µ(U ).   Conversely  if  K  �  U 
there  exists  an  element  f  ∈  Cc (X ),   0  ≤  f  ≤  1,  f  =  1  on  K  and 
� 
supp(f )  ⊂ U.   Then  we   know  that 
˜µ(U )  ≥ 
f dµ  ≥ µ(K ).  
(4.28) 
X 
By  the  inner   regularity   of  µ,  we  can  choose  K  � U  such that  µ(K )  ≥ 
µ(U ) − �,  given  � >  0.   Thus  ˜µ(U ) =  µ(U ).  
This  proves  the  Riesz   representation   theorem,  modulo  the  decompo­
sition  of  the  measure   ­ which   I  will   do  in  class   if  the  demand  is  there! 
� 
In  my  view  this  is   quite   enough  measure  theory. 
Notice  that  we  have  in  fact   proved  something  stronger   than  the  state­
ment  of  the  theorem.  Namely  we   have  shown  that   under  the  correspon­
dence   u  ←→ µ, 
(4.29) 

u� =  µ (X )  =:   �µ� . 
�
|
|
1 
Thus  the   map  is  an  isometry.  

30  

RICHARD  B.  MELROSE  

5.  Hilbert  space 

We  have   shown  that  Lp (X, µ) is  a  Banach space  – a  complete  normed 
space.   I  shall  next   discuss  the  class   of  Hilbert   spaces,  a  special  class  of 
Banach  spaces,   of   which  L2 (X, µ)  is   a  standard  example,  in  which  the 
norm  arises  from  an  inner  product,  just   as   it   does   in   Euclidean  space. 
An  inner  product  on   a   vector  space  V  over  C  (one   can  do  the  real 
case   too,   not  much  changes)   is  a  sesquilinear  form 
V  × V 
C→ 
written  (u, v),  if  u, v  ∈ V .  The   ‘sesqui­’  part  is  just   linearity  in   the  ﬁrst  
variable 

(5.1) 

(a1u1  +  a2u2  ,  v) =  a1 (u1 , v) +  a2 (u2 , v),  

anti­linearly  in  the  second 

(5.2) 

(u, a1v1  +  a2v2 ) =  a1 (u, v1 ) +  a2 (u, v2 ) 

and  the  conjugacy  condition 

(5.3) 

(u, v) = (v , u) . 

Notice  that   (5.2)  follows  from  (5.1)  and  (5.3).  If   we  assume  in   addition  
the  positivity  condition8 
(u, u) ≥ 0 ,  (u, u) = 0 

u = 0 ,

⇒ 

(5.4) 

then 

(5.5) 

�u� = (u, u)1/2 
is  a   norm   on  V ,  as  we  shall  see. 
= 1.  Then  (u, v) =  eiθ  |(u, v)
Suppose  that  u, v  ∈ V  have  �u� = 
�v�
|
for  some  θ ∈ R.   By  choice  of  θ ,  e−iθ (u, v) = (u, v) is   real,   so  expanding 
|
|
out  using   linearity  for  s ∈ R, 
0  ≤ (e−iθ  u − sv ,  e−iθ  u − sv) 
= 1  − 2s (u, v) +  s 2  .
�v�
− 2s Re  e−iθ (u, v) +  s 
�u�
|
|
2 
2
2 
= 
The  minimum  of  this  occurs  when  s  = (u, v)|  and  this   is  negative 
|
unless  (u, v) ≤  1.   Using   linearity,   and   checking  the  trivial  cases  u  =
|
|
or  v  = 0  shows  that 

(5.6) 

(u, v)| ≤ �u� �v�,  ∀  u, v  ∈ V .
|
This  is  called  Schwarz’9  inequality. 

8Notice  that  (u,   u) is   real  by  (5.3).

9No  ‘t’  in   this  Schwarz.


LECTURE  NOTES  FOR  18.155,   FALL  2004 

31 

Using  Schwarz’  inequality 
�
u +  v� =  u� +  (u, v) +  (v , u) +  �v�2 
�
2
2 
≤ (�u� +  �v�)2 
⇒ �
v� ≤ �
u + 
= 
which  is  the  triangle  inequality. 

u� +  �v� ∀ u, v  ∈ V

f g dµ , 

(5.8) 

Deﬁnition  5.1.  A  Hilbert  space  is   a  vector  space  V  with  an   inner  
product  satisfying  (5.1)  ­ (5.4)  which  is  complete   as   a  normed  space  
(i.e.,  is  a   Banach  space). 
� 
Thus  we  have  already  shown  L2 (X, µ) to  be  a  Hilbert  space  for  any 
positive   measure  µ.  The  inner  product   is 
X 

(5.7) 
(f , g) = 
since  then  (5.3)   gives  �f �2 . 
Another  important  identity  valid  in  any  inner   product  spaces   is  the 
parallelogram   law: 
�
u +  v�2  +  �u − v� = 2�u�2  +  2�v� . 
2
2
This  can  be  used  to  prove   the  basic  ‘existence  theorem’  in   Hilbert  space 
theory. 
Lemma  5.2.  Let  C  ⊂ H ,  in  a  Hilbert  space,   be  closed   and  convex  (i.e.,  
su  +  (1  − s)v  ∈  C  if  u, v  ∈  C  and  0  <  s  <  1).  Then  C  contains  a 
unique  element  of  smal lest  norm. 
Proof.  We  can  certainly   choose  a  sequence  un  ∈ C  such that 
�un� → δ 
=  inf  {�v� ;  v  ∈ C } .
By  the  parallelogram   law,  
un  − um� = 2�un�2  +  2�um�
− �
�
un  +  um�
2 
2
2 
≤ 2(�un�2  +  �um� ) − 4δ 2 
2
where  we  use  the  fact   that  (un  + um )/2  ∈ C  so  must  have  norm  at  least 
δ .  Thus  {un} is  a  Cauchy  sequence,  hence   convergent   by  the  assumed  
completeness  of  H .  Thus   lim  un  =  u  ∈ C  (since  it   is  assumed  closed) 
and  by  the  triangle   inequality 
|�un� − �u�| ≤ �un  − u� → 0 
So  �u� =  δ .  Uniqueness  of   u  follows   again  from  the  parallelogram  law 
� = 
which  shows  that  if  �u�
δ  then 
� ≤ 2δ 2 
�
− 4�(u +  u� )/2� ≤ 0 .
u − u�
2 

32  

RICHARD  B.  MELROSE 

� 
The  fundamental  fact  about  a  Hilbert   space  is   that   each  element 
v  ∈ H  deﬁnes  a  continuous  linear   functional   by 
H  � u 
�−→ (u,  v)  ∈ C 
and  conversely  every  continuous   linear   functional  arises  this   way.  This  
is  also   called  the  Riesz   representation  theorem. 
→
C  is  a  continuous   linear  functional   on
Proposition  5.3.  If  L  :  H 
a  Hilbert  space  then   this  is  a  unique  element  v  ∈ H  such  that 
Lu  = (u,  v)  ∀  u  ∈ H , 
(5.9) 
Proof.  Consider  the  linear  space 
M  =  {u  ∈ H  ;  Lu  = 0} 
the  null  space  of   L,  a  continuous  linear  functional  on  H .  By  the  as­
sumed  continuity,  M  is  closed. We  can  suppose  that   L  is   not  identically 
∈ M . 
zero  (since  then  v  = 0  in  (5.9)).   Thus  there   exists   w  /
Consider
w  +  M  =  {v  ∈ H  ;  v  =  w  +  u  ,  u  ∈ M }  . 
This  is  a   closed   convex   subset   of  H .  Applying  Lemma  5.2  it   has  a 
unique  smallest  element,  v  ∈  w  +  M .  Since  v  minimizes   the  norm  on 
w  +  M , 
�u�
�v�
+  2 Re(su,  v) +  �s�2
�v  +  su� = 
2
2 
2
is  stationary   at  s  =  0.   Thus   Re(u,  v)  = 0  ∀  u  ∈  M ,  and   the  same 
argument   with  s  replaced  by  is  shows  that  (v ,  u)   = 0  ∀  u  ∈ M . 
Now  v  ∈  w  +  M ,  so  Lv  =  Lw  =  0.   Consider   the  element   w �  = 
w/Lw  ∈ H .  Since  Lw �  =  1,  for   any  u  ∈ H 
L(u  − (Lu)w � ) =  Lu  − Lu  = 0 . 
It  follows  that   u  − (Lu)w �  ∈ M  so  if  w ��  =  w �/�w �
�
2
(w � ,  w � )
(u,   w �� )  = ((Lu)w � ,  w �� ) =  Lu 
�w ��2 
The  uniqueness  of  v  follows   from  the  positivity of the  norm. 

=  Lu  . 

Corollary  5.4.  For  any  positive   measure  µ,  any  continuous  
functional 
L  :  L2 (X,  µ) → C 
� 
X 

f g dµ  ,  g  ∈ L2 (X,  µ) . 

is  of  the  form 

Lf   = 

� 
linear 

�
LECTURE  NOTES  FOR  18.155,   FALL  2004 

33 

Notice  the  apparent  power  of   ‘abstract  reasoning’  here!  Although  we 
seem  to   have   constructed  g  out  of  nowhere,  its   existence  follows   from 
the  completeness  of  L2 (X,  µ),  but   it  is  very  convenient   to  express  the 
argument  abstractly  for  a  general  Hilbert  space. 

34  

RICHARD  B.  MELROSE 

6.  Test  functions 

So  far  we  have  largely  been  dealing  with   integration.  One  thing  we 
have  seen  is  that,  by  considering  dual   spaces,  we  can  think  of  functions  
as  functionals.   Let  me   brieﬂy  review   this   idea. 
Consider  the  unit  ball   in  Rn  , 
| ≤ 1}  . 
=  {x ∈ Rn  ;  x|
Bn 
I  take  the  closed   unit  ball  because  I  want   to   deal   with   a  compact   metric 
space.  We  have  dealt  with  several  Banach   spaces  of  functions  on  Bn  , 
� 
� 
for  example

�

� 
� 
→

C (Bn ) =  u :  Bn 
C ;  u continuous 
u dx < ∞ 
→ 
|
| 
C; Borel  measurable  with 
L2 (Bn ) =  u :  Bn 
2
.

Here,   as  always  below,   dx is   Lebesgue  measure  and   functions   are  iden­
tiﬁed  if  they   are  equal   almost  everywhere. 
Since  Bn  is  compact   we  have  a  natural  inclusion  
→ 
C (Bn )  � L (Bn ) .
2
(6.1) 
This  is  also  a  topological   inclusion,   i.e.,  is  a  bounded  linear  map,  since 
�u�L2  ≤ C �u||∞ 
(6.2) 
where  C 2  is  the   volume  of  the   unit  ball. 
In  general   if  we  have  such  a  set   up  then  
Lemma  6.1.  If  V �→ U is   a  subspace  with  a  stronger  norm, 
�ϕ�U  ≤ C �ϕ�V  ∀  ϕ ∈ V 
then  restriction  gives  a   continuous   linear  map 
L�V  ≤ C �L�U .
L =  L|V  ∈ V � , � ˜
V � , U �  � L �−→  ˜
→ 
U � 
� 
� 
If  V is  dense  in  U then  the  map  (6.3)  is  injective. 
��� � 
�� � 
�

Proof.  By  deﬁnition  of   the  dual  norm 
�� � �

� � �

�

L� ˜
�V 
;  �v�V  ≤ 1 , v ∈ V
˜L(v) 
= sup 
;  �v�U  ≤ C , v ∈ V
≤ sup  
˜L(v) 
≤ sup  {|L(u) ; �u�U  ≤ C , u ∈ U
} 
|
=  C �L�U . 
� 
If  V ⊂  U is  dense  then  the  vanishing  of  L :  U
vanishing  on  U . 

(6.3) 

� 

→

C  on  V implies   its 
� 

LECTURE  NOTES  FOR  18.155,   FALL  2004 

35 

Going   back  to   the  particular   case   (6.1)  we  do  indeed  get  a  continuous 
map  between  the  dual  spaces 
L2 (Bn )  ∼ (L (Bn ))�  → (C (Bn ))�  =  M (Bn ) .
2
= 
� 
Here  we  use  the  Riesz  representation   theorem  and   duality  for  Hilbert 
spaces.   The  map  use  here  is  supposed   to  be  linear  not   antilinear,  i.e., 
L2 (Bn ) � g �−→ 
·g dx ∈ (C (Bn ))�  . 

(6.4) 

So  the  idea   is  to  make   the   space  of  ‘test  functions’  as  small  as  reasonably 
possible,  while  still   retaining  density  in   reasonable  spaces. 
Recall   that  a   function   u :  Rn  → C  is   diﬀerentiable  at  x ∈ Rn  if  there 
exists  a ∈ Cn  such that  
u(x) − u(x) − a · (x − x) =  o( x − x ) .
|
|
|
|
(6.5) 
The  ‘little  oh’   notation   here  means   that  given   � > 0  there  exists   δ > 0 
s.t. 
⇒ |
x − x < δ
|
|
|
|
| 
u(x) − u(x) − a(x − x) < � x − x .
The  coeﬃcients  of   a = (a1 , . . . , an )  are  the  partial   derivations  of  u at 
x, 

ai  =

∂u 
∂xj 

(x)

since 

(6.6) 

, 

ai  =  lim 
→
t
0 

u(x +  tei ) − u(x) 
t
ei  =  (0, . . . , 1, 0, . . . , 0)  being  the  ith   basis  vector.  The   function   u is  
said  to  be  continuously  diﬀerentiable  on  Rn  if  it  is   diﬀerentiable  at  each 
point  x ∈ Rn  and  each  of  the  n partial  derivatives   are  continuous, 
→ 
∂u 
C . 
:  Rn 
(6.7) 
∂xj 
Deﬁnition 6.2.  Let  C0 (Rn )  be  the  subspace  of  C0 (Rn ) =  C0 (Rn )  such 
0
1
∈ 
that  each  element  u ∈  C0 (Rn )  is  continuously  diﬀerentiable  and  ∂xj 
∂u 
1 
C0 (Rn ), j = 1, . . . , n.  
n�  ∂u 
Proposition  6.3.  The  function 
�∞ 
�u�∞  + 
�u�C 1 
� 
∂x1 
i=1 
is  a  norm  on  C0 (Rn )  with  respect  to  which  it  is  a  Banach  space. 
1

=

→

vj  ∈ C

0 (Rn ) .
0

RICHARD  B.  MELROSE  
36  
Proof.  That  � �C 1  is  a  norm  follows   from  the  properties   of   � �∞ .  Namely 
=  0  certainly  implies  u  = 0,  �au�C 1  =  a u�C 1  and  the  triangle 
u�C 1 
�
| | �
inequality  follows  from  the  same  inequality  for   � �∞ . 
Similarly,  the  main  part  of  the  completeness  of  C 1
(Rn )  follows   from

the  completeness  of  C
(Rn ).   If  {
un}  is   a  Cauchy  sequence  in  C
0
(Rn )
0
1
are  Cauchy  in  C
0
0
0 (Rn
∂un 
0
).   It   follows  that   there  are 
then 
un  and  the  ∂xj 
limits  of  these  sequences,  
un  → v  ,  

∂un
∂xj 
However  we  do  have  to  check  that  v  is   continuously  diﬀerentiable  and 
that  ∂ v   =  vj .
∂xj 
� 
One  way  to  do  this  is  to  use  the  Fundamental  Theorem  of  Calculus  
in  each  variable.   Thus 
t  ∂un 
(x  +  sei ) ds  +  un (x) . 
un (x  +  tei ) = 
∂xj
� 
0 
As  n  → ∞ all  terms  converge  and  so,  by  the  continuity  of  the  integral, 
t 
0 
This  shows  that  the  limit  in  (6.6)  exists,  so  vi (x)  is   the  partial  deriva­
tion  of  u  with  respect  to   xi .  It  remains  only  to  show  that  u  is   indeed 
diﬀerentiable  at  each   point  and   I  leave  this  to  you  in  Problem   17. 
� 

vj (x   +  sei ) ds  +  u(x) . 

u(x  +  tei ) = 

So,  almost  by  deﬁnition,   we  have  an   example  of  Lemma  6.1, 
0 (Rn ) �→ C 0
C
0 (Rn ).
1
It  is  in  fact  dense  but  I  will  not   bother   showing  this  (yet).  So  we  know  
that  
(C
0 (Rn ))�  → (C 1
0 (Rn ))�
0
and  we  expect  it  to   be  injective.  Thus  there  are  more  functionals   on

C
0 (Rn )  including   things  that  are   ‘more  singular  than  measures’. 
1
An  example  is  related  to  the  Dirac  delta 
δ(x)(u) =  u(x) ,  u  ∈ C
0 (Rn ) ,
0

namely 

C

1
0

(Rn

)  � u 

∂u 
∂xj
This  is  clearly   a   continuous   linear  functional  which   it   is  only  just   to 
∂  δ(x).
denote 
∂xj 
Of  course,   why  stop  at  one   derivative? 

(x)  ∈ C .

�−→ 

(6.8) 

,

�C k−1  .

LECTURE   NOTES  FOR  18.155,  FALL  2004 
37 
Deﬁnition  6.4.  The  space   C k 
0 (Rn ) k  ≥  1  is  deﬁned  induc­
0 (Rn )  ⊂  C
1
tively  by  requiring  that 
∈ C k−1 (Rn ) ,  j = 1, . . . , n . 
∂u 
0 
∂xj 
n�  ∂u 
The  norm  on  C0  (Rn )  is  taken   to  be 
k
u�C k  =  u�C k−1  + 
�
�
�
∂xj
j=1 
These  are  all   Banach  spaces,  since  if   {un} is   Cauchy  in   C0 (Rn ),   it  is 
k
Cauchy  and  hence  convergent   in   C k−1 (Rn ),   as  is  ∂un/∂xj ,  j = 1, . . . , n−
0 
1. Furthermore  the  limits  of  the  ∂un/∂xj  are  the  derivatives   of  the  limits  
by  Proposition  6.3. 
This  gives  us   a  sequence  of  spaces   getting  ‘smoother  and  smoother’ 
C0
)  ⊃ C
)  ⊃ · · · ⊃ C
)  ⊃ · · · , 
k (Rn
1 (Rn
0 (Rn
0
0
with  norms  getting   larger   and  larger.  The  duals  can  also  be  expected  
to   get  larger  and   larger  as  k  increases. 
As  well   as  looking   at  functions  getting  smoother  and   smoother,  we 
need  to   think  about   ‘inﬁnity’,  since  Rn  is   not   compact.  Observe  that 
an  element  g ∈ L1 (Rn )  (with  respect  to  Lebesgue  measure by  default) 
deﬁnes  a  functional  on  C0 (Rn ) —  and   hence  al l  the  C0 (Rn )s.  However   a 
0 
k
function  such  as   the   constant  function   1  is   not  integrable  on  Rn  .  Since 
we  certainly   want   to  talk  about   this,  and  polynomials,  we  consider  a 
second  condition  of   smal lness  at  inﬁnity.  Let  us  set  
�x� = (1  +  x 2 )1/2
|
| 
(6.9) 
a  function  which  is  the   size  of  |x|  for  x large,  but   has   the  virtue   of  
|
|
being   smooth10  
� 
� 
Deﬁnition  6.5.  For  any  k ,  l ∈ N = 
{1, 2, · · · } set 
0 (Rn ) =  u ∈ C0 (Rn ) ;   u =  x�−l  v ,   v  ∈ C0 (Rn ) 
x�−l
�
C
�
k
k 
k 
with  norm,  �u�k,l  =  v�C k  ,  v  =  x�lu. 
�
�
Notice  that  the  deﬁnition   just   says   that  u =  x�−l v , with  v  ∈ C0  (Rn ).  
�
k
It  follows  immediately  that  �x�−l
C
0 (Rn )  is  a  Banach  space   with   this 
k 
norm. 
� 
� 
Deﬁnition  6.6.  Schwartz’  space11  of  test  functions   on  Rn  is 
0 (Rn )  for  al l  k  and  l ∈ N  .
S (Rn ) =  u :  Rn 
→ C; u ∈ �
x�−l
C k 
10See  Problem  18.

11Laurent  Schwartz  –  this  one   with  a  ‘t’.


38  

RICHARD  B.  MELROSE 

It  is  not  immediately   apparent  that   this  space  is  non­empty  (well  0 
is  in  there  but...);   that 

)

|  )  ∈ S (Rn
exp(− x
|
2
is  Problem  19.  There  are  lots   of  other   functions  in   there  as   we  shall 
see. 
Schwartz’  idea  is   that  the  dual  of  S (Rn )  should  contain  all   the  ‘in­
teresting’   ob jects,  at  least   those   of  ‘polynomial  growth’.  The  problem 
is  that  we  do   not  have  a  good  norm  on  S (Rn ).   Rather  we  have  a  lot  of 
them.  Observe  that 
0  (Rn )  if  l  ≥ l �  and  k  ≥ k �  .
)  ⊂ �
x�−l� 
C k� 
�x�−l
C
0 (Rn
k
� 
Thus  we  see  that  as  a  linear   space 
x�−k
�
S (Rn ) = 
k 

C
0 (Rn ).
k

(6.10) 

Since  these  spaces  are   getting  smaller,  we  have  a  countably  inﬁnite 
number  of  norms.  For  this  reason   S (Rn )  is   called  a  countably  normed 
space.  
Proposition  6.7.  For  u  ∈ S (Rn ),  set 
�u�(k)  =  ��x� u�C k 
k
(6.11) 
∞� 
�u  − v�(k) 
2−k 
1  +  �u  − v�(k) 
k=0 
then  d  is  a   distance  function  in  S (Rn )  with  respect  to  which  it  is   a 
complete  metric  space. 

and  deﬁne 

d(u,  v) = 

(6.12) 

, 

Proof.  The  series  in  (6.12)  certainly  converges,  since 
�u  − v�(k)  ≤ 1. 
1  +  �u  − v�(k) 
The  ﬁrst  two   conditions  on  a  metric  are  clear, 
d(u,  v)  = 0  ⇒ �
u  − v�C0 
= 0  ⇒ u  =  v , 
and  symmetry   is  immediate.  The   triangle  inequality  is  perhaps  more 
mysterious!  
Certainly  it  is  enough  to  show   that  
�u  − v� 
1  +  �u  − v� 

d˜(u,  v) = 

(6.13) 

LECTURE   NOTES  FOR  18.155,  FALL  2004 

39 

is  a  metric  on  any  normed  space,  since  then   we  may  sum  over  k .   Thus  
we  consider 
�u − v� 
1  +  �u − v� 

�v − w� 
1  +  �v − w� 
�u − v�(1  +  �v − w�) +  �v − w�(1  +  �u − v�) 
(1  +  �u − v�)(1  +  �v − w�) 

. 

+ 

= 

Comparing   this  to   d˜(v , w)  we  must   show  that 
(1  +  �u − v�)(1  +  �v − w�)�u − w� 
≤ (�u − v�(1  +  �v − w�) +  �v − w�(1  +  �u − v�))(1  +  �u − w�).  

Starting  from  the  LHS   and   using   the   triangle  inequality, 
LHS  ≤ �u − w� +  (�u − v� +  �v − w� +  �u − v��v − w�)�u − w�

≤ (�u − v� +  �v − w� +  �u − v��v − w�)(1  +  �u − w�)

≤ RHS.


Thus,  d is  a  metric.  
Suppose  un  is  a   Cauchy  sequence.  Thus,  d(un , um )  →  0  as  n, m  → 
∞.  In  particular,   given 
� > 0  ∃ N  s.t.  n, m > N  implies 
d(un , um ) < �2−k  ∀  n, m > N . 

The  terms  in  (6.12)  are  all  positive,  so  this  implies 
�un  − um�(k)  < � ∀  n, m > N . 
1  +  �un  − um�(k) 

If  � < 1/2  this  in  turn  implies   that 
�un  − u
m�(k)  < 2�,
so   the  sequence  is  Cauchy  in   �x�−k
C
0  (Rn )  for  each  k .   From  the  com­
k
that   un  →  u  in   �x�−k
C
k (Rn )j  for
pleteness  of  these  spaces  it   follows 
each  k .  Given  � >  0  choose  k  so  large  that  2−k  <  �/2.   Then  ∃  N  s.t. 
0
n > N 

⇒ �u − u

n�(j )  < �/2  n > N ,  j ≤ k .  

40 	

Hence 

d(un , u) = 

RICHARD  B.  MELROSE 
� 
2−j 
� 
j≤k 
2−j 
j>k 
≤ �/4  +  2−k  < �.  

u − un�(j )
�
1  +  �u − un�(j ) 
u − un�(j )
�
1  +  �u − un�(j )

+

This  un  → u in  S (Rn ).	
� 
As  well  as  the  Schwartz  space,  S (Rn ), of  functions   of  rapid  decrease 
with  all   derivatives,  there  is   a  smaller   ‘standard’  space  of  test  functions, 
namely 

(6.14) 

Cc
);  supp(u) � Rn} ,
{u ∈ S (Rn
∞ (Rn ) = 
the  space   of   smooth  functions  of  compact   support.  Again,  it  is  not 
quite  obvious  that  this  has  any  non­trivial  elements,  but  it   does  as 
we  shall   see.   If  we  ﬁx  a  compact   subset  of   Rn  and  look  at  functions  
with  support   in  that   set,   for   instance  the  closed  ball  of  radius   R > 0, 
then  we  get  a  closed  subspace  of   S (Rn ), hence  a  complete  metric  space. 
One  ‘problem’   with  C∞ (Rn )  is  that   it  does   not  have  a  complete  metric 
c 
topology  which  restricts  to  this  topology  on  the  subsets.  Rather  we 
must  use   an  inductive  limit   procedure  to  get   a  decent   topology. 
Just  to   show  that  this  is  not   really  hard,  I  will  discuss  it  brieﬂy 
here,  but  it  is   not  used   in   the  sequel.  In  particular  I  will  not  do  this 
in  the  lectures  themselves.  By  deﬁnition  our  space  C∞ (Rn )  (denoted  
traditionally  as  D(Rn ))  is  a  countable  union  of  subspaces 

 
c 
(6.15)	
);  u = 0  in  |x| > n .
∞ (B (n)),  Cc
C˙
Cc
{u ∈ S (Rn	
}
∞ (Rn ) = 
∞ (B (n)) = 
˙
c
n∈N 

Consider 
(6.16) 
T  =  {U ⊂ C∞
∞ (B (n))  is   open  in  C˙∞ (B (n))  for  each   n .
(Rn );  U ∩ C˙
}
c
c
This  is  a   topology  on  C∞ (Rn )  –  contains  the  empty  set  and  the  whole 
c 
space  and  is  closed  under  ﬁnite  intersections  and  arbitrary  unions   – 
simply  because  the  same  is   true  for  the  open  sets  in  C˙∞ (B (n))  for  each  
n.   This  is  in  fact  the  inductive  limit  topology.  One  obvious   question 
is:­ what  does  it  mean  for  a  linear   functional  u :  Cc
∞ (Rn )  −→ C  to  be 
continuous?  This  just  means   that  u−1 (O) is  open  for  each open  set   in  C. 
Directly  from  the  deﬁnition  this  in   turn  means   that   u−1 (O) ∩ C˙∞ (B (n)) 

LECTURE  NOTES  FOR  18.155,   FALL  2004 
41 
should  be  open  in   C˙∞ (B (n))   for   each   n.  This  however  just  means   that, 
restricted  to   each  of  these  subspaces  u  is   continuous.  If  you   now  go  
forwards  to   Lemma  7.3   you  can  see  what  this   means;  see  Problem  74. 
Of  course  there  is  a  lot   more  to  be   said   about  these  spaces;  you   can 
ﬁnd  plenty  of  it  in  the  references. 

42  

RICHARD  B.  MELROSE  

7.   Tempered  distributions  

A  good  ﬁrst  reference  for  distributions   is   [2],  [4] gives  a  more  exhaus­
tive  treatment.  
The  complete  metric   topology  on  S (Rn )  is   described   above.  Next  I 
want  to   try to  convice  you  that   elements  of  its  dual  space  S � (Rn ),   have 
enough  of  the  properties  of  functions   that   we  can  work  with  them  as 
‘generalized  functions’. 
First  let  me  develop  some  notation.   A   diﬀerentiable  function   ϕ  : 
→
→	
C has  partial  derivatives   which   we  have   denoted  ∂ϕ/∂xj  :  Rn 
Rn 
√−1  into  the 
C.   For  reasons  that  will   become  clear  later,  we  put  a 
deﬁnition	 and  write 

. 

(7.1)	

Dj ϕ  = 

1  ∂ϕ 
i  ∂xj 
We  say  ϕ  is  once   continuously  diﬀerentiable  if  each   of   these  Dj ϕ  is  
continuous.  Then  we  deﬁned   k  times   continuous  diﬀerentiability  in­
ductively  by   saying   that  ϕ  and  the  Dj ϕ  are  (k − 1)­times   continuously 
diﬀerentiable. For  k  = 2   this  means   that  
DjDkϕ  are  continuous   for   j, k  =  1, · · ·  , n . 
Now,   recall   that,   if  continuous,   these  second   derivatives   are  symmetric: 

(7.2)	

DjDkϕ  =  DkDj ϕ . 

(7.4) 

(7.3)  Dαϕ  = 

This  means  we  can  use   a  compact   notation   for   higher  derivatives.  Put  
N0  =  {0, 1, .  .  .};  we   call  an  element   α  ∈ Nn  a  ‘multi­index’  and   if  ϕ  is
0 
at  least  k  times  continuously  diﬀerentiable,   we  set12 
∂ αn
∂ α1 
|
· · · 
+ αn  ≤ k .  
|  α1  + α2  + · · ·
1 
ϕ  whenever  α =
i|α|  ∂x1 
∂xn 
� 
�	
Now  we  have  deﬁned   the  spaces. 
C0 (Rn ) =  ϕ  :  Rn  → C ;  Dαϕ  ∈ C0 (Rn )  ∀  α
| ≤ k 
|
k	
0
� 
�	
Notice   the  convention   is  that   Dαϕ  is   asserted  to  exist   if  it   is   required 
to  be  continuous!   Using   �x� = (1  +  x 2 )  we  deﬁned 
|
| 
�x�−k C0 (Rn ) =  ϕ  :  Rn	
→ C ;  �x�kϕ  ∈ C
k (Rn ) 
k
(7.5) 
� 
0
and  then  our  space  of  test  functions   is 
S (Rn ) = 
�x�−k C0  (Rn ) . 
k
k 

.

,

12Periodically  there  is   the  possibility  of  confusion  between   the  two  meanings  of 
|α|  but  it  seldom  arises. 

LECTURE  NOTES  FOR  18.155,   FALL  2004 

43 

Thus,  
α ≤ k and  all  k . 
)  ∀ |
|
ϕ ∈ S (Rn ) ⇔ (�x�kϕ)  ∈ C 0
0 (Rn
Dα
(7.6)

Lemma  7.1.  The  condition  ϕ ∈ S (Rn )  can  be  written 
�
x�
kDαϕ ∈ C 0
0 (Rn )  ∀  α ≤ k ,  ∀ k . 
|
|
Proof.  We  ﬁrst  check  that

0 (Rn ) ,  j =  1, · · · , n 
ϕ ∈ C
) ,  Dj (�x�ϕ)  ∈ C
0 (Rn
0
0
) ,  �
⇔
ϕ ∈ C
x�Dj ϕ ∈ C (Rn ) ,  j =  1, · · · , n . 
(Rn
0
0
0
0
Since 
�
Dj �x�ϕ =  x�Dj ϕ +  (Dj �x�)ϕ 
and  Dj �x� =  xj �
x�−1  is  a  bounded  continuous  function,   this   is  clear. 
1 
i
Then  consider   the  same  thing  for  a  larger   k : 
�
Dα x�
pϕ ∈ C
α =  p ,  0  ≤ p ≤ k
)  ∀ |
|
0 (Rn
0
0 (Rn )  ∀  α =  p ,  0  ≤ p ≤ k . 
x�⇔ �
pDαϕ ∈ C 0
|
|

(7.7) 

� 

are  equivalent. 

I  leave   you  to   check  this  as  Problem  7.1. 
� 
Corollary  7.2.  For  any  k ∈ N  the  norms 
x  ϕ�∞
� αDβ 
x�kϕ�C k  and 
��
x 
|α|≤k, 
|β |≤k 
��� 
Proof.  Any  reasonable  proof  of   (7.2)   shows  that   the  norms 
��
x�kDβ ϕ�∞ 
x�kϕ�C k  and 
|β |≤k 
⎞ 
⎛
⎛
⎞ 
� 
� 
are  equivalent.   Since  there  are  positive  constants   such  that 
|x α |⎠ ≤ �x� ≤ C2  ⎝1  + 
C1  ⎝1  + 
x| α |⎠ 
k
|α|≤k 
|α|≤k 
the  equivalent   of  the  norms  follows. 
� 
Proposition  7.3.  A  linear   functional   u :  S (Rn )  → C  is  continuous  if 
� 
�
�
sup  �x αDβ ϕ� .
and  only  if  there  exist  C ,  k  such  that 
u(ϕ)| ≤ C 
|
x
Rn 
|α|≤k, 
|β |≤k 

44  

RICHARD  B.  MELROSE 

Proof.  This  is  just  the  equivalence  of  the  norms,  since  we  showed   that 
u  ∈ S � (Rn )  if  and  only   if 

u(ϕ)| ≤ C ��x�kϕ�C k
|

for  some   k . 

� 

Lemma  7.4.  A  linear  map  
T  :  S (Rn
)  → S (Rn
� ��

� �� 
� 
� �
� � 
is  continuous  if  and   only  if  for  each  k  there  exist  C  and  j such  that  if 
|
≤ k  and
 β | ≤ k
|
|
α
αDβ T ϕ  
(7.8) 
sup  x 
sup  x 
Rn 
|α� |≤j,  |β � |≤j 
Proof.  This  is  Problem  7.2. 

∀ ϕ ∈ S (Rn

≤ C 

� 
Dβ �

).

ϕ 

)

α

� 

(7.11) 

(7.10) 

All   this  messing   about  with  norms  shows  that 
)  → S (Rn
) → S (Rn
)  and   Dj  :  S (Rn
xj  :  S (Rn
are  continuous. 
So  now  we  have  some  idea  of  what  u  ∈ S � (Rn )  means.  Let’s   notice  
that  u  ∈ S � (Rn )  implies 
1, · · · , n 
xj u  ∈ S
� (Rn )  ∀ j =
(7.9) 
Dj u  ∈ S � (Rn )  ∀ j = 1, · · · , n 
ϕu  ∈ S � (Rn
)  ∀ ϕ ∈ S (Rn
)
where  we  have  to  deﬁne  these  things  in   a  reasonable  way.  Remem­
ber  that  u  ∈  S � (Rn )  is  “supposed”  to  be   like   an  integral  against  a 
�

“generalized  function”  
Rn 
Since  it  would  be  true  if  u  were  a  function  we  deﬁne 
xj u(ψ) =  u(xj ψ)  ∀ ψ ∈ S (Rn ).  
(7.13) 
Then  we  check  that  xj u ∈ S � (Rn ):  
� 
��

xj u(ψ) =  u(xj ψ)|
|
|
|
≤ C 
sup  x 
�

Rn 
|α|≤k,  |β |≤k 
|α|≤k+1,  |β |≤k 

��

(xj ψ)
� �


u(x)ψ(x) dx  ∀ ψ ∈ S (Rn ).  

αDβ
� �

sup  x 
Rn 

≤ C � 

u(ψ) = 

αDβ ψ

(7.12) 

)

. 

45 

LECTURE  NOTES  FOR  18.155,   FALL  2004 
� 
� 
Similarly  we  can   deﬁne   the  partial  derivatives   by  using  the  standard 
integration  by   parts  formula 
− 
(7.14) 
(Dj u)(x)ϕ(x) dx  = 
u(x)(Dj ϕ(x))  dx 
Rn 
Rn 
if  u  ∈ C0 (Rn ).  Thus  if  u  ∈ S � (Rn )  again  we  deﬁne 
1
Dj u(ψ) =  −u(Dj ψ)  ∀ ψ  ∈ S (Rn ).  
Then  it  is  clear  that   Dj u  ∈ S � (Rn ).  
Iterating   these  deﬁnition  we   ﬁnd   that  Dα ,  for  any  multi­index  α, 
deﬁnes  a  linear   map 

(7.15) 

(7.16) 

Dα  :  S � (Rn )  → S � (Rn ) . 
In  general   a  linear  diﬀerential  operator   with  constant   coeﬃcients  is  a 
sum  of  such  “monomials”.  For  example  Laplace’s  operator   is 
∂ 2 
∂ 2 
∂ 2 
∂x2  − · · · − 
∂x2  −
2  +  · · · +  D2  . 
Δ =  −
∂x2  =  D2
1  +  D2 
n
1
2  
n 
We  will  be  interested  in   trying  to  solve  diﬀerential  equations  such   as 
Δu  =  f  ∈ S � (Rn ) . 
� (Rn ) by  ϕ  ∈ S (Rn ),   simply  deﬁning 
u  ∈ S
We  can  also  multiply 
ϕu(ψ) =  u(ϕψ)  ∀ ψ  ∈ S (Rn ).  
� �
 � 
� 
� �

� �

� �

For  this  to  make  sense  it   suﬃces   to  check that 
≤ C
αDβ ψ  .

x
αDβ (ϕψ)
sup  x 
Rn 
|α|≤k, 
|α|≤k, 
|β |≤k 
|β |≤k 

(7.17) 

sup 
Rn 

This  follows  easily   from  Leibniz’  formula. 
Now,   to   start  thinking  of  u  ∈  S � (Rn )  as   a  generalized  function   we 
ﬁrst  deﬁne  its  support.  Recall   that 
supp(ψ)  =  clos  {x  ∈ Rn ; ψ(x)  = 0} . 
We  can  write  this  in  another   ‘weak’  way  which   is   easier  to  generalize. 
Namely 

(7.18) 

p  /∈ supp(u)  ⇔  ∃ϕ  ∈ S (Rn ) ,  ϕ(p) = 0 ,  ϕu  = 0 . 
(7.19) 
In  fact  this   deﬁnition   makes  sense  for  any  u  ∈ S � (Rn ).  

Lemma  7.5.  The  set  supp(u)   deﬁned  by  (7.19)  is  a  closed  subset  of 
Rn  and  reduces  to  (7.18)  if  u  ∈ S (Rn ).  

�
�
46  

RICHARD  B.  MELROSE 

Proof.  The  set  deﬁned  by  (7.19)  is   closed,  since 
),   ϕ(p)   = 0,  ϕu = 0}
�  =  {p ∈ Rn
;  ∃ ϕ ∈ S (Rn
(7.20) 
supp(u)
is  clearly  open  —  the   same  ϕ  works   for  nearby  points.  If   ψ  ∈  S (Rn ) 
� 
we  deﬁne  uψ  ∈ S � (Rn ),  which  we  will   again   identify  with   ψ ,  by 
(7.21) 
uψ (ϕ) = 
ϕ(x)ψ(x) dx . 
Obviously  uψ  = 0  = ⇒ ψ = 0,   simply  set   ϕ =  ψ  in   (7.21).  Thus   the 
map 

(7.22) 

)  � ψ �−→ uψ  ∈ S
S (Rn
is  injective.  We  want   to   show   that  

� (Rn )

(7.23) 

supp(uψ )  =  supp(ψ) 
on  the  left  given  by  (7.19)  and   on   the  right   by  (7.18).  We  show   ﬁrst  
that 
supp(uψ ) ⊂ supp(ψ).  
∈  supp(uψ ).   The  ﬁrst 
∈  supp(ψ)  ⇒  p  /
Thus,   we  need  to  see  that  p  /
condition  is  that  ψ(x)  =  0  in   a  neighbourhood,  U  of  p,  hence  there 
is  a  C∞  function  ϕ  with  support   in  U  and  ϕ(p)  = 0.  Then  ϕψ  ≡  0. 
Conversely  suppose  p  /∈  supp(uψ ).   Then  there  exists   ϕ ∈  S (Rn )  with 
ϕ(p)  = 0  and   ϕuψ  =  0,   i.e.,  ϕuψ (η)  = 0  ∀ η ∈ S (Rn ).   By  the  injectivity 
of  S (Rn ) �
� (Rn )  this  means  ϕψ  =  0,  so  ψ ≡ 0  in  a  neighborhood   of 
→ S
p and  p  /∈ supp(ψ). 
� 
Consider  the  simplest  examples   of  distribution  which   are  not  func­
tions,  namely  those  with  support   at   a  given  point  p.  The  obvious   one 
is  the   Dirac  delta  ‘function’  
δp (ϕ) =  ϕ(p)  ∀ ϕ ∈ S (Rn ) . 
(7.24) 
We  can  make  many  more,  because  Dα  is   local  
supp(Dα u) ⊂ supp(u)  ∀ u ∈ S � (Rn ) . 
(7.25) 
Indeed,  p  /∈ supp(u)  ⇒ ∃ ϕ ∈ S (Rn ),   ϕu  ≡ 0,  ϕ(p)   = 0.   Thus   each   of 
the  distributions  Dαδp  also  has  support   contained   in   {p}.  In  fact  none 
of  them  vanish,  and  they  are  all  linearly  independent. 

�
�
�
�
LECTURE  NOTES  FOR  18.155,   FALL  2004 

47 

8.   Convolution  and  density  
� 
We  have  deﬁned  an  inclusion   map  
(8.1) 
S (Rn
ϕ(x)ψ(x) dx  ∀ ψ  ∈ S (Rn ).
)  � ϕ 
�−→ uϕ  ∈ S
� (Rn ),   uϕ (ψ) = 
Rn 
This  allows  us   to   ‘think  of ’   S (Rn )  as  a  subspace  of  S � (Rn );   that  is   we 
habitually  identify  uϕ  with   ϕ.  We  can   do  this  because  we  know  (8.1)  
to  be  injective.   We  can  extend  the  map   (8.1)   to  include  bigger   spaces 
�−→ uϕ  ∈ S
C0 (Rn )  � ϕ 
� (Rn )
0 
Lp (Rn )  � ϕ 
�−→ uϕ  ∈ S � (Rn ) 
�−→ � 
M (Rn )  � µ 
uµ  ∈ S � (Rn ) 
uµ (ψ) = 
Rn 

ψ  dµ  , 

(8.2) 

but  we   need  to   know  that  these  maps  are  injective  before  we  can  forget 
about  them.  
We  can  see  this  using   convolution.   This   is  a  sort  of  ‘product’  of 
functions.  To   begin  with,  suppose  v  ∈  C0 (Rn )  and  ψ  ∈  S (Rn ).   We 
� 
0
deﬁne  a   new  function  by  ‘averaging  v  with  respect  to  ψ :’ 
v  ∗ ψ(x) = 
v(x   − y)ψ(y) dy  . 
Rn 

(8.3) 

The  integral  converges  by  dominated   convergence,  namely  ψ(y)  is   in­
tegrable  and  v  is  bounded, 
|
ψ(y)

|
v(x  − y)ψ(y)| ≤ �v�C 0
.|
0
We  can  use  the  same   sort  of  estimates   to  show   that   v  ∗ ψ  is   continuous. 
Fix  x  ∈ Rn  , 
� 
(8.4)  v  ∗ ψ(x  +  x� ) − v  ∗ ψ(x) 
= (v(x   +  x�  − y) − v(x   − y))ψ(y) dy  . 
To   see  that  this  is  small  for   x�  small,  we  split   the  integral  into  two 
� 
pieces.   Since  ψ  is  very  small   near   inﬁnity,   given   �  >  0  we  can   choose 
R  so  large  that 
|
�v�∞  · 
|
ψ(y) dy  ≤ �/4 .
(8.5) 
|y ]|≥R 
The  set  y ≤ R  is  compact  and   if  x ≤ R� ,  |x� ≤ 1  then  x  +  x�
|
|
|
| |
|
− y | ≤
R  +  R�  +  1.  A  continuous  function   is   uniformly  continuous  on  any 

48  

(8.6) 

RICHARD  B.  MELROSE 
� 
compact  set,   so   we  can  chose  δ >  0  such   that  
sup  |v(x  +  x�  − y) − v(x   − y)| · 
|y |≤R 
x� |
|
|y |≤R

<δ
Combining  (8.5)  and  (8.6) we  conclude   that   v ∗ψ  is   continuous.  Finally, 
we  conclude  that 

|ψ(y)| dy  <  �/2 . 

u(y)ψ(x   − y)dy  + 

v  ∈ C0 (Rn )  ⇒ v  ∗ ψ  ∈ C0 (Rn ) . 
0
0
(8.7) 
For  this  we  need  to  show   that   v  ∗ ψ  is   small  at  inﬁnity,  which   follows 
from  the   fact  that   v  is  small  at  inﬁnity.   Namely  given   � >  0 there  exists  
R >  0  such  that  v(y) ≤ �  if  y ≥ R.  Divide  the  integral  deﬁning   the 
|
|
| |
� 
� 
convolution  into  two  
u(y)ψ(x   − y) dy
|
|
|v  ∗ ψ(x)| ≤ 
| |
y<R ≤ �/2�ψ�∞  +  �
y >R 
sup  ψ |.
u�∞ 
|
B (x,R)
Since  ψ  ∈ S (Rn )  the  last  constant   tends  to   0  as  x
|
| → ∞
.
We  can  do  much  better   than  this!  Assuming  |x� ≤  1  we  can   use 
|
� 
� 
Taylor’s  formula  with   remainder   to  write 
�  d
n
· 
ψ(z  +  x� ) − ψ(z ) = 
j (z ,  x� ) . 
xj  ψ˜
dt 
0 
j=1 

ψ(z  +  tx� ) dt  = 

(8.8) 

(8.9) 

As  Problem   23   I  ask   you   to  check  carefully  that  
ψj (z ; x� ) ∈ S (Rn )  depends   continuously  on  x�  in   |x�
| ≤ 1
� 
Going   back  to  (8.3))we  can  use  the  translation  and  reﬂection­invariance 
of  Lebesgue  measure  to   rewrite  the  integral  (by  changing  variable)   as 
v(y)ψ(x   − y) dy  . 
v  ∗ ψ(x) = 
Rn 

(8.10) 

.

This  reverses  the  role   of  v  and  ψ  and  shows   that   if  both  v  and  ψ  are  in  
S (Rn )  then  v  ∗ ψ  =  ψ  ∗ v . 
Using   this  formula   on  (8.4)   we  ﬁnd 
� 

(8.11) 
�
v  ∗ ψ(x  +  x� ) − v  ∗ ψ(x) = 
� 
n
xj 
Rn 
j=1 

= 

v(y)(ψ(x   +  x�  − y) − ψ(x   − y))   dy 
�n
j=1 

xj (v  ∗ ψj (·; x� )(x) . 

j (x   − y ,  x� ) dy  = 
v(y)ψ˜

LECTURE  NOTES  FOR  18.155,   FALL  2004 
49 
v  ∗ ψ(·
; x� )  is   continuous 
From (8.9)  and  what  we  have   already  shown, 
in  both  variables,  and  is  in  C0 (Rn )  in   the  ﬁrst.  Thus 
0
v  ∈ C
0 (Rn ) ,  ψ  ∈ S (Rn )  ⇒
v  ∗ ψ  ∈ C 1 
0 (Rn ) .
0
(8.12) 
In  fact  we  also   see  that 

.

v  ∗ ψ 
=  v  ∗ 
∂ψ 
∂ 
(8.13) 
∂xj 
∂xj 
Thus  v  ∗ ψ  inherits  its  regularity  from  ψ . 
� 
Proposition  8.1.  If  v  ∈ C0 (Rn )  and  ψ  ∈ S (Rn )  then  
0
v  ∗ ψ  ∈ C0
C0 (Rn ) . 
∞ (Rn ) = 
k
(8.14) 
k≥0 

(8.15) 

(8.16) 

Proof.  This  follows   from  (8.12),   (8.13)  and   induction. 

� 
Now,   let  us  make  a   more  special  choice  of  ψ .  We  have  shown   the 
existence  of 
� 
| ≤ 1} . 
ϕ  ∈ C∞ (Rn ) ,  ϕ  ≥ 0 ,  supp(ϕ)  ⊂ {|x
c 
�  � 
We  can  also   assume  Rn  ϕ dx  =  1,  by  multiplying  by  a  positive  constant. 
Now  consider 
1  ≥ t  >  0 . 
x 
ϕt (x) =  t−nϕ 
� 
t 
This  has  all  the  same  properties,  except  that 
supp  ϕt  ⊂ {|x
| ≤ t} , 
(8.17) 
ϕt  dx  = 1 .
Proposition  8.2.  If  v  ∈  C0 (Rn )  then   as  t  →  0,  vt  =  v  ∗ ϕt  →  v  in 
0
0C0 (Rn ).

� 
Proof.  using   (8.17)  we  can  write  the  diﬀerence  as

vt (x) − v(x) =
|
|
| 
| 
(v(x   − y) − v(x))ϕt (y) dy
Rn 
≤ sup  v(x   − y) − v(x)
|
| →
0.
|y |≤t 
Here  we  have  used  the  fact  that  ϕt  ≥ 0  has  support   in   y ≤ t  and  has  
| |
integral  1.  Thus  vt  → v  uniformly  on   any  set   on   which  v  is   uniformly 
� 
continuous,   namel  Rn ! 
Corollary  8.3.  C0 (Rn )  is  dense  in   C0
p (Rn )  for  any  k  ≥ p. 
k
Proposition  8.4.  S (Rn )  is  dense  in  C0  (Rn )  for  any  k  ≥ 0. 
k

(8.18) 

RICHARD  B.  MELROSE 
50  
Proof.  Take   k  =  0  ﬁrst.  The  subspace  Cc  (Rn )  is  dense  in  C0 (Rn ),   by 
0	
0
cutting  oﬀ   outside  a   large  ball.  If  v  ∈ Cc  (Rn )  has  support   in  {|x| ≤ R}
0
then 
v  ∗ ϕt  ∈ C∞
)  ⊂ S (Rn
(Rn
)
c
has  support   in  {|x ≤ R  +  1}.  Since  v  ∗ ϕt  →  v  the  result  follows   for 
|
k  =  0. 
For  k  ≥  1  the  same  argument   works,   since  Dα (v  ∗ ϕt )  = (DαV  ) ∗ 
� 
ϕt . 

Corollary  8.5.  The  map  from  ﬁnite  Radon  measures  
Mﬁn (Rn ) � µ 
�−→ uµ  ∈ S � (Rn ) 
(8.19)	

(8.20)	

(8.22) 

u(x  +  t) − u(x) 2
|
|  dx  = 0 . 

is  injective. 
Now,   we  want  the  same  result  for   L2 (Rn )  (and   maybe  for  Lp (Rn ),  
1  ≤  p  <  ∞).  I   leave  the  measure­theoretic  part   of  the  argument  to 
you. 
Proposition  8.6.  Elements  of  L2 (Rn )  are  “continuous   in  the  mean” 
�

i.e., 
lim 
|t|→0  Rn 
This  is  Problem  24.  
Using   this  we  conclude   that  
S (Rn )  � L2 (Rn )  is   dense 
→
(8.21)	
� 
as  before.  First 	 observe  that  the  space  of   L2  functions  of  compact  
support  is  dense  in  L2 (Rn ),   since 
u(x)| 2	 dx  = 0  ∀ u  ∈ L2 (Rn ) . 
|
lim 
R→∞ 
|x|≥R 
Then  look  back   at  the  discussion   of  v  ∗ ϕ,  now   v  is   replaced  by  u  ∈
� 
2 (Rn ).  The  compactness   of  the  support  means  that  u  ∈ L1 (Rn )  so  in  
Lc
u  ∗ ϕ(x) = 
u(x  − y)ϕ(y)dy 
Rn 
the  integral  is  absolutely  convergent.  Moreover  
�� � � 
�� � �

� 
u  ∗ ϕ(x  +  x� ) − u  ∗ ϕ(x)
|
| 
u(y)(ϕ(x  +  x�  − y) − ϕ(x  − y))   dy 
u�  sup  ϕ(x  +  x�  − y) − ϕ(x  − y)
≤ C �
|	
| → 0 
|y |≤R 

= 

�

Using   the  same  argument  twice 
| � � � 
u  ∗ ϕt (x) − u(x) dx
| 
2 
�� 
u(x  − y) − u(x)
≤
|

|


≤

|

LECTURE  NOTES  FOR  18.155,   FALL  2004 
51 
when  {|x ≤ R} large  enough.  Thus  u  ∗ ϕ  is   continuous   and  the  same 
|
argument   as  before  shows  that  
u  ∗ ϕt  ∈ S (Rn
) .
Now  to   see  that  u  ∗ ϕt  → u,  assuming  u  has  compact  support  (or   not) 
� �� �

� �� �

�

we  estimate  the  integral 
�

(u(x  − y) − u(x))ϕt (y) dy
u  ∗ ϕt (x) − u(x)
|
u(x  − y) − u(x) ϕt (y) dy  .
≤ |
|

=|

|

�

u(x  − y ) − u(x)
|
�
ϕt (y � ) dx  dy  dy �
ϕt (y)
�

u(x  − y) − u(x) 2 |  ϕt (y)ϕt (y � )dx  dy  dy �
≤ sup 
u(x  − y) − u(x) dx  . 
|
|
2 
|y |≤t 

(y � ) .

Note  that  at   the  second  step  here  I  have  used   Schwarz’s   inequality  with 
the  integrand  written  as  the   product 
(y � ) u(x  − y � ) − u(x) ϕt 
· |
u(x  − y) − u(x) ϕt
|
|
|
1/2 (y)ϕ1/2 
1/2 (y)ϕ1/2 
t
t  
Thus  we  now  know  that 
)  �→ S
� (Rn )  is   injective. 
L2 (Rn
This  means  that   all  our  usual   spaces  of   functions  ‘sit   inside’  S � (Rn ).  
Finally   we  can  use  convolution  with   ϕt  to  show   the  existence  of 
If  K  �  U  ⊂  Rn  is   a  compact  set  in  an  
smooth  partitions  of  unity. 
open  set  then  we  have  shown   the  existence  of  ξ  ∈ Cc  (Rn ),   with  ξ  = 1 
0
in  some  neighborhood  of  K  and  ξ  = 1  in  some  neighborhood  of  K  and 
supp(ξ )  � U . 
Then  consider  ξ  ∗ ϕt  for  t  small.  In  fact 
supp(ξ  ∗ ϕt )  ⊂ {p  ∈ Rn  ;  dist(p,  supp   ξ )  ≤ 2t} 
and  similarly,   0  ≤ ξ  ∗ ϕt  ≤ 1  and 
ξ  ∗ ϕt 
= 1  at  p  if  ξ  = 1  on   B (p,  2t) .
Using  this  we  get: 

 
52  
RICHARD  B.  MELROSE 
� 
Proposition  8.7.  If  Ua  ⊂ Rn  are  open   for   a  ∈ A  and  K  � 
a∈A  Ua 
then  there  exist  ﬁnitely  many  ϕi  ∈ C∞ (Rn ),  with  0  ≤ ϕi  ≤ 1,  supp(ϕi ) ⊂
c 
Uai  such   that 
ϕi  = 1   in  a  neighbourhood  of  K. 
i 
Proof.  By  the  compactness  of  K  we  may choose  a  ﬁnite  open  subcover. 
� ,  of  unity 
Using  Lemma  1.8  we   may  choose   a  continuous  partition,  φi
subordinate  to   this  cover.  Using  the  convolution   argument  above  we 
� ∗ ϕt  for  t  >  0.  If  t  is   suﬃciently  small   then   this   is 
� by  φi
can  replace  φi
again  a   partition  of  unity  subordinate  to  the  cover,  but  now  smooth. 
� 

Next  we  can  make  a   simple  ‘cut  oﬀ  argument’  to  show  
Lemma  8.8.  The  space  C∞ (Rn )  of  C∞  functions  of  compact  support 
is  dense  in  S (Rn ). 
c 
Proof.  Choose   ϕ  ∈  C∞ (Rn )  with   ϕ(x)   = 1  in   x ≤  1.  Then   given  
|
| 
ψ  ∈ S (Rn )  consider  the  sequence 
c 
ψn (x) =  ϕ(x/n)ψ(x) . 
Clearly  ψn  =  ψ  on  x ≤ n,  so  if  it   converges   in   S (Rn )  it  must  converge 
|
|
to  ψ .  Suppose  m  ≥
then  by  Leibniz’s  formula13 
n
α � 
� � 
� 
Dβ  � 
x  (ψn (x) − ψm (x)) 
Dα 
·
)   Dα−β ψ(x) .
ϕ( 
x
x 
β 
β≤α 
� 
All  derivatives  of  ϕ(x/n)   are  bounded,   independent   of  n  and  ψn  =  ψm 
in  x ≤ n  so  for  any  p
|
|
|Dα 
x  (ψn (x) − ψm (x))| ≤ 
Hence  ψn  is  Cauchy  in  S (Rn ).  
� 
Thus  every   element  of  S � (Rn )  is   determined  by  its   restriction   to 
cC∞
(Rn ).  The  support  of  a  tempered   distribution  was   deﬁned  above  to 
be 

0 
Cα,p �x�−2p 

| ≤ n
| ≥ n 

|
x
|
x

(8.23) 

�  .
;  ∃ ϕ  ∈ S (Rn
supp(u) =  x  ∈ Rn
) ,  ϕ(x) = 0 ,  ϕu  = 0} 
{
Using   the  preceding   lemma  and  the  construction  of  smooth   partitions  
of  unity  we  ﬁnd 

. 

= 

) − ϕ(

x 
n

x 
m 

Proposition  8.9.  f 

u  ∈ S

� (Rn )  and  supp(u) =  ∅ then   u  = 0.

13Problem  25.  

�
53 
LECTURE  NOTES  FOR  18.155,   FALL  2004 
Proof.  From  (8.23),   if  ψ  ∈ S (Rn ),   supp(ψu)  ⊂ supp(u).   If   x  � supp(u)  
then,   by  deﬁnition,  ϕu  = 0  for   some  ϕ  ∈ S (Rn )  with  ϕ(x)   =  0.  Thus  
ϕ  = 0 on  B (x,   �) for  �  >  0  suﬃciently  small.   If  ψ  ∈ C∞ (Rn ) has  support  
� 
c
in  B (x,   �)  then  ψu  =  ψϕu  =  0,  where  ψ˜ ∈ C∞ (Rn ):
˜
c 
in   B (x,  �)  
ψ/ϕ 
ψ˜ = 
� 
0 
elsewhere  . 
Thus,  given  K  � Rn  we  can  ﬁnd  ϕj  ∈ C∞ (Rn ),   supported  in  such  balls, 
ϕj  ≡  1  on  K  but  ϕj u  =  0.  For   given  µ  ∈  C∞ (Rn )  apply 
c 
so   that 
� 
� 
c 
j
this  to  supp(µ).  Then 
ϕj µ  ⇒ u(µ) =
(φj u)(µ)   = 0 . 
j 
j
Thus  u  = 0  on  C∞ (Rn ),  so  u  =  0. 
c 

µ  = 

�

The  linear  space  of  distributions  of  compact   support  will  be  denoted 
C −∞ (Rn );  it  is  often  written  E � (Rn ).
c 
Now  let  us   give  a   characterization   of  the  ‘delta  function’ 
δ(ϕ) =  ϕ(0)  ∀ ϕ  ∈ S (Rn ) , 
or  at  least  the  one­dimensional   subspace  of  S � (Rn )  it  spans.  This   is 
based  on  the  simple  observation  that  (xj ϕ)(0)   = 0  if  ϕ  ∈ S (Rn )!  
Proposition  8.10.  If  u  ∈ S � (Rn )  satisﬁes  xj u  = 0,  j  = 1, · · · , n  then  
u  =  cδ . 

(8.24) 

Proof.  The  main  work  is  in  characterizing  the  null  space  of  δ  as  a  linear 
functional,  namely   in  showing  that 
H =  {ϕ  ∈ S (Rn
� 
can  also   be  written  as 
H =  ϕ  ∈ S (Rn );   ϕ  = 

);   ϕ(0) = 0}
� 
� 
n
xj ψj  ,  ϕj  ∈ S (Rn ) 
j=1 

(8.25) 

. 

(8.26) 

Clearly  the  right  side  of  (8.25)   is  contained   in  the  left.  To  see  the 
converse,   suppose  ﬁrst  that 
ϕ  ∈ S (Rn ) ,  ϕ  = 0  in  |x| <  1 . 
� 

Then  deﬁne 

ψ  = 

0 
ϕ/ |x| 
2 

|
|
x <  1 
| ≥ 1
|
x

.

�
�
RICHARD  B.  MELROSE 
54  
All   the  derivatives   of  1/ |x| 2  are  bounded  in   x ≥ 1,  so  from  Leibniz’s 
|
|
� 
formula  it  follows  that  ψ  ∈ S (Rn ).   Since 
xj (xj ψ) 
j 

ϕ  = 

(8.27) 

= 

(tx) dt  . 

ϕ(tx) dt 

t  d 
dt

this  shows  that  ϕ  of  the  form  (8.26)  is  in  the   right   side  of  (8.25).  In  
� 
general  suppose  ϕ  ∈ S (Rn ).   Then  
�  t� 
ϕ(x) − ϕ(0)  = 
0 
n
∂ϕ 
xj 
∂xj
0 
j=1 
Certainly  these  integrals  are  C∞ ,  but  they  may  not   decay  rapidly  at  
inﬁnity.  However,  choose  µ  ∈  C∞ (Rn )  with  µ  = 1  in   x ≤  1.  Then
|
|
c 
(8.27)  becomes,  if   ϕ(0)  = 0, 
�  t
� 
ϕ  =  µϕ  +  (1  − µ)ϕ 
n
xj ψj  +  (1  − µ)ϕ ,  ψj  =  µ 
∂ϕ 
∂xj 
0 
j=1 
Since  (1  − µ)ϕ  is  of  the   form  (8.26),  this  proves  (8.25). 
Our  assumption  on  u  is  that   xj u  = 0,  thus  
u(ϕ)   = 0  ∀ ϕ  ∈ H 
by  (8.25).   Choosing  µ  as  above,  a  general  ϕ  ∈ S (Rn )  can  be  written  
ϕ  =  ϕ(0) · µ +  ϕ�  ,  ϕ�  ∈ H . 

(tx) dt  ∈ S (Rn ) . 

= 

Then 

u(ϕ) =  ϕ(0)u(µ)  ⇒ u  =  cδ  ,  c  =  u(µ) . 

� 

This  result  is  quite   powerful,  as  we  shall  soon  see.  The  Fourier 
� 
transform  of  an  element   ϕ  ∈ S (Rn )  is14 
e−ix·ξ ϕ(x) dx  ,  ξ  ∈ Rn  . 

ˆ
ϕ(ξ ) = 

(8.28) 

14Normalizations  vary,   but  it  doesn’t  matter  much. 

LECTURE   NOTES  FOR  18.155,  FALL  2004 
55 
The  integral  certainly   converges,  since  |ϕ| ≤ C �x�−n−1  .  In  fact  it  fol­
�  � ��
� ��

lows  easily  that  ˆ

ϕ  is  continuous,   since 
ix−ξ  − e−x·ξ �  |

ϕ(ξ ) −  ˆ
| ∈ 
|
|
�
ϕ(ξ
ˆ
)
ϕ dx
e 
→
→
0  as   ξ � 

ξ .

In  fact 

Proposition  8.11.  Fourier  transformation,  (8.28),  deﬁnes  a  continu­
ous  linear   map  

e−ix·ξ

xj ϕ(x) dx  . 

) ,  F ϕ  =  ϕ . 
F  :  S (Rn
)  → S (Rn
ˆ
� 
Proof.  Diﬀerentiating   under   the   integral15  sign   shows   that  
∂ξj ϕ(ξ ) =  −i
e−ix·ξ
ˆ
Since  the   integral   on   the  right  is  absolutely  convergent  that  shows  that  
ˆ =  −�
(remember  the  i’s) 
xj ϕ ,  ∀ ϕ  ∈ S (Rn ) . 
(8.30)	
Dξj ϕ
Similarly,   if  we  multiply  by  ξj  and  observe  that   ξj e−ix· =  i  ∂ 
� �

ξ 
∂xj 
then  integration  by  parts   shows 
∂ 
ξj  ˆϕ  =  i 
( 
∂xj 
=  −i
∂ϕ 
e−ix·ξ 
�
dx 
∂xj 
ξj  ˆϕ ,  ∀ ϕ  ∈ S (Rn )

= 
Dj ϕ 
� 
� 
Since  xj ϕ,   Dj ϕ  ∈ S (Rn ) 
these  results   can  be  iterated,  showing  that

� � �

� � �

� �
�
� �

(−1)|
ˆϕ  =  F 
|Dα
ξ αDβ 
xx β ϕ
(8.32)

. 
ξ 
x�
≤ C ��
≤ Cαβ  sup 
x�
n+1+|β |
Thus  ξ αDβ 
xxβ ϕ 
+n+1Dα 
ξ  ˆϕ 
shows  that  F  is  continuous  as  a  map  (8.32). 
Suppose  ϕ  ∈ S (Rn ).  Since  ˆ
ϕ  ∈ S (Rn ) 
�

tion  u  ∈ S � (Rn ) 
Rn 

� 
we  can  consider   the  distribu­

e−ix·ξ )ϕ(x) dx 

u(ϕ) = 

ϕ(ξ ) dξ  . 
ˆ

ϕ�C |α|

,  which 

.


β

(8.29) 

(8.31)	

(8.33)	

15See [5] 

56  

u(xj ϕ) = 

RICHARD  B.  MELROSE 
�  �� 
The  continuity   of  u  follows  from  the  fact  that   integration   is  continuous  
and  (8.29).   Now  observe   that  
xj ϕ(ξ ) dξ 
Rn 
− 
ˆ
Dξj ϕ dξ  = 0
Rn 
� 
where  we  use  (8.30).   Applying   Proposition  8.10  we  conclude  that  u  = 
cδ  for  some  (universal)  constant  c.  By  deﬁnition  this  means  
Rn 

ˆ
ϕ(ξ ) dξ  =  cϕ(0) . 

(8.34) 

= 

So   what  is  the  constant?  To  ﬁnd  it  we  need   to  work  out   an  example. 
The  simplest  one  is 
ϕ  = exp(−  x /2)   .
| 
|
2
Lemma  8.12.  The  Fourier  transform  of  the  Gaussian  exp(−  x /2)  
|
|
2
is  the  Gaussian  (2π)n/2   exp(−  ξ 2  /2). 
| | 
Proof.  There  are  two  obvious  methods   —   one  uses   complex  analysis 
� 
(Cauchy’s  theorem)  the   other,  which   I  shall  follow,  uses   the  uniqueness 
of  solutions  to   ordinary  diﬀerential  equations. 
j  exp(−xj /2).  Thus  16
First  observe  that  exp(−  x 2  /2)   = 
|
| 
� 
2
n
ψ(ξj ) ,  ψ(x) =  e−x2 /2  , 
ˆ
j=1 

ˆ
ϕ(ξ ) = 

being   a  function  of  one   variable.   Now  ψ  satisﬁes  the  diﬀerential  equa­
tion 

(∂x  +  x) ψ  = 0 , 
and  is  the  only  solution  of  this  equation   up   to  a  constant  multiple.  By 
∂xψ  +  �
�
(8.30)  and  (8.31)  its  Fourier   transform  satisﬁes  
d
xψ  =  iξψˆ +  i
dξ 
This  is  the  same  equation,  but  in  the   ξ  variable.  Thus  ψˆ =  ce−|ξ |2
� 
Again  we  need  to  ﬁnd   the  constant.  However, 
e−x2 /2  dx  = (2π)1/2 

ψˆ(0)  =   c  = 

ˆ = 0 .
ϕ 

/2

. 

16Really  by  Fubini’s  theorem,  but  here  one  can   use  Riemann   integrals. 

2 
c  = 

e−r2 /2r  dr  dθ  = 2π . 

LECTURE  NOTES  FOR  18.155,   FALL  2004 
�  2π 
�
� 
by  the   standard  use  of  polar  coordinates: 
∞ 
e−(x2+y2 )/2  dx  dy  = 
Rn 
0 
0
This  proves  the  lemma. 
� 
Thus  we   have  shown   that  for  any  ϕ  ∈ S (Rn ) 
ϕ(ξ ) dξ  = (2π)nϕ(0) . 
(8.35) 
ˆ
Rn 
Since  this  is  true  for  ϕ  =  exp(− x /2).   The  identity  allows  us  to 
|
|
2
invert  the  Fourier  transform. 

57 

� 

58  

RICHARD  B.  MELROSE 

(9.1) 

ϕ(0)  = (2π)−n 

ˆϕ(ξ ) dξ  ∀ ϕ  ∈ S (Rn ) . 

9.   Fourier  inversion 
� 
It  is  shown  above  that   the  Fourier   transform  satisﬁes   the  identity 
Rn 
If  y  ∈  Rn  and  ϕ  ∈  S (Rn )  set  ψ(x) =  ϕ(x  +  y).   The  translation­
� 
invariance  of  Lebesgue   measure  shows  that 
e−ix·
iy ·ξ  ˆ
=  e ϕ(ξ ) . 

ξ ϕ(x  +  y) dx 

ψˆ(ξ ) = 

(9.2) 

� 
Applied  to   ψ  the  inversion  formula  (9.1)  becomes  
� 
ϕ(y) =  ψ(0) = (2π)−n 
Rn 
Theorem 9.1.  Fourier   transform  F  :  S (Rn )  → S (Rn )  is  an   isomor­
� 
phism  with   inverse 

iy ·ξ  ˆ
e ϕ(ξ ) dξ  . 

= (2π)−n 

ψˆ(ξ ) dξ 

(9.3) 

G :  S (Rn

) → S (Rn

) ,  Gψ(y)  = (2π)−n 

eiy ·ξ ψ(ξ ) dξ  . 

Proof.  The  identity  (9.2)  shows  that  F  is   1 − 1,  i.e.,   injective,  since  we 
can  remove  ϕ  from  ϕ.   Moreover, 
ˆ
Gψ(y) = (2π)−nF ψ(−y) 
(9.4) 
So   G  is  also  a  continuous  linear  map,  G  :  S (Rn )  →  S (Rn ).  
Indeed  
the  argument  above  shows  that   G ◦ F  =  I d  and  the  same  argument, 
with  some  changes  of  sign,   shows  that  F · G  =  I d.  Thus   F  and  G  are 
isomorphisms.  
� 

� 
� 
Lemma  9.2.  For  al l  ϕ,   ψ  ∈ S (Rn ),  Paseval’s  identity  holds: 
Rn 
Rn 

ϕψ  dx  = (2π)−n 

ϕ  ˆˆψ  dξ  . 

(9.5) 

LECTURE  NOTES  FOR  18.155,   FALL  2004 
�  � 
� 
� 
Proof.  Using   the   inversion  formula  on   ϕ, 
� 
� 
ϕψ   dx  = (2π)−n 
ix·ξ  ˆ
e ϕ(ξ ) dξ  ψ(x) dx 
� 
ϕ(ξ ) 
ˆ

= (2π)−n 

e−ix·

ξ ψ(x) dx  dξ 

= (2π)−n 

ϕ(ξ ) ˆ
ˆ ϕ(ξ ) dξ  . 

59 

Here  the  integrals  are  absolutely  convergent,  justifying  the  exchange  of 
orders. 
� 

(9.6) 

Proposition  9.3.  Fourier  transform  extends   to  an   isomorphism 
F  :  L2 (Rn ) → L2 (Rn ) . 
Proof.  Setting  ϕ  =  ψ  in  (9.5)   shows  that 
�F ϕ�L2  = (2π)n/2�ϕ�L2  . 
(9.7) 
In  particular  this  proves,  given   the  known  density  of  S (Rn )  in  L2 (Rn ),  
that  F  is  an  isomorphism,  with  inverse   G ,  as  in  (9.6). 
� 
� 
� 
For  any  m  ∈ R 
x�mL2 (Rn ) = 
� (Rn ) ;   �x�−m  ˆu  ∈ L2 (Rn )
u  ∈ S
�
is  a   well­deﬁned  subspace.  We  deﬁne  the  Sobolev  spaces   on  Rn  by,  for  
� 
� 
m  ≥ 0 
H m (Rn ) =  u  ∈ L2 (Rn ) ;   ˆu  =  F u  ∈ �ξ �−mL2 (Rn ) 
(9.8) 
. 
(Rn )  if  m  ≥ m�  ,  H 0 (Rn ) =  L2 (Rn ) . 
Thus  H m (Rn )  ⊂ H m� 
Lemma  9.4.  If  m  ∈ N  is  an  integer,  then  
| ≤ m 
u  ∈ H m (Rn ) ⇔ Dα u  ∈ L2 (Rn )  ∀  α
|
(9.9) 
.
�
Proof.  By  deﬁnition,   u  ∈ H m (Rn ) implies   that  �ξ �−m  ˆu  ∈ L2 (Rn ).   Since 
u  this  certainly  implies  that   Dαu  ∈  L2 (Rn )  for   α ≤  m. 
|
|
Dαu  =  ξ α ˆ
Conversely  if  Dαu  ∈ L2 (Rn ) for  all  α ≤ m  then  ξ α ˆu  ∈ L2 (R
|
|
� 
n )
for  all 
|
|
α ≤ m  and  since 
≤ Cm 
|α|≤m 
this  in  turn  implies  that  �ξ �m  ˆu  ∈ L2 (Rn ).  

�ξ �m 

|ξ α |

.

� 

60  

RICHARD  B.  MELROSE  

e−ix·ξ ψˆ(ξ ) dξ 

e−ix·
ξ η(ξ ) dξ  = (2π)−nηˆ(x). 

Now  that  we  have  considered  the  Fourier  transform  of  Schwartz  test 
functions  we  can  use   the  usual  method,  of  duality,  to  extend  it  to 
tempered  distributions.   If  we  set  η  =  ψ  then  ψ  =  η  and  ψ  =  Gψˆ =  G η 
ˆ
ˆ
� 
so 
� 
ψ(x)  = (2π)−n 

= (2π)−n
� 
� 
Substituting   in  (9.5)  we  ﬁnd   that 
η  dx  = 
ϕ ˆ
ˆ
ϕη  dξ  .  
Now,  recalling   how  we   embed  S (Rn )  �→ S � (Rn )  we  see  that  
η)  ∀ η  ∈ S (Rn
(9.10) 
ϕ (η) =  uϕ ( ˆ
) . 
u ˆ
Deﬁnition  9.5.  If  u  ∈ S � (Rn )  we  deﬁne  its  Fourier  transform  by 
ϕ)  ∀ ϕ  ∈ S (Rn
) .
ˆ
(9.11) 
u(ϕ) =  u( ˆ
u  =  u  · F ,  with  each   term  continuous,  ˆ
As  a  composite  map,   ˆ
u  is  
continuous,  i.e.,   ˆu  ∈ S � (Rn ).  

Proposition  9.6.  The  deﬁnition   (9.7)  gives  an   isomorphism 
F  :  S � (Rn )  → S
� (Rn ) ,  F u  =  u
ˆ
satisfying  the  identities �
Dαu  =  ξ α u  ,  � = (−1)|
|Dα ˆu . 
α
xαu 
(9.12) 
Proof.  Since  ˆu  =  u  ◦ F  and  G  is   the  2­sided  inverse  of  F , 
u  = ˆu  ◦ G 
(9.13) 
gives  the   inverse  to   F  :  S �
(Rn )  → S
� (Rn ),   showing  it   to  be  an  isomor­
phism.  The  identities  (9.12)  follow   from  their   counterparts  on  S (Rn ):  
�
=  u(� u(ξ αϕ) =  ξ α ˆ
ϕ) =  u((−1)|
|Dα  ˆ
α
Dαu(ϕ) =  Dα u( ˆ
ϕ)
u(ϕ)   ∀ ϕ  ∈ S (Rn
ξ αϕ)  = ˆ
� 
� 
We  can  also  deﬁne  Sobolev  spaces   of   negative  order: 
H m (Rn ) =  u  ∈ S � (Rn ) ;   ˆ
u  ∈ �ξ �−mL2
(Rn ) 

(9.14) 

) . 

� 

.

(9.15) 

u  = 

(9.16) 

LECTURE  NOTES  FOR  18.155,   FALL  2004 
61 
Proposition  9.7.  If  m  ≤ 0  is  an  integer  then   u  ∈ H m (Rn )  if  and  only 
� 
if  it  can  be  written  in  the  form 
Dα vα  ,  vα  ∈ L2 (Rn ) . 
|α|≤−m 
� 
Proof.  If  u  ∈ S � (Rn )  is  of  the  form  (9.15)  then 
vα  ∈ L2 (Rn ) . 
� 
ξ αvˆα  with  ˆ
u  = 
ˆ
|α|≤−m 
Thus  �ξ �m  ˆu  = 
mvˆα .  Since  all  the  factors  ξ α �ξ �
|α|≤−m  ξ α �ξ �
m
are 
bounded,  each  term  here  is   in  L2 (Rn ),   so  �ξ �m  ˆu  ∈ L2 (Rn )  which   is  the 
deﬁnition,   u  ∈ �ξ �−mL2 (Rn ).  
⎛
⎞ 
Conversely,  suppose  u  ∈  H m (Rn ),   i.e.,  �ξ � u  ∈  L2 (Rn ).   The  func­
m  ˆ
� 
⎝ 
|ξ α ⎠ 
tion 
| 
· �ξ �m 
∈ L2 (Rn )  (m  <  0)
|α|≤−m 
⎞−1 
⎛
� 
is  bounded  below   by  a   positive   constant.  Thus  
|ξ α ⎠  u  ∈ L2 (Rn ) .
v  =  ⎝ 
|
ˆ
|α|≤−m 
v  ∈ L2 (Rn )  so  the   identity  (9.16), 
vα  = sgn(ξ α )ˆ
Each of the  functions  ˆ
and  hence   (9.15),  follows  with  these  choices. 
� 
Proposition  9.8.  Each   of  the  Sobolev  spaces  H m (Rn ) is  a  Hilbert  space 
�� 
�1/2 
with  the  norm   and   inner   product 
� 
u�Hm  = 
�
u(ξ )| �ξ �2m  dξ 
|
2
ˆ
Rn 
u(ξ )vˆ(ξ )�ξ �2m  dξ  . 
�u,  v� = 
ˆ
Rn 
The  Schwartz  space  S (Rn )  � H m (Rn )  is  dense  for   each  m  and  the 
→
pairing 
� 
H m (Rn ) × H −m (Rn )  � (u,  u�
�−→ 
) 
u� (ξ )uˆ� (·ξ ) dξ  ∈ C 
((u,   u� ))   = 
ˆ
Rn 
�  =  H −m (Rn ). 
gives  an  identiﬁcation  (H m (Rn ))

(9.17) 

,

(9.18) 

62  

RICHARD  B.  MELROSE 

Proof.  The  Hilbert  space  property  follows  essentially  directly  from  the 
deﬁnition (9.14)  since   �ξ �−mL2 (Rn )  is  a  Hilbert   space  with   the  norm 
(9.17). Similarly   the  density  of  S  in   H m (Rn ) follows,  since  S (Rn ) dense 
in  L2 (Rn )  (Problem  L11.P3)   implies  �ξ �−mS (Rn ) =  S (Rn )  is   dense  in 
�ξ �−mL2 (Rn )  and  so,  since  F  is   an   isomorphism  in  S (Rn ),   S (Rn )  is 
dense   in  H m (Rn ). 
Finally   observe  that  the  pairing  in  (9.18)   makes   sense,  since  �ξ �−m  ˆu(ξ ),  
u� (ξ )  ∈ L2 (Rn )  implies 
�ξ �m  ˆ
ˆu(ξ ))uˆ� (−ξ )  ∈ L1 (Rn ) . 
Furthermore,   by  the  self­duality of  L2 (Rn ) each  continuous   linear  func­
tional 
U  :  H m (Rn )  → C ,  U (u)  ≤ C �u�Hm 
can  be  written  uniquely  in  the  form 
U (u)  = ((u, u� ))   for   some  u�  ∈ H −m (Rn ) . 
Notice  that  if  u, u�  ∈ S (Rn )  � 
then
((u, u� ))   = 
u(x)u� (x) dx . 
Rn 
This  is  always  how   we   “pair”  functions  —  it   is  the  natural  pairing  on 
� 
L2 (Rn ).  Thus  in  (9.18)  what  we  have  shown   is  that   this   pairing  on   test 
function 
)  � (u, u� → ((u, u� ))   = 
) × S (Rn
S (Rn
) �−
u(x)u� (x) dx
Rn 
extends  by  continuity  to  H m (Rn ) × H −m (Rn )  (for   each  ﬁxed  m)  when 
it  identiﬁes  H −m (Rn )  as  the  dual  of  H m (Rn ).   This   was   our   ‘picture’ 
at  the   beginning.  
For  m  >  0  the  spaces  H m (Rn )  represents   elements  of  L2 (Rn )  that  
have  “m”   derivatives  in   L2 (Rn ).   For  m < 0  the  elements   are  ??  of  “up 
to  −m”  derivatives  of  L2  functions. For  integers  this   is   precisely  ??. 

� 

LECTURE  NOTES  FOR  18.155,   FALL  2004	

63 

10.  Sobolev  embedding 

The  properties  of  Sobolev  spaces   are  brieﬂy  discussed  above.  If  m 
is  a   positive  integer  then  u  ∈  H m (Rn )  ‘means’  that   u  has  up  to  m 
derivatives  in  L2 (Rn ).  The  question  naturally  arises  as   to  the  sense 
in  which  these  ‘weak’   derivatives   correspond  to  old­fashioned   ‘strong’ 
derivatives.  Of  course   when   m  is   not  an   integer   it  is   a  little  harder 
to  imagine  what  these   ‘fractional  derivatives’  are.  However   the  main 
result  is: 
Theorem  10.1  (Sobolev  embedding).  If  u ∈ H m (Rn )  where  m > n/2 
then  u ∈ C0 (Rn ),  i.e., 
0
) ⊂ C0
0 (Rn ) ,  m > n/2 . 
m (Rn
(10.1)	
H
Proof.  By  deﬁnition,   u ∈ H m (Rn )  means 
� (Rn )  and  �ξ �m  ˆ(ξ )  ∈
v ∈ S
u
L2 (Rn ).  Suppose  ﬁrst   that  u ∈ S (Rn ).   The  Fourier   inversion  formula 
� �� �

� �� � 
� 
shows  that 
|

�1/2
� � �

ix·ξ ˆu
�� 
(2π)n  u(x)
e 
ξ �−2m  dξ 
· 
|
| 
2 
ˆ(ξ )u
Rn 
Rn 
Now,  if  m  >  n/2  then   the  second  integral  is  ﬁnite.  Since  the  ﬁrst 
integral  is  the  norm   on  H m (Rn )  we  see  that 
sup  u(x)| =  u L∞  ≤ (2π)−n u Hm  , m > n/2 . 
|
� �
� �
(10.2) 
Rn 
This  is  all   for  u  ∈  S (Rn ),   but   S (Rn )  � H m (Rn )  is  dense.   The
→
� 
estimate   (10.2)  shows  that   if  uj  →  u  in   H m (Rn ),   with  uj  ∈  S (Rn ),  
�  in  C0 (Rn ).  In  fact  u�  =  u  in   S � (Rn )  since 
j  →
j  → 
0
then	
� 
� 
� 
u  in  
u
u
u
in  C

j  →
� 
0 (Rn ) both  imply  that  
2 (Rn )  and  u
0
j ϕ converges,  so
u
u
L
u�ϕ ∀ ϕ ∈ S (Rn ).  
uj ϕ → 
Rn 
Rn 
Rn 

�1/2 

ξ �
�
2m 

| = 

≤ 

dξ

.

(ξ ) dξ


uϕ = 

� 
Notice  here  the  precise  meaning   of  u =  u� , u ∈ H m (Rn )  ⊂ L2 (Rn ),  
u�  ∈  C0 (Rn ).  When  identifying  u  ∈  L2 (Rn )  with   the  corresponding 
0
tempered  distribution,   the  values   on  any  set   of  measure  zero  ‘are  lost’. 
Thus  as  functions  (10.1)  means  that   each   u ∈ H m (Rn )  has   a  represen­
tative   u�  ∈ C0 (Rn ). 
0
We  can  extend  this  to  higher   derivatives   by  noting  that  

64  
RICHARD  B.  MELROSE 
Proposition  10.2.  If  u ∈ H m (Rn ),  m ∈ R,  then  D u ∈ H m−|α| (Rn ) 
α
and 

(10.3) 

is  continuous. 

Dα

:  H

m (Rn ) →

H m−|α| (Rn ) 

Proof.  First  it  is  enough  to  show  that   each  Dj  deﬁnes   a  continuous  
linear  map 

(10.4) 

Dj  :  H m (Rn )  → H m−1 (Rn )  ∀ j 
2 (Rn ).   Since  �Dj u =
since  then  (10.3)  follows  by  composition. 
If  m ∈ R  then  u ∈ H m (Rn )  means  ˆ
u ∈ �ξ �−mL
·
ξj  uˆ,   and 
∀ m 
|ξj | �ξ �−m  ≤ C
m �ξ �−m+1
we   conclude  that  Dj u ∈ H m−1 (Rn )  and  
�Dj u�Hm−1  ≤ Cm� �
u Hm  .

� 

Applying  this  result  we  see  
Corollary  10.3.  If  k ∈ N0  and  m > n  +  k then
2 
) ⊂ C0 
m (Rn
k (Rn ) . 
(10.5) 
H
Proof.  If  α ≤  k ,  then  Dαu ∈  H
m−k (Rn )  ⊂  C
|
| 
0 (Rn ).   Thus  the  ‘weak 
0
derivatives’   Dαu are  continuous.  Still  we  have  to  check  that  this  means 
that  u is  itself  k times  continuously  diﬀerentiable.   In  fact  this   again  
follows  from  the  density  of  S (Rn )  in  H m (Rn ).   The   continuity  in   (10.3) 
implies  that  if  uj  → u in  H m (Rn ),   m > n  +  k ,  then  uj  → u�  in   C0  (Rn )
k
(using   its  completeness).  However  u =  u�  as  before,  so  u ∈ C0  (Rn ).  
2 
k
� 
� 
In  particular  we  see  that 
H ∞ (Rn ) =  H
m 

)  ⊂ C∞ (Rn ) . 

m (Rn

(10.6) 

These  functions  are  not  in  general  Schwartz  test  functions. 
� �
Proposition  10.4.  Schwartz  space  can   be  written  in  terms  of  weighted 
Sobolev  spaces 
x�−kH k (Rn ) . 
k 

S (Rn ) = 

(10.7) 

65 

).

(Rn

LECTURE  NOTES  FOR  18.155,   FALL  2004 
�
�
Proof.  This  follows  directly  from  (10.5)   since  the  left  side  is  contained  
in 
C
)  ⊂ S (Rn
�−k
k−n 
x

0
k 
� 
�

Theorem  10.5  (Schwartz  representation).  Any  tempered  distribution  
can  be  written  in  the  form  of  a  ﬁnite  sum 
αβ  ∈ C
|α|≤m 
|β |≤m 
�

|α|≤m

|β |≤m


αβ  ),   vαβ  ∈ C

βαD
x  uαβ  , u

or  in  the  form 

0 (Rn ).
0

0 (Rn ).
0

x  (x  α v
β 
D

(10.8) 

(10.9) 

u = 

u = 

x 

).

Thus  every  tempered   distribution   is   a  ﬁnite  sum  of  derivatives  of 
continuous  functions  of  poynomial  growth. 
Proof.  Essentially  by  deﬁnition  any  u ∈ S � (Rn )  is   continuous   with   re­
�� �
x kϕ�C k  .  From  the  Sobolev  embedding  
spect  to  one  of  the  norms  
theorem  we  deduce  that,   with   m > k +  n/2,  
|u(ϕ)| ≤ C �� �
�
∀ ϕ ∈ S (Rn
x kϕ Hm 
� �
�
� �

This  is  the  same  as  
(ϕ)   ≤ C �ϕ
�−k  u
Hm  ∀ ϕ ∈ S (Rn ).
�

x
� 
�−k u ∈ H −m (Rn ),   i.e.,  from  Proposition   9.8, 
which  shows  that  �x

α  ∈ L
�−k  u = 
�
2 (Rn
Dα
)

. 
uα  ,  u
x
|α|≤m 
In  fact,   choose  j > n/2  and   consider   vα  ∈ H j (Rn )  deﬁned   by  ˆvα  = 
�

�ξ �−j ˆα . 
As  in  the  proof  of  Proposition   9.14  we  conclude  that 
u
� ∈ H j (Rn
)  ⊂ C
β  u�
0 (Rn
0
D
α,β  , uα,β 
|β |≤j 
� � �

k
u =  x
|γ |≤M 
To   get  (10.9)   we  ‘commute’  the  factor  �x k  to  the  inside;  since  I  have 
�
not  done  such  an  argument  carefully  so  far,  let   me  do  it  as   a  lemma. 

γ  ∈ C

γ
αvγ  ,  v

Thus,17  

0 (Rn
0

(10.10) 

uα  = 

) .

D

)

. 

17This  is  probably  the  most  useful  form  of   the  representation   theorem! 

66  
RICHARD  B.  MELROSE 
Lemma  10.6.  For  any  γ  ∈ Nn 
� 
� 
� 
0  there  are  polynomials   pα,γ (x)  of  degrees 
| 
at  most  γ  − α such  that 
|
Dγ−α  pα,γ �x�k−2|γ−α|v .
�x�kDγ 
v  = 
α≤γ 
Proof.  In  fact  it  is  convenient   to  prove  a  more  general  result.  Suppose 
| � 
p  is  a   polynomial  of  a  degree  at   most   j  then  there  exist  polynomials  of 
|
degrees   at  most  j  +  γ  − α such that 
Dγ−α (pα,γ �x�k−2|γ−α|v) . 
p�x�kDγ  v  = 
(10.11) 
α≤γ 
The  lemma   follows  from   this  by  taking  p  =  1. 
Furthermore,  the  identity  (10.11)  is  trivial  when  γ  =  0,  and  proceed­
ing  by  induction   we  can  suppose  it   is   known  whenever   |γ | ≤ L. Taking 
|
|
γ =  L  +  1,  
Dγ  =  DjDγ �  |γ � =  L.
|
� 
Writing  the  identity  for  γ �  as 
p�x�kDγ � 
= 
α�≤γ � 
we  may  diﬀerentiate   with  respect   to  xj .  This  gives 
� 
p�x�kDγ  =  −Dj (p�x�k ) Dγ � 
·
v 
x�k−2|γ−α|
α� ,γ � �
(p�
Dγ−α� 
+2
v) .
|α� |≤γ 
The  ﬁrst  term  on  the   right  expands  to 
v  −  kpxj �x�k−2Dγ � 
(−(Dj p) · �
x�kDγ � 
1 
v) .
i 
We  may   apply  the  inductive  hypothesis   to  each  of  these  terms  and 
rewrite  the  result   in  the  form  (10.11);   it   is  only  necessary  to  check  the 
order  of  the  polynomials,  and   recall   that  �
x�
2  is   a  polynomial   of  degree 
� 
2.  
Applying  Lemma  10.6  to  (10.10)  gives  (10.9),  once  negative  powers 
of  �x�  are  absorbed  into   the  continuous  functions.  Then   (10.8)  follows  
� 
from  (10.9)  and  Leibniz’s  formula. 

(pα ,γ �x�k−2|γ �−α� |v) 
Dγ �−α� 
�
� 

+ 

LECTURE  NOTES  FOR  18.155,   FALL  2004 

67 

11.  Differential  operators. 

) .

In  the  last  third  of  the  course  we  will  apply  what   we  have  learned 
about  distributions,  and  a  little  more,  to  understand  properties   of  dif­
ferential  operators  with  constant  coeﬃcients.  Before  I  start   talking 
about  these,  I   want   to   prove  another   density  result. 
So  far  we  have  not  deﬁned   a  topology  on   S � (Rn )  –  I  will  leave  this  
as  an  optional  exercise.18   However   we  shall  consider  a   notion   of  con­
vergence.  Suppose  uj  ∈  S � (Rn )  is   a  sequence  in  S � (Rn ).   It   is   said  to 
converge  weakly  to  u  ∈ S � (Rn )  if 
uj (ϕ) →
u(ϕ)   ∀ ϕ  ∈ S (Rn
(11.1) 
There  is  no   ‘uniformity’  assumed   here,  it  is  rather   like  pointwise  con­
vergence  (except  the  linearity  of  the  functions   makes   it   seem  stronger). 
Proposition  11.1.  The  subspace  S (Rn )  ⊂  S � (Rn )  is  weakly  dense, 
i.e.,  each  u  ∈ S � (Rn )  is  the  weak  limit  of  a  subspace  uj  ∈ S (Rn ). 
� � 
Proof.  We  can  use  Schwartz   representation   theorem  to  write,  for  some 
m  depending  on  u, 
u  =  x�
m 
|α|≤m 
We  know   that  S (Rn )  is  dense  in   L2 (Rn ),   in  the  sense  of  metric  spaces  
so  we  can  ﬁnd  uα,j  ∈ S (Rn ),   uα,j  → uα  in   L2 (Rn ).   The  density  result 
� 
then  follows  from  the   basic  properties  of  weak  convergence. 
Proposition  11.2.  If  uj  →  u  and  uj
� →  u�  weakly  in  S � (Rn )  then  
cuj  → cu,  uj  + uj
uj  → �
x�mu  weakly 
� → u  + u� ,  Dαuj  → Dαu  and  �x�m
in  S � (Rn ). 
Proof.  This  follows  by   writing  everyting  in  terms   of  pairings,  for   exam­
ple  if  ϕ  ∈ S (Rn ) 
Dα uj (ϕ) =  uj ((−1)(α)Dαϕ)  → u((−1)(α)Dαϕ) =  Dα u(ϕ) . 

Dα uα  ,  uα  ∈ L2 (Rn ) . 

� 
This  weak  density  shows   that  our  deﬁnition  of  Dj ,  and  xj ×  are 
unique  if  we  require  Proposition  11.2  to  hold. 
We  have  discussed  diﬀerentiation  as  an   operator   (meaning  just  a 
linear  map between  spaces  of  function­like  ob jects) 
Dj  :  S � (Rn
) → S
� (Rn ) .

18Problem  34.  

68  
Any  polynomial  on  Rn 

deﬁnes  a  diﬀerential   operator19 

(11.2)	

p(D)u = 

RICHARD  B.  MELROSE 
� 
|α|≤m 

p(ξ ) = 

pαξ α  ,  pα  ∈ C 
� 
|α|≤m 

pαDα u . 

(11.4)	

(11.3)	

Before  discussing   any  general  theorems  let  me  consider   some  exam­
ples.  
� 
On  R2  , ∂ =  ∂x  +  i∂y “d­bar  operator” 
n
on  Rn  ,  Δ = 
2“Laplacian” 
Dj
j=1 
on  R × Rn  =  Rn+1 ,  Dt 
2  − Δ“Wave  operator” 
onR × Rn  =  Rn+1  ,  ∂t  +  Δ“Heat   operator” 
on  R × Rn  = 
Rn+1	
,  Dt  +  Δ“Schr¨
odinger   operator” 
Functions,   or  distributions,   satisfying  ∂u  =  0  are  said  to  be  holo­
morphic,  those  satisfying  Δu = 0  are  said  to  be  harmonic. 
Deﬁnition  11.3.  An  element  E ∈ S � (Rn )  satisfying 
P (D)E =  δ 
(11.8) 

(11.5) 

(11.6) 

(11.7) 

is  said  to  be  a  (tempered)   fundamental   solution  of  P (D). 

Theorem  11.4  (without  proof ).  Every  non­zero  constant  coeﬃcient 
diﬀerential  operator  has  a  tempered  fundamental  solution. 

This  is  quite   hard  to   prove  and   not   as  interetsing  as  it   might   seem. 
We  will  however  give  lots  of  examples,  starting  with   ∂ .  Consider  the 
function 

(x +  iy)−1  ,  (x, y) =�
1 
0 . 
E (x, y) =
(11.9) 
2π
Lemma  11.5.  E (x, y)  is  local ly  integrable  and  so  deﬁnes   E  ∈ S � (R2 ) 
� 
by 
1 
2π  R2 

(x +  iy)−1ϕ(x, y) dx dy , 

E (ϕ) = 

(11.10) 

and  E  so  deﬁned   is  a  tempered  fundamental  solution  of  ∂ . 

19More  correctly  a  partial   diﬀerential  operator  with   constant  coeﬃcients. 

(x   +  iy)−1  ∂ϕ dx   dy  . 

+

(x   +  iy)−1ϕ(x,   y) dy  . 

(11.11) 

(11.12) 

= 

r  dr  dθ 
r

= 2π . 

(x  +  iy)−1∂xϕ dx  dy  =

LECTURE  NOTES  FOR  18.155,  FALL  2004 
69 
Proof.  Since  (x+ iy)−1  is  smooth  and   bounded  away  from  the  origin   the 
�  2π  �  1
�

local  integrability   follows  from  the   estimate,  using  polar  coordinates, 
dx  dy 
|(x,y)|≤1  x  +  iy | 
|
0
0
Diﬀerentiating  directly   in   the  region   where  it   is  smooth, 
∂x (x  +  iy)−1  =  −(x  +  iy)−2  ,  ∂y (x   +  iy)−1  =  −i(x  ∈ iy)−2 
so   indeed,  ∂E   = 0   in  (x,  y) =�
0.20 
The  derivative  is   real ly  deﬁned   by 
�

(∂E )(ϕ) =  E (−∂ϕ) 
− 
1 
=  lim 
|x|≥� 
↓
2π 
� 0 
|y |≥� 
Here  I  have  cut  the  space  {|x ≤ � ,  y ≤ �} out   of  the  integral  and  used 
| |
| 
the  local   integrability  in  taking  the  limit  as   �  ↓ 0.  Integrating  by  parts  
� 
� 
in  x  we  ﬁnd 
−  |x|≥�
� 
� 
|x|≥� 
|y |≥� 
|y |≥� 
(x  +  iy)−1ϕ(x,  y) dy  − 
|y |≤� 
|y |≤� 
x=−� 
x=�
There   is  a   corrsponding  formula  for   integration   by  parts   in  y  so, 
recalling   that  ∂E   = 0   away  from  (0,  0), 
� 
(11.13)  2π∂E (ϕ) 
|y |≤� 

= 
�

[(�  +  iy)−1ϕ(�,  y) − (−�  +  iy)−1ϕ(−�,   y)]   dy 
|x|≤� 
assuming   that  both   limits  exist.  Now,  we  can   write 
ϕ(x,  y) =  ϕ(0,  0)  +  xψ1 (x1y) +  yψ2 (x,  y) . 
� �� �

� �� �

�

�

Replacing  ϕ  by  either   xψ1  or  yψ2  in   (11.13)  both   limits  are  zero.  For  
example

|y |≤� 
|y |≤� 
20Thus  at  this  stage  we  know  ∂E  must  be   a   sum   of   derivatives  of  δ . 

[(x   +  i�)−1ϕ(x,   �) − (x   − i�)−1ϕ(x,   �)]   dx  , 

(�  +  iy)−1 �ψ1 (�,  y) dy 

≤

(∂x (x   +  iy)−1 )ϕ dx  dy 

lim 
↓
� 0 

+  i lim 
� 0↓

|ψ1 | →

0 .

70  

=  lim  < 
↓
� 0 

= 2π . 

c  =  lim 2� 
↓
� 0 

RICHARD  B.  MELROSE 
� 
� 
Thus  we  get  the  same  result  in   (11.13)   by  replacing  ϕ(x,   y) by  ϕ(0,  0). 
Then  2π∂E (ϕ) =  cϕ(0),  
dy 
dy 
|y |≤�  �2  +  y 2 
|y |≤1  1  +  y 2 
� 
� 
Let  me  remind  you  that  we  have  already  discussed  the  convolution 
of  functions  
u(x  − y)v(y) dy  =  v  ∗ u(x) . 
u  ∗ v(x) = 
This  makes  sense  provided  u  is   of  slow   growth  and   s  ∈ S (Rn ).   In  fact 
we  can  rewrite  the  deﬁnition  in   terms   of  pairing 
(u  ∗ ϕ)(x) =  �u,  ϕ(x   − ·)� 
(11.14) 
where   the   · indicates  the   variable  in   the  pairing. 
Theorem 11.6   (H¨ormander,  Theorem  4.1.1).   If  u  ∈ S � (Rn )  and  ϕ  ∈ 
S (Rn )  then 
u  ∗ ϕ  ∈ S (Rn ) ∩ C∞ (Rn ) 
and  if  supp(ϕ)  � Rn
�
supp(u  ∗ ϕ)  ⊂ supp(u) +  supp(ϕ) . 
For  any  multi­index  α 
Dα (u  ∗ ϕ) =  Dα u  ∗ ϕ  =  u  ∗ Dαϕ . 
Proof.  If  ϕ  ∈ S (Rn )  then  for   any  ﬁxed  x  ∈ Rn  , 
ϕ(x  − ·)  ∈ S (Rn
) .
Indeed  the  seminorm  estimates   required  are 
y ϕ(x  − y) <  ∞ ∀ α,  k >  0 . 
sup(1   +  |y | 2 )k/2  Dα
|
|
y 
y ϕ(x  − y)  = (−1)|α| (Dαϕ)(x  − y)  and  
(1  +  |y |  )  ≤ (1  +  x  − y )(1  +  |x|  )
|
| 
2
2
2

Since  Dα

we  conclude  that 
�(1  +  y 2 )k/2Dα
| 2 )k/2��y�
y (x  − y)�L∞  ≤ (1  +  x
| | 
|
kDα
The  continuity   of  u  ∈ S � (Rn )  means  that  for  some  k 
u(ϕ) ≤ C  sup  �(y)kDαϕ�L∞
|
|
|α|≤k 

y ϕ(y)�L∞  .

so   it  follows  that 
|u  ∗ ϕ(x)| =  |�u,  ϕ(x   − ·)�| ≤ C (1  +  x 2 )k/2  .
|
| 

(11.15) 

LECTURE  NOTES  FOR  18.155,  FALL  2004 
71 
The  argument  above  shows   that  x �→ ϕ(x− ) is  a  continuous   function 
·
of  x  ∈  Rn  with  values  in  S (Rn ),   so  u ∗ ϕ  is   continuous   and   satisﬁes  
(11.15).  It  is  therefore  an  element  of   S � (Rn ).  
Diﬀerentiability  follows  in   the  same  way  since  for  each  j ,  with  ej  the 
j th  unit  vector  
ϕ(x +  sej  − y) − ϕ(x − y)
∈ S (Rn
) 
s 
is  continuous  in   x  ∈  Rn  ,  s  ∈  R.  Thus,   u ∗ ϕ  has  continuous  partial  
derivatives  and 
Dj u ∗ ϕ =  u ∗ Dj ϕ . 
The  same  argument   then  shows  that  u ∗ ϕ ∈ C∞ (Rn ).   That   Dj (u ∗ ϕ) = 
Dj u ∗ ϕ follows  from  the  deﬁnition  of  derivative  of  distributions  
Dj (u ∗ ϕ(x))  = (u ∗ Dj ϕ)(x)  
=  �u, Dxj ϕ(x − y)� = 
= (Dj u) ∗ ϕ . 
Finally   consider   the  support   property.  Here  we  are  assuming  that 
supp(ϕ)  is  compact;  we   also  know  that  supp(u)   is  a  closed  set.  We 
have  to   show   that 

−�
u(y), Dyj ϕ(x − y)�y

x  /∈ supp(u) +  supp(ϕ) 
(11.16) 
implies  u ∗ ϕ(x� )  = 0   for   x�  near   x.  Now   (11.16)   just  means   that 
supp  ϕ(x − ·) ∩ supp(u) =  φ , 
(11.17) 
Since  supp  ϕ(x − ·) =  {y ∈ Rn ; x − y ∈ supp(ϕ)},  so  both  statements 
mean  that  there  is  no  y ∈ supp(ϕ)  with  x − y ∈ supp(u).   This   can  also 
be   written 
supp(ϕ) ∩ supp  u(x − ·) =  φ 
and  as  we  showed  when  discussing  supports  implies 
u ∗ ϕ(x� ) =  u(x�  − ·), ϕ� = 0 . 
�
From  (11.17)  this  is  an  open  condition  on  x� ,  so  the  support  property 
follows. 
� 

Now  suppose  ϕ,   ψ ∈ S (Rn )  and   u ∈ S � (Rn ).   Then  
(u ∗ ϕ) ∗ ψ =  u ∗ (ϕ ∗ ψ) . 
(11.18) 
This  is  really   H¨ormander’s   Lemma  4.1.3  and  Theorem  4.1.2;  I  ask  you 
to  prove  it  as  Problem   35. 
We  have  shown  that  u  ∗ ϕ  is   C∞
� (Rn )  and  ϕ  ∈  S (Rn ),
if  u  ∈  S
i.e.,   the   regularity  of  u ∗ ϕ  follows   from  the  regularity  of  one  of  the 

72  
RICHARD  B.  MELROSE 
factors.  This  makes  it   reasonable   to  expect   that   u  ∗ v  can be  deﬁned  
u  ∈ S
� (Rn ),  v  ∈ S � (Rn )  and  one  of  them  has  compact  support. 
�

�

when 
If  v  ∈ Cc
∞ (Rn )  and  ϕ  ∈ S (Rn )  then

�	
�
u(·), v(x  − ·)�ϕ(x) dx  =	
u(·), v(x   − ·)�ˇvϕ(−x) dx 
u  ∗ v(ϕ) = 
where  ϕ(z ) =  ϕ(−z ).  In  fact   using  Problem  35, 
ˇ
ϕ)(0)   = (u   ∗ (v  ∗  ˇ
u  ∗ v(ϕ)  = ((u  ∗ v) ∗  ˇ	
ϕ))(0)  .
(11.19) 
Here,   v , ϕ   are  both  smooth,  but  notice 
Lemma  11.7.  If  v  ∈ S � (Rn )  has   compact  support  and  ϕ  ∈ S (Rn )  then  
v  ∗ ϕ  ∈ S (Rn ).

Proof.  Since  v  ∈ S � (Rn )  has   compact   support   there  exists  χ  ∈ C∞ (Rn )

c 
such that  χv  =  v .  Then 
v  ∗ ϕ(x) = (χv) ∗ ϕ(x) =  �χv(y), ϕ(x  − y)�y 
=  u(y), χ(y)ϕ(x  − y)�y  . 
�

Thus,  for  some  k , 

|v  ∗ ϕ(x)|
≤ C �χ(y)ϕ(x  − y)�(k)
where  �  �(k)  is  one  of  our  norms  on  S (Rn ).   Since  χ  is   supported  in 
some   large  ball, 
��

��

�χ(y)ϕ(x  − y)�(k) 
y (χ(y)ϕ(x  − y))  
�y�
kDα
sup 
|α|≤k 
C  sup  sup   |
(Dαϕ)(x  − y)| 
|y |≤R  |α|≤k 
CN  sup (1  +  x  − y 2 )−N/2
|
|
|y |≤R 
CN (1  +  |x| 2 )−N/2  .
Thus  (1   +  |x| 2 )N/2  
|v  ∗ ϕ|
is   bounded  for  each   N .  The  same  argument  
applies  to  the  derivative  using  Theorem	 11.6,  so 
v  ∗ ϕ  ∈ S (Rn

≤

≤ 
≤ 
≤ 

) .

� 
In  fact  we  get  a  little   more,  since  we  see  that   for   each  k  there  exists 
k �  and  C  (depending  on  k  and  v)  such   that 
v  ∗ ϕ�(k)  ≤ C �ϕ�(k
�

)  .

�

LECTURE  NOTES  FOR  18.155,   FALL  2004 

73 

This  means  that  

)  → S (Rn
v∗ :  S (Rn
)
is  a   continuous   linear   map. 
Now  (11.19) allows   us  to  deﬁne  u ∗ v when  u ∈ S � (Rn ) and  v  ∈ S � (Rn ) 
has  compact  support  by 
u ∗ (v ∗  ˇ
u ∗ v(ϕ) = 
ϕ)(0) .
Using  the  continuity  above,   I  ask  you  to  check  that   u ∗ v  ∈ S � (Rn )  in  
Problem  36.   For   the   moment  let  me   assume  that   this  convolution  has  
the  same  properties  as  before  –  I  ask  you  to  check  the  main  parts  of 
this  in  Problem  37. 
Recall   that  E ∈ S � (Rn )  is  a  fundamental   situation   for  P (D),   a  con­
stant  coeﬃcient  diﬀerential  operator,  if   P (D)E   =  δ .  We  also  use  a 
weaker  notion. 

Deﬁnition  11.8.  A  parametrix  for  a  constant  coeﬃcient  diﬀerential  
operator   P (D)  is  a  distribution  F  ∈ S � (Rn )  such  that 
P (D)F  =  δ +  ψ ,   ψ ∈ C∞ (Rn ) . 
(11.20) 
An  operator  P (D)  is  said  to  be  hypoelliptic  if  it  has   a  parametrix  sat­
isfying 

sing  supp(F )  ⊂ {0} , 
(11.21) 
where  for   any  u ∈ S � (Rn ) 
{
�  =  x ∈ Rn
(sing  supp(u))

(11.22) 

;  ∃ ϕ ∈ C∞
(Rn ) ,
c
ϕ(x) = 0, ϕu  ∈ C∞ (Rn )} .
c 
Since  the  same  ϕ  must   work  for  nearby  points  in  (11.22),  the  set  
sing   supp(u)  is   closed.  Furthermore 
sing  supp(u)  ⊂ supp(u) . 
(11.23) 
As  Problem  37   I   ask   you  to  show  that   if  K � Rn  and  K ∩sing  supp(u) = 
φ the  ∃ ϕ ∈ C∞ (Rn )  with  ϕ(x) = 1  in  a  neighbourhood   of  K  such that 
ϕu  ∈ Cc
c

∞
(Rn ).  In  particular

sing  supp(u) =  φ
(11.24) 

⇒ u ∈ S
� (Rn ) ∩ C∞ (Rn ) .
Theorem  11.9.  If  P (D)  is  hypoel liptic  then 
sing  supp(u)  =  sing  supp(P (D)u)  ∀ u ∈ S � (Rn ) . 
Proof.  One   half  of  this  is  true  for  any  diﬀerential  operator: 
Lemma  11.10.  If  u ∈ S � (Rn )  then   for  any  polynomial 
sing  supp(P (D)u) ⊂ sing  supp(u)  ∀ u ∈ S � (Rn ) . 
(11.26) 

(11.25) 

�
74 	

RICHARD  B.  MELROSE 

� 
∈ sing  supp(P (D)u).
∈ sing  supp(u)  ⇒ x  /
Proof.  We  must  show  that  x  /	
Now,   if  x  /∈ sing  supp(u)  we  can   ﬁnd   ϕ ∈ C∞ (Rn ),   ϕ ≡ 1  near  x,  such  
that  ϕu  ∈ C∞ (Rn ).  Then 
c 
c 
P (D)u =  P (D)(ϕu +  (1  − ϕ)u)  
=  P (D)(ϕu) +  P (D)((1  − ϕ)u) . 
∈ sing  supp(P (D)u).
∈ supp(P (D)((1−ϕ)u)),   so  x  /
The  ﬁrst  term   is  C∞  and  x  /
� 
It  remains  to  show   the  converse   of  (11.26) where  P (D) is  assumed  to 
be  hypoelliptic. Take  F ,  a  parametrix  for  P (D) with  sing  supp  u ⊂ {0}
and  assume,  or  rather  arrange,  that  F  have  compact   support.  In  fact  
if  x  /∈ sing  supp(P (D)u)  we  can  arrange  that 
(supp(F ) +  x) ∩ sing  supp(P (D)u) =  φ . 
Now  P (D)F  =  δψ with  ψ ∈ C∞ (Rn )  so
c 
u =  δ ∗ u = (P (D)F ) ∗ u − ψ ∗ u. 
Since  ψ ∗ u ∈ C∞  it  suﬃces   to  show  that  ¯ ∈ sing  supp  ((P (D)u) ∗ f ) . 
x  /
Take   ϕ ∈ C∞ (Rn )  with  ϕf  ∈ C∞ ,  f  =  P (D)u   but
c 
(supp  F +  x) ∩ supp(ϕ)  = 0 . 
Then  f  =  f1  +  f2 ,  f1  =  ϕf  ∈ Cc
∞ (Rn )  so 
=  f1  ∗ F +  f2  ∗ F
f ∗ F 
f1  ∗ F  ∈  C∞ (Rn )	
and  x  /∈	 supp(f2  ∗ F ).  
where 
sing  supp(u). 

Example  11.1.  If  u  is  holomorphic  on   Rn  ,  ∂u =  0,  then  u ∈ C∞ (Rn ). 

Recall   from   last  time   that  a  diﬀerential  operator  P (D)  is   said  to  be 
hypoelliptic  if  there  exists  F  ∈ S � (Rn )  with  
P (D)F − δ ∈ C∞ (Rn )  and   sing  supp(F )  ⊂ {0} . 
(11.27)	
The  second  condition  here   means  that  if  ϕ ∈ C∞ (Rn ) and  ϕ(x) = 1  in 
x	 < � for  some   � > 0  then  (1−ϕ)F  ∈ C∞ (Rn ).   Since  P (D)((1−ϕ)F )  ∈
|
|	
c 
C∞ (Rn )  we  conclude  that 
P (D)(ϕF ) − δ ∈ Cc
∞ (Rn ) 
and  we   may  well   suppose  that   F ,  replaced  now   by  ϕF ,  has  compact 
support.  Last   time  I  showed  that  
If  P (D)  is  hypoelliptic  and  u ∈ S � (Rn )  then 
sing  supp(u)   =  sing  supp(P (D)u) . 

∈
It   follows  that  x  /

LECTURE  NOTES  FOR  18.155,   FALL  2004 

75 

I  will  remind  you  of  the  proof  later. 
First  however   I   want  to  discuss  the  important  notion  of  el lipticity. 
� 
Remember  that  P (D)  is  ‘really’ just   a  polynomial,  called  the  charac­
teristic  polynomial 
|α|≤m 

Cαξ α  . 

P (ξ )  = 

It  has  the  property 
�P (D)u(ξ )  =  P (ξ ) ˆ
u(ξ )  ∀ u  ∈ S

� (Rn ) .
This  shows  (if  it  isn’t   already  obvious)  that  we  can  remove  P (ξ )  from 
P (D)  thought  of  as   an   operator  on  S � (Rn ).  
We  can  think   of  inverting  P (D) by  dividing by  P (ξ ).   This  works 
� 
well   provided  P (ξ )  =  0,  for   all  ξ  ∈ Rn  .  An   example  of  this  is 
n
P (ξ ) =  |ξ | 2  +  1 = 
� 
+1  . 
j=1 
n
2 ,  does   not   satisfy  this  rather  
However  even  the  Laplacian,  Δ  = 
j=1  Dj
stringent  condition.  
� 
It  is  reasonable  to  expect  the  top   order   derivatives  to  be  the  most  
important.  We  therefore   consider  
α|=m|

Pm (ξ ) = 

Cαξ α 

the  leading   part,   or   principal  symbol,  of  P (D).  

Deﬁnition  11.11.  A  polynomial  P (ξ ),  or  P (D),  is  said  to  be  elliptic 
of  order   m  provided  Pm (ξ )  = 0  for  al l  0 =  ξ  ∈ Rn  . 
So  what  I  want  to   show  today  is 

Theorem  11.12.  Every  el liptic  diﬀerential  operator  P (D)  is  hypoel­
liptic. 
transform  of  (11.27)  we  see  that  F� should  satisfy 
We  want  to  ﬁnd  a  parametrix  for  P (D);   we  already  know  that   we 
might as  well  suppose  that  F  has  compact   support. Taking  the  Fourier  
P (ξ )F�(ξ ) = 1  +  �ψ ,  ψ� ∈ S (Rn ) . 
),   so  ψ� ∈ S (Rn )  too. 
(11.28) 
Here  we  use  the  fact  that  ψ  ∈ C∞ (Rn
)  ⊂ S (Rn
c 
Pm (ξ ) =  |ξ | m  Pm (ξ�), ξ  =  ξ/ ξ ,  ξ  = 0 . 
�
First  suppose  that   P (ξ ) =  Pm (ξ )  is   actually  homogeneous   of  degree 
m.  Thus 
| |

�
�
�
�
76  

, 

(11.29) 
Since  S

(11.30)


RICHARD  B.  MELROSE 
Pm (ξ�)  = 0  ∀  �
The  assumption  at  ellipticity  means  that 
=  {ξ ∈ Rn ; ξ = 1} .
ξ ∈ S n−1 
| |
� � �
� � � 
m (ξ�)  ≥ C > 0  ∀  �ξ ∈ S n−1
n−1  is  compact  and  Pm  is   continuous  
P
� � �

� � � 
m (ξ�)
for  some   constant  C .  Using  homogeneity 
ξ≥ C | | 
m  ,  C > 0  ∀ ξ ∈ Rn
Now,   to   get  F� from  (11.28)  we  want  to  divide  by  Pm (ξ )  or  multiply 
(11.31)

.

P
by 1/Pm (ξ ).  The  only   problem  with  deﬁning  1/Pm (ξ )  is   at   ξ =  0.  We  
shall   simply  avoid  this  unfortunate  point   by  choosing  P  ∈ C∞ (Rn )  as
before,  with  ϕ(ξ ) = 1   in  ξ ≤ 1.
| |
c 
Lemma  11.13.  If  Pm (ξ )  is  homogeneous  of  degree  m  and  el liptic  then 
(1  − ϕ(ξ ))   ∈ S � (Rn ) 
P (ξ )m
is  the  Fourier   transform   of  a  parametrix   for  Pm (D),  satisfying  (11.27). 
Proof.  Clearly  Q(ξ ) is  a   continuous  function   and  Q(ξ ) ≤ C (1+ ξ )−m
∀ ξ ∈
|
|
| |
Rn ,  so   Q  ∈  S � (Rn ). 
It  therefore  is  the  Fourier  transform  of  some 
F  ∈ S
m (D)F (ξ ) =  Pm (ξ )F� =  Pm (ξ )Q(ξ ) 
� (Rn ).  Furthermore 
P� 
Pm (D)F  =  δ +  ψ , ψ�(ξ ) =  −ϕ(ξ ) .
= 1  − ϕ(ξ ) , 
⇒
ϕ  ∈  C∞ (Rn )  ⊂  S (Rn ),   ψ  ∈  S (Rn )  ⊂  C∞ (Rn ).  
Since 
Thus   F  is  a
c
parametrix  for  Pm (D).  We  still  need  to  show  the  ‘hard  part’  that 
sing  supp(F )  ⊂ {0} . 

(11.33) 

(11.32) 

Q(ξ )  =

� 
We  can  show  (11.33)  by considering   the  distributions   xαF .  The  idea 
is  that  for   |α|  large,   xα  vanishes  rather  rapidly  at   the  origin  and  this 
should  ‘weaken’  the   singularity  of  F  there.   In   fact   we  shall   show  that 
|+m−n−1 (Rn ) ,  α > n +  1  − m . 
x αF  ∈ H |
|
|
α
If  you  recall,   these  Sobolev  spaces   are  deﬁned  in   terms  of  the  Fourier 
�x
transform,   namely  we  must  show  that 
αF  ∈ �ξ �−|α|−m+n+1L2 (Rn ) . 

(11.34) 

�
77 

. 

|  .

(11.35) 

(11.36) 

(11.37)	

1 
P (ξ ) 

| |
|  in  ξ >  1/C

Now  αF�x
�
LECTURE  NOTES  FOR  18.155,  FALL  2004 
of  the  derivatives  of  F�,  which   is  just  Q(ξ )  in   (11.32). 
(−1)
α|Dα
|
=

F ,  so  what  we  need  to  cinsider  is  the   behaviour  
ξ 
Lemma  11.14.  Let  P (ξ )  be  a  polynomial   of  degree  m  satisfying 
P (ξ )| ≥ C  |ξ | m  in  ξ >  1/C   for  some  C  >  0 ,
|	
| |
� � ��

� � ��

then  for   some  constants  Cα 
≤ Cα  | |
−m−|α
Dα 
ξ
Proof.  The  estimate  in  (11.36)   for   α  =  0  is   just   (11.35).  To  prove  the 
higher  estimates  that   for  each  α  there  is  a  polynomial  of  degree  at  most 
(m  − 1)  α such that  
|
|
� �� �

� �� �

Once  we  know  (11.37)  we  get   (11.36)   straight  away  since 
C | |
� ξ (m−1) α|
|
)  ≤ Cα  | |
−m−|α
α
Dα 
ξ
|  |ξ | 
m(1+|α|
C 1+ α|
We  can  prove  (11.37)  by  induction,  since  it   is   certainly  true  for  α  =  0. 
Suppose  it  is  true  for   |α| ≤ k . To  get  the  same  identity  for   each   β  with 
β =  k + 1  it  is  enough  to   diﬀerentiate  one  of  the  identities  with   |α| =  k
|
|
once.	 Thus 
(1  +  |α|)LαDj P (ξ ) 
P (ξ )1+|α|  −
1 
Dβ  1
Dj Lα (ξ ) 
=  DjDα 
= 
. 
(P (ξ ))2+|α| 
P (ξ )
P (ξ )
Since  Lβ (ξ ) =  P (ξ )Dj Lα (ξ ) − (1  +  α )Lα (ξ )Dj P (ξ )  is  a  polynomial  of 
|
|
degree  at  most  (m − 1)  α + m − 1  = (m − 1)  β this  proves  the  lemma. 
|	
|
|
|
� 
Going   backwards,  observe  that  Q(ξ ) =  Pm (ξ)  is   smooth   in  ξ ≤ 1/C ,
| |
1−ϕ
so  (11.36)  implies  that  

Lα (ξ ) 
|
(P (ξ ))1+ α

Dα  1
P (ξ ) 

1 
P (ξ ) 

= 

. 

| 

≤


(11.38)	

DαQ(ξ ) ≤ Cα (1  +  ξ )−m−|α|
|
|
| |
⇒ �ξ �
�DαQ  ∈ L2 (Rn )  if  �  − m  − α
|
| <  −
n
,
2 
which  certainly  holds  if  �  =  α +  m  − n  − 1,  giving  (11.34).  Now,  by 
|
|
Sobolev’s  embedding   theorem 
k  if  α > n  +  1  − m  +  k  + 
αF  ∈ C
|
|	

x 

. 

n
2 

78  
RICHARD  B.  MELROSE 
In  particular  this  means  that  if  we  choose  µ ∈ C∞ (Rn ) with  0  /∈ supp(µ)
c 
then  for  every  k ,  µ/ |x| 
2k
is   smooth  and 
x 2k  F ∈ C 2�−2n  ,  � > n . 
|x| 2k  |
| 
µ
µF  = 
Thus  µF  ∈ C∞ (Rn ) and  this   is  what  we  wanted   to  show,   sing  supp(F ) ⊂
.{0}
c 
So  now   we  have  actually  proved  that  Pm (D)  is  hypoelliptic  if  it  is 
elliptic.  Rather   than  go   through   the  proof  again  to  make  sure,  let  me 
go   on  to   the  general  case  and   in  doing  so  review  it. 

On  the  other  hand 

Cαξ α 

P (ξ ) − Pm (ξ ) = 

Proof.  Proof  of  theorem.  We  need  to  show  that  if  P (ξ )  is   elliptic  then  
P (D)  has  a  parametrix   F as  in   (11.27).  From  the  discussion   above  the 
ellipticity  of  P (ξ )  implies  (and   is  equivalent  to) 
|Pm (ξ )| ≥ c | | 
ξ m  ,  c > 0 .
� 
α <m|
|
is  a  polynomial  of  degree  at  most  m − 1,  so 
P (ξ ) − Pm (ξ ) 2  ≤ C � (1  +  ξ )m−1  .
|
|
| |
This  means  that  id  C >  0  is  large  enough  then  in  |ξ |  >  C ,  C � (1  + 
|ξ |)m−1  < c  ξ
2  | | 
m 
,  so 
P (ξ ) − Pm (ξ )
P (ξ )| ≥ |Pm (ξ )
| − |
|
| 
≥ c |ξ | m 
− C � (1  +  |ξ |)m−1 
≥ 
| | 
c
ξ m 
.
2 
This  means  that   P (ξ )  itself  satisﬁes   the  conditions  of  Lemma  11.14. 
Thus  if  ϕ ∈ C∞ (Rn )  is  equal  to  1  in  a  large  enough  ball  then   Q(xi) = 
(1   − ϕ(ξ ))/P (ξ )  in  C∞  and  satisﬁes  (11.36)  which  can  be  written  
c 
The  discussion  above   now   shows  that  deﬁning  F ∈ S � (Rn ) by  F�(ξ ) = 
DαQ(ξ )| ≤ Cα (1  +  ξ )m−|α|  .
|
| |
Q(ξ )  gives  a  solution  to   (11.27).  
� 
The  last  step  in  the   proof  is   to  show   that  if  F ∈ S � (Rn )  has  compact  
support,  and  satisﬁes  (11.27),  then 
u ∈ S (Rn
) ∩ C∞ (Rn
) , P (D)u ∈ S � (Rn
)
⇒ u =  F ∗ (P (D)u) − ψ ∗ u ∈ C∞ (Rn ) . 
Let  me  reﬁne  this  result  a  little  bit. 

LECTURE  NOTES  FOR  18.155,  FALL  2004 
79 
Proposition  11.15.  If  f  ∈ S � (Rn )  and  µ ∈ S � (Rn )  has   compact  sup­
port  then 

sing  supp(u ∗ f )  ⊂ sing  supp(u) +  sing  supp(f ).  
Proof.  We  need  to   show   that  p  /∈  sing  supp(u)  ∈  sing  supp(f )  then  
p  /∈ sing  supp(u ∗ f ).  Once  we  can  ﬁx  p,  we   might   as  well  suppose  that 
f  has  compact  support  too. Indeed,   choose  a  large  ball  B (R, 0)  so  that  
∈ B (0, R) ⇒ p  /
∈ supp(u) +  B (0, R) . 
z  /

This  is  possible  by  the   assumed   boundedness  of  supp(u).  Then  choose 
ϕ ∈ C∞
(Rn )  with  ϕ = 1  on  B (0, R);   it  follows   from  Theorem  L16.2,  or  
rather  its  extension  to   distributions,  that   φ  /∈ supp(u(1  − ϕ)f ),   so  we 
c
can  replace  f  by  ϕf ,  noting  that  sing  supp(ϕf ) ⊂ sing  supp(f ).   Now  if 
f  has  compact  support   we  can  choose  compact  neighbourhoods  K1 ,  K2 
of  sing  supp(u)  and  sing   supp(f )  such   that  p  /∈ K1  +  K2 .  Furthermore 
we  an  decompose  u  =  u1  +  u2 ,  f  =  f1  +  f2  so  that   supp(u1 )  ⊂  K1 , 
supp(f2 )  ⊂ K2  and  u2 , f2  ∈ C∞ (Rn ).   It   follows  that  
u ∗ f 
=  u1  ∗ f1  +  u2  ∗ f2  +  u1  ∗ f2  +  u2  ∗ f2  .
Now,   p  /∈ supp(u1  ∗ f1 ),  by  the  support  property  of  convolution  and  the 
three  other   terms  are  C∞ ,  since  at  least  one  of  the   factors   is  C∞ .  Thus  
p  /∈ sing  supp(u ∗ f ).	
� 

(11.39)	

The  most  important   example  of  a   diﬀerential  operator   which   is  hy­
� 
poelliptic,  but  not   elliptic,   is  the  heat  operator  
n
∂t  +  Δ  =  ∂t  − 
∂ 2  .xj 
j=1 
� 
� 
� 
(4πt)n/2  exp  − |
1 
0 

In  fact  the  distribution 

t ≥ 0 
t ≤ 0 

(11.40)	

E (t, x) = 

2

|
x
4
t 

is  a   fundamental   solution.  First  we   need   to  check  that   E  is  a  distri­
bution.  Certainly  E  is  C∞  in   t  >  0.  Moreover   as   t 
↓
0  in  x  = 0  it  
vanishes  with  all   derivatives,  so  it   is   C∞  except  at  t =  0,  x =  0.  Since 
� 
it  is  clearly   measurable   we  will  check  that  it  is   locally  integrable  near  
the  origin,   i.e., 
0≤t≤1 
|x|≤1 

E (t, x)  dx dt  < ∞ ,

(11.41)	

�
E (ϕ) = 

(11.42) 

E  + 

E 

n
2t
xj
2t

80  
RICHARD  B.  MELROSE 
since  E  ≥  0.   We  can  change  variables,  setting   X  =  x/t1/2 ,  so  dx  = 
�  � 
tn/2   dX  and  the  integral  becomes 
exp(− |X | 2 
� 
) dx  dt  <  ∞ . 
1 
(4π)n/2  
|X |≤t−1/2 
4 
� 
0 
Since  E  is  actually  bounded  near  inﬁnity,  it  follows  that  E  ∈ S �Rn  , 
E (t,  x)ϕ(t,  x) dx  dt  ∀ ϕ  ∈ S (Rn+1 ) . 
t≥0 
As  before  we  want  to  compute 
�  � 
(∂t  +  Δ)E (ϕ) =  E (−∂tϕ  +  Δϕ) 
∞ 
E (t,  x)(−∂tϕ  +  Δϕ) dx  dt  . 
=  lim 
E ↓0 
E 
Rn
First  we  check  that  (∂t  +  Δ)E  = 0  in  t  >  0,  where  it  is  a  C∞  function. 
This  is  a  straightforward  computation: 
|
| 
2 
∂tE  =  −
x
4t2 
∂xj E  =  −
E ,  ∂ 2  E  =
xj 
|
| 
2 
⇒
n
x
ΔE  =  E  + 
4t2

2t 
� 
Now  we  can  integrate   by  parts  in  (11.42)   to  get 

2 /4E
e−|x|
ϕ(E ,  x)
(4πE )n/2  dx  . 
(∂t  +  Δ)E (ϕ) =  lim 
E ↓0 
Rn
� 
Making  the  same  change  of  variables   as  before,  X  =  x/2E 1/2  , 
e−|x|
2 
ϕ(E ,  E 1/2X ) 
(∂t  +  Δ)E (ϕ)   =  lim 
dX  .  
E ↓0  Rn 
πn/2 
As  E  ↓  0  the  integral  here  is  bounded  by  the  integrable  function 
C  exp(− X 2 ),  for  some  C  >  0,  so  by  Lebesgue’s  theorem  of  domi­
|
|
� 
nated  convergence,  conveys   to  the  integral  of  the  limit.  This   is 
· 
2  dx 
e−|x| 
πn/2  =  ϕ(0,  0)  .
Rn 
(∂t  +  Δ)E (ϕ) =  ϕ(0,  0)  ⇒ (∂t  +  Δ)E  =  δtδx  , 
so  E  is  indeed  a   fundamental  solution.  Since  it  vanishes  in  t  <  0  it  is 
canned  a  forward  fundamrntal   solution.  
Let’s  see  what  we  can  use  it  for. 

2 
xj  E
4t2 

−

1 
2t 

E  + 

E .

ϕ(0,  0) 

Thus 

81 
LECTURE  NOTES  FOR  18.155,  FALL  2004 
Proposition  11.16.  If  f  ∈  S �Rn  has   compact  support  ∃ !u  ∈  S �Rn 
with  supp(m) ⊂ {t ≥ −T } for  some  T  and 
(∂t  +  Δ)u =  f in  Rn+1  .

E ∗ f
.  That  it  satisﬁes  (11.43)follows  from

Proof.  Naturally  we  try  u = 
is   such  that   supp(f )  ⊂ 
the  properties  of  convolution.  Similarly  if   T 
t ≥ T } then
{

(11.43) 

supp(u)  ⊂ supp(f ) +  supp(E ) ⊂ {t ≥ T ]  . 
So  we   need  to   show  uniqueness.   If  u1 , u2  ∈ S �Rn  in   two  solutions   of 
(11.43)  then  their  diﬀerence   v  =  u1  − u2  satisﬁes  the  ‘homogeneous’ 
equation  (∂t  +  Δ)v  =  0.  Furthermore,  v  = 0  in   t < T �  for  some  T � . 
Given  any  E  ∈  R  choose  ϕ(t
)  ∈  C∞ (R) 
with  ϕ(t)  = 0  in  t > t +  1, 
ϕ(t) = 1  in  t < t and  consider 

Now,  

=  ϕ(t)E =  F1  +  F2  ,
Et 
where  F1  =  ψEt  for  some  ψ ∈ C∞Rn+1 ),   ψ =  1  near  0.  Thus  F1  has
comapct  support  and  in   fact  F2  ∈  S Rn  .  I  ask  you   to  check  this  last  
c 
statement  as  Problem   L18.P1. 
Anyway,  
(∂t  +  Δ)(F1  +  F2 ) =  δ +  ψ ∈ S Rn  ,  ψ = 0  t ≤ t . 
t 
� 
)  = 0  =  u +  ψt  ∗ u . 
t  ∗ u
(∂t  +  Δ)(E
Since  supp(ψt )  ⊂  t ≥ t ],  the  second  tier  here  is   supported   in  t ≥ t ≥
� 
T � .  Thus  u = 0  in  t < t +  T � ,  but  t is   arbitrary,   so  u =  0. 
Notice  that  the  assumption   that  u ∈ S �Rn  is   not   redundant   in  the 
statement  of  the  Proposition,  if  we  allow  “large”  solutions  they  be­
come  non­unique.  Problem  L18.P2  asks   you  to  apply  the  fundamental 
solution  to   solve  the   initial  value  problem  for  the  heat   operator. 
Next  we   make  similar  use  of  the  fundamental  solution   for  Laplace’s 
operator.  If   n ≥ 3  the 

(11.44) 

E =  Cn  |x|−n+2 
is  a   fundamental   solution.  You  should   check  that   ΔEn  = 0  in  x = 0 
directly,  I  will  show  later  that  ΔEn  =  δ ,  for   the  appropriate  choice  of 
Cn ,  but  you  can  do  it  directly,  as  in  the  case  n =  3. 
∃ !u ∈ C∞
Theorem  11.17.  If  f ∈ S Rn 
Rn  such  that  Δu =  f .
0

�
82  
RICHARD  B.  MELROSE 
Proof.  Since  convolution  u  =  E ∗ f  ∈  S �Rn  ∩ C∞Rn  is   deﬁned   we 
certainly  get  a  solution  to  Δu =  f  this  way.  We  need   to  check  that  
u ∈ C∞
Rn  .  First  we  know  that  Δ  is  hypoelliptic  so  we  can   decompose 
0
E =  F1  +  F2  ,  F1  ∈ S �Rn  , supp  F, � Rn 
2  ∈ C∞Rn 
.  In  fact   we  can   see  from  (11.44)   that 
and  then  F
|DαF2 (x)
α (1  +  |x|)−n+2−|α|  .
| ≤ C
Now,   F1  ∗ f ∈ S Rn ,  as  we  showed  before,  and   continuing  the  integral 
we  see   that 

|
Dα u

| ≤ |DαF2  ∗ f |

+  CN (1  +  |x|)−N  ∀ N
≤ C �

α (1  +  |x|)−n+2−|α|  . 
u ∈ C∞
Rn  .
Since  n > 2  it  follows  that 
0 
So  only  the  uniqueness  remains.  If   there  are  two  solutions,  u1 , u2  for 
2  ∈ C∞
a  given  f then  v =  u1  − u
v ∈ S �
Rn  satisﬁes  Δv =  0.   Since 
Rn 
v�(χ)  = 0  ⇒ supp(�v
0
we  can  take  the  Fourier   transform  and  see  that 
) ⊂ {0} .  � 
an  earlier  problem  was  to  conclude  from  this   that   �v = 
|χ| 2 
CαDαδ
|α|≤m 
for  some  constants  Cα .  This   in  turn  implies  that  v  is   a  polynomial. 
However   the  only  polynomials   in   C 0Rn  are  identically  0.  Thus  v = 0
� 
0
and  uniqueness  follows.  

LECTURE  NOTES  FOR  18.155,   FALL  2004 

83 

12.  Cone  support  and  wavefront  set  

In  discussing  the  singular   support  of  a  tempered   distibution  above, 
notice  that 

singsupp(u) =  ∅ 
only   implies  that  u  ∈ C∞ (Rn ),   not   as   one  might  want,   that   u  ∈ S (Rn ).  
We  can  however   ‘reﬁne’  the   concept  of  singular   support   a  little  to  get  
this. 
Let  us  think  of  the  sphere  Sn−1  as  the  set   of  ‘asymptotic  directions’  in  
Rn  .  That   is,   we  identify  a   point   in  Sn−1  with  a  half­line  {a ¯x; a  ∈ (0,  ∞)}
for  0   = ¯x  ∈ Rn  .  Since  two  points  give  the  same  half­line  if  and  only  if 
they  are  positive  multiples  of  each   other,  this  means   we  think  of  the 
sphere  as  the  quotient 

Sn−1  = (Rn  \ {0})/R+  . 
(12.1) 
Of  course  if  we  have  a  metric  on  Rn  ,  for  instance  the  usual   Euclidean 
metric,  then  we  can  identify  Sn−1  with  the  unit   sphere.  However   (12.1)  
does  not  require  a   choice  of   metric. 
Now,   suppose  we  consider  functions   on  Rn \{0} which  are  (positively) 
homogeneous  of  degree  0.  That   is  f (a ¯
x) =  f ( ¯
x),  for  all  a  >  0,  and 
they  are  just  functions  on   Sn−1  .  Smooth   functions   on   Sn−1  correspond  
(if  you  like  by   deﬁnition)  with   smooth   functions  on   Rn  \ {0} which  are 
homogeneous  of  degree  0.  Let  us   take  such  a  function   ψ  ∈ C∞ (Rn  \ {0}),  
ψ(ax) =  ψ(x)  for  all   a  >  0.  Now,  to  make  this  smooth  on  Rn  we  need 
to  cut  it  oﬀ  near   0.  So  choose  a  cutoﬀ  function   χ  ∈  C∞ (Rn ),   with
χ(x)  = 1   in  |x| <  1.   Then 
c 
ψR (x) =  ψ(x)(1  − χ(x/R))   ∈ C∞ (Rn ),  
(12.2) 
for  any  R  >  0.   This  function  is  supported  in   x ≥  R.  Now,  if  ψ  has
|
|
support  near   some  point  ω  ∈ Sn−1  then  for  R  large  the  corresponding 
function  ψR  will   ‘localize  near  ω  as  a  point   at  inﬁnity  of  Rn  .’  Rather 
than  try  to   understand  this   directly,   let   us   consider   a  corresponding 
analytic   construction. 
First  of  all,   a   function  of  the  form  ψR  is   a  multiplier   on   S (Rn ).   That  

is,  

(12.3) 

).

)  −→ S (Rn

ψR · :  S (Rn
To   see   this,  the  main  problem  is  to  estimate  the  derivatives  at   inﬁnity, 
since  the  product  of  smooth  functions  is  smooth.  This  in  turn  amounts 
to   estimating   the  deriviatives  of  ψ  in   x ≥ 1.  This  we  can   do  using  the 
|
|
homogeneity.  

�
84  
RICHARD  B.  MELROSE 
Lemma  12.1.  If  ψ ∈ C∞ (Rn  \ {0})  is  homogeneous  of  degree  0  then  
| ≤ C |
|Dαψ
|
α x −|α| .
(12.4) 
Proof.  I  should  not  have  even  called  this  a  lemma.  By  the  chain  rule, 
the  derivative  of  order  α is  a  homogeneous  function   of  degree  −|α from 
|
� 
which  (12.4)  follows. 

(12.5) 

= 

(12.7) 

For  the  smoothed  versio,  ψR , of  ψ this  gives  the  estimates 
|DαψR (x)
| ≤ Cα �
x�−|α| .
This  allows  us   to   estimate  the  derivatives   of  the  product  of  a  Schwartz 
function  and  ψR  : 
�  � 
�  α 
(12.6)  x βD (ψRf ) 
α
|
|
�
Dα−γ ψRx βDγ f = ⇒  sup  x βD (ψRf ) ≤ C sup  �f k
α
|x|≥1 
γ 
γ≤α 
for  some   seminorm  on  S (Rn ). Thus   the  map  (12.3)  is  actually  continu­
ous.  This  continuity  means  that  ψR  is   a  multiplier   on   S � (Rn ), deﬁned  
as  usual  by  duality: 
ψRu(f ) =  u(ψRf )  ∀ f ∈ S (Rn ).  
Deﬁnition  12.2.  The  cone­support  and  cone­singular­support   of  a  tem­
pered  distribution  are  the  subsets  Csp(u)  ⊂  Rn  ∪ Sn−1  and  Css(u)   ⊂
Rn  ∪ Sn−1  deﬁned   by  the  conditions 
(12.8) 
Csp(u) ∩ Rn  = supp(u)  
�  ∩ Sn−1  ={ω ∈ Sn−1 ; 
(Csp(u))
∃ R > 0, ψ ∈ C∞ (Sn−1 ), ψ(ω)  = 0, ψRu = 0}, 
Css(u) ∩ Rn  = singsupp(u)  
�  ∩ Sn−1  ={ω ∈ Sn−1 ; 
∈ S (Rn )}
∃ R > 0, ψ ∈ C∞ (Sn−1 ), ψ(ω)  = 0, ψRu
.
That   is,   on  the  Rn  part   these  are  the  same  sets  as  before  but   ‘at 
inﬁnity’   they   are  deﬁned  by  conic  localization  on  Sn−1  . 
In  considering   Csp(u)  and  Css(u)  it   is  convenient  to  combine  Rn 
and  Sn−1  into   a  compactiﬁcation   of  Rn  . To  do  so  (topologically)  let  
us  identify   Rn  with  the  interior   of  the   unit  ball   with  respect   to  the 
Euclidean  metric  using  the  map 
∈ {y ∈ Rn ; |y | ≤ 1} = 
Rn  � x �−→  �x� 
x 

(Css(u))

(12.9) 

Bn

. 

�
�
(12.10) 

LECTURE   NOTES  FOR  18.155,  FALL  2004 
85 
|
|
�
|
�  and  for  0  ≤ a < 1,
| < �
�  has  only  the  solution 

x

x

Clearly 
x =  a
x
x =|
a/(1   − a2 ) 
|
1 
. Thus  if  we  combine  (12.9)  with   the  identiﬁcation   of 
2
Sn
with  the  unit  sphere   we  get  an   identiﬁcation 
Rn  ∪ Sn−1  � Bn  . 
Using  this  identiﬁcation  we  can,   and   will,  regard   Csp(u)  and  Css(u)  as  
subsets  of  Bn  . 
21
Lemma  12.3.  For  any  u  ∈  S � (Rn ),   Csp(u)  and  Css(u)   are  closed 
subsets  of  Bn  and  if  ψ ∈ C∞ (Sn )  has   supp(ψ˜) ∩ Css(u) =  ∅ then   for  R 
˜
suﬃciently  large  ψRu ∈ S (Rn ).  
˜
Proof.  Directly  from  the  deﬁnition   we  know   that   Csp(u) ∩ Rn  is   closed,  
as  is  Css(u) ∩ Rn  . Thus,   in  each  case,  we  need  to  show   that   if   ω ∈ Sn−1 
and  ω /∈ Csp(u) then  Csp(u)   is  disjoint  from  some  neighbourhood  of  ω 
in  Bn  . However,  by   deﬁnition, 
0} ∪ {ω
U =  x ∈ Rn ; ψR (x) = 
�  ∈ Sn−1 ; ψ(ω � )  = 0}
{
is  such  a  neighbourhood.  Thus  the  fact   that   Csp(u)  is  closed  follows 
directly  from  the  deﬁnition.   The  argument   for  Css(u)   is  essentially  the 
same. 
The  second  result  follows  by  the  use  of  a  partition  of  unity  on  Sn−1  . 
Thus,   for  each  point  in  supp(ψ) ⊂ Sn−1  there  exists   a  conic  localizer   for  
Ru ∈ S (Rn
which  ψ
). By  compactness  we  may choose   a  ﬁnite  number  of  
these  functions  ψj  such  that  the  open  sets  {ψj (ω)  > 0} cover  supp( ψ˜).  
u ∈  S (Rn ) 
By  assumption   (ψj )Rj
for  some  Rj  > 0. However   this  will 
� 
remain  true  if  Rj  is  increased,  so  we  may  suppose  that  Rj  =  R is  
independent   of  j. Then  for  function 
|ψj |2  ∈ C∞ (Sn−1 ) 
j 
we  have  µRu ∈ S (Rn ). Since  ψ =  ψ �µ for  some  µ ∈ C∞ (Sn−1 )  it  follows  
˜
that  ψR+1u ∈ S (Rn )  as  claimed.  
� 
˜
Corollary   12.4.  If  u ∈  S � (Rn )  then   Css(u) =  ∅  if  and  only  if  u ∈ 
S (Rn ). 
Proof.  Certainly  Css(u) =  ∅ if  u ∈ S (Rn ). If  u ∈ S � (Rn )  and   Css(u) = 
∅  then  from  Lemma   12.3,   ψ
Ru  ∈  S (Rn ) 
where  ψ  = 1.  Thus  v  = 
(1   − ψR )u ∈ Cc
−∞ (Rn )  has  singsupp(v) =  ∅  so  v ∈ Cc
∞ (Rn )  and  hence 
u ∈ S (Rn ). 
� 
21In  fact  while  the  topology  here   is  correct  the  smooth  structure  on  Bn  is  not 
the  right  one –  see  Problem??   For  our  purposes  here  this  issue  is  irrelevant. 

µ = 

�
�
86  

RICHARD  B.  MELROSE 
Of  course  the  analogous   result   for  Csp(u),  that   Csp(u) =  ∅  if  and 
.  I∅
only   if  u  =  0  follows  from  the  fact   that   this  is  true  if  supp(u) = 
will  treat  a   few   other  properties  as  self­evident.  For  instance 
(12.11) 
Csp(φu)  ⊂ Csp(u),  Css(φu)   ⊂ Css(u)   ∀ u ∈ S � (Rn ),   φ ∈ S (Rn ) 
and 
(12.12)  Csp(c1u1  +  c2u2 )  ⊂ Csp(u1 ) ∪ Csp(u2 ),  
Css(c1u1  +  c2u2 )  ⊂ Css(u1 ) ∪ Css(u2 ) 
∀ u1 , u2  ∈ S � (Rn ),   c1 , c2  ∈ C. 
One  useful   consequence  of  having   the  cone  support   at  our  disposal 
is  that  we  can  discuss  suﬃcient   conditions  to  allow  us   to  multiply  dis­
tributions;  we  will   get  better   conditions   below   using  the  same  idea  but  
applied  to  the  wavefront   set  but   this   preliminary  discussion  is  used 
there.   In  general  the  product  of  two  distributions  is  not  deﬁned,  and  
indeed  not  deﬁnable,  as  a  distribution.  However,  we  can  always  multi­
ply  an  element   of  S � (Rn )  and   an   element  of   S (Rn ).  
To  try  to   understand  multiplication  look  at  the  question  of  pairing 
between  two   distributions. 
Lemma  12.5.  If  Ki  ⊂  Bn ,  i  = 1, 2,  are  two  disjoint  closed  (hence 
compact)  subsets  then  we  can  deﬁne  an  unambiguous   pairing  

(12.13) 
{u ∈ S

(12.14) 

(12.15) 

u ∈ S

� (Rn );  Css(u)  ⊂ K1} × {

� (Rn );   Css(u)   ⊂ K2} � (u1 , u2 )
−→
u1 (u2 ) ∈ C.
Proof.  To  deﬁne  the  pairing,  choose  a  function  ψ ∈ C∞ (Sn−1 )  which   is 
identically  equal  to  1  in  a  neighbourhood   of  K1 ∩ Sn−1  and  with  support 
disjoint  from  K2  ∩ Sn−1  .  Then  extend   it  to  be  homogeneous,  as  above, 
and  cut  oﬀ   to   get  ψR .  If  R is   large  enough  Csp(ψR )  is  disjoint   from  K2 . 
Then  ψR  +  (1   − ψ)R  = 1  +  ν  where  ν ∈ C∞ (Rn ).   We  can   ﬁnd   another  
function  µ ∈ C∞ (Rn )  such  that   ψ1  =  ψR  + µ = 1  in  a  neighbourhood  of 
c 
c 
K1  and  with  Csp(ψ1 )  disjoint  from  K2 .  Once  we  have  this,  for   u1  and 
u2  as  in  (12.13),  
ψ1u2  ∈ S (Rn )  and   (1  − ψ1 )u1  ∈ S (Rn ) 
since   in  both  cases  Css  is  empty  from  the  deﬁnition.  Thus  we  can   deﬁne 
the  desired  pairing   between  u1  and  u2  by 
u1 (u2 ) =  u1 (ψ1u2 ) +  u2 ((1  − ψ1 )u1 ).  

LECTURE  NOTES  FOR  18.155,   FALL  2004 

87 

Of  course  we  should  check  that  this  deﬁnition   is   independent  of  the 
cut­oﬀ   function   used  in  it.  However,  if  we  go  through   the  deﬁnition   and 
choose  a   diﬀerent  function   ψ �  to  start  with,  extend   it  homogeneoulsy 
and  cut  oﬀ  (probably   at  a  diﬀerent   R)  and   then  ﬁnd   a  correction   term 
µ�  then  the   1­parameter  linear  homotopy  between  them 
ψ1 (t) =  tψ1  +  (1  − t)ψ1
� ,  t  ∈ [0,  1] 
(12.16) 
satisﬁes  all  the  conditions  required  of  ψ1  in   formula  (12.14).  Thus   in 
fact  we   get   a  smooth  family  of  pairings,  which   we  can  write  for  the 
moment  as 

(12.17) 

(12.18) 

(u1 ,  u2 )t  =  u1 (ψ1 (t)u2 ) +  u2 ((1  − ψ1 (t))u1 ).  
By  inspection,  this  is  an  aﬃne­linear  function   of  t  with  derivative 
u1 ((ψ1  − ψ1
� )u2 ) +  u2 ((ψ1  − ψ1 ))u1 ).  
�
Now,   we   just  have  to   justify  moving  the  smooth  function   in  (12.18)  to 
1  − ψ1 ) 
see  that  this  gives  zero.  This  should  be  possible  since  Csp(ψ �
is
disjoint  from  both  K1  and  K2 . 
In  fact,  to   be  very  careful  for  once,  we  should  construct   another  
function  χ  in  the  same  way  as  we  constructed   ψ1  to  be  homogenous 
near  inﬁnity   and  smooth  and   such  that   Csp(χ) is  also  disjoint   from  both  
K1  and  K2  but  χ  = 1  on  Csp(ψ1  − ψ1 ).   Then  χ(ψ �
1  − ψ1 ) =  ψ1
� − ψ1  so 
�
we  can  insert  it   in  (12.18)   and   justify 
1 )u2 ) =  u1 (χ2 (ψ1  − ψ1 )u2 ) = (χu1 )((ψ1  − ψ1 )χu2 ) 
(12.19)  u1 ((ψ1  − ψ �
�
�
= (χu2 )(ψ1  − ψ1 )χu1 ) =  u2 (ψ1  − ψ �
�
1 )χu1 ).
Here  the  second  equality  is  just   the  identity  for  χ  as  a  (multiplica­
tive)  linear   map  on  S (Rn )  and   hence  S � (Rn )  and   the  operation   to  give 
the  crucial,   third,  equality  is   permissible  because  both  elements   are  in 
S (Rn ). 
� 
Once  we  have  deﬁned  the  pairing   between  tempered  distibutions   with 
disjoint  conic  singular  supports,   in   the  sense  of  (12.14),  (12.15),  we  can 
deﬁne  the   product  under   the  same  conditions.  Namely  to  deﬁne  the 
product  of   say  u1  and  u2  we   simply  set 
(12.20)  u1u2 (φ) =  u1 (φu2 ) =  u2 (φu1 )  ∀ φ  ∈ S (Rn ),  
provided  Css(u1 ) ∩ Css(u2 ) = 
.∅
Indeed,  this  would  be  true   if  one  of  u1  or  u2  was   itself  in  S (Rn )  and 
makes  sense  in  general.   I  leave  it   to  you  to  check  the  continuity  state­
ment  required  to  prove  that   the   product  is   actually  a  tempered   disti­
bution  (Problem  78). 

88  

RICHARD  B.  MELROSE 

One  can  also  give  a  similar  discussion   of  the  convolution  of   two  tem­
pered  distributions.   Once  again   we  do  not  have  a  deﬁnition of  u ∗ v as  a 
tempered  distribution  for  all  u, v ∈ S � (Rn ). We  do  know  how  to  deﬁne 
the  convolution   if   either  u or  v is   compactly  supported,   or  if  either   is 
in  S (Rn ). This  leads   directly  to 
Lemma  12.6.  If  Css(u) ∩ Sn−1  =  ∅ then   u ∗ v is  deﬁned  unambiguously 
by 

, u1  = (1  − χ(  ))u,  u2  =  u − u1
2  ∗ v
u ∗ v =  u1  ∗ v +  u
x 
(12.21) 
r 
where  χ ∈ C∞ (Rn )  has  χ(x)   = 1  in  x ≤ 1  and  R is  suﬃciently  large; 
|
|
∩
.∅
c 
Sn−1  = 
there  is  a  similar  deﬁnition  if  Css(v)
Proof.  Since  Css(u) ∩ Sn−1  = 
∅
, we   know  that  Css(u1 ) =  ∅ if  R is   large 
enough,  so   then  both  terms  on  the  right  in  (12.21)   are  well­deﬁned.  To 
see   that  the  result   is  independent   of  R just  observe  that   the  diﬀerence 
of  the   right­hand   side   for  two  values  of  R is   of  the  form  w ∗ v − w ∗ v 
� 
with  w compactly   supported. 
Now,   we   can  go  even  further  using   a  slightly  more  sophisticated 
decomposition  based  on 
Lemma  12.7.  If  u ∈ S � (Rn )  and  Css(u) ∩ Γ =  ∅  where  Γ  ⊂ Sn−1  is  a 
closed   set,  then  u =  u1  +  u2  where  Csp(u1 ) ∩ Γ =  ∅ and  u2  ∈ S (Rn );   in 
fact 
1  ∈ Cc
1  +  u2  where  u�
(12.22)  u =  u�
1  +  u��
−∞
(Rn )  and
= ⇒ x /
∈ supp(u��
1 ), x ∈ Rn  \ {0},  x/ x
∈ supp(u��
|
| ∈ Γ 
1 ).
0  /
� 
Proof.  A  covering   argument   which   you  should   provide. 
Let  Γi  ⊂ Rn , i = 1, 2, be  closed  cones.   That   is  they  are  closed  sets  
such that   if   x ∈ Γi  and  a > 0  then   ax ∈ Γi . Suppose  in   addition  that 
Γ1  ∩ (−Γ2 ) =  {0}. 
(12.23) 
That  is,   if  x ∈  Γ1  and  −x ∈  Γ2  then  x = 0. Then  it  follows  that  for  
some  c > 0,  

x +  y | ≥ c(|x| +  y ).
x ∈ Γ1 ,  y ∈ Γ2  = 
⇒ |
| |
(12.24) 
To  see  this  consider   x +  y where  x ∈  Γ1 , y ∈  Γ2  and  y
|
| | ≤ |
x .  We 
can  assume  that  x = 0, otherwise  the  estimate  is  trivially  true  with  
c = 1, and  then  Y =  y/ x ∈ Γ1  and  X =  x/ x ∈ Γ2  have  Y ≤ 1  and 
|
|
|
|
|
|
X | = 1. However  X + Y = 0, since  X = 1, so  by  the  continuity  of  the 
|
|
|
sum,   |X +  Y ≥ 2c > 0  for  some  c > 0. Thus   X +  Y
|
|
( X | +  Y )
| ≥ c |
|
|
and  the  result  follows  by  scaling  back.  The  other  case,  of  |x| ≤ |y | 

�
�
LECTURE  NOTES  FOR  18.155,   FALL  2004 

89 

follows  by  the  same  argument  with  x  and  y interchanged,  so  (12.24)  is 
a  consequence  of  (12.23).  
u ∈ S
� (Rn )  and  φ ∈ S (Rn ),
Lemma  12.8.  For  any 
Css(φ ∗ u)   ⊂ Css(u) ∩ Sn−1  . 
(12.25)	
Proof.  We  already  know  that   φ∗u is   smooth,  so  Css(φ∗u)   ⊂ Sn−1  . Thus, 
we   need  to   show  that  if  ω ∈ Sn−1  and  ω  /
∈ Css(u)   then   ω  /
∈ Css(φ ∗ u). 
Fix  such  a  point  ω  ∈ Sn−1  \ Css(u)   and   take  a  closed   set  Γ  ⊂ Sn−1 
which  is  a   neighbourhood  of  ω but  which  is  still  disjoint  from  Css(u) and  
then  apply  Lemma  12.7.  The   two  terms   φ ∗ u2 ,  where  u2  ∈ S (Rn )  and  
φ ∗ u�
1  ∈ Cc
(Rn )  are  both   in  S (Rn )  so  we  can  assume  that  u
1  where  u�
−∞
has  the  support  properties   of   u��
1 .  In  particular  there  is  a  smaller  closed  
subset  Γ1  ⊂ Sn−1  which  is  still  a  neighbourhood  of  ω  but  which  does  
not  meet   Γ2 , which  is  the  closure   of   the  complement   of  Γ.  If  we  replace 
these   Γi  by  the  closed  cones   of   which  they  are  the  ‘cross­sections’  then 
we  are  in  the  situation  of  (12.23)   and   (12.23),  except  for   the  signs. 
That  is,  there  is  a   constant  c > 0  such  that  
x − y ≥ c( x +  y ).
|
|
|
|
| |
(12.26)	
Now,   we  can  assume   that   there  is   a  cutoﬀ  function  ψR  which  has 
�
support  in  Γ2  and  is  such  that  u =  ψRu.  For  any  conic  cutoﬀ,   ψR , with 
support  in  Γ1 
R (φ ∗ u) =  �ψRu, φ(x − ·)� =  u(y), ψR (y)ψ �
�
R (x)φ(x − y)�. 
(12.27)	 ψ �
The  continuity  of  u  means   that   this  is   estimated  by  some  Schwartz 
seminorm 

R (x)φ(x − y)) (1  +  y )k
|
| |
|Dα 
y  (ψR (y)ψ �
(12.28)	
sup 
y ,|α|≤k 
≤ CN �φ� sup(1   +  x +  y )−N (1  +  y )k  ≤ CN �φ�(1  +  x )−N +k 
| |
| |
|	
|
|
|
y 

for  some  Schwartz  seminorm  on  φ.  Here  we  have  used  the  estimate 
(12.24),  in  the  form  (12.26),  using  the  properties   of  the  supports   of  
ψ � and  ψR .  Since  this  is  true  for  any  N  and  similar  estimates   hold 
R (u ∗ φ)  ∈  S (Rn	
R 
for  the  derivatives,   it   follows  that  ψ �	
)  and  hence  that 
ω  /∈ Css(u ∗ φ). 
�
Corollary  12.9.  Under   the  conditions  of  Lemma  12.6 
(12.29)  Css(u ∗ v)  ⊂ (singsupp(u) +  singsupp(v))   ∪ (Css(v) ∩ Sn−1 ).  
Proof.  We  can  apply  Lemma  12.8  to  the   ﬁrst   term  in  (12.21)   to  con­
clude  that  it  has  conic   singular  support   contained  in   the  second  term 
in  (12.29).  Thus   it  is  enough   to  show  that  (12.29)   holds   when  u  ∈ 

90  
RICHARD  B.  MELROSE 
C −∞ (Rn ).  In  that  case  we  know  that   the  singular   support   of   the  con­
c 
volution  is  contained  in  the  ﬁrst  term  in  (12.29),  so  it   is   enough   to 
consider  the  conic  singular  support  in  the  sphere  at   inﬁnity.  Thus,  if 
∈  Css(v)  we  need  to  show  that   ω  /
∈  Css(u  ∗ v).   Using  Lemma  12.7 
ω  /
we  can  decompose  v  =  v1  +  v2  +  v3  as  a  sum  of   a  Schwartz   term,   a 
compact  supported  term  and  a  term  which   does   not  have  ω  in   its   conic 
support.  Then  u  ∗ v1  is  Schwartz,  u  ∗ v2  has  compact  support  and   sat­
isﬁes  (12.29)  and  ω  is  not  in  the  cone  support   of  u  ∗ v3 .  Thus   (12.29) 
� 
holds  in  general. 
Lemma  12.10.  If  u,  v  ∈  S � (Rn )  and  ω  ∈  Css(u)   ∩ Sn−1  =⇒  −ω  /∈
Css(v)  then  their   convolution   is   deﬁned  unambiguously,  using  the  pair­
ing  in  Lemma  12.5,  by 
u  ∗ v(φ) =  u(ˇ
v  ∗ φ)  ∀ φ  ∈ S (Rn
).
v(x) =  v(−x),  Css(ˇ
v) =  − Css(v) so  applying  Lemma  12.8 
Proof.  Since  ˇ
we  know  that  

Css(ˇv  ∗ φ)   ⊂ − Css(v) ∩ Sn−1  . 
(12.31) 
Thus,   Css(v) ∩ Css(ˇv  ∗ φ) =  ∅  and  the  pairing  on  the  right  in   (12.30) 
is  well­deﬁned  by   Lemma  12.5.  Continuity  follows  from  your   work  in  
� 
Problem  78.  
In  Problem  79  I   ask  you   to  get  a  bound   on  Css(u   ∗ v) ∩ Sn−1  under  
the  conditions  in  Lemma  12.10.  
Let  me  do   what  is  actually  a  fundamental  computation. 
Css( �
Lemma  12.11.  For  a  conic   cutoﬀ,  ψR ,  where  ψ  ∈ C∞ (Sn−1 ),  
ψR )  ⊂ {0}
(12.32) 
.
Proof.  This  is  actually  much  easier   than   it  seems.  Namely  we  already 
know   that  Dα (ψR )  is  smooth  and   homogeneous  of   degree  −|α near
|
inﬁnity. From  the  same   argument  it  follows   that  
Dα (x β ψR ) ∈ L2 (Rn )  if  α > β +  n/2
|
|
|
|
(12.33) 
since  this  is  a   smooth   function   homogeneous  of  degree  less  than  −n/2 
near  inﬁnity,   hence  square­integrable.   Now,  taking  the  Fourier   trans­
ξ αDβ ( �
form  gives 
ψR )  ∈ L2 (Rn )  ∀ α > β +  n/2. 
|
|
|
|
(12.34) 
If  we  localize  in  a   cone   near   inﬁnity,  using  a  (completely  unrelated) 
�
R� (ξ ) �
|ψ � (ξ )Dβ ( �
cutoﬀ  ψR� (ξ )  then  we  must  get  a  Schwartz  function   since 
(12.35) 
ψR  ∈ S (Rn
ψR )  ∈ L2 (Rn )  ∀ α > β +  n/2 =  ψ �
|
|
|
|
⇒
|ξ ||
α
R� 

(12.30) 

).

LECTURE  NOTES  FOR  18.155,   FALL  2004 

91 

(12.36) 

Indeed  this  argument  applies   anywhere  that  ξ  = 0  and  so  shows  that 
� 
(12.32)  holds. 
Now,   we  have  obtained   some  reasonable  looking  conditions   under 
which  the  product  uv  or  the  convolution   u ∗ v  of  two  elements   of  S � (Rn ) 
is  deﬁned.  However,   reasonable  as  they  might  be  there  is  clearly  a  ﬂaw, 
or  at  least  a  deﬁciency,   in  the  discussion. We  know   that   in   the  simplest  
�v . 
� =  u�
of  cases,  
u ∗ v 
Thus,  it  is  very   natural   to  expect   a  relationship  between  the  conditions 
under  which  the  product   of  the  Fourier   transforms  is   deﬁned   and   the 
conditions  under  which  the  convolution  is   deﬁned.  Is  there?  Well,  not  
tionship  between  Css(�u)  and  Css(v�)  and   on  the  other   the  relationship  
much  it  would  seem,   since  on  the   one  hand   we  are  considering  the  rela­
between  Css(u) ∩ Sn−1  and  Css(v) ∩ Sn−1  .  If  these  are  to  be  related, 
Css(�u).   As  we  shall  see,  there  is   one  but   it  is  not  very  strong  as   can 
we  would  have  to   ﬁnd  a  relationship  of  some  sort  between  Css(u)   and 
be  guessed  from  Lemma   12.11.  This   is  not  so  much  a  bad  thing  as  a 
both  Css(u)  and  Css(�u).   This  we  will   do  through  the  notion  of  wave­
sign  that  we  should  look  for   another   notion  which   combines  aspects   of 
front  set.  In  fact  we  deﬁne  two  related  ob jects.  The  ﬁrst   is   the  more 
conventional,   the  second  is   more  natural  in  our   present  discussion. 
Deﬁnition 12.12.  If  u  ∈ S � (Rn )  we  deﬁne  the  wavefront  set   of  u  to 
be 
∈ Css(�
(12.37)  WF(u) =  {(x, ω)  ∈ Rn  × Sn−1 ; 
∃ φ ∈ C∞
φu)}� 
(Rn ),   φ(x)  = 0,  ω  /
c
and  more  general ly  the  scattering  wavefront  set  by 
∈ Css( �
(12.38)  WFsc  (u)  =  WF(u) ∪ {(ω , p) ∈ Sn−1  × Bn ; 
∃ ψ ∈ C∞ (Sn
ψRu)}� .
),  ψ(ω)  = 0,   R > 0  such  that  p  /
So,   the  deﬁnition   is  really  always  the  same.  To  show  that  (p, q)  /∈
∈  Css( �
WFsc (u)  we  need  to  ﬁnd  ‘a  cutoﬀ  Φ   near  p’  –  depending  on  whether  
φ ∈ C∞
p ∈ Rn  or  p ∈ Sn−1  this  is   either   Φ  = 
(Rn )  with  F  =  φ(p)   = 0
c
or  a  ψR  where  ψ  ∈  C∞ (Sn−1 )  has  ψ(p)   =  0  –  such   that   q  /
Φu). 
One   crucial  property  is 
Lemma  12.13.  If  (p, q)  /∈  WFsc (u)  then   if  p  ∈  Rn  there  exists  a 
that  for   al l  φ ∈ C∞ (Rn )  with  support  in   U,  U �  ∩ Css(�φu) =  ∅;  similarly
neighbourhood   U  ⊂  Rn  of  p  and  a  neighbourhood  U  ⊂  Bn  of  q  such 
c 

�
�
�
�
�
(12.40) 

92  
RICHARD  B.  MELROSE 
U �  ∩ Css( �
if  p  ∈  Sn−1  then  there  exists  a  neigbourhood  ˜U  ⊂  Bn  of  p  such  that 
ψRu) =  ∅ if  Csp(ωR )  ⊂  ˜
U . 
Proof.  First  suppose  p ∈ Rn  .  From  the  deﬁnition  of  conic  singular   sup­
port,  (12.37) means  precisely  that  there  exists   ψ ∈ C∞ (Sn−1 ), ψ(ω)  = 0 
ψR (�φu)   ∈ S (Rn ).  
and  R such that 
Since  we  know   that  �φu  ∈ C∞ (Rn ),   this  is  actually  true  for   all  R  >  0 
(12.39) 
∈  Css( �
∈  Css(�
as  soon  as  it  is  true  for  one   value.   Furthermore,  if  φ�  ∈ C∞ (Rn )  has
c 
supp(φ� )  ⊂  {φ  = 0}  then  ω  /
φ�u)   follows  from  ω  /
φu). 
∈  Css(�
∈  Css(v�)  then   ω  /
Indeed  we   can  then  write  φ�  =  µφ  where  µ  ∈  C∞ (Rn )  so  it  suﬃces 
µv  =  (2π)−nυ ∗ �
(Rn ).  Since  �
�
to  show   that  if  v  ∈  C −∞ (Rn )  has   ω  /
c 
∈ Css( �
µv)  if
Lemma   12.8   we  see   that  Css(υ ∗ �v) ⊂ Css(�v),   so  indeed  ω  /
µ ∈ C∞
u  where  υˇ =  µ ∈ S (Rn ),   applying 
c 
c
φ�u). 
∈ Css( �
The  case   that   p ∈ Sn−1  is   similar.  Namely  we  have  one  cut­oﬀ  ψR 
{
ωRu). We  can  take  U  =  ψR+10  = 0} since  if 
with  ψ(p)  = 0  and   q  /
ψ � has  conic   support  in  U then  ψ � =  ψ ��R�ψR  for  some  ψ ��  ∈ C∞ (Sn−1 ).
R� 
R� 
�
ψ � u =  v ∗ �
Thus 
� ψRu,  vˇ =  ω ��
R�� .
R� 
ψ � u)   ⊂ Css( �
From  Lemma   12.11  and   Corollary12.9  we  deduce  that 
Css(� ωRu)
(12.41) 
R� 
and  hence  the  result   follows  with  U �  a  small   neighourhood  of  q . 
Proposition  12.14.  For  any  u ∈ S � (Rn ),  
(12.42)  WFsc  (u)  ⊂ ∂ (Bn  × Bn )  = (Bn  × Sn−1 ) ∪ (Sn−1  × Bn ) 
= (Rn  × Sn−1 ) ∪ (Sn−1  × Sn−1 ) ∪ (Sn−1  × Rn ) 
and   WF(u)  ⊂  Rn  are  closed  sets   and  under  projection   onto  the  ﬁrst 
variable 
(12.43) 
π1 (WF(u))  =  singsupp(u) ⊂ Rn ,  π1 (WFsc (u))   =  Css(u)   ⊂ Bn  . 
Proof.  To  prove  the  ﬁrst  part  of  (12.43)  we  need  to  show   that   if  ( ¯x, ω)  /∈
WF(u) for  all  ω ∈ Sn−1  with  x ∈ Rn  ﬁxed,  then  ¯ ∈ singsupp(u).   The 
∈  Css(�
¯
x  /
deﬁnition  (12.37)  means  that   for  each  ω  ∈  Sn−1  there  exists  φω  ∈ 
cC∞
(Rn )  with  φω ( ¯
x)   =  0  with  the  Sn−1  \ Css(�
x)  =  0  such  that   ω  /
φω u).  Since  Css(φu)   is
closed  and  Sn−1  is  compact,  a  ﬁnite  number   of  these  cutoﬀs,  φj  ∈ 
(Rn ),  can  be  chosen  so  that  φj ( ¯ �
cC∞
φj u)
covering  Sn−1  .  Now  applying  Lemma  12.13  above,  we  can  ﬁnd  one 

� 

�
�
�
�
�
� 
LECTURE  NOTES  FOR  18.155,   FALL  2004 
93 
φu)  ⊂  Css(�
Css(�
φ ∈ C∞
j {φj (x)  = 0} and  φ( ¯x)   = 0,  such  that  
(Rn ),  with  support  in 
c 
φj u)  for  each  j  and  hence  φu  ∈  S (Rn )  (since  it  is  
¯ ∈  singsupp(u).   The
already   smooth).   Thus  indeed   it   follows   that  x  /

converse,   that   ¯ ∈ singsupp(u)   implies   ( ¯
∈ WF(u)  for  all   ω ∈ Sn−1

x, ω)  /
x  /
is  immediate.  
The  argument  to   prove  the  second  part  of   (12.43)   is   similar.  Since,  by 
deﬁnition,  WFsc (u)∩(Rn ×Bn )  =  WF(u) and  Css(u)∩Rn  = singsupp(u)  
we  only  need  consider  points   in  Css(u) ∩ Sn−1  .  Now,  we  ﬁrst   check  that 
if  θ  /∈  Css(u)  then  {θ} × Bn  ∩ WFsc (u) = 
∅
.  By  deﬁnition  of   Css(u)
there  is  a  cut­oﬀ  ψR ,  where  ψ  ∈  C∞ (Sn−1 )  and  ψ(θ)  = 0,  such  that 
ψRu  ∈ S (Rn ).  From (12.38)   this   implies  that  (θ, p)   /∈ WFsc (u)  for   all 
p ∈ Bn  . 
Now,   Lemma   12.13  allows  us  to  apply  the  same  argument  as  used 
above   for  WF  .  Namely  we  are  given   that   (θ , p)  /∈  WFsc (u)  for  all 
∈  Css( �
p ∈ Bn  .  Thus,   for  each  p we   may  ﬁnd   ψR ,  depending  on  p,  such  that  
ψ(θ) =�
ψRu).  Since  Bn  is   compact,  we  may  choose   a 
0  and  p  /
ﬁnite  subset  of  these   conic  localizers,  ψ (j )  such  that   the  intersection  
Rj 
�
of  the  corresponding   sets  Css(  ψ (j )u),  is   empty,  i.e.  their  complements  
Rj 
cover  Bn  .  Now,   using   Lemma  12.13  we  may  choose  one  ψ with  support 
such  that  Css(  � ∅
in  the  intersection  of  the   sets  {ψ (j )  = 0}  with  ψ(θ)  = 0  and one  R 
, but  this   just   means   that   ψRu ∈ S (Rn )  and  so 
ψRu) = 
θ  /∈ Css(u)  as  desired. 
The  fact  that  these  sets  are  closed  (in  the  appropriate  sets)  follows  
� 
directly  from  Lemma12.13. 
Corollary  12.15.  For  u ∈ S � (Rn ),  
WFsc (u) =  ∅ ⇐⇒ u ∈ S (Rn ).  
(12.44) 
Let  me   return  to   the   deﬁnition  of  WFsc  (u) and   rewrite  it,  using  what 
we  have  learned  so   far,  in  terms  of   a  decomposition  of  u. 
u ∈ S
� (Rn )  and  (p, q)  ∈ ∂ (Bn  × Bn ),
Proposition  12.16.  For  any 
∈ Css(u�2 ).  
(p, q)  /∈ WFsc (u)  ⇐⇒ 
∈ Css(u1 ),   q  /
u =  u1  +  u2 ,  u1 ,  u2  ∈ S � (Rn ),   p  /
φ ∈ C∞
∈  WFsc (u),  take  Φ   = 
(Rn )  with  φ  ≡  1
Proof.  For  given  (p, q)  /
near  p,   if  p ∈ Rn  or  Φ  =  ψR  with  ψ  ∈ C∞ (Sn−1 )  and  ψ  ≡ 1  near   p,  if 
c 
p ∈ Sn−1  .  In  either  case  p  /∈ Css(u1 )  if  u1  = (1  − Φ)u  directly  from  the 
deﬁnition.   So   u2  =  u − u1  = Φu.   If  the  support  of  Φ  is  small  enough  it 
q  /∈ Css(u�2 ).  
follows  as  in  the  discussion  in  the  proof  of  Proposition  12.14  that 

(12.45) 

(12.46) 

�
�
�
�
�
94  

RICHARD  B.  MELROSE 

Thus  we   have  (12.45)  in  the  forward   direction. 
For  reverse  implication   it  follows  directly  that  (p, q)  /∈ WFsc  (u1 ) and 
that  (p, q)  /∈ WFsc (u2 ).	
� 
This  restatement  of  the  deﬁnition  makes  it   clear   that   there  a  high 
degree  of  symmetry  under  the  Fourier   transform 
Corollary  12.17.  For  any  u ∈ S � (Rn ),  
(p, q)  ∈ WFsc (u))   ⇐⇒ (q , −p) ∈ WFsc  ( ˆu). 
(12.47)	
Proof.  I  suppose  a   corollary  should  not  need   a  proof,  but   still  .  .  .  .  The 
statement  (12.47)  is  equivalent   to 
∈ WFsc (u))   = ⇒ (q , −p)  /
∈ WFsc ( ˆ
(p, q)  /	
u)
(12.48) 
since  the  reverse  is  the  same  by  Fourier  inversion.  By  (12.45)  the 
q  /∈ Css(u�2 ).  Hence  equivalent   to 
condition  on  the  left  is  equivalent  to  u  =  u1  +  u2  with  p  /∈  Css(u1 ),  
u� =  v1  +  v2 ,  v1  =  u�2 , v�2  = (2π)−n uˇ1 
∈ Css(v�2 )  which   proves   (12.47).  
(12.49) 
∈ Css(v1 ),  −p  /
� 
so  q  /
Now,   we  can  exploit  these   notions  to  reﬁne  our   conditions   under 
which  pairing,  the  product  and   convolution   can  be  deﬁned. 
Theorem   12.18.  For  u,  v  ∈ S � (Rn ) 
(12.50)	 uv  ∈ S � (Rn )  is  unambiguously  deﬁned  provided 
(p, ω) ∈ WFsc  (u) ∩ (Bn  × Sn−1 ) = ⇒ (p, −ω)  /∈ WFsc (v) 

and  
(12.51)	 u ∗ v  ∈ S � (Rn )  is  unambiguously  deﬁned  provided 
(θ , q) ∈ WFsc (u) ∩ (Sn−1  × Bn ) = ⇒ (−θ , q)  /∈ WFsc (v).  
Proof.  Let  us  consider  convolution  ﬁrst.  The  hypothesis,  (12.51)   means 
that  for  each  θ ∈ Sn−1 
(12.52) 
.∅
{q ∈ Bn−1 ; (θ, q)  ∈ WFsc (u)} ∩ {q ∈ Bn−1 ; (−θ, q) ∈ WFsc  (v)} = 
Now,   the  fact   that  WFsc  is   always   a  closed  set   means   that   (12.52) 
remains   true  near  θ in  the  sense  that  if   U  ⊂ Sn−1  is   a  suﬃciently  small  
neighbourhood  of  θ then 
(12.53)	 {q ∈ Bn−1 ; ∃ θ �  ∈ U,  (θ � , q)  ∈ WFsc (u)} 
∩ {q ∈ Bn−1	
; ∃ θ ��  ∈ U,  (−θ �� , q) ∈ WFsc (v)} = 

∅

.

LECTURE  NOTES  FOR  18.155,   FALL  2004 
95 
The  compactness  of  Sn−1  means  that   there  is  a  ﬁnite   cover   of  Sn−1  by 
such  sets  Uj .  Now  select  a  partition   of  unity  ψi  of  Sn−1  which  is  not 
only   subordinate  to   this  open  cover,  so  each   ψi  is   supported   in   one  of 
the  Uj  but  satisﬁes  the  additional  condition   that  
supp(ψi ) ∩ (− supp(ψi ))   =  ∅ =
⇒ 
� 
� 
supp(ψi ) ∪ (− supp(ψi ))   ⊂ Uj  for  some   j. 
� 
Now,  if  we  set  ui  = (ψi )Ru,  and  vi = (ψi )Rv ,  we   know  that  u  − 
� 
� 
ui 
i 
has  compact  support  and  similarly  for  v .  Since  convolution   is  already 
known  to   be  possible  if  (at   least)   one  factor  has  compact  support,  it  
suﬃces  to  deﬁne  ui  ∗ vi�  for  every  i,  i� .  So,  ﬁrst   suppose  that  supp(ψi ) ∩
Css( u�i ) ∩ Css(v�i� ) =  ∅. 
(− supp(ψi ))  =  ∅.  In  this   case  we  conclude  from  (12.54)  that 
� 
(12.55) 
� =  u�iv�i�
ui  ∗ vi� 
(12.56) 
using   (12.20).  On  the  other   hand  if  supp   ψi  ∩ (− supp(ψi ))   =  ∅  then 
� 
Css(ui ) ∩ (− Css(vi ))   ∩ Sn−1  =
∅ 
� 
(12.57) 
and  in  this  case  we  can  deﬁne  ui  ∗ vi using  Lemma  12.10. 
� 
Thus  with  such  a   decomposition   of  u  and  v  all  terms  in   the  convolu­
tion  are  well­deﬁned.  Of  course  we  should   check  that   this   deﬁnition   is 
independent  of  choices  made  in  the  decomposition.  I  leave  this  to  you. 
That   the  product  is  well­deﬁned   under   condition  (12.50)   now   follows 
� =  f  ∗ g ,  f  =  u,  gˇ =  �
�
if  we  deﬁne  it   using  convolution,  i.e.  as 
uv 
v . 
Indeed,  using   (12.47),   (12.50)  for   u  and  v  becomes  (12.51)   for  f  and 
� 
g . 

Thus  we  may  deﬁne 

(12.54) 

(12.58) 

�
�
96  

RICHARD  B.  MELROSE 

13.  Homogeneous  distributions  
� 
Next  time  I   will  talk  about  homogeneous   distributions.  On  R  the 
functions 
sx
x  >  0
s x  = 
t 
x  <  0 
0 
where  S  ∈ R,   is  locally  integrable  (and  hence  a  tempered  distribution)  
precisely  when  S  >  −1.   As  a  function   it  is  homogeneous  of   degree  s. 
Thus  if  a  >  0  then 
� � 
s s
(ax)s  =  a xt  .
t

s

Thinking  of  x =  µs  as  a  distribution  we  can  set   this   as  
t 
s =  a µs (ϕ) . 
Thus  if  we  deﬁne  ϕa (x) =   a  ϕ( x  ),   for   any  a  >  0,  ϕ  ∈ S (R)  we  can  ask 
1
a 
whether  a  distribution  is  homogeneous: 
µ(ϕa ) =  a s µ(ϕ)   ∀ ϕ  ∈ S (R). 

µs (ax)ϕ(x) dx 

µs (ax)(ϕ) = 

= 

µs (x)ϕ(x/a) 

dx 
a 

LECTURE  NOTES  FOR  18.155,   FALL  2004 

99 

16.  Spectral  theorem 

(16.1) 

For  a   bounded  operator   T  on  a  Hilbert   space  we   deﬁne   the   spectrum 
as  the   set 

spec(T ) =  z  ∈ C; T  − z  Id  is  not   invertible}.
{
Proposition  16.1.  For  any  bounded  linear  operator  on  a  Hilbert  space 
spec(T )  ⊂ C  is  a  compact  subset  of  {|z
| ≤ �T �}
.
Proof.  We  show  that  the  set   C \ spec(T )  (generally  called  the  resolvent 
set  of  T )  is  open  and  contains  the  complement   of  a  suﬃciently  large 
ball.  This  is  based  on  the   convergence  of  the  Neumann  series.  Namely 
� 
if  T  is  bounded  and  �T � <  1  then  
∞
(Id  −T )−1  = 
T j 
(16.2) 
j=0 
converges  to  a   bounded  operator  which   is  a  two­sided  inverse  of  Id   −T . 
Indeed,  �T j �  ≤  �T �j  so  the  series  is   convergent   and   composing  with  
Id  −T  on  either  side  gives  a  telescoping  series   reducing  to  the  identity. 
Applying  this  result,  we  ﬁrst  see  that  
−
z (Id  −T /z )
(T  − z ) = 
(16.3) 
is  invertible  if  z >  �T �.  Similarly,  if  (T  − z0 )−1  exists  for  some  z0  ∈ C
| |
then 
(16.4)  (T − z )  = (T − z0 )− (z − z0 )  = (T − z0 )−1 (Id  −(z − z0 )(T − z0 )−1 ) 
|z  − z0 |�(T  − z0 )−1
� <  1. 
�
exists  for 
In  general   it  is   rather  diﬃcult  to  precisely  locate  spec(T ).  
However   for  a   bounded  self­adjoint   operator   it   is  easier.  One  sign  of 
this  is  the  the  norm  of  the  operator   has  an   alternative,  simple,  charac­
terization.  Namely  
sup  �Aφ,  φ�| = 
�A�
if  A∗  =  A  then 
(16.5) 
.
�φ�=1
If  a  is  this  supermum,   then  clearly  a  ≤ �A�.  To  see  the  converse,   choose 
any   φ,   ψ  ∈ H  with  norm   1  and   then  replace  ψ  by  eiθψ  with  θ  chosen 
so  that  �Aφ,   ψ�  is  real.  Then  use  the  polarization   identity  to  write 
(16.6)  4�Aφ,   ψ� =  �A(φ  +  ψ),   (φ   +  ψ)� − �A(φ  − ψ),   (φ   − ψ)� 
+  i�A(φ  +  iψ),   (φ   +  iψ)� − i�A(φ   − iψ),   (φ   − iψ)�. 
Now,  by   the  assumed  reality  we  may  drop   the  last  two  terms  and   see 
that  
(16.7)  4|�Aφ,   ψ�| ≤ a(�φ  +  ψ�2  +  �φ − ψ� ) = 2a(�φ�2  +  �ψ�2 )  = 4a. 
2

�2  →

0.

100 
RICHARD  B.  MELROSE 
Thus  indeed  �A� = sup�φ�=�ψ�=1  |�Aφ,  ψ�| =  a. 
We  can  always  subtract  a  real  constant   from  A  so  that   A�  =  A  − t 
satisﬁes 

(16.11) 

�φ,  φ� =  sup  �A�φ,  φ� =  �A� . 
�A
−  inf 
�
(16.8)	
�φ�=1
�φ�=1
Then,  it  follows  that  A� ± �A��  is   not  invertible.  Indeed,  there  exists  a 
sequence  φn ,  with  �φn� = 1  such  that  �(A�
− �A
��)φn ,  φn � → 0.  Thus 
(16.9) 
��)φn� =  −2�A�φn ,  φn �+�A�φn� +�A�
�(A�
−�A
�φn ,  φn �+2�A�
� ≤ −2�A
2
2
2 
− �A
�� cannot   be  invertible and  the  same  argument 
This  shows  that   A�
�
works  for  A�  +  �A� .  For  the  original  operator   A  if  we  set 
�Aφ,  φ� M  =  sup  �Aφ,  φ�
(16.10) 
inf
m  =  �φ�=1
�φ�=1
then  we  conclude  that  neither  A − m  Id  nor  A − M  Id  is   invertible  and  
�A� =

max(−m,   M ).
Proposition  16.2.  If  A  is  a  bounded  self­adjoint  operator  then,  with 

m  and  M  deﬁned  by  (16.10),

{
m} ∪ {M } ⊂ spec(A)   ⊂ [m,   M ].
Proof.  We  have   already  shown  the   ﬁrst   part,  that   m  and  M  are  in  
the  spectrum  so  it  remains  to   show  that   A  −  z  is   invertible  for  all 
z  ∈ C \ [m,  M ].  
Using  the  self­adjointness  
Im�(A  − z )φ,  φ� =  − Im  z�φ�2  . 
(16.12) 
This  implies  that  A  − z  is  invertible  if  z  ∈  C \ R.  First  it  shows   that  
(A − z )φ  = 0  implies  φ  = 0,  so  A − z  is   injective.  Secondly,  the  range  is 
closed.  Indeed,  if  (A  − z )φn  → ψ  then  applying  (16.12)   directly  shows  
that  �φn�  is  bounded  and  so  can   be  replaced  by  a  weakly  convergent 
subsequence.   Applying   (16.12)  again  to  φn  − φm  shows  that   the  se­
quence  is  actually  Cauchy,  hence   convergens   to  φ  so  (A − z )φ   =  ψ  is   in 
the  range.   Finally,   the   orthocomplement   to  this  range  is  the  null  space 
of  A∗ − ¯z ,   which  is  also   trivial,  so  A − z  is   an   isomorphism  and  (16.12) 
also  shows  that  the  inverse  is   bounded,  in  fact  
� ≤ 
�(A  − z )−1
1 
(16.13)	
|
Im  z |
.
When  z  ∈ R we  can  replace  A  by  A�  satisfying  (16.8).  Then  we  have 
to  show   that  A� − z  is  inverible  for  z
| | >  �A�	
,   but  that  is   shown   in  the 
�
proof  of  Proposition  16.1. 

LECTURE  NOTES  FOR  18.155,   FALL  2004 

101 

(16.14)	

p(t) = 

then  p(A) = 

The  basic   estimate  leading  to  the  spectral  theorem  is: 
Proposition  16.3.  If  A  is  a  bounded  self­adjoint  operator  and  p  is  a 
� 
real  polynomial   in  one  variable, 
N
ci ti  ,  cN  = 0, 
� 
i=0 
N
ciAi  satisﬁes 
i=0  
p(t)|.
�p(A)� ≤ 
|
(16.15)	
sup 
t∈[m,M   ]
Proof.  Clearly,  p(A) is  a  bounded  self­adjoint  operator.  If  s  /∈ p([m, M ])  
then  p(A) − s  is  invertible.   Indeed,  the  roots   of  p(t) − s  must  cannot 
lie  in [m.M ],   since  otherwise  s  ∈ p([m, M ]).  Thus,  factorizing  p(s) − t 
we  have  
� � 
(16.16) 
N
(t − ti (s)),  ti (s)   / [m, M ] = ⇒ (p(A) − s)−1  exists
p(t) − s  =  cN 
∈
i=1  
(A  − ti (s))  and  each   of  the   factors  is  invertible. 
since   p(A) =  cN 
Thus  spec(p(A))  ⊂  p([m, M ]),  which  is  an   interval  (or   a  point),  and 
i 
from  Proposition   16.3  we  conclude   that   �p(A)� ≤ sup  p([m, M ])   which 
� 
is  (16.15). 

(16.17)	

Now,   reinterpreting  (16.15)   we   have  a  linear   map  
P (R)  � p �−→ p(A) ∈ B(H ) 
from  the  real  polynomials  to  the  bounded   self­adjoint  operators  which 
is  continuous  with  respect   to  the  supremum  norm  on  [m, M ].  Since 
polynomials  are  dense  in   continuous   functions  on  ﬁnite  intervals,  we 
see  that  (16.17)  extends  by  continuity  to  a  linear  map  
(16.18)

C ([m, M ])  � f 
�−→ f (A) ∈ B(H ),   �f (A)� ≤ �f �[m,M   ] ,  f g(A) =  f (A)g(A) 

where   the  multiplicativity  follows   by  continuity  together  with  the  fact 
that  it  is  true  for  polynomials. 
Now,   consider  any  two   elements  φ, ψ  ∈ H.   Evaluating  f (A) on  φ and 
pairing   with  ψ  gives  a  linear   map 
C ([m, M ])   � f 
�−→ �f (A)φ, ψ� ∈ C. 
(16.19) 
This  is  a  linear   functional  on  C ([m, M ])   to  which we  can  apply  the  Riesz 
representatin  theorem  and  conclude  that  it   is  deﬁned  by  integration  

�
102 

RICHARD  B.  MELROSE 
� 
against  a  unique  Radon  measure  µφ,ψ  : 
�f (A)φ, ψ� = 
(16.20)	
f dµφ,ψ  . 
[m,M   ] 
The  total  mass  µφ,ψ  |  of  this   measure  is   the  norm  of  the  functional. 
|
Since  it  is  a  Borel  measure,  we  can  take  the  integral  on  −∞, b]  for  any 
b  ∈  R  ad,  with  the  uniqueness,  this  shows   that  we  have  a  continuous 
� 
sesquilinear  map 
(16.21) 
Pb (φ, ψ) :   H×H  � (φ, ψ) 
[m,b] 
From  the  Hilbert  space  Riesz  representation  theorem  it  follows  that  
this  sesquilinear  form   deﬁnes,   and   is  determined   by,  a  bounded   linear 
operator 

dµφ,ψ  ∈ R, Pb (φ, ψ)| ≤ �A��φ��ψ�.
|

�−→ 

(16.22) 

(16.23) 

Pb (φ, ψ) =  �Pbφ, ψ�,  �Pb� ≤ �A�. 
In  fact,  from  the  functional  calculus  (the  multiplicativity  in  (16.18)) 
we  see   that 

P ∗  =  Pb ,  P 2  =  Pb ,  �Pb� ≤ 1,
b
b 
so   Pb  is  a  pro jection. 
Thus  the  spectral   theorem  gives   us  an  increasing  (with  b)   family  of 
commuting   self­adjoint  pro jections  such  that  µφ,ψ  ((−∞, b])   =  �Pbφ, ψ�
determines  the  Radon  measure   for  which  (16.20)   holds.  One  can  go 
further  and  think  of  Pb  itself  as  determining  a  measure 
µ((−∞, b])   =  Pb 
(16.24)	
� 
which  takes  values  in  the  pro jections  on  H  and  which   allows  the  func­
tions  of  A  to  be  written  as   integrals  in   the  form  
[m,M   ] 
of  which  (16.20)  becomes  the  ‘weak  form’.  To  do  so  one  needs  to 
develop  the  theory  of  such  measures  and  the  corresponding  integrals. 
This  is  not  so  hard  but  I   shall   not  do  it. 

(16.25)	

f (A) = 

f dµ 

LECTURE  NOTES  FOR  18.155,  FALL  2004 

103 

17.   Problems 

Problem  1.  Prove  that  u+ ,  deﬁned  by  (1.10)  is  linear. 

Problem  2.  Prove  Lemma  1.8. 
Hint(s).   All   functions  here  are   supposed   to  be  continuous,  I  just  
don’t  bother  to   keep   on  saying  it. 
(1)  Recall,  or  check,  that   the  local  compactness   of  a  metric  space 
X  means  that  for  each   point  x ∈ X  there  is   an   � > 0  such  that  
the  ball  { y ∈ X ; d(x, y)  ≤ δ}  is   compact  for  δ ≤ �.  
(2)  First  do  the  case  n = 1,  so  K � U  is   a  compact   set  in   an   open  
subset.  
(a)  Given  δ  >  0,   use  the  local  compactness   of  X,   to  cover   K 
with  a   ﬁnite  number   of  compact  closed   balls  of  radius   at  
most  δ.  
(b)  Deduce	 that  if  � >  0  is  small   enough   then   the   set  { x  ∈
X ; d(x, K )  ≤ �} ,  where 
d(x, K )  =  inf  d(x, y),  
y∈K 

is  compact.  
(c)  Show   that  d(x, K ),   for  K  compact,  is   continuous.  
(d)  Given  � >  0  show  that   there  is  a  continuous function  g�  : 
R  −→  [0, 1]   such  that   g� (t)  = 1  for  t  ≤  �/2  and   g� (t)   = 0 
for  t > 3�/4. 
(e)  Show  that  f  =  g�  ◦ d(· , K ) satisﬁes   the  conditions  for  n = 1 
if  � > 0  is  small  enough. 
(3)	 Prove  the   general   case  by  induction  over   n. 
(a)  In  the   general  case,  set  K �  =  K ∩ U1 
�  and  show   that  the 
� 
inductive  hypothesis  applies  to  K �  and  the  Uj  for  j > 1;  let  
� ,  j = 2, . . . , n  be  the  functions   supplied   by the  inductive 
fj
assumption  and  put  f �  = 
� . 
j≥2  fj
(b)  Show   that  K1  =  K ∩ { f �  ≤  2 }  is   a  compact   subset  of  U1 . 
1
(c)  Using  the  case  n  =  1  construct   a  function   F  for  K1  and 
U1 . 
(d)  Use  the  case  n = 1  again  to  ﬁnd  G such  that  G = 1  on   K 
and  supp(G)  � { f �  +  F >  2 } . 
1
(e)  Make  sense  of  the  functions  

f1  =  F 

,  j ≥ 2 

G 
G
f �  +  F
f �  +  F
and  show  that   they  satisﬁes   the  inductive  assumptions. 

�
,  fj  =  fj

104 

RICHARD  B.  MELROSE 

Problem  3.  Show  that  σ ­algebras  are  closed   under  countable   intersec­
tions. 
Problem  4.  (Easy)  Show  that   if  µ  is   a  complete  measure  and   E  ⊂  F 
where  F  is  measurable  and  has  measure  0  then   µ(E )  = 0. 

Problem  5.  Show  that  compact   subsets   are  measurable  for   any  Borel 
measure.  
(This  just  means  that   compact   sets   are  Borel  sets   if   you 
follow  through  the  tortuous   terminology.)  

Problem  6.  Show  that  the  smallest   σ ­algebra  containing  the  sets 
⊂ −∞
(a,  ∞]
, ∞]
[
for  all   a  ∈  R,   generates  what  is   called   above   the  ‘Borel’  σ ­algebra  on 
−∞
, ∞].
[
Problem  7.  Write  down  a  careful  proof  of   Proposition  1.1. 

Problem  8.  Write  down  a  careful  proof  of  Proposition  1.2. 

Problem  9.  Let  X  be  the  metric  space 
{0} ∪ {1/n; n  ∈ N = 
{1, 2, .  .  .}} ⊂ R
X  =	
with  the  induced  metric   (i.e.  the  same  distance  as   on  R).  Recall  why 
X  is  compact.  Show   that   the  space  C0 (X )  and  its  dual  are  inﬁnite 
dimensional.   Try   to   describe  the  dual  space  in   terms  of  sequences;  at  
least  guess  the  answer.  
Problem  10.  For  the  space  Y  =  N  =  {1, 2, .  .  .}  ⊂  R,  describ e  C0 (Y ) 
and  guess  a   description  of  its   dual  in  terms   of  sequences. 
Problem  11.  Let  (X, M, µ)   be  any  measure   space  (so  µ  is   a  measure 
on  the  σ ­algebra  M of  subsets  of  X ).   Show  that   the  set  of  equivalence  
classes  of  µ­integrable  functions  on   X,   with  the  equivalence   relation  
� 
given  by  (4.8),   is  a   normed  linear   space  with  the  usual  linear  structure 
and  the  norm  given  by 
|
|
�f � = 
f dµ.
X 
Problem  12.  Let  (X, M)  be  a  set  with a  σ ­algebra.  Let  µ  :  M → R be 
a  ﬁnite   measure  in  the  sense   that  µ(φ)  =  0  and  for  any  {Ei}∞
i=1  ⊂ M 
� 
 
� � 
with  Ei  ∩ Ej  =  φ  for  i  =  j , 
� 
∞
∞
Ei  = 
µ(Ei ) 
µ
i=1 
i=1 

(17.1)	

105 

|
|
µ (E ) =  sup  

LECTURE  NOTES  FOR  18.155,  FALL  2004 
with  the  series  on  the   right  always  absolutely  convergenct   (i.e.,  this  is 
� 
part  of  the  requirement  on  µ).   Deﬁne 
∞
|µ(Ei )|
(17.2)	
E  = 
i=1 
for  E  ∈ M,  with  the  supremum  over   al l  measurable  decompositions 
�

Ei  with  the	 Ei  disjoint.  Show   that   |µ| is   a  ﬁnite,   positive 
∞
i=1|µ| (Ai )  if 
i=1  
measure.  
Hint  1.  You  must  show  that   |µ| (E ) = 
∞
Ai  =  E ,
 
Ai  ∈ M being   disjoint.   Observe  that  if  Aj  = 
i 
Aj l  is   a  measurable 
l 
decomposition   of  Aj  then  together   the  Aj l  give  a  decomposition   of  E . 
j  Ej  is   any  such  decomposition  of  E  then  Aj l  = 
Similarly,  if   E  = 
Aj  ∩ El  gives  such  a   decomposition  of  Aj . 
Hint  2.  See  [5]  p.  117! 

Problem  13.  (Hahn  Decomposition) 
With  assumptions  as  in   Problem  12:  
(1)  Show   that  µ+  =  2 ( µ +  µ)  and  µ−  =  2 ( µ − µ)  are  positive 
|
|	
|
|
1	
1
measures,   µ  =  µ+  − µ− .  Conclude  that  the  deﬁnition  of  a 
measure  based  on  (4.16)   is  the  same  as  that   in  Problem  12. 
(2)  Show  that  µ±  so  constructed  are  orthogonal  in   the  sense  that 
there  is  a   set	 E  ∈ M such that  µ− (E )  = 0,  µ+ (X  \ E )  = 0. 
Hint.  Use  the  deﬁnition  of  µ to  show  that   for  any  F  ∈ M 
|
|
,  F �  ⊂ F  such  that  
∈ M
and  any  �  >  0  there  is   a  subset   F � 
µ+ (F � )  ≥  µ+ (F )  − �  and  µ− (F � )  ≤  �.   Given  δ  >  0  apply 
this  result  repeatedly  (say  with  �  = 2−nδ)  to  ﬁnd  a  decreas­
� 
∈ M
,  Fn+1  ⊂ Fn  such  that  
ing   sequence  of  sets  F1  =  X,   Fn 
 
µ+ (Fn )  ≥ µ+ (Fn−1 ) − 2−nδ  and  µ− (Fn )  ≤ 2−nδ.  Conclude  that  
Fn  has  µ+ (G)   ≥ µ+ (X ) − δ  and  µ− (G)   = 0.   Now  let 
G  = 
n 
Gm  be   chosen  this   way  with   δ  = 1/m.  Show  that  E  = 
Gmm 
is  as  required.  

Problem  14.  Now  suppose  that   µ  is   a  ﬁnite,  positive   Radon   measure 
on  a   locally  compact  metric  space  X  (meaning  a  ﬁnite  positive  Borel 
measure  outer  regular   on   Borel  sets  and  inner   regular   on  open   sets). 
Show  that  µ  is  inner  regular  on   all  Borel  sets  and  hence,  given   � >  0 
and  E  ∈ B(X )  there  exist  sets  K  ⊂ E  ⊂ U  with  K  compact   and   U 
open  such  that  µ(K )  ≥ µ(E ) − �,   µ(E )  ≥ µ(U ) − �.  
Hint.  First  take  U  open,  then   use  its  inner  regularity  to  ﬁnd   K 
with  K �  �  U  and  µ(K � )  ≥ µ(U )  − �/2.  How   big  is  µ(E \K � )?  Find  
V  ⊃ K � E  with  V  open  and   look  at  K  =  K � V .
\	
\

106 

RICHARD  B.  MELROSE 

Problem  15.  Using  Problem  14  show  that  if  µ  is   a  ﬁnite  Borel   measure 
on  a  locally  compact  metric   space  X  then  the  following  three  conditions  
are  equivalent 
(1)  µ  =  µ1 − µ2  with  µ1  and  µ2  both   positive  ﬁnite  Radon   measures. 
(2)  |µ|  is  a  ﬁnite  positive  Radon  measure. 
(3)  µ+  and  µ−  are  ﬁnite  positive  Radon   measures. 
Problem  16.  Let  �  �  be   a   norm  on  a  vector   space  V  .  Show  that  �u� = 
(u,   u)1/2   for  an  inner  product  satisfying  (5.1)   ­ (5.4)   if  and   only  if  the 
parallelogram  law  holds  for  every  pair  u,  v  ∈ V  . 
Hint  (From  Dimitri   Kountourogiannis) 
If  � · �  comes  from  an  inner   product,  then   it  must  satisfy  the  polari­
sation  identity:  
(x,   y)  = 1/4(�x  +  y�2 

− �x  − y� − i�
2

− i�
x  − iy�2 )

x  +  iy�2 

i.e,  the  inner  product  is  recoverable  from  the  norm,  so  use  the  RHS  
(right  hand  side)  to  deﬁne  an   inner  product  on   the  vector  space.  You  
will   need  the  paralellogram  law  to  verify  the  additivity  of  the  RHS. 
Note   the  polarization  identity  is   a  bit  more  transparent   for   real  vector  
spaces.  There  we  have  
(x,   y)  = 1/2(�x  +  y�2 
both  are   easy  to  prove   using  �
a�
2  = (a,  a).
→
Problem  17.  Show  (Rudin   does  it)  that  if  u  :  Rn 
C  has  continuous 
partial  derivatives  then  it  is   diﬀerentiable  at   each  point  in  the  sense  of 
(6.5). 
Problem  18.  Consider  the  function  f (x) =  x�−1  = (1 + x
�
|
that 

x  − y� )
2

| 2 )−1/2 

− �

.  Show 

=  lj (x) · �x�−3 
∂ f 
∂xj 
with  lj (x)  a   linear  function.  Conclude  by  induction  that   x�−1 
�
C0  (Rn )  for  al l  k . 
k 
Problem  19.  Show  that  exp(− x|

|  )  ∈ S (Rn ).  
2

∈ 

Problem  20.  Prove  (7.7),  probably  by  induction   over   k . 

Problem  21.  Prove  Lemma  7.4.  

LECTURE  NOTES  FOR  18.155,   FALL  2004 
107 
Hint.  Show   that  a  set  U  � 0  in  S (Rn )  is  a  neighbourhood of  0  if  and  
only   if  for   some  k  and  �  >  0  it  contains  a  set   of  the  form ⎫ ⎪⎪⎬ 
⎧ ⎪⎪⎨ 
� 
� �

� �

⎪⎪⎭

⎪⎪⎩

ϕ  ∈ S (Rn
αDβ ϕ
sup

) ;
x 
<  �
. 
|α|≤k, 
|β |≤k 
Problem  22.  Prove  (8.7),   by  estimating  the  integrals. 
�

0 

Problem  23.  Prove  (8.9)  where 

�
ψj (z ; x ) = 

�  ∂ψ 
∂ zj

�

(z  +  tx


) dt  .

Problem  24.  Prove  (8.20).   You   will  probably  have  to  go  back  to  ﬁrst  
principles  to  do  this.  Show   that   it   is  enough  to  assume  u  ≥  0  has 
compact  support.  Then   show  it   is  enough  to  assume  that  u  is   a  simple, 
and  integrable,  function.   Finally  look  at  the  deﬁnition   of  Lebesgue 
measure  and  show  that   if  E  ⊂  Rn  is   Borel  and  has   ﬁnite  Lebesgue  
measure  then 

lim  µ(E \(E   +  t))   = 0 
|t|→∞ 

where  µ  =  Lebesgue  measure  and  
E  +  t  =  {p  ∈ Rn  ;  p�  +  t ,  p�  ∈ E } . 
�
 �
 �

Problem  25.  Prove  Leibniz’  formula 
·
α 
xϕ dα−β 
Dα
x (ϕψ)  = 
x  ψ
β 
β≤α 
for  any  C∞  functions  and  ϕ  and  ψ .  Here  α  and  β  are  multiindices, 
�  �  �
 �
 �

βj  ≤ αj  for  each  j?  and
β  ≤ α
means

αj
α 
= 
βj 
β 
j 

Dα 

. 

I  suggest  induction!  
Problem  26.  Prove  the   generalization   of  Proposition   8.10  that   u  ∈
� (Rn ),  supp(w)  ⊂  {0}  implies  there  are  constants  cα  ,  α ≤  m,  for
S
|
|
�

some 
m,  such  that
|α|≤m 

cαDαδ . 

u  = 

108 

RICHARD  B.  MELROSE 

Hint  This  is  not  so   easy!  I  would  be  happy  if  you  can   show   that 
u  ∈ M (Rn ),  supp  u  ⊂ {0}  implies  u  =  cδ .  To  see  this,  you  can  show 
that 
ϕ ∈ S (Rn

),  ϕ(0) = 0

⇒  ∃ϕj  ∈ S (Rn

) ,  ϕj (x)  = 0  in  x ≤ �j  > 0(↓ 0)  ,
|
|
sup  ϕj  − ϕ
|
| →
0  as   j → ∞ .
To   prove  the  general   case you  need   something  similar   —   that  given   m, 
if  ϕ ∈ S (Rn )  and  Dα
xϕ(0)   = 0  for   α ≤ m  then  ∃ ϕj  ∈ S (Rn ),   ϕj  = 0
|
|
in  x ≤ �j  ,  �j  ↓ 0  such  that   ϕj  → ϕ in   the  C norm. 
|
|
m
Problem  27.  If  m  ∈  N,   m�  >  0  show  that  u  ∈  H m (Rn )  and  Dαu  ∈
H m� (Rn )  for  all  α ≤ m implies   u ∈ H m+m� (Rn ).   Is   the  converse  true?
|
|
Problem  28.  Show  that  every  element  u ∈ L2 (Rn )  can  be  written  as  a 
� 
sum 
n
Dj uj  ,  uj  ∈ H 1 (Rn ) ,  j = 0, . . . , n . 
j=1 
� 
Problem  29.  Consider  for  n  =  1,  the  locally  integrable  function  (the 
Heaviside   function),  

u =  u0  + 

H (x) =

0  x ≤ 0 
1  x > 1 . 

Show   that  DxH (x) =  cδ ;  what   is  the  constant   c? 
Problem  30.  For  what range  of   orders  m is   it   true  that   δ ∈ H m (Rn ) ,  δ(ϕ) = 
ϕ(0)? 

Problem  31.  Try  to   write  the  Dirac  measure   explicitly  (as   possible)  in  
the  form  (10.8).  How   many  derivatives   do  you  think  are  necessary? 

Problem  32.  Go  through  the  computation   of  ∂E again,  but  cutting  out  
a  disk  {x2  +  y ≤ �2} instead. 
2
Problem  33.  Consider  the  Laplacian,  (11.4),  for   n  =  3.  Show  that  
E =  c(x2  +  y 2 )−1/2  is  a  fundamental  solution  for   some  value  of   c. 
Problem  34.  Recall   that  a  topology  on  a  set   X  is   a  collection  F  of 
subsets  (called  the  open  sets)   with  the  properties,   φ ∈ F ,  X  ∈ F  and 
F  is  closed  under   ﬁnite  intersections   and  arbitrary  unions.  Show  that  
the  following   deﬁnition   of  an   open  set  U  ⊂ S � (Rn )  deﬁnes  a  topology:  
∀ u ∈ U  and  all  ϕ ∈ S (Rn )  ∃� > 0  st.  
(u�  − u)(ϕ) < � ⇒ u�  ∈ U . 
|
|

LECTURE  NOTES  FOR  18.155,   FALL  2004 

109 

This  is  called   the  weak  topology  (because  there  are  very  few  open 
sets).  Show  that   uj  → u  weakly  in   S � (Rn )  means  that   for   every  open 
set  U  � u  ∃N  st.  uj  ∈ U  ∀ j  ≥ N . 
Problem  35.  Prove  (11.18)  where  u  ∈ S � (Rn )  and   ϕ,  ψ  ∈ S (Rn ).  
Problem  36.  Show  that  for   ﬁxed   v  ∈ S � (Rn )  with   compact  support  
S (Rn
)  � ϕ 
�→ v  ∗ ϕ  ∈ S (Rn
)
is  a   continuous  linear  map. 
Problem  37.  Prove  the   ??  to  properties  in  Theorem  11.6  for  u ∗ v  where 
u  ∈ S
� (Rn )  and  v  ∈ S � (Rn )  with  at  least   one  of  them  having  compact 
support.  

Problem  38.  Use  Theorem  11.9  to  show  that   if  P (D)  is  hypoelliptic 
then  every  parametrix  F  ∈ S (Rn )  has   sing  supp(F ) = 
.{0}
Problem  39.  Show  that  if  P (D)  is  an  ellipitic  diﬀerential  operator  of 
order  m,   u  ∈ L2 (Rn )  and  P (D)u   ∈ L2 (Rn )  then   u  ∈ H m (Rn ).  
Problem  40   (Taylor’s  theorem).  .  Let  u  :  Rn  −→  R  be  a  real­valued  
function  which   is  k  times  continuously  diﬀerentiable.   Prove  that  there 
is  a   polynomial   p  and  a  continuous   function  v  such that 
|v(x)| 
|
|k 
= 0. 
lim 
u(x) =  p(x) +  v(x)  where 
|x|↓0 
x
Problem  41.  Let  C (Bn )  be  the  space  of  continuous   functions   on  the 
(closed)  unit   ball,   Bn  =  x  ∈  Rn ; x
{
|
| ≤  1}
.   Let  C
0 (Bn )  ⊂  C (Bn ) 
be 
the  subspace  of  functions  which   vanish  at  each  point  of  the  boundary 
and  let  C (Sn−1 ) be  the  space  of  continuous  functions  on  the  unit  sphere. 
Show  that  inclusion  and  restriction   to  the  boundary  gives  a  short  exact 
sequence 
C0 (Bn )  �→ C (Bn ) −→ C (Sn−1
)
(meaning   the  ﬁrst  map  is  injective,  the  second  is  surjective  and   the 
image   of  the  ﬁrst  is  the   null  space  of  the  second.)  

Problem  42   (Measures).  A  measure  on   the  ball  is  a  continuous   linear  
functional  µ  :  C (Bn )  − R  where  continuity  is  with   respect   to  the 
→
supremum  norm,  i.e.   there  must   be  a  constant   C  such that 
µ(f ) ≤ C  sup  f (x)
|
|
|
| ∀ f  ∈ C (Bn
).
x∈Rn 
Let  M (Bn )  be   the  linear  space  of   such   measures.  The  space  M (Sn−1 ) 
of  measures  on  the  sphere  is  deﬁned  similarly.  Describe  an   injective 
map 
M (Sn−1 )  − M (Bn ).
→

110 

RICHARD  B.  MELROSE 

(17.3) 

Can  you  deﬁne  another   space  so  that  this  can  be  extended  to  a  short 
exact  sequence? 
� 
Problem  43.  Show  that  the  Riemann   integral  deﬁnes  a  measure 
C (Bn
) � f 
�−→ 
f (x)dx.
Bn 
If  g  ∈  C (Bn ) 
and  µ  ∈  M (Bn )  show  that  gµ  ∈  M (Bn )
Problem  44. 
where  (gµ)(f ) =  µ(f g) for  all  f  ∈  C (Bn ).   Describ  e  all  the  measures  
with  the   property  that 
xj µ  = 0  in   M (Bn )  for  j  = 1, .  .  .  ,  n. 
Problem  45   (H¨ormander,   Theorem  3.1.4).   Let  I  ⊂ R  be  an  open,  non­
� 
empty  interval.  
i)  Show  (you  may  use  results  from  class)  that   there  exists   ψ  ∈
cC∞
� 
(I )  with  R ψ(x)ds  = 1.
ii)  Show   that  any   φ  ∈ C∞ (I )  may  be  written  in   the  form 
c 
� 
φ  =  φ  +  cψ ,   c  ∈ C,  ˜
φ  ∈ C∞
φ˜ = 0.
˜
(I )  with  
c
R 
iii)  Show  that  if   φ˜ ∈  C∞ (I )  and 
φ˜ =  0  then   there  exists  µ  ∈
R

c 
C∞
(I )  such  that  dx  =  φ˜ in   I . 
dµ

c 
iv)  Suppose  u  ∈ C −∞ (I )  satisﬁes  du  = 0,  i.e.
dx 
)  = 0  ∀ φ  ∈ C∞ (I ),
u(− 
dφ 
c 
dx 
show  that  u  =  c  for  some   constant  c. 
v)  Suppose  that  u  ∈ C −∞ (I )  satisﬁes  du  =  c,  for  some  constant  c,
show  that  u  =  cx  +  d  for  some  d  ∈ C. 
dx 
Problem  46.  [H¨ormander  Theorem  3.1.16] 
i)  Use  Taylor’s  formula  to  show   that  there  is  a  ﬁxed   ψ  ∈ C∞ (Rn )
� 
such that  any  φ  ∈ C∞ (Rn )  can  be  written   in  the  form 
c 
c 
n
xj ψj 
j=1 
where   c  ∈ C  and  the   ψj  ∈ C∞ (Rn )  depend   on  φ.
c 
ii)  Recall  that  δ0  is  the  distribution  deﬁned   by 
δ0 (φ) =  φ(0)   ∀ φ  ∈ C∞ (Rn );
c 
explain  why  δ0  ∈ C −∞ (Rn ).  
iii)  Show   that  if  u  ∈ C −∞ (Rn )  and  u(xj φ)  = 0  for  all  φ  ∈ C∞ (Rn )
and  j  = 1, .  .  .  ,  n  then   u  =  cδ0  for  some   c  ∈ C. 
c 

φ  =  cψ  + 

111 

LECTURE  NOTES  FOR  18.155,  FALL  2004 
� 
iv)  Deﬁne  the  ‘Heaviside  function’ 
∞ 
φ(x)dx  ∀ φ  ∈ Cc
∞ (R); 
H (φ) = 
0 
show  that  H  ∈ C −∞ (R). 
v)  Compute  dx  H  ∈ C −∞ (R). 
d
Problem  47.  Using   Problems   45  and   46,  ﬁnd  all  u  ∈ C −∞ (R) satisfying 
the  diﬀerential  equation  

= 0  in  R. 

du 
x 
dx 
� 
These  three  problems  are  all  about  homogeneous  distributions  on 
the  line,  extending  various  things   using  the  fact  that  
exp(z  log  x) 	 x  >  0 
x  ≤ 0 
0	
is  a  continuous  function  on  R if  Re  z  >  0  and  is  diﬀerentiable  if  Re  z  >  1 
and  then  satisﬁes 

z x  = + 

We  used  this  to   deﬁne 

z−1 
z
x+  =  zx + 

. 

d 
dx

(17.4) 

x z	 = + 

· · · 

if  z  ∈ C \ −N. 

dk
1 
1
1 
z+k
z  +  k z  +  k  − 1 
z  +  1  dxk  x+ 
Problem  48.  [Hadamard  regularization]  
� 
i)  Show  that  (17.4)  just  means   that   for   each  φ  ∈ C∞ (R)
c 
(−1)k 
∞  dk φ 
∈ −N. 
dx,  Re  z  >  −k ,   z  /
dxk  (x)x z+k
(z  +  k) · · · (z  +  1)	
0 
�
�� 
ii)  Use  integration   by  parts  to  show  that  
� 
(17.5)	
k
φ(x)x z dx  − 
Cj (φ)�z+j 
�	
j=1 

,  Re  z  >  −k ,   z  /
∈ −N 

z x+ (φ)  =  lim 
↓
� 0	

z	
x+ (φ) = 

∞	

for  certain  constants  Cj (φ)  which  you  should   give  explicitly. 
[This  is  called  Hadamard   regularization  after   Jacques   Hadamard, 
feel   free   to  look  at  his  classic   book  [3].] 
iii)  Assuming   that  −k  +  1  ≥  Re  z  >  −k ,   z  =  −k  +  1,  show  that 
there  can  only  be  one  set   of   the  constants  with   j <  k  (for   each  
choice  of  φ  ∈ C∞ (R))  such   that   the  limit   in   (17.5)  exists.
c 

�
112 

RICHARD  B.  MELROSE 

iiv)  Use  ii),  and   maybe  iii),   to  show  that 
z x	 =  zx z−1  in   C −∞ (R)  ∀ z  /
∈ −N0

d 
dx  +
+ 

=  {0, 1, . . . }. 
∈ −N. 
z+1

z
v)  Similarly  show  that  xx =  x+ 
for  all  z  /
∈ −N.  (Duh.)
+ 
z 
vi)  Show  that   x+  = 0  in  x < 0  for   all  z  /
Problem  49.  [Null  space  of  x dx  − z ] 
d
i)  Show  that  if  u  ∈  C −∞ (R)  then  ˜u(φ) =  u(φ˜),   where  φ˜(x) = 
if  u ∈ C 0 (R)?  Compute  δ�0 . 
φ(−
x)  ∀ φ ∈ C∞
c  (R),  deﬁnes   an  element   of  C −∞ (R).  What   is  ˜u
�
�x
˜u −=

d
d
ii)  Show   that

u.
dx 
dx 
−	 − 
∈ −N  and  show  that 
zx z−1
d	
z
z −
iii)  Deﬁne  x

for  z  /	
and

z 
dx  x−  = 
= 
+ 
−
x	
z+1 
z 
xx
 =
− 
.−
u  ∈ C −∞ (R)  satisﬁes   the  distributional  equation  
iv)  Suppose  that  
(x
 − z )u  = 
d
0  (meaning  of  course,  x  du 
zu  where  z  is   a 
= 
� �

� �

� �

� �

dx 
dx 
constant).  Show  that 
z
z 
=  c−x
−
− 
x<0 
x<0 
x>0 
x>0 
=  u−
c+x
+−
z 
for  some  constants  c± . Deduce  that  v 
− z )v  = 0  and  supp(v)  ⊂ {0}. 
d 
(17.6)	
(x
dx 
v)  Show   that  for  each  k ∈ N,  (x   d  +  k +  1)   dk  δ0  = 0.
vi)  Using  the  fact  that  any  v  ∈  C −∞ (R)  with  supp(v)  ⊂  {0}  is  
dxk 
dx 
a  ﬁnite  sum  of  constant   multiples   of  the  dk  δ0 ,  show  that,   for 
z  /∈ −N,   the  only  solution  of  (17.6)   is  v  = 0.

dxk 
�

�

vii)  Conclude  that  for  z  /
∈ −N 
u ∈ C −∞ (R);  (x 
= 0 

− z )u

z
c−x− 

satisﬁes


(17.7)	

u 

=  c+x 

and  u

d 
dx 

is  a  two­dimensional   vector   space. 

Problem  50.  [Negative  integral  order]  To  do  the  same  thing  for  negative 
integral  order  we  need  to   work  a  little  diﬀerently.  Fix  k ∈ N. 
i)  We   deﬁne  weak  convergence   of  distributions  by  saying  un  → u in  
cC∞
(X ), where  un , u ∈ C −∞ (X ), X ⊂ Rn  being  open,   if  un (φ)  →
u(φ)	 for  each  φ  ∈  C∞ (X ).   Show  that   un  →  u  implies  that  
c

for  each  j = 1, . . . , n  and  f un  → f u  if  f  ∈ C∞ (X ).  
→  ∂xj 
∂u 

∂un 
∂xj	

LECTURE  NOTES  FOR  18.155,   FALL  2004 
113 
ii)  Show  that  (z  +  k)x+  is   weakly  continuous   as  z  →  −k  in   the 
z
sense  that  for  any   sequence  zn  → −k ,   zn  /
∈ −N,  (zn
+  → vk
+k)x  zn 
where 

dk+1
· · · −k +  1  dxk+1  x+ ,  x+  =  x+ . 
1
1 
1 
vk  =  −1 
iii)  Compute  vk ,  including  the  constant   factor.

iv)  Do  the  same  thing  for  (z  +  k)x−  as  z  → −k .  
z

z 
z
v)  Show   that  there  is  a  linear   combination  (k  +  z )(x+  +  c(k)x− ) 
such that  as  z  → −k  the  limit  is   zero. 
z
z
vi)  If  you  get   this  far,  show   that  in   fact  x+  +  c(k)x also  has   a
−
weak  limit,   uk ,  as  z  → −k .   [This  may  be  the  hardest   part.]  
d
vii)  Show  that  this  limit  distribution   satisﬁes  (x dx  +  k)uk  = 0. 
viii)  Conclude  that  (17.7)   does  in  fact   hold  for  z  ∈  −N  as  well. 
[There  are  still   some   things  to  prove   to  get  this.] 
� 
Problem  51.  Show  that  for   any  set   G  ⊂ Rn 
∞
v ∗ (G)   =  inf 
v(Ai ) 
i=1 
where  the   inﬁmum   is  taken   over   coverings  of  G  by  rectangular   sets  
(products  of  intervals). 

Problem  52.  Show   that  a   σ ­algebra  is  closed  under   countable  intersec­
tions. 

Problem  53.  Show   that  compact   sets   are   Lebesgue  measurable  and 
have   ﬁnite  volume  and  also  show   the   inner   regularity  of  the  Lebesgue 
measure  on  open  sets,  that  is   if  E  is   open   then  
v(E )  =  sup{v(K );   K  ⊂ E ,  K  compact}. 
(17.8) 
Problem  54.  Show   that  a  set   B  ⊂  Rn  is   Lebesgue  measurable  if  and  
only  if 

�

)  ∀ open  E  ⊂ Rn  . 

v ∗ (E ) =  v ∗ (E  ∩ B ) +  v ∗ (E   ∩ B
[The  deﬁnition  is  this  for  all  E  ⊂ Rn  .] 
Problem  55.  Show   that  a  real­valued   continuous   function   f  :  U  − R→
on  an  open  set,  is  Lebesgue  measurable,  in  the  sense  that   f −1 (I )  ⊂
U  ⊂ Rn  is  measurable  for  each   interval   I . 
Problem  56.  Hilbert  space  and  the  Riesz  representation  theorem. 
If 
you  need  help  with  this,   it  can   be  found  in   lots  of  places   –  for  instance 
[6]  has  a  nice  treatment.  

114 

RICHARD  B.  MELROSE 
i)  A  pre­Hilbert  space  is  a  vector  space  V  (over   C) with  a  ‘positive 
deﬁnite  sesquilinear   inner   product’  i.e.  a  function 
V  × V  � (v , w) 
�→ �v , w� ∈ C


satisfying

�v , w�
•  �w, v� = 
a1v1  +  a2v2 , w� =  a1 �v1 , w� +  a2 �v2 , w�
•  �
•  �v , v� ≥ 0 
•  �v , v� =  ⇒
0 
v  =  0.
Prove  Schwarz’   inequality,  that  
|�u,  v�| ≤ �u�
 2 v� 2 ∀ u,  v  ∈ V . 
�
1 
1
Hint:  Reduce  to   the   case  �v , v� = 1  and  then  expand 
u  − �u,  v�v , u  − �u,  v�
�
v� ≥ 0. 
ii)  Show  that  �v�  =  �v , v�1/2  is   a  norm  and  that   it  satisﬁes   the 
parallelogram  law:  
v1  +  v2� +  �v1  − v2� = 2�v1�2  +  2�v2� ∀ v1 , v2  ∈ V . 
�
2
2 
2
(17.9) 
iii)  Conversely,  suppose  that   V  is   a  linear   space  over   C with  a  norm 
which  satisﬁes  (17.9).  Show   that  
− i�
v  − iw�2
v  − w� +  i�v  +  iw�2 
4�v , w� =  v  +  w�2 
�
− �
2
deﬁnes  a   pre­Hilbert  inner  product  which  gives   the  original 
norm.  
iv)  Let  V  be  a   Hilbert  space,  so  as  in   (i)  but  complete  as   well. 
Let  C  ⊂  V  be  a  closed  non­empty  convex  subset,  meaning 
v , w  ∈  C  ⇒  (v  +  w)/2  ∈  C.  Show  that  there  exists  a  unique  
v  ∈ C  minimizing   the  norm,   i.e.  such   that 
v� =  inf 
�
.w�
�
w∈C 
Hint:  Use  the  parallelogram  law   to  show  that   a  norm  mini­
mizing  sequence  is   Cauchy.  
→
C  be  a  continuous   linear  functional  on  a  Hilbert  
v)  Let  u  :  H 
|u(ϕ)| ≤  C �ϕ�  ∀  ϕ  ∈  H . 
Show  that   N  =  {ϕ  ∈
space,   so 
H ; u(ϕ)  = 0}  is  closed  and  that  if  v0  ∈ H  has  u(v0 )  =  0  then 
each  v  ∈ H  can  be  written  uniquely  in   the  form 
v  =  cv0  +  w,  c  ∈ C,  w  ∈ N .  
vi)  With  u  as  in  v),   not  the  zero  functional,  show  that   there  exists 
a  unique  f  ∈ H  with  u(f )  = 1  and  �w, f � = 0  for   all   w  ∈ N . 
Hint:  Apply  iv)  to  C  =  {g  ∈ V ; u(g)  = 1}. 

�
LECTURE  NOTES  FOR  18.155,   FALL  2004 

115 

vii)  Prove  the  Riesz   Representation  theorem,  that  every  continuous  
linear  functional  on  a  Hilbert  space  is  of   the  form 
uf  :  H  � ϕ 
�→ �ϕ,  f � for  a  unique  f  ∈ H.  
Problem  57.  Density  of   C∞ (Rn )  in   Lp (Rn ).
� 
c 
�N 
i)  Recall   in  a   few   words  why  simple  integrable  functions  are  dense 
Rn  |
f (x)|dx. 
in  L1 (Rn )  with  respect  to  the  norm  �f �L1  = 
ii)  Show  that  simple  functions  
j=1  cj χ(Uj ) where  the  Uj  are  open  
and  bounded  are  also  dense  in  L1 (Rn ).  
iii)  Show  that  if  U  is  open   and   bounded   then  F (y) =  v(U  ∩ Uy ),  
where  Uy  =  z  ∈ Rn ; z  =  y + y � , y �  ∈ U } is   continuous  in  y  ∈ Rn
{
and  that 
�  ∩ Uy ) → 0  as   y  → 0. 
v(U  ∩ Uy
�
) +  v(U
� 
iv)  If  U  is  open  and  bounded   and  ϕ  ∈ C∞ (Rn )  show  that  
c 
ϕ(x  − y)dy  ∈ Cc
∞ (Rn ).  
f (x) = 
� 
U 
v)  Show   that  if   U  is  open  and   bounded   then 
↓
χU (x) − χU (x   − y) dx 
|
| →
� 
sup 
0  as   δ 
0.
|y |≤δ 
vi)  If  U  is  open  and  bounded   and  ϕ  ∈  C∞ (Rn ),   ϕ  ≥  0, ϕ  = 1
c 
then

fδ  → χU  in   L1 (Rn )  as  δ 
0
↓
�  �  � 
�  � 
� 
χU (x   − y)dy . 
y
fδ (x) =  δ−n 
ϕ
δ 
Hint:  Write  χU (x) =  δ−n  ϕ 
y
δ  χU (x)  and  use  v).

vii)  Conclude  that  C∞ (Rn )  is   dense  in  L1 (Rn ). 

viii)  Show   that  C∞ (Rn )  is   dense  in  Lp (Rn )  for  any  1  ≤ p <  ∞.
c 
c 
Problem  58.  Schwartz   representation  theorem.  Here  we  (well  you)   come 
to   grips  with   the  general  structure  of  a  tempered  distribution. 
i)  Recall   brieﬂy  the  proof  of  the  Sobolev  embedding  theorem  and 
the  corresponding  estimate 
sup  φ(x)| ≤ C �φ�Hm  , 
|
x∈Rn 

< m  ∈ R. 

where  

n 
2 

ii)  For  m  =  n  +  1   write  down  a(n   equivalent)   norm  on   the  right   in 
a  form  that  does  not  involve  the  Fourier   transform. 

116 

RICHARD  B.  MELROSE 
� 
� 
� 
iii)  Show  that   for   any  α  ∈ N0 
|
|
|
|
(1  +  |x|2 )N Dβ φ .
Dα  (1  +  |x|2 )N φ  ≤ Cα,N 
β≤α 

iv)  Deduce  the  general  estimates  
sup (1   +  |x|2 )N Dαφ(x) ≤ CN �(1  +  x )N φ�H N +n+1  .
|
|
|
|
2
|α|≤N 
x∈Rn 
v)  Conclude  that  for  each  tempered  distribution  u  ∈ S � (Rn ) there 
is  an  integer  N  and  a  constant   C  such that 
|
u(φ) ≤ C �(1  +  x 2 )N φ�H 2N 
|
|
|
∀ φ  ∈ S (Rn

vi)  Show  that  v  = (1  +  |x|2 )−N u  ∈ S � (Rn )  satisﬁes

|
v(φ) ≤ C �(1  +  D 2 )N φ�
|
|
|
L2  ∀ φ  ∈ S (Rn
vi)  Recall   (from  class   or   just  show  it)  that  if  v  is   a  tempered   dis­
tribution  then  there  is   a  unique  w  ∈  S � (Rn )  such   that   (1  + 
|D 2 )N w  =  v .  
|
vii)  Use  the  Riesz  Representation   Theorem  to  conclude  that   for  each 
tempered  distribution  u  there  exists   N  and  w  ∈  L2 (Rn )  such 
that 

).

).

u  = (1  +  |D|2 )N (1  +  x 2 )N  w. 
|
|
(17.10) 
viii)  Use   the  Fourier  transform  on  S � (Rn )  (and  the  fact  that  it   is   an 
isomorphism  on  L2 (Rn ))   to  show   that  any  tempered   distribu­
tion  can  be  written  in  the  form 
u  = (1  +  |x|2 )N (1  +  |D 2 )N  w  for  some   N  and  some  w  ∈ L2 (Rn ).
|
ix)  Show  that  any  tempered  distribution  can  be  written   in  the  form 
u  =  (1+|x|2 )N (1+|D 2 )N +n+1  ˜
w  ∈ H 2(n+1) (Rn
|
w  for  some   N  and  some ˜
x)  Conclude  that  any  tempered  distribution   can   be  written  in   the 
form 
u  = (1  +  |x|2 )N (1  +  |D )M U  for  some  N , M 
|
2
and  a  bounded  continuous   function   U 
Problem  59.  Distributions  of  compact   support. 
� � 
� 
i)  Recall   the  deﬁnition   of  the  support  of  a  distribution,  deﬁned  in  
terms  of  its  complement 
Rn\supp(u) =  p  ∈ Rn ; ∃ U  ⊂ Rn  ,  open,  with   p  ∈ U  such that  u  = 
U 

).

� 
0 

LECTURE  NOTES  FOR  18.155,   FALL  2004 
ii)  Show  that  if  u  ∈ C −∞ (Rn )  and   φ  ∈ C∞ (Rn )  satisfy 
c 
supp(u) ∩ supp(φ) =  ∅ 

117 

= 

(17.11) 

then  u(φ) = 0. 
iii)  Consider  the  space  C∞ (Rn ) of  all  smooth  functions  on  Rn  ,  with­
out  restriction  on  supports.  Show  that  for   each  N 
�f �(N ) 
|Dαf (x)|

sup
|α|≤N ,  |x|≤N 
is  a  seminorn  on  C∞ (Rn )  (meaning  it  satisﬁes  �f � ≥ 0,  �cf � = 
c|�f �  for  c  ∈  C  and  the  triangle  inequality  but   that  �f � = 0
|
does  not  necessarily  imply  that  f  = 0.) 
iv)  Show  that  C∞
c  (Rn )  ⊂  C∞ (Rn ) 
is   dense  in  the  sense  that   for 
each  f  ∈  C∞ (Rn )  there  is   a  sequence  fn  in   C∞ (Rn )  such  that  
�f  − fn�(N )  →
c 
0  for   each   N .  
v)  Let  E � (Rn )  temporarily  (or   permanantly  if  you  prefer)   denote 
the  dual   space  of  C∞ (Rn )  (which   is   also  written   E (Rn )),  that  
v  ∈  E
:  C∞ (Rn )  − C  which  is  
→
� (Rn )  is  a  linear   map  v 
is,  
continuous  in   the  sense  that  for   some  N 
|
| ≤ C �f �(N )  ∀ f  ∈ C∞ (Rn
v(f )
).
Show   that  such  a   v  ‘is’  a  distribution  and  that  the  map   E � (Rn )  −
→ 
C −∞ (Rn )  is  injective.  
vi)  Show  that  if  v  ∈  E � (Rn )  satisﬁes  (17.11)   and   f  ∈  C∞ (Rn )  has 
f  = 0  in  |x| <  N  +  �  for  some   �  >  0  then   v(f ) = 0. 
vii)  Conclude  that   each  element  of  E � (Rn )  has   compact  support  
when  considered  as   an   element   of  C −∞ (Rn ).  
viii)  Show   the  converse,  that  each   element   of  C −∞ (Rn ) with  compact 
support  is  an  element  of  E � (Rn
)  ⊂ C −∞ (Rn
) and  hence  conclude 
that  E � (Rn )  ‘is’  the  space  of  distributions   of   compact   support. 
I  will  denote  the  space   of  distributions   of  compact  support  by  C −∞ (R).
c 
� 
Problem  60.  Hypoellipticity  of   the   heat  operator  H  =  iDt  +  Δ  = 
n
iDt  +  D2  on  Rn+1  .
xj

j=1

(1)  Using   τ  to  denote  the  ‘dual  variable’  to  t  and  ξ  ∈ Rn  to  denote 
the  dual  variables   to  x  ∈ Rn  observe  that   H  =  p(Dt , Dx )  where  
| |
p  =  iτ  +  ξ 2  . 
| |
| |
p(τ , ξ )| >  2  ( τ +  ξ 2 ) .
(2)  Show  that  |
1

118 

RICHARD  B.  MELROSE 

(17.12) 

(3)  Use  an  inductive  argument   to  show  that,  in  (τ , ξ )  =  0  where  it  
1  �  qk,α,j (ξ )
makes  sense,  
|
α|
DkDα 
= 
τ
ξ  p(τ , ξ ) 
p(τ , ξ )k+j+1 
j=1 
where  qk,α,j (ξ )  is  a  polynomial  of  degree   (at  most)   2j − α .
|
|
(4)  Conclude  that  if  φ  ∈  C∞ (Rn+1 )  is  identically  equal  to  1  in  a 
c 
neighbourhood  of  0  then  the  function  
1  − φ(τ , ξ ) 
iτ  +  |ξ |2 
is  the  Fourier  transform  of   a  distribution  F  ∈  S � (Rn )  with 
sing  supp(F )  ⊂ {0}.  [Remember   that  sing  supp(F )  is   the  com­
plement   of  the  largest  open   subset   of  Rn  the  restriction  of  F  to 
which  is  smooth]. 
(5)  Show  that  F  is  a  parametrix  for  the   heat   operator. 
(6)  Deduce  that  iDt  +  Δ  is   hypoel liptic  –  that  is,  if  U  ⊂ Rn  is   an 
open  set   and  u  ∈ C −∞ (U )  satisﬁes (iDt  +  Δ)u  ∈ C∞ (U )  then 
u ∈ C∞ (U ). 
(7)  Show   that  iDt  − Δ is   also  hypoelliptic. 

g(τ , ξ )  =

Problem  61.  Wavefront  set  computations  and   more  –  all  pretty  easy, 
especially  if  you  use   results  from  class. 
i)  Compute  WF(δ)  where  δ  ∈ S � (Rn )  is   the  Dirac  delta  function 
at  the  origin.  
ii)  Compute  WF(H (x))   where  H (x)  ∈ S � (R) is   the  Heaviside  func­
� 
tion 
1  x > 0 
0  x ≤ 0 

H (x) = 

. 

Hint:  Dx  is  elliptic  in   one  dimension,   hit  H  with  it. 
iii)  Compute  WF(E ),  E  =  iH (x1 )δ(x� )  which  is  the  Heaviside  in 
the  ﬁrst  variable  on  Rn ,  n > 1,  and  delta  in  the  others. 
iv)  Show  that  D E =  δ,  so  E  is   a  fundamental  solution   of  Dx1 .
x1
v)  If  f  ∈ C −∞ (Rn )  show  that   u =  E � f  solves   Dx1 u =  f .  
c 
vi)  What  does   our  estimate  on  WF(E � f )  tell  us   about   WF(u)   in  
terms  of  WF(f )? 

Problem  62.  The  wave  equation  in  two   variables  (or  one  spatial  vari­
able). 

�
E (t, x) = 

1 
4

119 

LECTURE  NOTES  FOR  18.155,  FALL  2004 
� 
i)  Recall   that  the  Riemann   function  
if  t > x  and  t > −x
−
otherwise 
0 
2  − D2 
is  a  fundamental   solution  of  Dt 
x  (check  my  constant). 
ii)  Find  the  singular   support  of  E . 
iii)  Write  the  Fourier  transform  (dual)  variables  as   τ , ξ  and  show  
that 
WF(E )  ⊂ {0} × S1  ∪ {(t, x, τ , ξ );   x =  t > 0  and  ξ +  τ  = 0} 
∪ {(t, x, τ , ξ );   −x =  t > 0  and  ξ =  τ } . 
iv)  Show  that  if  f  ∈ C −∞ (R2 ) then  u =  E � f  satisﬁes  (Dt 
2 −D2 
x )u = 
c 
f .

v)  With  u  deﬁned  as  in  iv)   show  that

supp(u) ⊂ {(t, x);  ∃ 
(t� , x� ) ∈ supp(f )  with  t�  +  x�  ≤ t +  x  and  t�  − x� 
vi)  Sketch  an  illustrative  example   of  v).

vii)  Show  that,   still  with  u  given  by  iv),

sing  supp(u)  ⊂ {(t, x);  ∃ (t� , x� )  ∈ sing  supp(f )  with 
t ≥ t�  and  t +  x =  t�  +  x�  or  t − x =  t�  − x� .}
viii)  Bound  WF(u)  in  terms  of  WF(f ).  
Problem  63.  A  little  uniqueness   theorems.  Suppose  u ∈ C −∞ (Rn ) recall 
that   the  Fourier  transform  ˆu  ∈  C∞ (Rn ).   Now,  suppose  u  ∈  C −∞ (Rn )
c 
c 
satisﬁes  P (D)u = 0   for  some  non­trivial  polynomial   P, show  that  u = 0. 
� 
� 
� 
Problem  64.  Work  out  the  elementary  behavior   of  the  heat  equation. 
i)  Show  that  the  function   on  R × Rn  ,  for  n ≥ 1, 
t− 2  exp  − |
|
2 
n 
x
t > 0 
4
t 
F (t, x) = 
t ≤ 0 
0 
is  measurable,   bounded  on  the  any  set  {|(t, x) ≥  R}  and  is 
|
integrable  on  {|(t, x) ≤ R} for  any  R > 0.
|
ii)  Conclude  that  F  deﬁnes  a  tempered  distibution   on  Rn+1  . 
iii)  Show  that   F  is  C∞  outside   the  origin.  
� 
iv)  Show  that   F  satisﬁes the  heat   equation  
n
(∂t  − 
∂ 2  )F (t, x)  = 0  in  (t, x) = 0.
xj
j=1 

≤ t − x}
.

�
120 

RICHARD  B.  MELROSE 

(17.13) 

) 

v)  Show  that  F  satisﬁes 
F (s  t,  sx) =  s−nF (t,  x)  in   S �
(Rn+1
2
where  the  left  hand   side  is  deﬁned  by  duality  “F (s2 t, sx) =  Fs ” 
where 
Fs (φ) =  s−n−2F (φ1/s ),   φ1/s (t, x) =  φ( 
� 
n
(∂t  − 
∂ 2  )F (t, x) =  G(t,  x)
xj
j=1 

vi)  Conclude  that  

t 
2  , 
s

x 
s 

).  

(17.14) 

where   G(t,  x)  satisﬁes  
G(s  t,   sx) =  s−n−2G(t,  x)  in   S �
(Rn+1
2
) 
in  the   same  sense  as  above  and  has   support   at  most  {0}. 
� 
vii)  Hence  deduce  that 
n
(∂t  − 
∂ 2  )F (t,  x) =  cδ(t)δ(x)
xj
j=1 

(17.15) 

for  some  real   constant   c. 
Hint:   Check  which   distributions  with  support  at  (0, 0)  satisfy 
(17.14). 
viii)  If  ψ  ∈ C∞
(Rn+1 )
show  that   u  =  F  � ψ  satisﬁes
c 
(17.16)  u  ∈ C∞ (Rn+1 )  and 
(1   +  |x|)N Dα u(t,  x)
|
| <  ∞ ∀ S 
sup 
x∈Rn ,  t∈[−S,S ] 
� 
ix)  Supposing   that  u  satisﬁes  (17.16)   and   is  a  real­valued  solution  
of 
n
(∂t  − 
∂ 2  )u(t, x)  = 0
xj
� 
j=1 
Rn 

>  0, α  ∈ Nn+1 ,  N . 

in  Rn+1  ,  show   that 

u 2 (t,  x) 

v(t) = 

is  a  non­increasing  function  of   t. 
Hint:   Multiply  the  equation  by  u  and  integrate  over   a  slab 
[t1 , t2 ] × Rn  . 

LECTURE  NOTES  FOR  18.155,  FALL  2004 

121 

x)  Show  that  c in  (17.15)   is   non­zero by arriving  at a  contradiction  
from  the  assumption   that   it  is  zero.  Namely,  show  that  if  c = 0 
then  u in  viii)  satisﬁes   the   conditions   of  ix)   and  also  vanishes 
in  t < T   for  some  T  (depending  on  ψ).   Conclude  that   u = 0 
for  all   ψ . Using   properties  of  convolution   show  that  this   in  turn 
implies  that   F = 0  which  is  a  contradiction. 
1
xi)  So,  ﬁnally,  we  know   that  E =  c  F  is   a  fundamental   solution  of 
the  heat  operator  which   vanishes   in   t  <  0.  Explain   why  this 
allows  us   to   show  that   for   any  ψ  ∈  C∞ (R × Rn )  there  is  a 
� 
c 
solution  of 
n
(∂t  − 
∂ 2  )u =  ψ ,   u = 0  in  t < T for  some   T .
xj

j=1


(17.17) 

c = 

)dx? 

What  is  the  largest   value  of   T for  which  this  holds? 
� 
xii)  Can  you  give  a  heuristic,  or  indeed  a  rigorous,  explanation   of 
why 
exp(− |
|
2x
4 
Rn 
xiii)  Explain  why  the   argument  we  used   for  the  wave  equation   to 
show  that   there  is   only  one  solution,  u ∈ C∞ (Rn+1 ), of  (17.17)  
does  not  apply  here.   (Indeed   such   uniqueness   does  not  hold  
without  some  growth  assumption  on   u.)  
Problem  65.  (Poisson  summation  formula)   As   in  class,  let  L ⊂ Rn  be 
� 
� 
� 
an  integral  lattice  of  the  form 
n
kj vj ,  kj  ∈ Z 
v = 
L = 
j=1 
·
where  the  vj  form  a  basis  of  Rn  and  using  the  dual  basis  wj  (so  wj vi  = 
� 
� 
� 
δij  is  0 or  1  as  i =  j or  i =  j )  set 
n
kj wj ,  kj  ∈ Z 
L◦  =  w = 2π
. 
j=1 

Recall  that  we  deﬁned 
);   u(z +  v) =  u(z )  ∀ z ∈ Rn  , v ∈ L}.
(17.18)  C∞ (TL ) = 
{u ∈ C∞ (Rn

� 
i)  Show  that  summation  over   shifts   by  lattice  points:

f (z − v
AL  :  S (Rn
) � f �−→
)  ∈ C∞ (TL ).  
v∈L 
deﬁnes  a  map  into  smooth   periodic  functions. 

ALf (z ) = 

(17.19) 

�
122 

RICHARD  B.  MELROSE 
ii)  Show  that  there  exists   f  ∈  C∞ (Rn )  such  that   ALf  ≡  1  is   the 
c 
costant  function  on  Rn  . 
iii)  Show   that  the  map  (17.19)  is   surjective.  Hint:  Well  obviously 
enough  use  the  f  in   part  ii)  and   show  that  if  u  is   periodic  then  
AL (uf   ) =  u. 
� 
iv)  Show  that   the  inﬁnite  sum 
δ(· − v)  ∈ S � (Rn ) 
v∈L 

F  = 

(17.20) 

does  indeed  deﬁne  a  tempered   distribution   and  that  F 
is   L­
periodic  and  satisﬁes   exp(iw   · z )F (z ) =  F (z )  for  each  w  ∈  L◦ 
with  equality  in  S � (Rn ).  
v)  Deduce  that  ˆF ,  the  Fourier  transform  of  F,  is   L◦  periodic,  con­
� 
clude  that  it  is   of  the  form 
w∈L◦ 

δ(ξ   − w) 

Fˆ (ξ ) =  c

(17.21) 

vi)  Compute  the  constant   c. 
vii)  Show  that  AL (f ) =  F  �  f . 
viii)  Using  this,   or  otherwise,  show  that   AL (f ) = 0  in  C∞ (TL )  if  and 
only   if  fˆ = 0   on  L◦ . 
Problem  66.  For  a  measurable  set  Ω  ⊂  Rn  ,  with  non­zero  measure,  
set  H  =  L2 (Ω)  and  let   B  =  B(H )  be  the  algebra  of  bounded  linear 
operators  on  the  Hilbert  space  H  with  the  norm  on  B  being 
�B �B  = sup{�B f �H ; f  ∈ H,   �f �H  = 1}. 
(17.22) 
i)  Show  that  B is  complete  with   respect  to  this  norm.  Hint  (prob­
ably   not  necessary!)  For   a  Cauchy  sequence  {Bn} observe  that  
Bnf  is  Cauchy  for   each  f  ∈ H.  
ii)  If  V  ⊂  H  is  a   ﬁnite­dimensional  subspace   and  W  ⊂  H  is   a 
closed  subspace  with   a  ﬁnite­dimensional  complement  (that   is 
W  + U  =  H  for  some  ﬁnite­dimensional  subspace   U )  show  that 
there  is  a  closed  subspace  Y  ⊂ W  with  ﬁnite­dimensional  com­
plement   (in  H )  such  that  V  ⊥ Y ,  that   is   �v ,  y� = 0  for  all  v  ∈ V 
and  y  ∈ Y . 
iii)  If  A  ∈  B  has  ﬁnite  rank  (meaning  AH  is   a  ﬁnite­dimensional 
vector  space)  show  that   there  is  a   ﬁnite­dimensional  space  V  ⊂
H  such that  AV   ⊂ V  and  AV  ⊥  =  {0} where 
V  ⊥  =  {f  ∈ H ; �f ,   v� = 0  ∀ v  ∈ V  }. 

LECTURE  NOTES  FOR  18.155,   FALL  2004 

123 

{f  ∈ H ; (Id +A)f  = 0} and 

Hint:   Set  R  =  AH,   a  ﬁnite  dimensional  subspace  by  hypothesis. 
Let  N  be  the  null   space  of  A,  show  that  N ⊥  is   ﬁnite  dimensional. 
Try  V  =  R +  N ⊥ . 
iv)  If  A  ∈ B has  ﬁnite  rank,   show  that   (Id −zA)−1  exists  for  all   but 
a  ﬁnite  set  of   λ  ∈  C  (just   quote  some  matrix  theory).  What 
might  it  mean  to   say  in   this  case  that   (Id   −zA)−1  is   meromor­
phic  in  z?  (No  marks   for   this   second  part). 
v)  Recall   that  K ⊂ B is   the  algebra  of   compact  operators,  deﬁned 
as  the  closure  of  the   space  of  ﬁnite   rank  operators.  Show  that  
K is  an  ideal  in  B . 
vi)  If  A  ∈ K show   that 
Id  +A  =  (Id  +B )(Id  +A� ) 
where   B  ∈  K,  (Id  +B )−1  exists  and   A�  has  ﬁnite  rank.  Hint: 
Use  the  invertibility  of   Id  +B  when  �B �B  <  1  proved  in   class. 
vii)  Conclude  that  if  A  ∈ K then 
� 
�
(Id   +A)H 
Problem  67.  [Separable  Hilbert  spaces] 
i)  (Gramm­Schmidt  Lemma).   Let  {vi}i∈N  be  a  sequence  in  a 
Hilbert  space  H.  Let  Vj  ⊂  H  be  the  span   of  the   ﬁrst  j  ele­
ments  and  set  Nj  =  dim  Vj .  Show  that   there  is  an  orthonormal 
sequence  e1 , .  .   .   , ej  (ﬁnite  if  Nj  is   bounded   above)   such  that   Vj 
is  the  span  of  the  ﬁrst  Nj  elements.   Hint:  Proceed  by  induction 
over  N  such  that  the  result  is  true  for  all   j  with  Nj  <  N .  So, 
consider  what  happens  for   a  value  of  j  with  Nj  =  Nj−1  + 1  and  
add  element  eNj  ∈  Vj  which  is  orthogonal  to  all   the  previous 
ek ’s. 
ii)  A  Hilbert   space  is  separable   if  it   has  a  countable  dense  subset  
(sometimes  people  say  Hilbert  space   when   they  mean   separable 
Hilbert  space).  Show   that  every  separable  Hilbert   space  has   a 
complete  orthonormal  sequence,  that  is  a  sequence  {ej }  such 
that  �u,  ej � = 0  for  all  j  implies  u  = 0. 
iii)  Let  {ej } an  orthonormal  sequence  in   a   Hilbert  space,  show   that 
for  any  aj  ∈ C,  
� 
� 
N
N
|aj |
aj ej �
2 
j=1 
j=1 

are  ﬁnite   dimensional.  

�

⊥ 

2

= 

.

124 

RICHARD  B.  MELROSE 
iv)  (Bessel’s  inequality)   Show   that  if  ej  is   an  orthormal  sequence 
in  a  Hilbert  space  and  u  ∈ H  then 
� 
N
�u,  ej �ej �
� 
≤ �u�
2
j=1 
� 
and  conclude  (assuming  the  sequence   of  ej ’s   to  be  inﬁnite)  that  
the  series 
∞
�u,  ej �ej 
j=1 

2

converges  in  H. 
v)  Show  that   if  ej  is  a  complete  orthonormal   basis  in   a  separable 
� 
Hilbert  space  then,  for  each   u  ∈ H,  
∞
�u,  ej �ej . 
j=1 

u  = 

Problem  68.  [Compactness]  Let’s   agree  that   a  compact   set   in   a  metric 
space  is  one  for  which  every  open  cover   has  a  ﬁnite  subcover.  You  may 
use  the  compactness  of  closed  bounded   sets  in  a  ﬁnite  dimensional 
vector  space. 
i)  Show  that  a   compact  subset  of   a  Hilbert   space  is  closed  and 
bounded. 
ii)  If  ej  is  a   complete  orthonormal  subspace  of  a  separable  Hilbert 
� 
space  and  K  is  compact   show  that  given  � >  0  there  exists   N 
such that 
|�u,  ej �|2  ≤ �  ∀  u  ∈ K. 
j≥N 

(17.23) 

iii)  Conversely  show   that  any  closed  bounded   set  in  a  separable 
Hilbert  space  for  which  (17.23) holds  for  some  orthonormal  basis  
is  indeed  compact. 
iv)  Show  directly  that   any  sequence   in   a  compact  set  in   a  Hilbert  
space  has  a   convergent  subsequence. 
v)  Show   that   a   subspace  of   H  which  has  a  precompact   unit   ball 
must  be  ﬁnite  dimensional. 
vi)  Use  the  existence  of  a  complete  orthonormal  basis  to  show   that 
any   bounded  sequence  {uj },  �uj �  ≤  C,  has  a  weakly  conver­
gent  subsequence,  meaning  that   �v , uj �  converges   in  C  along 
the  subsequence  for   each   v  ∈ H.   Show  that   the  subsequnce  can 
be   chosen  so   that  �ek , uj �  converges   for   each  k ,   where  ek  is   the 
complete  orthonormal  sequence.  

LECTURE  NOTES  FOR  18.155,   FALL  2004 

125 

Problem  69.  [Spectral  theorem,  compact  case]  Recall  that  a  bounded 
operator  A  on  a   Hilbert  space  H  is   compact   if  A{�u�  ≤  1}  is   pre­
compact  (has  compact  closure).  Throughout   this  problem  A  will  be  a 
compact  operator  on  a   separable  Hilbert   space,  H.  
i)  Show  that  if  0  =  λ  ∈ C  then 
Eλ  =  {u  ∈ H ; Au  =  λu}. 
is  ﬁnite  dimensional. 
ii)  If  A  is  self­adjoint  show  that   all  eigenvalues   (meaning  Eλ  =  {0}) 
are  real  and  that  diﬀerent  eigenspaces  are  orthogonal. 
iii)  Show  that  αA  =  sup{|�Au,  u�|2}; �u�  = 1}  is   attained.  Hint: 
Choose   a  sequence  such   that  |�Auj ,  uj �|2  tends   to  the  supre­
mum,   pass  to  a   weakly  convergent   sequence  as  discussed  above 
and  then  using   the   compactness  to  a  furhter   subsequence  such  
that  Auj  converges. 
iv)  If  v  is  such  a   maximum  point   and   f  ⊥  v  show  that  �Av ,  f � + 
�Af ,  v� = 0.  
v)  If  A  is  also  self­adjoint  and  u  is   a  maximum  point  as  in   iii) 
deduce  that  Au  =  λu  for  some   λ  ∈ R  and  that  λ  =  ±α. 
vi)  Still   assuming   A  to  be   self­adjoint,  deduce  that  there  is   a  ﬁnite­
dimensional  subspace  M  ⊂  H,   the  sum  of   eigenspaces  with 
eigenvalues  ±α,  containing  all  the  maximum  points. 
vii)  Continuing   vi)  show  that  A  restricts   to  a  self­adjoint   bounded  
operator   on  the  Hilbert  space   M ⊥  and  that   the  supremum  in  
iii)  for  this  new  operator   is  smaller. 
viii)  Deduce  that  for  any  compact   self­adjoint  operator   on  a  sep­
arable  Hilbert  space  there   is   a  complete  orthonormal  basis  of 
eigenvectors.   Hint:  Be  careful  about   the  null  space  –  it  could 
be  big. 
� 
Problem  70.  Show   that  a  (complex­valued)   square­integrable  function 
u  ∈ L2 (Rn )  is  continuous  in   the  mean,  in  the   sense  that 
u(x  +  y) − u(x) 2dx  = 0. 
|
|

lim  sup 
�↓0  |y |<� 
Hint:  Show  that  it   is  enough  to   prove  this   for  non­negative  functions  
and  then  that  it  suﬃces  to  prove  it  for   non­negative  simple  functions 
and  ﬁnally   that  it  is  enough  to  check  it  for  the  characteristic  function  
of  an  open  set   of   ﬁnite  measure.  Then  use  Problem  57  to  show  that  it 
is  true  in  this  case.  

(17.24)	

Problem  71.  [Ascoli­Arzela]  Recall  the  proof  of  the  theorem  of  Ascoli 
and  Arzela,  that  a   subset  of  C0 (Rn )  is  precompact   (with  respect  to  the 
0

�
�
126	

RICHARD  B.  MELROSE 

(17.26) 

supremum  norm)  if  and  only  if  it  is  equicontinuous  and  equi­small  at  
inﬁnity,  i.e.   given  � > 0  there  exists   δ > 0  such   that  for   all   elements 
u ∈ B 
(17.25) 
y < δ = ⇒  sup  u(x +  y) =  u(x) < � and  x > 1/δ = 
| | 
|	
| 
|
|
⇒ |
u(x)| < �.
x∈Rn 
Problem  72.  [Compactness  of  sets  in   L2 (Rn ).]  Show   that  a  subset  B ⊂
L2 (Rn )  is  precompact  in  L2 (Rn )  if  and   only  if  it   satisﬁes  the  following 
two   conditions: 
� 
i)  (Equi­continuity  in  the  mean)   For  each   � > 0  there  exists  δ > 0 
such that 
Rn 

u(x +  y) − u(x) 2dx < � ∀  y < δ,  u ∈ B . 
|	
|
| | 
� 
ii)  (Equi­smallness  at   inﬁnity)  For  each  � > 0  there  exists   R such 
that 
u 2dx < � ∀  u ∈ B .
|
|
(17.27)	
x >R|
|
|
Hint:  Problem  70   shows  that  (17.26)   holds  for  each  u ∈ L2 (Rn );   check 
that  (17.27) also   holds  for  each   function. Then   use  a  covering  argument  
to  prove  that  both  these   conditions   must   hold  for   a  compact   subset   of 
L2 (R)  and  hence  for  a  precompact  set.  One  method  to  prove  the  con­
verse  is  to   show  that  if  (17.26)   and   (17.27)   hold  then   B is   bounded 
and  to   use  this  to   extract  a  weakly  convergent   sequence  from  any  given 
sequence  in  B . Next  show  that   (17.26)  is  equivalent   to  (17.27)  for  the 
set  F (B ), the  image  of  B under   the  Fourier   transform.  Show,  possi­
bly  using  Problem  71,   that  if   χR  is   cut­oﬀ   to  a  ball  of  radius  R then 
χRG (χR ˆn )  converges  strongly  if  un  converges   weakly.  Deduce   from 
u
this  that  the  weakly  convergent  subsequence  in   fact   converges   strongly 
¯
so   B is  sequently  compact,  and  hence   is  compact. 
Problem  73.  Consider the  space  Cc (Rn )  of  all   continuous   functions   on 
Rn  with  compact  support.   Thus  each   element   vanishes  in  |x| > R for 
some   R, depending  on  the  function.  We  want   to  give  this  a  toplogy  in  
terms  of  which  is  complete.  We  will   use  the  inductive  limit  topology. 

 
Thus  the  whole  space  can   be  written   as  a  countable  union 
(17.28)	
{u :  Rn ; u is   continuous   and  u(x)  = 0  for  x > R}.
Cc (Rn ) = 
|
|
n 

Each  of  the  space  on  the  right  is  a  Banach   space  for   the  supremum 
norm.  

LECTURE  NOTES  FOR  18.155,  FALL  2004 

127 

(1)  Show   that  the  supreumum  norm  is   not   complete  on  the  whole 
of  this  space.  
(2)  Deﬁne  a  subset  U  ⊂  C c (Rn )  to  be  open  if  its   intersection   with  
each  of  the  subspaces  on  the  right  in   (17.28)  is  open   w.r.t.  the 
supremum  norm. 
(3)  Show  that  this  deﬁnition   does  yield  a  topology. 
(4)  Show  that  any  sequence  { fn} which  is   ‘Cauchy’  in   the   sense  that 
for  any  open  neighbourhood  U of  0  there  exists  N such  that   fn−
fm  ∈  U  for  all  n, m  ≥  N ,   is   convergent   (in   the  corresponding 
sense  that  there  exists   f  in   the   space  such   that  f  − fn 
U∈
eventually). 
(5)  If  you  are  determined,  discuss  the  corresponding  issue  for  nets. 
Problem  74.  Show   that  the  continuity  of  a  linear   functional  u :  C ∞
c  (Rn ) −→ 
C with  respect  to   the   inductive  limit   topology  deﬁned  in   (6.16)  means 
precisely  that   for  each  n  ∈  N  there  exists  k  =  k(n)  and  C  =  Cn  such 
that 

(17.29) 

| u(ϕ)| ≤ C � ϕ� C k ,  ∀  ϕ ∈  ˙
C ∞ (B (n)).
The  point  of  course  is  that  the  ‘order’  k  and  the  constnat  C  can both  
increase  as  n,  measuring   the  size  of  the  support,   increases. 

Problem  75.  [Restriction  from  Sobolev  spaces] The  Sobolev  embedding  
theorem  shows  that  a  function   in   H m (Rn ),   for  m > n/2  is  continuous  
–  and  hence  can  be  restricted  to  a   subspace  of  Rn  .  In  fact   this   works  
more   generally.   Show  that  there  is  a  well  deﬁned   restriction   map 
(Rn )  −→ H m− 1 
1 
2 (Rn
2 

)  if  m > 

(17.30) 

H m

with  the   following   properties: 
(1) On  S (Rn )  it  is  given   by  u �−→ u(0, x� ),   x�  ∈ Rn−1  . 
(2)  It  is  continuous  and   linear.  
Hint:  Use  the  usual   method  of  ﬁnding  a  weak  version  of   the  map   on 
� 
smooth  Schwartz  functions;   namely  show  that  in  terms   of  the  Fourier 
transforms  on  Rn  and  Rn−1 
�
u(0, · )(ξ � ) = (2π)−1 
R 
Use  Cauchy’s  inequality  to  show  that  this  is  continuous   as  a  map   on  
Sobolev  spaces  as  indicated  and  then   the  density  of  S (Rn )  in   H m (Rn ) 
to  conclude  that  the   map  is   well­deﬁned   and   unique. 

u(ξ1 , ξ � )dξ1 ,  ∀  ξ �  ∈ Rn−1  . 
ˆ

(17.31) 

Problem  76.  [Restriction  by  WF]   From  class  we  know  that  the  product 
of  two  distributions,  one  with  compact   support,  is  deﬁned  provided 

128 

RICHARD  B.  MELROSE  

they  have  no   ‘opposite’   directions   in   their   wavefront   set: 
(x,   ω)  ∈ WF(u) = ⇒ (x,  −ω)  /∈ WF(v)  then   uv  ∈ C −∞ (Rn ).
c 

(17.32) 

Show  that  this  product  has   the   property  that  f (uv)  = (f u)v  =  u(f v) 
if  f  ∈  C∞ (Rn ). 
Use  this  to  deﬁne  a  restriction  map   to  x1  =  0  for 
distributions  of  compact  support  satisfying  ((0,  x� ),   (ω1 ,  0))   /∈  WF(u) 
as  the  product  

(17.33) 
u0  =  uδ(x1 ).  
[Show  that   u0 (f ),  f  ∈ C∞ (Rn )  only  depends   on  f (0,  ·)  ∈ C∞ (Rn−1 ).  

Problem  77.  [Stone’s  theorem]   For  a  bounded  self­adjoint  operator  A 
show   that  the  spectral   measure   can  be  obtained  from  the  resolvent  in  
the  sense  that  for  φ,   ψ   ∈ H 
�[(A  − t  − i�)−1  − (A   +  t  +  i�)−1 ]φ,  ψ� −→ µφ,ψ
1 
2π i

(17.34) 

lim
� 0↓

in  the  sense  of  distributions   –  or  measures   if  you   are  prepared  to  work 
harder! 

If  u  ∈  S (Rn
Problem  78. 
Lemma  12.5,   such  that 

)  and   ψ �  =  ψR  +  µ  is,  as  in   the  proof  of 

supp(ψ � ) ∩ Css(u) =  ∅ 

show   that 

�−→
) � φ 
φψ �u  ∈ S (Rn )
S (Rn
is  continuous  and   hence   (or  otherwise)   show  that   the  functional  u1u2 
deﬁned  by  (12.20)  is  an  element   of  S � (Rn ).  

Problem  79.  Under  the  conditions  of  Lemma  12.10  show   that  
(17.35)

|
|
| |
,  x =  y = 1,  x   ∈ Css(u),  y  ∈ Css(v),   0  ≤ s,  t  ≤ 1}.

⊂ { |sx  +  ty
Css(u∗v)∩Sn−1 
sx  +  ty
| 
Notice  that  this  make   sense   exactly  because  sx  +  ty  = 0  implies   that 
t/s  = 1   but  x  +  y  = 0   under  these  conditions by  the  assumption   of 
Lemma   12.10. 
Problem  80.  Show   that  the  pairing  u(v)  of  two  distributions  u,  v  ∈
bS � (Rn )  may  be   deﬁned  under  the  hypothesis  (12.50). 

�
LECTURE  NOTES  FOR  18.155,   FALL  2004 

129 

Problem  81.  Show  that  under   the  hypothesis  (12.51) 

(17.37) 

(17.36) 
WFsc (u∗v)  ⊂ {(x+y , p);   (x,  p) ∈ WFsc (u)∩(Rn ×Sn−1 ),   (y , p)  ∈ WFsc (v)∩(Rn ×Sn−1 )} 
s�θ �  +  s��θ �� 
,  0  ≤ s� , s��  ≤ 1, 
∪ {(θ , q) ∈ Sn−1  × Bn ; θ  =  |s�θ �  +  s��θ �� | 
(θ � , q) ∈ WFsc (u) ∩ (Sn−1  × Bn ),   (θ �� , q) ∈ WFsc  (v) ∩ (Sn−1  × Bn )}. 
Problem  82.  Formulate  and   prove  a  bound  similar   to  (17.36)  for  WFsc (uv) 
when  u,  v  ∈ S � (Rn )  satisfy  (12.50).  
Problem  83.  Show  that  for   convolution  u  ∗ v  deﬁned   under  condition  
(12.51)  it  is  still   true  that  
P (D)(u  ∗ v)  = (P (D)u) ∗ v  =  u  ∗ (P (D)v).  
Problem  84.  Using   Problem  80  (or  otherwise)  show  that  integration  is 
deﬁned  as  a   functional 
� 
�
{u  ∈ S � (Rn );  (Sn−1  × {0}) ∩ WFsc (u) = 
∅} −→ C. 
If  u  satisﬁes  this  condition,  show  that   P (D)u   =  c u   where  c  is   the 
constant   term  in  P (D),  i.e.  P (D)1  =  c. 
Problem  85.  Compute  WFsc (E )  where  E  =  C/ x  − y is   the  standard  
|
|
� 
fundamental   solution  for   the  Laplacian  on  R3  .  Using  Problem  83  give 
a  condition  on  WFsc (f )  under  which   u  =  E  ∗ f  is   deﬁned  and  satisﬁes 
� 
Δu  =  f .  Show  that  under   this  condition 
f  is   deﬁned  using  Prob­
lem   84.  What  can  you   say  about  WFsc (u)?  Why  is   it  not   the   case  that 
Δu  = 0,  even  though  this  is   true  if  u  has  compact  support? 

(17.38) 

130 

RICHARD  B.  MELROSE 

18.  Solutions  to  (some  of)   the  problems 

�x�1 

= 

Solution	 18.1  (To   Problem  10).  (by  Matjaˇz  Konvalinka). 
Since  the  topology  on  N,  inherited   from  R,  is   discrete,  a  set   is  com­
pact  if  and  only   if   it  is  ﬁnite.  If   a  sequence  {xn} (i.e.  a  function  N
C)→
is  in  C0 (N)  if  and  only  if  for  any  � >  0  there  exists  a  compact   (hence 
ﬁnite)  set  F�  so  that  |xn | <  �  for  any  n  not   in   F� .  We  can   assume  that  
F�  =  {1, .  .  .  , n�},  which  gives  us  the  condition   that  {xn}  is   in  C0 (N) 
if  and  only  if  it   converges  to  0.  We  denote  this  space  by  c0 ,  and  the  
supremum  norm  by   � · �0 .  A  sequence  {xn}  will  be  abbreviated  to  x. 
� 
Let  l1  denote  the  space  of  (real  or  complex)   sequences  x  with  a  ﬁnite 
1­norm 
∞
xn |.
|
n=1 
We  can  deﬁne  pointwise  summation   and   multiplication   with   scalars, 
and  (l1  , � · �1 )  is  a   normed   (in  fact  Banach)   space.  Because  the  func­
� 
tional 
∞
�→ 
�
�
xnyn
n=1 
| 
xnyn | ≤ ∞
|xn ||yn |
∞
is  linear   and  bounded  (

�x�0 ,  the  mapping 
=1n
=1n
�−→ c∗ 
�
�

Φ :   l1 
� 
0 
∞
�→  y 
xnyn
n=1 
is  a  (linear)  well­deﬁned  mapping  with  norm  at   most  1.  In  fact,  Φ  is 
an  isometry  because  if  |xj |  =  �x�0  then  Φ(x)(ej )|  =  1  where  ej  is
|
�
�	
the  j ­th  unit   vector.  We  claim  that   Φ  is  also  surjective  (and  hence  an 
�
isometric  isomorphism).  If  ϕ  is   a  functional  on  c0  let   us  denote  ϕ(ej ) 
∞
∞
by  xj .  Then  Φ(x)(y) 
ϕ(en )yn 
= 
= 
ϕ(ynen ) =  ϕ(y)  (the 
∞
=1n
=1n
last  equality  holds  because  
converges   to  y  in   c0  and  ϕ  is  
y en n
=1n
continuous  with  respect  to  the  topology  in  c0 ),   so  Φ(x) =  ϕ. 
�

Solution  18.2  (To   Problem  29).  (Matjaˇz  Konvalinka)   Since 
∞ 
� 
DxH (ϕ) =  H (−Dxϕ) =  i
H (x)ϕ
−∞
∞ 
0 

(x) dx  =  i(0  − ϕ(0))   =  −iδ(ϕ),


≤  �x�0  �y�1 ) by 

deﬁned  by	

�

(x) dx
 =

x 

�→ 

y 

i
we  get  DxH  =  C δ  for  C  =  −i. 

�

ϕ

LECTURE  NOTES  FOR  18.155,  FALL  2004 

131 

Solution  18.3  (To  Problem  40).  (Matjaˇz  Konvalinka)   Let   us  prove  this  
in  the  case  where  n  = 1.   Deﬁne  (for  b  = 0) 
U (x) =  u(b) − u(x) − (b − x)u� (x) − .  .  .  − 

(k−1) (x);

u

(b − x)k−1 
(k  − 1)! 

then 

(b − x)k−1 
−
U � (x)   =
u(k) (x).
(k  − 1)! 
For  the  continuously  diﬀerentiable   function   V (x) =  U (x)−(1−x/b)kU (0)  
we  have  V (0)  =  V (b)  =  0,  so  by  Rolle’s  theorem   there  exists  ζ  between 
0  and  b  with 

V � (ζ ) =  U � (ζ ) + 

Then 

k(b − ζ )k−1 
bk 

U (0)   = 0 

bk  . 

x k−1  + 

k 
x ,

2 
x  +  .  .  .  + 

u(k) (0)  
k ! 

u(k) (ζ ) 
k ! 

U (0) =  −

p(x) =  u(0) +  u� (0)x  + 

bk 
k(b − ζ )k−1  U � (ζ ),  
u(k−1) (0)  
bk−1  + 
u(b) =  u(0) +  u� (0)b +  .  .  .  + 
(k  − 1)! 
The  required  decomposition  is   u(x) =  p(x) +  v(x)  for 
u(k−1) (0)  
u�� (0)  
(k  − 1)! 
2
u(k) (ζ ) − u(k) (0)  
v(x) =  u(x) − p(x) = 
k 
x 
k ! 
for  ζ  between  0  and  x,  and   since  u(k)  is   continuous,  (u(x) − p(x))/xk 
tends  to   0   as  x  tends  to  0. 
The  proof   for   general  n  is   not   much  more  diﬃcult.  Deﬁne   the  func­
→
R  by  wx (t) =  u(tx).  Then   wx  is   k ­times  continuously 
tion  wx  :  I 
n�  ∂u 
diﬀerentiable,  
w �
x (t) = 
n�  ∂ 2u 
∂xi
i=1 
∂xi∂xj
i,j=1 

(tx)xixj ,

(tx)xi ,

w ��
x (t) = 
� 
l1+l2+...+li=l 

w(l) (t) = 
x 

l! 
· · ·
l1 !l2 !

lu 
∂
2  · · ·
l2 
li ! ∂x l1 
1  ∂x

li 
∂x i

l2  · · · x li 
(tx)x l
1 x2 
1 
i 

�
132 

RICHARD  B.  MELROSE  

=

so  by  above  u(x) =  wx (1)   is  the  sum  of  some  polynomial   p  (od  degree 
k),  and  we  have 
wx  (ζx ) − wx  (0)  
u(x) − p(x) 
(k)
(k)
vx (1)  
k !|x|k
|
|k 
|
|k 
�� � � 
�� � � 
x
x
so  it  is  bounded  by  a  positive  combination  of   terms   of  the  form 
∂ lu

∂ lu
(ζxx) − 
(0)  
2  · · ·
2  · · ·
li 
li 
1  ∂x l2 
1  ∂x l2 
∂x l1

∂x l1 
∂x i
∂x i
with  l1  +  .  .  .   +  li  =  k  and  0  <  ζx  <  1.  This   tends   to  zero  as  x  →
because  the  derivative  is  continuous. 

= 

0 

,

f (x) = 

Solution  18.4  (Solution  to  Problem  41).  (Matjˇz  Konvalinka) Obviously 
the  map  C0 (Bn ) → C (Bn ) is  injective  (since  it   is  just   the  inclusion   map), 
and  f  ∈  C (Bn )  is  in  C0 (Bn )  if  and  only  if  it   is  zero  on   ∂Bn  ,  ie.  if  and 
only  if  f |Sn−1  = 0.  It  remains  to  prove  that  any  map   g  on  Sn−1  is   the 
� 
restriction  of  a  continuous  function   on  Bn  .  This  is   clear   since 
x g(x/|x|)  x  = 0 
|
|
0 
x  = 0 
is  well­deﬁned,   coincides  with   f  on  Sn−1 ,  and   is   continuous: 
if  M  is  
the  maximum  of   |g |  on  Sn−1 ,  and   �  >  0  is   given,  then   f (x) <  �   for
|
|
|
| 
x <  �/M .  
�

� 
�

Solution  18.5.  (partly  Matjaˇz  Konvalinka)  
For  any  ϕ  ∈ S (R) 
we  have

∞ 
∞ 
ϕ(x) dx  ≤ sup((1+x
|
x|
|
| 
|
|
ϕ(x)dx| ≤ 
|
|
2 )−1dx
2
(1+
) ϕ(x) ) 
−∞ 
−∞ 
−∞ 
�

≤ C  sup((1  +  x ) ϕ(x) ). 

|
|
|
� 
2
�−→  R ϕdx  is   continous. 
Thus  S (R)  � ϕ 
Now,   choose  φ  ∈  C∞ (R)  with  R φ(x)dx  = 1.  Then,  for   ψ  ∈  S (R),
� 
� 
c 
set 
∞ 
x 
(ψ(t) − c(ψ)φ(t))  dt,  c(ψ) = 
� 
−∞ 
−∞ 
Note  that   the  assumption  on  φ  means  that  
∞ 
− 
(ψ(t) − c(ψ)φ(t))   dt
x 
Clearly  Aψ   is  smooth,  and  in  fact   it  is   a  Schwartz  function  since 
(Aψ(x))   =  ψ(x) − cφ(x)  ∈ S (R)
d 
dx 

Aψ(x) = 

Aψ(x) = 

ψ(s) ds.  

(18.1) 

∞

(18.2) 

(18.3) 

�
LECTURE   NOTES  FOR  18.155,  FALL  2004 
133 
so  it  suﬃces   to  show  that  xkAψ  is   bounded  for  any  k  as  |x| → ±∞. 
� 
Since  ψ(t) − cφ(t)  ≤ Ck t−k−1  in   t  ≥ 1  it  follows   from  (18.2)   that  
∞ 
x kAψ(x) ≤ C x k 
|
|
t−k−1dt  ≤ C � ,  k >  1,  in   x  >  1.
x 
A  similar  estimate  as  x  → −∞ follows   from  (18.1).  Now,  A  is   clearly 
� 
linear,  and  it   follows  from  the   estimates  above,  including  that  on  the 
integral,  that   for   any  k  there  exists   C  and  j  such that 
sup  x αDβ Aψ | ≤ C 
|
ψ |. 
|
sup  x α� 
Dβ � 
x∈R 
α,β≤k 
α� ,β �≤j
−
Finally  then,  given  u  ∈  S � (R)  deﬁne  v(ψ) = 
u(Aψ).   From  the
continuity  of  A,   v  ∈  S (R)  and  from  the  deﬁnition   of  A,  A(ψ � ) =  ψ . 
Thus 
dv/dx(ψ) =  v(−ψ � ) =  u(Aψ � ) =  u(ψ) = 
⇒
dv 
�
=  u.
dx 
� 
Solution  18.6.  We  have   to  prove  that  �ξ �m+m� u  ∈  L2 (Rn ),   in  other  
�ξ �2(m+m� ) � 2  dξ  <  ∞.
words,  that 
|
|
u
� 
� 
Rn 
� 2  dξ  = 
�ξ �2(m+m� ) |�|2  dξ  = 
But  that  is  true  since 
n )m |u|
�ξ �2m� 
⎛
⎞ 
2  +  .  .  .  +  ξ 2 
�� 
(1  +  ξ1
u
� 
� 
� 
Rn 
Rn 
Cαξ 2α⎠ |�|2  dξ  = 
�ξ �2m�  ⎝ 
|�|2  dξ
�ξ �2m� 
ξ 2α u
= 
u
�
and  since  �ξ �m� ξ α �
Rn 
Rn 
|α|≤m 
|α|≤m 
u  =  ξ �m� Dαu  is   in  L2 (Rn )  (note  that  u  ∈ H m (Rn ) 
�
� (Rn ),   α ≤ m).  The  converse  is  also  true  since 
|
follows  from  Dαu  ∈ H m
|
Cα  in  the  formula  above  are  strictly  positive. 
Solution  18.7.  Take  v  ∈ L2 (Rn ),   and   deﬁne  subsets  of  Rn  by 
E0  =  {x :  x
|
| ≤ 1}
,
� 
{ � 
|xj |}
Ei  =  x :  |x| ≥ 1, xi =  max 
|
|
.
j 
n  χEj  a.e.,  and  v  = 
n
√
vj  for  vj  = 
Then  obviously   we  have   1  = 
j=0 
i=0 
χEj v .  Then  �x� is  bounded  by 
2  on   E0 ,  and  �x�v0  ∈ L2 (Rn );   and   on  
Ej ,  1  ≤ j  ≤ n,   we  have 
�1/2  ≤ (2n)1/2  , 
=  � 
x� 
�
(1  +  n|xj |2 )1/2 
xj | ≤
n  +  1/|xj
|xj |
|

� 

Cα 

|
2

�  x�vj 
134 
RICHARD  B.  MELROSE 
=  xj wj  for  wj  ∈ L2 (Rn ).   But   that  means   that   �x�v  =  w0  +
so  �
If  u  is  in  L2 (Rn )  then  �u  ∈ L2 (Rn ),   and  so  there  exist  w0 , . . . , wn  ∈
n  xj wj  for  wj  ∈ L2 (Rn ).
j=1 
� 
L2 (Rn )  so   that 
u� =  w0  + 
n
�
ξ �
ξj wj ,
� 
j=1 
ξj �
� =  �
in  other  words 
n
u0  + 
u
uj 
�
j=1 
� 
where  �ξ �uj  ∈ L2 (Rn ).  Hence 
n
Dj uj 
j=1 

u =  u0  + 
where  uj  ∈ H 1 (Rn ). 
� 
� 
Solution  18.8.  Since 
∞
∞ 
DxH (ϕ) =  H (−Dxϕ) =  i
ϕ� (x) dx  =  i(0−ϕ(0))   = 
H (x)ϕ� (x) dx  =  i
−∞ 
0
i.−
Solution  18.9.  It  is  equivalent   to  ask  when  �ξ �mδ�0  is   in  L2 (Rn ).   Since 
we   get  DxH  =  C δ  for  C = 
�

δ�0 (ψ) =  δ0 (ψ�) =  ψ�(0)   = 
ψ(x) dx  = 1(ψ), 

Rn 
this  is  equivalent  to  ﬁnding  m such  that  �
ξ �
2m  has  a  ﬁnite  integral  over  
Rn  .  One  option  is  to   write   �ξ � =  (1  +  r2 )1/2  in   spherical  coordinates, 
and  to   recall   that   the  Jacobian  of   spherical  coordinates   in  n dimensions  
�  ∞ 
has  the   form  rn−1Ψ(ϕ1 , . . . , ϕn−1 ),   and  so  �ξ �2m  is   integrable  if  and  only 
if 
rn−1 
dr 
(1  +  r2 )m 
0 
converges.  It  is  obvious  that   this   is  true  if  and  only  if  n − 1 − 2m < −1, 
ie.   if  and  only   if  m > n/2. 
Solution  18.10   (Solution  to  Problem31).  We  know  that   δ  ∈ H m (Rn ) 
for  any  m < −n/1.  Thus  is   just  because  �ξ �p  ∈ L2 (Rn ) when   p < −n/2. 
Now,   divide  Rn  into   n + 1  regions,  as   above,  being  A0  =  ξ ; ξ ≤ 1 and 
{ | |
ξ ; ξi =  supj  |ξj , ξ
{
|
|
|
| | ≥ 1}
Ai  = 
.  Let  v0  have  Fourier  transform  χA0
> c�ξ � on  the  support   of  v�i  for  each  i = 1, . . . , n,  each  term 
1, . . . , n,   vi  ∈ S ; (Rn )  have  Fourier   transforms  ξ−n−1χAi .
and  for  i
=
|ξi |
i 
Since 

−
iδ(ϕ),

135 

(18.4) 

1  =  vˆ0 

vi .

δ =  v0  + 

LECTURE  NOTES  FOR  18.155,   FALL  2004 
is  in  H m  for  any  m < 1  +  n/2  so,  by the  Sobolev  embedding  theorem, 
� 
� 
each  vi  ∈ C0 (Rn )  and 
0 
v�i  = 
n
⇒
n+1 
n+1
Di
ξi
i 
i=1  
How  to  see  that  this  cannot   be   done   with  n or  less  derivatives?  For  
� 
the  moment  I  do  not   have  a  proof  of  this,  although  I   believe  it  is   true. 
Notice  that  we  are  actually  proving  that  δ can  be  written 
α  ∈ H n/2
(Rn ).  
Dα uα , u
|α|≤n+1 
This  cannot  be  improved  to  n from  n +  1  since  this   would   mean   that 
δ ∈  H −n/2 (Rn ), which  it  isn’t.  However,  what  I  am  asking  is  a  little 
more  subtle  than   this. 

(18.5) 

δ = 

136 

RICHARD  B.  MELROSE 

References 

[1]  G.B.  Folland,  Real  analysis,  Wiley,  1984. 
[2]  F.  G.  Friedlander,   Introduction   to  the  theory  of  distributions,  second  ed.,  Cam­
bridge  University Press,   Cambridge,  1998,  With  additional  material  by M.  Joshi. 
MR   2000g:46002 
[3]  J.  Hadamard,  Le  probl`eme  de  Cauchy  et  les   `
eriv´
equatons  aux  d´
ees  partiel les 
lin´eaires  hyperboliques,   Hermann,  Paris,  1932. 
[4]  L.  H¨ormander,   The  analysis  of 
linear  partial   diﬀerential  operators,  vol.  3, 
Springer­Verlag,  Berlin,   Heidelberg,  New   York,  Tokyo,  1985. 
[5]  W.  Rudin,  Real  and  complex  analysis,  third   edition   ed.,  McGraw­Hill,  1987. 
[6]  George  F.  Simmons,   Introduction  to  topology  and  modern  analysis,  Robert  E. 
Krieger  Publishing  Co.   Inc.,  Melbourne,  Fla.,  1983,  Reprint   of  the  1963  original. 
MR   84b:54002 

